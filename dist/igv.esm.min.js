function t(t){return function(t,e){const i=document.createElement(t);e&&(e.class&&i.classList.add(e.class),e.id&&(i.id=e.id),e.style&&function(t,e){for(let i of Object.keys(e))t.style[i]=e[i]}(i,e.style));return i}("div",t)}function e(t){const e=getComputedStyle(t);"none"!==e.display&&(t._initialDisplay=e.display),t.style.display="none"}function i(t){if("none"===getComputedStyle(t).display){const e=t._initialDisplay||"block";t.style.display=e}}function n(t,e){e=e||"currentColor";let i=r[t];i||(console.error(`No icon named: ${t}`),i=r.question);const n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttributeNS(null,"viewBox","0 0 "+i[0]+" "+i[1]);const s=document.createElementNS("http://www.w3.org/2000/svg","path");return s.setAttributeNS(null,"fill",e),s.setAttributeNS(null,"d",i[4]),n.appendChild(s),n}const r={check:[512,512,[],"f00c","M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"],cog:[512,512,[],"f013","M444.788 291.1l42.616 24.599c4.867 2.809 7.126 8.618 5.459 13.985-11.07 35.642-29.97 67.842-54.689 94.586a12.016 12.016 0 0 1-14.832 2.254l-42.584-24.595a191.577 191.577 0 0 1-60.759 35.13v49.182a12.01 12.01 0 0 1-9.377 11.718c-34.956 7.85-72.499 8.256-109.219.007-5.49-1.233-9.403-6.096-9.403-11.723v-49.184a191.555 191.555 0 0 1-60.759-35.13l-42.584 24.595a12.016 12.016 0 0 1-14.832-2.254c-24.718-26.744-43.619-58.944-54.689-94.586-1.667-5.366.592-11.175 5.459-13.985L67.212 291.1a193.48 193.48 0 0 1 0-70.199l-42.616-24.599c-4.867-2.809-7.126-8.618-5.459-13.985 11.07-35.642 29.97-67.842 54.689-94.586a12.016 12.016 0 0 1 14.832-2.254l42.584 24.595a191.577 191.577 0 0 1 60.759-35.13V25.759a12.01 12.01 0 0 1 9.377-11.718c34.956-7.85 72.499-8.256 109.219-.007 5.49 1.233 9.403 6.096 9.403 11.723v49.184a191.555 191.555 0 0 1 60.759 35.13l42.584-24.595a12.016 12.016 0 0 1 14.832 2.254c24.718 26.744 43.619 58.944 54.689 94.586 1.667 5.366-.592 11.175-5.459 13.985L444.788 220.9a193.485 193.485 0 0 1 0 70.2zM336 256c0-44.112-35.888-80-80-80s-80 35.888-80 80 35.888 80 80 80 80-35.888 80-80z"],exclamation:[192,512,[],"f12a","M176 432c0 44.112-35.888 80-80 80s-80-35.888-80-80 35.888-80 80-80 80 35.888 80 80zM25.26 25.199l13.6 272C39.499 309.972 50.041 320 62.83 320h66.34c12.789 0 23.331-10.028 23.97-22.801l13.6-272C167.425 11.49 156.496 0 142.77 0H49.23C35.504 0 24.575 11.49 25.26 25.199z"],"exclamation-circle":[512,512,[],"f06a","M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"],"exclamation-triangle":[576,512,[],"f071","M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"],minus:[448,512,[],"f068","M424 318.2c13.3 0 24-10.7 24-24v-76.4c0-13.3-10.7-24-24-24H24c-13.3 0-24 10.7-24 24v76.4c0 13.3 10.7 24 24 24h400z"],"minus-circle":[512,512,[],"f056","M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zM124 296c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h264c6.6 0 12 5.4 12 12v56c0 6.6-5.4 12-12 12H124z"],"minus-square":[448,512,[],"f146","M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zM92 296c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h264c6.6 0 12 5.4 12 12v56c0 6.6-5.4 12-12 12H92z"],plus:[448,512,[],"f067","M448 294.2v-76.4c0-13.3-10.7-24-24-24H286.2V56c0-13.3-10.7-24-24-24h-76.4c-13.3 0-24 10.7-24 24v137.8H24c-13.3 0-24 10.7-24 24v76.4c0 13.3 10.7 24 24 24h137.8V456c0 13.3 10.7 24 24 24h76.4c13.3 0 24-10.7 24-24V318.2H424c13.3 0 24-10.7 24-24z"],"plus-circle":[512,512,[],"f055","M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92h-92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z"],"plus-square":[448,512,[],"f0fe","M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zm-32 252c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92H92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z"],question:[384,512,[],"f128","M202.021 0C122.202 0 70.503 32.703 29.914 91.026c-7.363 10.58-5.093 25.086 5.178 32.874l43.138 32.709c10.373 7.865 25.132 6.026 33.253-4.148 25.049-31.381 43.63-49.449 82.757-49.449 30.764 0 68.816 19.799 68.816 49.631 0 22.552-18.617 34.134-48.993 51.164-35.423 19.86-82.299 44.576-82.299 106.405V320c0 13.255 10.745 24 24 24h72.471c13.255 0 24-10.745 24-24v-5.773c0-42.86 125.268-44.645 125.268-160.627C377.504 66.256 286.902 0 202.021 0zM192 373.459c-38.196 0-69.271 31.075-69.271 69.271 0 38.195 31.075 69.27 69.271 69.27s69.271-31.075 69.271-69.271-31.075-69.27-69.271-69.27z"],save:[448,512,[],"f0c7","M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"],search:[512,512,[],"f002","M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"],share:[512,512,[],"f064","M503.691 189.836L327.687 37.851C312.281 24.546 288 35.347 288 56.015v80.053C127.371 137.907 0 170.1 0 322.326c0 61.441 39.581 122.309 83.333 154.132 13.653 9.931 33.111-2.533 28.077-18.631C66.066 312.814 132.917 274.316 288 272.085V360c0 20.7 24.3 31.453 39.687 18.164l176.004-152c11.071-9.562 11.086-26.753 0-36.328z"],spinner:[512,512,[],"f110","M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"],square:[448,512,[],"f0c8","M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48z"],"square-full":[512,512,[],"f45c","M512 512H0V0h512v512z"],times:[384,512,[],"f00d","M323.1 441l53.9-53.9c9.4-9.4 9.4-24.5 0-33.9L279.8 256l97.2-97.2c9.4-9.4 9.4-24.5 0-33.9L323.1 71c-9.4-9.4-24.5-9.4-33.9 0L192 168.2 94.8 71c-9.4-9.4-24.5-9.4-33.9 0L7 124.9c-9.4 9.4-9.4 24.5 0 33.9l97.2 97.2L7 353.2c-9.4 9.4-9.4 24.5 0 33.9L60.9 441c9.4 9.4 24.5 9.4 33.9 0l97.2-97.2 97.2 97.2c9.3 9.3 24.5 9.3 33.9 0z"],"times-circle":[512,512,[],"f057","M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z"],wrench:[512,512,[],"f0ad","M481.156 200c9.3 0 15.12 10.155 10.325 18.124C466.295 259.992 420.419 288 368 288c-79.222 0-143.501-63.974-143.997-143.079C223.505 65.469 288.548-.001 368.002 0c52.362.001 98.196 27.949 123.4 69.743C496.24 77.766 490.523 88 481.154 88H376l-40 56 40 56h105.156zm-171.649 93.003L109.255 493.255c-24.994 24.993-65.515 24.994-90.51 0-24.993-24.994-24.993-65.516 0-90.51L218.991 202.5c16.16 41.197 49.303 74.335 90.516 90.503zM104 432c0-13.255-10.745-24-24-24s-24 10.745-24 24 10.745 24 24 24 24-10.745 24-24z"]};function s(t,e){var i,r=document.createElement("div");t.appendChild(r),r.appendChild(n("times",i)),r.addEventListener("click",(function(t){t.preventDefault(),t.stopPropagation(),e()}))}var o={Huffman:{},Util:{},CRC32:{},CompressionMethod:{DEFLATE:8,RESERVED:15},Zip:function(t){t=t||{},this.files=[],this.comment=t.comment,this.password}};o.Zip.CompressionMethod={STORE:0,DEFLATE:8},o.Zip.OperatingSystem={MSDOS:0,UNIX:3,MACINTOSH:7},o.Zip.Flags={ENCRYPT:1,DESCRIPTOR:8,UTF8:2048},o.Zip.FileHeaderSignature=[80,75,1,2],o.Zip.LocalFileHeaderSignature=[80,75,3,4],o.Zip.CentralDirectorySignature=[80,75,5,6],o.Zip.prototype.addFile=function(t,e){(e=e||{}).filename;var i,n=t.length,r=0;if(t instanceof Array&&(t=new Uint8Array(t)),"number"!=typeof e.compressionMethod&&(e.compressionMethod=o.Zip.CompressionMethod.DEFLATE),e.compress)switch(e.compressionMethod){case o.Zip.CompressionMethod.STORE:break;case o.Zip.CompressionMethod.DEFLATE:r=o.CRC32.calc(t),t=this.deflateWithOption(t,e),i=!0;break;default:throw new Error("unknown compression method:"+e.compressionMethod)}this.files.push({buffer:t,option:e,compressed:i,encrypted:!1,size:n,crc32:r})},o.Zip.prototype.setPassword=function(t){this.password=t},o.Zip.prototype.compress=function(){var t,e,i,n,r,s,a,h,l,c,u,f,d,p,g,m,b,w,v,y,x,k,S,_,C,E,T=this.files,A=0,R=0;for(S=0,_=T.length;S<_;++S){if(p=(t=T[S]).option.filename?t.option.filename.length:0,g=t.option.extraField?t.option.extraField.length:0,m=t.option.comment?t.option.comment.length:0,!t.compressed)switch(t.crc32=o.CRC32.calc(t.buffer),t.option.compressionMethod){case o.Zip.CompressionMethod.STORE:break;case o.Zip.CompressionMethod.DEFLATE:t.buffer=this.deflateWithOption(t.buffer,t.option),t.compressed=!0;break;default:throw new Error("unknown compression method:"+t.option.compressionMethod)}if(void 0!==t.option.password||void 0!==this.password){for(k=this.createEncryptionKey(t.option.password||this.password),y=t.buffer,(x=new Uint8Array(y.length+12)).set(y,12),y=x,C=0;C<12;++C)y[C]=this.encode(k,11===S?255&t.crc32:256*Math.random()|0);for(E=y.length;C<E;++C)y[C]=this.encode(k,y[C]);t.buffer=y}A+=30+p+t.buffer.length,R+=46+p+m}for(s=22+(this.comment?this.comment.length:0),e=new Uint8Array(A+R+s),i=0,r=(n=A)+R,S=0,_=T.length;S<_;++S)p=(t=T[S]).option.filename?t.option.filename.length:0,g=0,m=t.option.comment?t.option.comment.length:0,a=i,e[i++]=o.Zip.LocalFileHeaderSignature[0],e[i++]=o.Zip.LocalFileHeaderSignature[1],e[i++]=o.Zip.LocalFileHeaderSignature[2],e[i++]=o.Zip.LocalFileHeaderSignature[3],e[n++]=o.Zip.FileHeaderSignature[0],e[n++]=o.Zip.FileHeaderSignature[1],e[n++]=o.Zip.FileHeaderSignature[2],e[n++]=o.Zip.FileHeaderSignature[3],20,e[n++]=20,e[n++]=t.option.os||o.Zip.OperatingSystem.MSDOS,e[i++]=e[n++]=20,e[i++]=e[n++]=0,h=0,(t.option.password||this.password)&&(h|=o.Zip.Flags.ENCRYPT),e[i++]=e[n++]=255&h,e[i++]=e[n++]=h>>8&255,l=t.option.compressionMethod,e[i++]=e[n++]=255&l,e[i++]=e[n++]=l>>8&255,c=t.option.date||new Date,e[i++]=e[n++]=(7&c.getMinutes())<<5|c.getSeconds()/2|0,e[i++]=e[n++]=c.getHours()<<3|c.getMinutes()>>3,e[i++]=e[n++]=(c.getMonth()+1&7)<<5|c.getDate(),e[i++]=e[n++]=(c.getFullYear()-1980&127)<<1|c.getMonth()+1>>3,u=t.crc32,e[i++]=e[n++]=255&u,e[i++]=e[n++]=u>>8&255,e[i++]=e[n++]=u>>16&255,e[i++]=e[n++]=u>>24&255,f=t.buffer.length,e[i++]=e[n++]=255&f,e[i++]=e[n++]=f>>8&255,e[i++]=e[n++]=f>>16&255,e[i++]=e[n++]=f>>24&255,d=t.size,e[i++]=e[n++]=255&d,e[i++]=e[n++]=d>>8&255,e[i++]=e[n++]=d>>16&255,e[i++]=e[n++]=d>>24&255,e[i++]=e[n++]=255&p,e[i++]=e[n++]=p>>8&255,e[i++]=e[n++]=255&g,e[i++]=e[n++]=g>>8&255,e[n++]=255&m,e[n++]=m>>8&255,e[n++]=0,e[n++]=0,e[n++]=0,e[n++]=0,e[n++]=0,e[n++]=0,e[n++]=0,e[n++]=0,e[n++]=255&a,e[n++]=a>>8&255,e[n++]=a>>16&255,e[n++]=a>>24&255,(b=t.option.filename)&&(e.set(b,i),e.set(b,n),i+=p,n+=p),(w=t.option.extraField)&&(e.set(w,i),e.set(w,n),i+=g,n+=g),(v=t.option.comment)&&(e.set(v,n),n+=m),e.set(t.buffer,i),i+=t.buffer.length;return e[r++]=o.Zip.CentralDirectorySignature[0],e[r++]=o.Zip.CentralDirectorySignature[1],e[r++]=o.Zip.CentralDirectorySignature[2],e[r++]=o.Zip.CentralDirectorySignature[3],e[r++]=0,e[r++]=0,e[r++]=0,e[r++]=0,e[r++]=255&_,e[r++]=_>>8&255,e[r++]=255&_,e[r++]=_>>8&255,e[r++]=255&R,e[r++]=R>>8&255,e[r++]=R>>16&255,e[r++]=R>>24&255,e[r++]=255&A,e[r++]=A>>8&255,e[r++]=A>>16&255,e[r++]=A>>24&255,m=this.comment?this.comment.length:0,e[r++]=255&m,e[r++]=m>>8&255,this.comment&&(e.set(this.comment,r),r+=m),e},o.Zip.prototype.deflateWithOption=function(t,e){return new o.RawDeflate(t,e.deflateOption).compress()},o.Zip.prototype.getByte=function(t){var e=65535&t[2]|2;return e*(1^e)>>8&255},o.Zip.prototype.encode=function(t,e){var i=this.getByte(t);return this.updateKeys(t,e),i^e},o.Zip.prototype.updateKeys=function(t,e){t[0]=o.CRC32.single(t[0],e),t[1]=1+(6681*(20173*(t[1]+(255&t[0]))>>>0)>>>0)>>>0,t[2]=o.CRC32.single(t[2],t[1]>>>24)},o.Zip.prototype.createEncryptionKey=function(t){var e,i,n=[305419896,591751049,878082192];for(n=new Uint32Array(n),e=0,i=t.length;e<i;++e)this.updateKeys(n,255&t[e]);return n},o.Huffman.buildHuffmanTable=function(t){var e,i,n,r,s,o,a,h,l,c,u,f=t.length,d=0,p=Number.POSITIVE_INFINITY;for(h=0,l=f;h<l;++h)t[h]>d&&(d=t[h]),t[h]<p&&(p=t[h]);for(e=1<<d,i=new Uint32Array(e),n=1,r=0,s=2;n<=d;){for(h=0;h<f;++h)if(t[h]===n){for(o=0,a=r,c=0;c<n;++c)o=o<<1|1&a,a>>=1;for(u=n<<16|h,c=o;c<e;c+=s)i[c]=u;++r}++n,r<<=1,s<<=1}return[i,d,p]};var a=o.Huffman.buildHuffmanTable;o.RawInflate=function(t,e){switch(this.buffer,this.blocks=[],this.bufferSize=32768,this.totalpos=0,this.ip=0,this.bitsbuf=0,this.bitsbuflen=0,this.input=new Uint8Array(t),this.output,this.op,this.bfinal=!1,this.bufferType=o.RawInflate.BufferType.ADAPTIVE,this.resize=!1,!e&&(e={})||(e.index&&(this.ip=e.index),e.bufferSize&&(this.bufferSize=e.bufferSize),e.bufferType&&(this.bufferType=e.bufferType),e.resize&&(this.resize=e.resize)),this.bufferType){case o.RawInflate.BufferType.BLOCK:this.op=o.RawInflate.MaxBackwardLength,this.output=new Uint8Array(o.RawInflate.MaxBackwardLength+this.bufferSize+o.RawInflate.MaxCopyLength);break;case o.RawInflate.BufferType.ADAPTIVE:this.op=0,this.output=new Uint8Array(this.bufferSize);break;default:throw new Error("invalid inflate mode")}},o.RawInflate.BufferType={BLOCK:0,ADAPTIVE:1},o.RawInflate.prototype.decompress=function(){for(;!this.bfinal;)this.parseBlock();switch(this.bufferType){case o.RawInflate.BufferType.BLOCK:return this.concatBufferBlock();case o.RawInflate.BufferType.ADAPTIVE:return this.concatBufferDynamic();default:throw new Error("invalid inflate mode")}},o.RawInflate.MaxBackwardLength=32768,o.RawInflate.MaxCopyLength=258,o.RawInflate.Order=new Uint16Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),o.RawInflate.LengthCodeTable=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258]),o.RawInflate.LengthExtraTable=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0]),o.RawInflate.DistCodeTable=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577]),o.RawInflate.DistExtraTable=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),o.RawInflate.FixedLiteralLengthTable=function(){var t,e,i=new Uint8Array(288);for(t=0,e=i.length;t<e;++t)i[t]=t<=143?8:t<=255?9:t<=279?7:8;return a(i)}(),o.RawInflate.FixedDistanceTable=function(){var t,e,i=new Uint8Array(30);for(t=0,e=i.length;t<e;++t)i[t]=5;return a(i)}(),o.RawInflate.prototype.parseBlock=function(){var t=this.readBits(3);switch(1&t&&(this.bfinal=!0),t>>>=1){case 0:this.parseUncompressedBlock();break;case 1:this.parseFixedHuffmanBlock();break;case 2:this.parseDynamicHuffmanBlock();break;default:throw new Error("unknown BTYPE: "+t)}},o.RawInflate.prototype.readBits=function(t){var e,i=this.bitsbuf,n=this.bitsbuflen,r=this.input,s=this.ip;if(s+(t-n+7>>3)>=r.length)throw new Error("input buffer is broken");for(;n<t;)i|=r[s++]<<n,n+=8;return e=i&(1<<t)-1,i>>>=t,n-=t,this.bitsbuf=i,this.bitsbuflen=n,this.ip=s,e},o.RawInflate.prototype.readCodeByTable=function(t){for(var e,i,n=this.bitsbuf,r=this.bitsbuflen,s=this.input,o=this.ip,a=s.length,h=t[0],l=t[1];r<l&&!(o>=a);)n|=s[o++]<<r,r+=8;if((i=(e=h[n&(1<<l)-1])>>>16)>r)throw new Error("invalid code length: "+i);return this.bitsbuf=n>>i,this.bitsbuflen=r-i,this.ip=o,65535&e},o.RawInflate.prototype.parseUncompressedBlock=function(){var t,e,i=this.input,n=this.ip,r=this.output,s=this.op,a=i.length,h=r.length;if(this.bitsbuf=0,this.bitsbuflen=0,n+1>=a)throw new Error("invalid uncompressed block header: LEN");if(t=i[n++]|i[n++]<<8,n+1>=a)throw new Error("invalid uncompressed block header: NLEN");if(t===~(i[n++]|i[n++]<<8))throw new Error("invalid uncompressed block header: length verify");if(n+t>i.length)throw new Error("input buffer is broken");switch(this.bufferType){case o.RawInflate.BufferType.BLOCK:for(;s+t>r.length;)t-=e=h-s,r.set(i.subarray(n,n+e),s),s+=e,n+=e,this.op=s,r=this.expandBufferBlock(),s=this.op;break;case o.RawInflate.BufferType.ADAPTIVE:for(;s+t>r.length;)r=this.expandBufferAdaptive({fixRatio:2});break;default:throw new Error("invalid inflate mode")}r.set(i.subarray(n,n+t),s),s+=t,n+=t,this.ip=n,this.op=s,this.output=r},o.RawInflate.prototype.parseFixedHuffmanBlock=function(){switch(this.bufferType){case o.RawInflate.BufferType.ADAPTIVE:this.decodeHuffmanAdaptive(o.RawInflate.FixedLiteralLengthTable,o.RawInflate.FixedDistanceTable);break;case o.RawInflate.BufferType.BLOCK:this.decodeHuffmanBlock(o.RawInflate.FixedLiteralLengthTable,o.RawInflate.FixedDistanceTable);break;default:throw new Error("invalid inflate mode")}},o.RawInflate.prototype.parseDynamicHuffmanBlock=function(){var t,e,i,n,r,s,h,l,c,u=this.readBits(5)+257,f=this.readBits(5)+1,d=this.readBits(4)+4,p=new Uint8Array(o.RawInflate.Order.length);for(l=0;l<d;++l)p[o.RawInflate.Order[l]]=this.readBits(3);for(t=a(p),n=new Uint8Array(u+f),l=0,c=u+f;l<c;)switch(r=this.readCodeByTable(t)){case 16:for(h=3+this.readBits(2);h--;)n[l++]=s;break;case 17:for(h=3+this.readBits(3);h--;)n[l++]=0;s=0;break;case 18:for(h=11+this.readBits(7);h--;)n[l++]=0;s=0;break;default:n[l++]=r,s=r}switch(e=a(n.subarray(0,u)),i=a(n.subarray(u)),this.bufferType){case o.RawInflate.BufferType.ADAPTIVE:this.decodeHuffmanAdaptive(e,i);break;case o.RawInflate.BufferType.BLOCK:this.decodeHuffmanBlock(e,i);break;default:throw new Error("invalid inflate mode")}},o.RawInflate.prototype.decodeHuffmanBlock=function(t,e){var i=this.output,n=this.op;this.currentLitlenTable=t;for(var r,s,a,h,l=i.length-o.RawInflate.MaxCopyLength,c=o.RawInflate.LengthCodeTable,u=o.RawInflate.LengthExtraTable,f=o.RawInflate.DistCodeTable,d=o.RawInflate.DistExtraTable;256!==(r=this.readCodeByTable(t));)if(r<256)n>=l&&(this.op=n,i=this.expandBufferBlock(),n=this.op),i[n++]=r;else for(h=c[s=r-257],u[s]>0&&(h+=this.readBits(u[s])),a=f[r=this.readCodeByTable(e)],d[r]>0&&(a+=this.readBits(d[r])),n>=l&&(this.op=n,i=this.expandBufferBlock(),n=this.op);h--;)i[n]=i[n++-a];for(;this.bitsbuflen>=8;)this.bitsbuflen-=8,this.ip--;this.op=n},o.RawInflate.prototype.decodeHuffmanAdaptive=function(t,e){var i=this.output,n=this.op;this.currentLitlenTable=t;for(var r,s,a,h,l=i.length,c=o.RawInflate.LengthCodeTable,u=o.RawInflate.LengthExtraTable,f=o.RawInflate.DistCodeTable,d=o.RawInflate.DistExtraTable;256!==(r=this.readCodeByTable(t));)if(r<256)n>=l&&(l=(i=this.expandBufferAdaptive()).length),i[n++]=r;else for(h=c[s=r-257],u[s]>0&&(h+=this.readBits(u[s])),a=f[r=this.readCodeByTable(e)],d[r]>0&&(a+=this.readBits(d[r])),n+h>l&&(l=(i=this.expandBufferAdaptive()).length);h--;)i[n]=i[n++-a];for(;this.bitsbuflen>=8;)this.bitsbuflen-=8,this.ip--;this.op=n},o.RawInflate.prototype.expandBufferBlock=function(t){var e=new Uint8Array(this.op-o.RawInflate.MaxBackwardLength),i=this.op-o.RawInflate.MaxBackwardLength,n=this.output;return e.set(n.subarray(o.RawInflate.MaxBackwardLength,e.length)),this.blocks.push(e),this.totalpos+=e.length,n.set(n.subarray(i,i+o.RawInflate.MaxBackwardLength)),this.op=o.RawInflate.MaxBackwardLength,n},o.RawInflate.prototype.expandBufferAdaptive=function(t){var e,i,n,r=this.input.length/this.ip+1|0,s=this.input,o=this.output;return t&&("number"==typeof t.fixRatio&&(r=t.fixRatio),"number"==typeof t.addRatio&&(r+=t.addRatio)),i=r<2?(n=(s.length-this.ip)/this.currentLitlenTable[2]/2*258|0)<o.length?o.length+n:o.length<<1:o.length*r,(e=new Uint8Array(i)).set(o),this.output=e,this.output},o.RawInflate.prototype.concatBufferBlock=function(){var t,e,i,n,r,s=0,a=this.totalpos+(this.op-o.RawInflate.MaxBackwardLength),h=this.output,l=this.blocks,c=new Uint8Array(a);if(0===l.length)return this.output.subarray(o.RawInflate.MaxBackwardLength,this.op);for(e=0,i=l.length;e<i;++e)for(n=0,r=(t=l[e]).length;n<r;++n)c[s++]=t[n];for(e=o.RawInflate.MaxBackwardLength,i=this.op;e<i;++e)c[s++]=h[e];return this.blocks=[],this.buffer=c,this.buffer},o.RawInflate.prototype.concatBufferDynamic=function(){var t,e=this.op;return this.resize?(t=new Uint8Array(e)).set(this.output.subarray(0,e)):t=this.output.subarray(0,e),this.buffer=t,this.buffer};var h;a=o.Huffman.buildHuffmanTable;let l,c;function u(t,e){e.addEventListener("mousedown",f.bind(t))}function f(t){t.stopPropagation(),t.preventDefault();!function(t){if(!t.getClientRects().length)return{top:0,left:0};const e=t.getBoundingClientRect(),i=t.ownerDocument.defaultView;e.top,i.pageYOffset,e.left,i.pageXOffset}(this);const e=d.bind(this),i=p.bind(this),n=getComputedStyle(this),r=parseInt(n.top.replace("px","")),s=parseInt(n.left.replace("px",""));c={dragFunction:e,dragEndFunction:i,screenX:t.screenX,screenY:t.screenY,top:r,left:s},document.addEventListener("mousemove",e),document.addEventListener("mouseup",i),document.addEventListener("mouseleave",i),document.addEventListener("mouseexit",i)}function d(t){if(!c)return;t.stopPropagation(),t.preventDefault();const e=t.screenX-c.screenX,i=t.screenY-c.screenY;this.style.left=`${c.left+e}px`,this.style.top=`${c.top+i}px`}function p(t){if(!c)return;t.stopPropagation(),t.preventDefault();const e=c.dragFunction,i=c.dragEndFunction;document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",i),document.removeEventListener("mouseleave",i),document.removeEventListener("mouseexit",i),c=void 0}o.RawInflateStream=function(t,e,i){this.blocks=[],this.bufferSize=i||65e3,this.totalpos=0,this.ip=void 0===e?0:e,this.bitsbuf=0,this.bitsbuflen=0,this.input=new Uint8Array(t),this.output=new Uint8Array(this.bufferSize),this.op=0,this.bfinal=!1,this.blockLength,this.resize=!1,this.litlenTable,this.distTable,this.sp=0,this.status=o.RawInflateStream.Status.INITIALIZED,this.ip_,this.bitsbuflen_,this.bitsbuf_},o.RawInflateStream.BlockType={UNCOMPRESSED:0,FIXED:1,DYNAMIC:2},o.RawInflateStream.Status={INITIALIZED:0,BLOCK_HEADER_START:1,BLOCK_HEADER_END:2,BLOCK_BODY_START:3,BLOCK_BODY_END:4,DECODE_BLOCK_START:5,DECODE_BLOCK_END:6},o.RawInflateStream.prototype.decompress=function(t,e){var i=!1;for(void 0!==t&&(this.input=t),void 0!==e&&(this.ip=e);!i;)switch(this.status){case o.RawInflateStream.Status.INITIALIZED:case o.RawInflateStream.Status.BLOCK_HEADER_START:this.readBlockHeader()<0&&(i=!0);break;case o.RawInflateStream.Status.BLOCK_HEADER_END:case o.RawInflateStream.Status.BLOCK_BODY_START:switch(this.currentBlockType){case o.RawInflateStream.BlockType.UNCOMPRESSED:this.readUncompressedBlockHeader()<0&&(i=!0);break;case o.RawInflateStream.BlockType.FIXED:this.parseFixedHuffmanBlock()<0&&(i=!0);break;case o.RawInflateStream.BlockType.DYNAMIC:this.parseDynamicHuffmanBlock()<0&&(i=!0)}break;case o.RawInflateStream.Status.BLOCK_BODY_END:case o.RawInflateStream.Status.DECODE_BLOCK_START:switch(this.currentBlockType){case o.RawInflateStream.BlockType.UNCOMPRESSED:this.parseUncompressedBlock()<0&&(i=!0);break;case o.RawInflateStream.BlockType.FIXED:case o.RawInflateStream.BlockType.DYNAMIC:this.decodeHuffman()<0&&(i=!0)}break;case o.RawInflateStream.Status.DECODE_BLOCK_END:this.bfinal?i=!0:this.status=o.RawInflateStream.Status.INITIALIZED}return this.concatBuffer()},o.RawInflateStream.MaxBackwardLength=32768,o.RawInflateStream.MaxCopyLength=258,o.RawInflateStream.Order=new Uint16Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),o.RawInflateStream.LengthCodeTable=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258]),o.RawInflateStream.LengthExtraTable=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0]),o.RawInflateStream.DistCodeTable=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577]),o.RawInflateStream.DistExtraTable=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),o.RawInflateStream.FixedLiteralLengthTable=function(){var t,e,i=new Uint8Array(288);for(t=0,e=i.length;t<e;++t)i[t]=t<=143?8:t<=255?9:t<=279?7:8;return a(i)}(),o.RawInflateStream.FixedDistanceTable=function(){var t,e,i=new Uint8Array(30);for(t=0,e=i.length;t<e;++t)i[t]=5;return a(i)}(),o.RawInflateStream.prototype.readBlockHeader=function(){var t;if(this.status=o.RawInflateStream.Status.BLOCK_HEADER_START,this.save_(),(t=this.readBits(3))<0)return this.restore_(),-1;switch(1&t&&(this.bfinal=!0),t>>>=1){case 0:this.currentBlockType=o.RawInflateStream.BlockType.UNCOMPRESSED;break;case 1:this.currentBlockType=o.RawInflateStream.BlockType.FIXED;break;case 2:this.currentBlockType=o.RawInflateStream.BlockType.DYNAMIC;break;default:throw new Error("unknown BTYPE: "+t)}this.status=o.RawInflateStream.Status.BLOCK_HEADER_END},o.RawInflateStream.prototype.readBits=function(t){for(var e,i=this.bitsbuf,n=this.bitsbuflen,r=this.input,s=this.ip;n<t;){if(r.length<=s)return-1;i|=(e=r[s++])<<n,n+=8}return e=i&(1<<t)-1,i>>>=t,n-=t,this.bitsbuf=i,this.bitsbuflen=n,this.ip=s,e},o.RawInflateStream.prototype.readCodeByTable=function(t){for(var e,i,n=this.bitsbuf,r=this.bitsbuflen,s=this.input,o=this.ip,a=t[0],h=t[1];r<h;){if(s.length<=o)return-1;n|=s[o++]<<r,r+=8}if((i=(e=a[n&(1<<h)-1])>>>16)>r)throw new Error("invalid code length: "+i);return this.bitsbuf=n>>i,this.bitsbuflen=r-i,this.ip=o,65535&e},o.RawInflateStream.prototype.readUncompressedBlockHeader=function(){var t,e=this.input,i=this.ip;if(this.status=o.RawInflateStream.Status.BLOCK_BODY_START,i+4>=e.length)return-1;if((t=e[i++]|e[i++]<<8)===~(e[i++]|e[i++]<<8))throw new Error("invalid uncompressed block header: length verify");this.bitsbuf=0,this.bitsbuflen=0,this.ip=i,this.blockLength=t,this.status=o.RawInflateStream.Status.BLOCK_BODY_END},o.RawInflateStream.prototype.parseUncompressedBlock=function(){var t=this.input,e=this.ip,i=this.output,n=this.op,r=this.blockLength;for(this.status=o.RawInflateStream.Status.DECODE_BLOCK_START;r--;){if(n===i.length&&(i=this.expandBuffer({fixRatio:2})),e>=t.length)return this.ip=e,this.op=n,this.blockLength=r+1,-1;i[n++]=t[e++]}return r<0&&(this.status=o.RawInflateStream.Status.DECODE_BLOCK_END),this.ip=e,this.op=n,0},o.RawInflateStream.prototype.parseFixedHuffmanBlock=function(){return this.status=o.RawInflateStream.Status.BLOCK_BODY_START,this.litlenTable=o.RawInflateStream.FixedLiteralLengthTable,this.distTable=o.RawInflateStream.FixedDistanceTable,this.status=o.RawInflateStream.Status.BLOCK_BODY_END,0},o.RawInflateStream.prototype.save_=function(){this.ip_=this.ip,this.bitsbuflen_=this.bitsbuflen,this.bitsbuf_=this.bitsbuf},o.RawInflateStream.prototype.restore_=function(){this.ip=this.ip_,this.bitsbuflen=this.bitsbuflen_,this.bitsbuf=this.bitsbuf_},o.RawInflateStream.prototype.parseDynamicHuffmanBlock=function(){var t,e,i,n,r=new Uint8Array(o.RawInflateStream.Order.length);if(this.status=o.RawInflateStream.Status.BLOCK_BODY_START,this.save_(),t=this.readBits(5)+257,e=this.readBits(5)+1,i=this.readBits(4)+4,t<0||e<0||i<0)return this.restore_(),-1;try{(function(){var s,h,l,c,u,f,d=0;for(u=0;u<i;++u){if((s=this.readBits(3))<0)throw new Error("not enough input");r[o.RawInflateStream.Order[u]]=s}for(n=a(r),c=new Uint8Array(t+e),u=0,f=t+e;u<f;){if((h=this.readCodeByTable(n))<0)throw new Error("not enough input");switch(h){case 16:if((s=this.readBits(2))<0)throw new Error("not enough input");for(l=3+s;l--;)c[u++]=d;break;case 17:if((s=this.readBits(3))<0)throw new Error("not enough input");for(l=3+s;l--;)c[u++]=0;d=0;break;case 18:if((s=this.readBits(7))<0)throw new Error("not enough input");for(l=11+s;l--;)c[u++]=0;d=0;break;default:c[u++]=h,d=h}}this.litlenTable=a(c.subarray(0,t)),this.distTable=a(c.subarray(t))}).call(this)}catch(t){return this.restore_(),-1}return this.status=o.RawInflateStream.Status.BLOCK_BODY_END,0},o.RawInflateStream.prototype.decodeHuffman=function(){var t,e,i,n,r,s=this.output,a=this.op,h=this.litlenTable,l=this.distTable,c=s.length;for(this.status=o.RawInflateStream.Status.DECODE_BLOCK_START;;){if(this.save_(),(t=this.readCodeByTable(h))<0)return this.op=a,this.restore_(),-1;if(256===t)break;if(t<256)a===c&&(c=(s=this.expandBuffer()).length),s[a++]=t;else{if(e=t-257,n=o.RawInflateStream.LengthCodeTable[e],o.RawInflateStream.LengthExtraTable[e]>0){if((r=this.readBits(o.RawInflateStream.LengthExtraTable[e]))<0)return this.op=a,this.restore_(),-1;n+=r}if((t=this.readCodeByTable(l))<0)return this.op=a,this.restore_(),-1;if(i=o.RawInflateStream.DistCodeTable[t],o.RawInflateStream.DistExtraTable[t]>0){if((r=this.readBits(o.RawInflateStream.DistExtraTable[t]))<0)return this.op=a,this.restore_(),-1;i+=r}for(a+n>=c&&(c=(s=this.expandBuffer()).length);n--;)s[a]=s[a++-i];if(this.ip===this.input.length)return this.op=a,-1}}for(;this.bitsbuflen>=8;)this.bitsbuflen-=8,this.ip--;this.op=a,this.status=o.RawInflateStream.Status.DECODE_BLOCK_END},o.RawInflateStream.prototype.expandBuffer=function(t){var e,i,n,r=this.input.length/this.ip+1|0,s=this.input,o=this.output;return t&&("number"==typeof t.fixRatio&&(r=t.fixRatio),"number"==typeof t.addRatio&&(r+=t.addRatio)),i=r<2?(n=(s.length-this.ip)/this.litlenTable[2]/2*258|0)<o.length?o.length+n:o.length<<1:o.length*r,(e=new Uint8Array(i)).set(o),this.output=e,this.output},o.RawInflateStream.prototype.concatBuffer=function(){var t,e,i=this.op;return t=this.resize?new Uint8Array(this.output.subarray(this.sp,i)):this.output.subarray(this.sp,i),this.sp=i,i>o.RawInflateStream.MaxBackwardLength+this.bufferSize&&(this.op=this.sp=o.RawInflateStream.MaxBackwardLength,e=this.output,this.output=new Uint8Array(this.bufferSize+o.RawInflateStream.MaxBackwardLength),this.output.set(e.subarray(i-o.RawInflateStream.MaxBackwardLength,i))),t},o.Inflate=function(t,e){var i,n;switch(this.input=t,this.ip=0,this.rawinflate,this.verify,!e&&(e={})||(e.index&&(this.ip=e.index),e.verify&&(this.verify=e.verify)),i=t[this.ip++],n=t[this.ip++],15&i){case o.CompressionMethod.DEFLATE:this.method=o.CompressionMethod.DEFLATE;break;default:throw new Error("unsupported compression method")}if(((i<<8)+n)%31!=0)throw new Error("invalid fcheck flag:"+((i<<8)+n)%31);if(32&n)throw new Error("fdict flag is not supported");this.rawinflate=new o.RawInflate(t,{index:this.ip,bufferSize:e.bufferSize,bufferType:e.bufferType,resize:e.resize})},o.Inflate.BufferType=o.RawInflate.BufferType,o.Inflate.prototype.decompress=function(){var t,e=this.input;if(t=this.rawinflate.decompress(),this.ip=this.rawinflate.ip,this.verify&&(e[this.ip++]<<24|e[this.ip++]<<16|e[this.ip++]<<8|e[this.ip++])>>>0!==o.Adler32(t))throw new Error("invalid adler-32 checksum");return t},o.InflateStream=function(t){this.input=void 0===t?new Uint8Array:t,this.ip=0,this.rawinflate=new o.RawInflateStream(this.input,this.ip),this.method,this.output=this.rawinflate.output},o.InflateStream.prototype.decompress=function(t){var e;if(void 0!==t){var i=new Uint8Array(this.input.length+t.length);i.set(this.input,0),i.set(t,this.input.length),this.input=i}return void 0===this.method&&this.readHeader()<0?new Uint8Array:(e=this.rawinflate.decompress(this.input,this.ip),0!==this.rawinflate.ip&&(this.input=this.input.subarray(this.rawinflate.ip),this.ip=0),e)},o.InflateStream.prototype.readHeader=function(){var t=this.ip,e=this.input,i=e[t++],n=e[t++];if(void 0===i||void 0===n)return-1;switch(15&i){case o.CompressionMethod.DEFLATE:this.method=o.CompressionMethod.DEFLATE;break;default:throw new Error("unsupported compression method")}if(((i<<8)+n)%31!=0)throw new Error("invalid fcheck flag:"+((i<<8)+n)%31);if(32&n)throw new Error("fdict flag is not supported");this.ip=t},o.Gunzip=function(t,e){this.input=t,this.ip=0,this.member=[],this.decompressed=!1},o.Gunzip.prototype.getMembers=function(){return this.decompressed||this.decompress(),this.member.slice()},o.Gunzip.prototype.decompress=function(){for(var t=this.input.length;this.ip<t;)this.decodeMember();return this.decompressed=!0,this.concatMember()},o.Gunzip.prototype.decodeMember=function(){var t,e,i,n,r,s,a,h,l,c=new o.GunzipMember,u=this.input,f=this.ip;if(c.id1=u[f++],c.id2=u[f++],31!==c.id1||139!==c.id2)throw new Error("invalid file signature:"+c.id1+","+c.id2);switch(c.cm=u[f++],c.cm){case 8:break;default:throw new Error("unknown compression method: "+c.cm)}if(c.flg=u[f++],h=u[f++]|u[f++]<<8|u[f++]<<16|u[f++]<<24,c.mtime=new Date(1e3*h),c.xfl=u[f++],c.os=u[f++],(c.flg&o.Gzip.FlagsMask.FEXTRA)>0&&(c.xlen=u[f++]|u[f++]<<8,f=this.decodeSubField(f,c.xlen)),(c.flg&o.Gzip.FlagsMask.FNAME)>0){for(a=[],s=0;(r=u[f++])>0;)a[s++]=String.fromCharCode(r);c.name=a.join("")}if((c.flg&o.Gzip.FlagsMask.FCOMMENT)>0){for(a=[],s=0;(r=u[f++])>0;)a[s++]=String.fromCharCode(r);c.comment=a.join("")}if((c.flg&o.Gzip.FlagsMask.FHCRC)>0&&(c.crc16=65535&o.CRC32.calc(u,0,f),c.crc16!==(u[f++]|u[f++]<<8)))throw new Error("invalid header crc16");if(t=u[u.length-4]|u[u.length-3]<<8|u[u.length-2]<<16|u[u.length-1]<<24,u.length-f-4-4<512*t&&(n=t),e=new o.RawInflate(u,{index:f,bufferSize:n}),c.data=i=e.decompress(),f=e.ip,c.crc32=l=(u[f++]|u[f++]<<8|u[f++]<<16|u[f++]<<24)>>>0,o.CRC32.calc(i)!==l)throw new Error("invalid CRC-32 checksum: 0x"+o.CRC32.calc(i).toString(16)+" / 0x"+l.toString(16));if(c.isize=t=(u[f++]|u[f++]<<8|u[f++]<<16|u[f++]<<24)>>>0,(4294967295&i.length)!==t)throw new Error("invalid input size: "+(4294967295&i.length)+" / "+t);this.member.push(c),this.ip=f},o.Gunzip.prototype.decodeSubField=function(t,e){return t+e},o.Gunzip.prototype.concatMember=function(){var t,e,i,n=this.member,r=0,s=0;for(t=0,e=n.length;t<e;++t)s+=n[t].data.length;for(i=new Uint8Array(s),t=0;t<e;++t)i.set(n[t].data,r),r+=n[t].data.length;return i},o.GunzipMember=function(){this.id1,this.id2,this.cm,this.flg,this.mtime,this.xfl,this.os,this.crc16,this.xlen,this.crc32,this.isize,this.name,this.comment,this.data},o.GunzipMember.prototype.getName=function(){return this.name},o.GunzipMember.prototype.getData=function(){return this.data},o.GunzipMember.prototype.getMtime=function(){return this.mtime},o.Gzip=function(t,e){this.input=t,this.ip=0,this.output,this.op=0,this.flags={},this.filename,this.comment,this.deflateOptions,e&&(e.flags&&(this.flags=e.flags),"string"==typeof e.filename&&(this.filename=e.filename),"string"==typeof e.comment&&(this.comment=e.comment),e.deflateOptions&&(this.deflateOptions=e.deflateOptions)),this.deflateOptions||(this.deflateOptions={})},o.Gzip.DefaultBufferSize=32768,o.Gzip.prototype.compress=function(){var t,e,i,n,r,s,a,h,l=new Uint8Array(o.Gzip.DefaultBufferSize),c=0,u=this.input,f=this.ip,d=this.filename,p=this.comment;if(l[c++]=31,l[c++]=139,l[c++]=8,t=0,this.flags.fname&&(t|=o.Gzip.FlagsMask.FNAME),this.flags.fcomment&&(t|=o.Gzip.FlagsMask.FCOMMENT),this.flags.fhcrc&&(t|=o.Gzip.FlagsMask.FHCRC),l[c++]=t,e=(Date.now?Date.now():+new Date)/1e3|0,l[c++]=255&e,l[c++]=e>>>8&255,l[c++]=e>>>16&255,l[c++]=e>>>24&255,l[c++]=0,l[c++]=o.Gzip.OperatingSystem.UNKNOWN,void 0!==this.flags.fname){for(a=0,h=d.length;a<h;++a)(s=d.charCodeAt(a))>255&&(l[c++]=s>>>8&255),l[c++]=255&s;l[c++]=0}if(this.flags.comment){for(a=0,h=p.length;a<h;++a)(s=p.charCodeAt(a))>255&&(l[c++]=s>>>8&255),l[c++]=255&s;l[c++]=0}return this.flags.fhcrc&&(i=65535&o.CRC32.calc(l,0,c),l[c++]=255&i,l[c++]=i>>>8&255),this.deflateOptions.outputBuffer=l,this.deflateOptions.outputIndex=c,l=(r=new o.RawDeflate(u,this.deflateOptions)).compress(),(c=r.op)+8>l.buffer.byteLength?(this.output=new Uint8Array(c+8),this.output.set(new Uint8Array(l.buffer)),l=this.output):l=new Uint8Array(l.buffer),n=o.CRC32.calc(u),l[c++]=255&n,l[c++]=n>>>8&255,l[c++]=n>>>16&255,l[c++]=n>>>24&255,h=u.length,l[c++]=255&h,l[c++]=h>>>8&255,l[c++]=h>>>16&255,l[c++]=h>>>24&255,this.ip=f,c<l.length&&(this.output=l=l.subarray(0,c)),l},o.Gzip.OperatingSystem={FAT:0,AMIGA:1,VMS:2,UNIX:3,VM_CMS:4,ATARI_TOS:5,HPFS:6,MACINTOSH:7,Z_SYSTEM:8,CP_M:9,TOPS_20:10,NTFS:11,QDOS:12,ACORN_RISCOS:13,UNKNOWN:255},o.Gzip.FlagsMask={FTEXT:1,FHCRC:2,FEXTRA:4,FNAME:8,FCOMMENT:16},o.Heap=function(t){this.buffer=new Uint16Array(2*t),this.length=0},o.Heap.prototype.getParent=function(t){return 2*((t-2)/4|0)},o.Heap.prototype.getChild=function(t){return 2*t+2},o.Heap.prototype.push=function(t,e){var i,n,r,s=this.buffer;for(i=this.length,s[this.length++]=e,s[this.length++]=t;i>0&&(n=this.getParent(i),s[i]>s[n]);)r=s[i],s[i]=s[n],s[n]=r,r=s[i+1],s[i+1]=s[n+1],s[n+1]=r,i=n;return this.length},o.Heap.prototype.pop=function(){var t,e,i,n,r,s=this.buffer;for(e=s[0],t=s[1],this.length-=2,s[0]=s[this.length],s[1]=s[this.length+1],r=0;!((n=this.getChild(r))>=this.length)&&(n+2<this.length&&s[n+2]>s[n]&&(n+=2),s[n]>s[r]);)i=s[r],s[r]=s[n],s[n]=i,i=s[r+1],s[r+1]=s[n+1],s[n+1]=i,r=n;return{index:t,value:e,length:this.length}},o.RawDeflate=function(t,e){this.compressionType=o.RawDeflate.CompressionType.DYNAMIC,this.lazy=0,this.freqsLitLen,this.freqsDist,this.input=t instanceof Array?new Uint8Array(t):t,this.output,this.op=0,e&&(e.lazy&&(this.lazy=e.lazy),"number"==typeof e.compressionType&&(this.compressionType=e.compressionType),e.outputBuffer&&(this.output=e.outputBuffer instanceof Array?new Uint8Array(e.outputBuffer):e.outputBuffer),"number"==typeof e.outputIndex&&(this.op=e.outputIndex)),this.output||(this.output=new Uint8Array(32768))},o.RawDeflate.CompressionType={NONE:0,FIXED:1,DYNAMIC:2,RESERVED:3},o.RawDeflate.Lz77MinLength=3,o.RawDeflate.Lz77MaxLength=258,o.RawDeflate.WindowSize=32768,o.RawDeflate.MaxCodeLength=16,o.RawDeflate.HUFMAX=286,o.RawDeflate.FixedHuffmanTable=function(){var t,e=[];for(t=0;t<288;t++)switch(!0){case t<=143:e.push([t+48,8]);break;case t<=255:e.push([t-144+400,9]);break;case t<=279:e.push([t-256+0,7]);break;case t<=287:e.push([t-280+192,8]);break;default:throw"invalid literal: "+t}return e}(),o.RawDeflate.prototype.compress=function(){var t,e,i,n=this.input;switch(this.compressionType){case o.RawDeflate.CompressionType.NONE:for(e=0,i=n.length;e<i;)e+=(t=n.subarray(e,e+65535)).length,this.makeNocompressBlock(t,e===i);break;case o.RawDeflate.CompressionType.FIXED:this.output=this.makeFixedHuffmanBlock(n,!0),this.op=this.output.length;break;case o.RawDeflate.CompressionType.DYNAMIC:this.output=this.makeDynamicHuffmanBlock(n,!0),this.op=this.output.length;break;default:throw"invalid compression type"}return this.output},o.RawDeflate.prototype.makeNocompressBlock=function(t,e){var i,n,r,s,a=this.output,h=this.op;for(a=new Uint8Array(this.output.buffer);a.length<=h+t.length+5;)a=new Uint8Array(a.length<<1);return a.set(this.output),i=e?1:0,n=o.RawDeflate.CompressionType.NONE,a[h++]=i|n<<1,s=65536+~(r=t.length)&65535,a[h++]=255&r,a[h++]=r>>>8&255,a[h++]=255&s,a[h++]=s>>>8&255,a.set(t,h),h+=t.length,a=a.subarray(0,h),this.op=h,this.output=a,a},o.RawDeflate.prototype.makeFixedHuffmanBlock=function(t,e){var i,n,r,s=new o.BitStream(new Uint8Array(this.output.buffer),this.op);return i=e?1:0,n=o.RawDeflate.CompressionType.FIXED,s.writeBits(i,1,!0),s.writeBits(n,2,!0),r=this.lz77(t),this.fixedHuffman(r,s),s.finish()},o.RawDeflate.prototype.makeDynamicHuffmanBlock=function(t,e){var i,n,r,s,a,h,l,c,u,f,d,p,g,m,b,w,v,y=new o.BitStream(new Uint8Array(this.output.buffer),this.op),x=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],k=new Array(19);for(i=e?1:0,n=o.RawDeflate.CompressionType.DYNAMIC,y.writeBits(i,1,!0),y.writeBits(n,2,!0),r=this.lz77(t),l=this.getLengths_(this.freqsLitLen,15),c=this.getCodesFromLengths_(l),u=this.getLengths_(this.freqsDist,7),f=this.getCodesFromLengths_(u),s=286;s>257&&0===l[s-1];s--);for(a=30;a>1&&0===u[a-1];a--);for(d=this.getTreeSymbols_(s,l,a,u),p=this.getLengths_(d.freqs,7),w=0;w<19;w++)k[w]=p[x[w]];for(h=19;h>4&&0===k[h-1];h--);for(g=this.getCodesFromLengths_(p),y.writeBits(s-257,5,!0),y.writeBits(a-1,5,!0),y.writeBits(h-4,4,!0),w=0;w<h;w++)y.writeBits(k[w],3,!0);for(w=0,v=d.codes.length;w<v;w++)if(m=d.codes[w],y.writeBits(g[m],p[m],!0),m>=16){switch(w++,m){case 16:b=2;break;case 17:b=3;break;case 18:b=7;break;default:throw"invalid code: "+m}y.writeBits(d.codes[w],b,!0)}return this.dynamicHuffman(r,[c,l],[f,u],y),y.finish()},o.RawDeflate.prototype.dynamicHuffman=function(t,e,i,n){var r,s,o,a,h,l,c,u;for(h=e[0],l=e[1],c=i[0],u=i[1],r=0,s=t.length;r<s;++r)if(o=t[r],n.writeBits(h[o],l[o],!0),o>256)n.writeBits(t[++r],t[++r],!0),a=t[++r],n.writeBits(c[a],u[a],!0),n.writeBits(t[++r],t[++r],!0);else if(256===o)break;return n},o.RawDeflate.prototype.fixedHuffman=function(t,e){var i,n,r;for(i=0,n=t.length;i<n;i++)if(r=t[i],o.BitStream.prototype.writeBits.apply(e,o.RawDeflate.FixedHuffmanTable[r]),r>256)e.writeBits(t[++i],t[++i],!0),e.writeBits(t[++i],5),e.writeBits(t[++i],t[++i],!0);else if(256===r)break;return e},o.RawDeflate.Lz77Match=function(t,e){this.length=t,this.backwardDistance=e},o.RawDeflate.Lz77Match.LengthCodeTable=(h=function(){var t,e,i=[];for(t=3;t<=258;t++)e=n(t),i[t]=e[2]<<24|e[1]<<16|e[0];function n(t){switch(!0){case 3===t:return[257,t-3,0];case 4===t:return[258,t-4,0];case 5===t:return[259,t-5,0];case 6===t:return[260,t-6,0];case 7===t:return[261,t-7,0];case 8===t:return[262,t-8,0];case 9===t:return[263,t-9,0];case 10===t:return[264,t-10,0];case t<=12:return[265,t-11,1];case t<=14:return[266,t-13,1];case t<=16:return[267,t-15,1];case t<=18:return[268,t-17,1];case t<=22:return[269,t-19,2];case t<=26:return[270,t-23,2];case t<=30:return[271,t-27,2];case t<=34:return[272,t-31,2];case t<=42:return[273,t-35,3];case t<=50:return[274,t-43,3];case t<=58:return[275,t-51,3];case t<=66:return[276,t-59,3];case t<=82:return[277,t-67,4];case t<=98:return[278,t-83,4];case t<=114:return[279,t-99,4];case t<=130:return[280,t-115,4];case t<=162:return[281,t-131,5];case t<=194:return[282,t-163,5];case t<=226:return[283,t-195,5];case t<=257:return[284,t-227,5];case 258===t:return[285,t-258,0];default:throw"invalid length: "+t}}return i}(),new Uint32Array(h)),o.RawDeflate.Lz77Match.prototype.getDistanceCode_=function(t){var e;switch(!0){case 1===t:e=[0,t-1,0];break;case 2===t:e=[1,t-2,0];break;case 3===t:e=[2,t-3,0];break;case 4===t:e=[3,t-4,0];break;case t<=6:e=[4,t-5,1];break;case t<=8:e=[5,t-7,1];break;case t<=12:e=[6,t-9,2];break;case t<=16:e=[7,t-13,2];break;case t<=24:e=[8,t-17,3];break;case t<=32:e=[9,t-25,3];break;case t<=48:e=[10,t-33,4];break;case t<=64:e=[11,t-49,4];break;case t<=96:e=[12,t-65,5];break;case t<=128:e=[13,t-97,5];break;case t<=192:e=[14,t-129,6];break;case t<=256:e=[15,t-193,6];break;case t<=384:e=[16,t-257,7];break;case t<=512:e=[17,t-385,7];break;case t<=768:e=[18,t-513,8];break;case t<=1024:e=[19,t-769,8];break;case t<=1536:e=[20,t-1025,9];break;case t<=2048:e=[21,t-1537,9];break;case t<=3072:e=[22,t-2049,10];break;case t<=4096:e=[23,t-3073,10];break;case t<=6144:e=[24,t-4097,11];break;case t<=8192:e=[25,t-6145,11];break;case t<=12288:e=[26,t-8193,12];break;case t<=16384:e=[27,t-12289,12];break;case t<=24576:e=[28,t-16385,13];break;case t<=32768:e=[29,t-24577,13];break;default:throw"invalid distance"}return e},o.RawDeflate.Lz77Match.prototype.toLz77Array=function(){var t,e=this.length,i=this.backwardDistance,n=[],r=0;return t=o.RawDeflate.Lz77Match.LengthCodeTable[e],n[r++]=65535&t,n[r++]=t>>16&255,n[r++]=t>>24,t=this.getDistanceCode_(i),n[r++]=t[0],n[r++]=t[1],n[r++]=t[2],n},o.RawDeflate.prototype.lz77=function(t){var e,i,n,r,s,a,h,l,c,u={},f=o.RawDeflate.WindowSize,d=new Uint16Array(2*t.length),p=0,g=0,m=new Uint32Array(286),b=new Uint32Array(30),w=this.lazy;function v(t,e){var i,n,r=t.toLz77Array();for(i=0,n=r.length;i<n;++i)d[p++]=r[i];m[r[0]]++,b[r[3]]++,g=t.length+e-1,l=null}for(m[256]=1,e=0,i=t.length;e<i;++e){for(s=0,n=0,r=o.RawDeflate.Lz77MinLength;n<r&&e+n!==i;++n)s=s<<8|t[e+n];if(void 0===u[s]&&(u[s]=[]),a=u[s],g-- >0)a.push(e);else{for(;a.length>0&&e-a[0]>f;)a.shift();if(e+o.RawDeflate.Lz77MinLength>=i){for(l&&v(l,-1),n=0,r=i-e;n<r;++n)c=t[e+n],d[p++]=c,++m[c];break}a.length>0?(h=this.searchLongestMatch_(t,e,a),l?l.length<h.length?(c=t[e-1],d[p++]=c,++m[c],v(h,0)):v(l,-1):h.length<w?l=h:v(h,0)):l?v(l,-1):(c=t[e],d[p++]=c,++m[c]),a.push(e)}}return d[p++]=256,m[256]++,this.freqsLitLen=m,this.freqsDist=b,d.subarray(0,p)},o.RawDeflate.prototype.searchLongestMatch_=function(t,e,i){var n,r,s,a,h,l,c=0,u=t.length;t:for(a=0,l=i.length;a<l;a++){if(n=i[l-a-1],s=o.RawDeflate.Lz77MinLength,c>o.RawDeflate.Lz77MinLength){for(h=c;h>o.RawDeflate.Lz77MinLength;h--)if(t[n+h-1]!==t[e+h-1])continue t;s=c}for(;s<o.RawDeflate.Lz77MaxLength&&e+s<u&&t[n+s]===t[e+s];)++s;if(s>c&&(r=n,c=s),s===o.RawDeflate.Lz77MaxLength)break}return new o.RawDeflate.Lz77Match(c,e-r)},o.RawDeflate.prototype.getTreeSymbols_=function(t,e,i,n){var r,s,o,a,h,l,c=new Uint32Array(t+i),u=new Uint32Array(316),f=new Uint8Array(19);for(s=0,r=0;r<t;r++)c[s++]=e[r];for(r=0;r<i;r++)c[s++]=n[r];for(h=0,r=0,a=c.length;r<a;r+=s){for(s=1;r+s<a&&c[r+s]===c[r];++s);if(o=s,0===c[r])if(o<3)for(;o-- >0;)u[h++]=0,f[0]++;else for(;o>0;)(l=o<138?o:138)>o-3&&l<o&&(l=o-3),l<=10?(u[h++]=17,u[h++]=l-3,f[17]++):(u[h++]=18,u[h++]=l-11,f[18]++),o-=l;else if(u[h++]=c[r],f[c[r]]++,--o<3)for(;o-- >0;)u[h++]=c[r],f[c[r]]++;else for(;o>0;)(l=o<6?o:6)>o-3&&l<o&&(l=o-3),u[h++]=16,u[h++]=l-3,f[16]++,o-=l}return{codes:u.subarray(0,h),freqs:f}},o.RawDeflate.prototype.getLengths_=function(t,e){var i,n,r,s,a,h=t.length,l=new o.Heap(2*o.RawDeflate.HUFMAX),c=new Uint8Array(h);for(s=0;s<h;++s)t[s]>0&&l.push(s,t[s]);if(i=new Array(l.length/2),n=new Uint32Array(l.length/2),1===i.length)return c[l.pop().index]=1,c;for(s=0,a=l.length/2;s<a;++s)i[s]=l.pop(),n[s]=i[s].value;for(r=this.reversePackageMerge_(n,n.length,e),s=0,a=i.length;s<a;++s)c[i[s].index]=r[s];return c},o.RawDeflate.prototype.reversePackageMerge_=function(t,e,i){var n,r,s,o,a,h=new Uint16Array(i),l=new Uint8Array(i),c=new Uint8Array(e),u=new Array(i),f=new Array(i),d=new Array(i),p=(1<<i)-e,g=1<<i-1;function m(t){var i=f[t][d[t]];i===e?(m(t+1),m(t+1)):--c[i],++d[t]}for(h[i-1]=e,r=0;r<i;++r)p<g?l[r]=0:(l[r]=1,p-=g),p<<=1,h[i-2-r]=(h[i-1-r]/2|0)+e;for(h[0]=l[0],u[0]=new Array(h[0]),f[0]=new Array(h[0]),r=1;r<i;++r)h[r]>2*h[r-1]+l[r]&&(h[r]=2*h[r-1]+l[r]),u[r]=new Array(h[r]),f[r]=new Array(h[r]);for(n=0;n<e;++n)c[n]=i;for(s=0;s<h[i-1];++s)u[i-1][s]=t[s],f[i-1][s]=s;for(n=0;n<i;++n)d[n]=0;for(1===l[i-1]&&(--c[0],++d[i-1]),r=i-2;r>=0;--r){for(n=0,o=0,a=d[r+1],s=0;s<h[r];s++)(o=u[r+1][a]+u[r+1][a+1])>t[n]?(u[r][s]=o,f[r][s]=e,a+=2):(u[r][s]=t[n],f[r][s]=n,++n);d[r]=0,1===l[r]&&m(r)}return c},o.RawDeflate.prototype.getCodesFromLengths_=function(t){var e,i,n,r,s=new Uint16Array(t.length),a=[],h=[],l=0;for(e=0,i=t.length;e<i;e++)a[t[e]]=1+(0|a[t[e]]);for(e=1,i=o.RawDeflate.MaxCodeLength;e<=i;e++)h[e]=l,l+=0|a[e],l<<=1;for(e=0,i=t.length;e<i;e++)for(l=h[t[e]],h[t[e]]+=1,s[e]=0,n=0,r=t[e];n<r;n++)s[e]=s[e]<<1|1&l,l>>>=1;return s},o.Unzip=function(t,e){e=e||{},this.input=t instanceof Array?new Uint8Array(t):t,this.ip=0,this.eocdrOffset,this.numberOfThisDisk,this.startDisk,this.totalEntriesThisDisk,this.totalEntries,this.centralDirectorySize,this.centralDirectoryOffset,this.commentLength,this.comment,this.fileHeaderList,this.filenameToIndex,this.verify=e.verify||!1,this.password=e.password},o.Unzip.CompressionMethod=o.Zip.CompressionMethod,o.Unzip.FileHeaderSignature=o.Zip.FileHeaderSignature,o.Unzip.LocalFileHeaderSignature=o.Zip.LocalFileHeaderSignature,o.Unzip.CentralDirectorySignature=o.Zip.CentralDirectorySignature,o.Unzip.FileHeader=function(t,e){this.input=t,this.offset=e,this.length,this.version,this.os,this.needVersion,this.flags,this.compression,this.time,this.date,this.crc32,this.compressedSize,this.plainSize,this.fileNameLength,this.extraFieldLength,this.fileCommentLength,this.diskNumberStart,this.internalFileAttributes,this.externalFileAttributes,this.relativeOffset,this.filename,this.extraField,this.comment},o.Unzip.FileHeader.prototype.parse=function(){var t=this.input,e=this.offset;if(t[e++]!==o.Unzip.FileHeaderSignature[0]||t[e++]!==o.Unzip.FileHeaderSignature[1]||t[e++]!==o.Unzip.FileHeaderSignature[2]||t[e++]!==o.Unzip.FileHeaderSignature[3])throw new Error("invalid file header signature");this.version=t[e++],this.os=t[e++],this.needVersion=t[e++]|t[e++]<<8,this.flags=t[e++]|t[e++]<<8,this.compression=t[e++]|t[e++]<<8,this.time=t[e++]|t[e++]<<8,this.date=t[e++]|t[e++]<<8,this.crc32=(t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)>>>0,this.compressedSize=(t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)>>>0,this.plainSize=(t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)>>>0,this.fileNameLength=t[e++]|t[e++]<<8,this.extraFieldLength=t[e++]|t[e++]<<8,this.fileCommentLength=t[e++]|t[e++]<<8,this.diskNumberStart=t[e++]|t[e++]<<8,this.internalFileAttributes=t[e++]|t[e++]<<8,this.externalFileAttributes=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24,this.relativeOffset=(t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)>>>0,this.filename=String.fromCharCode.apply(null,t.subarray(e,e+=this.fileNameLength)),this.extraField=t.subarray(e,e+=this.extraFieldLength),this.comment=t.subarray(e,e+this.fileCommentLength),this.length=e-this.offset},o.Unzip.LocalFileHeader=function(t,e){this.input=t,this.offset=e,this.length,this.needVersion,this.flags,this.compression,this.time,this.date,this.crc32,this.compressedSize,this.plainSize,this.fileNameLength,this.extraFieldLength,this.filename,this.extraField},o.Unzip.LocalFileHeader.Flags=o.Zip.Flags,o.Unzip.LocalFileHeader.prototype.parse=function(){var t=this.input,e=this.offset;if(t[e++]!==o.Unzip.LocalFileHeaderSignature[0]||t[e++]!==o.Unzip.LocalFileHeaderSignature[1]||t[e++]!==o.Unzip.LocalFileHeaderSignature[2]||t[e++]!==o.Unzip.LocalFileHeaderSignature[3])throw new Error("invalid local file header signature");this.needVersion=t[e++]|t[e++]<<8,this.flags=t[e++]|t[e++]<<8,this.compression=t[e++]|t[e++]<<8,this.time=t[e++]|t[e++]<<8,this.date=t[e++]|t[e++]<<8,this.crc32=(t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)>>>0,this.compressedSize=(t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)>>>0,this.plainSize=(t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)>>>0,this.fileNameLength=t[e++]|t[e++]<<8,this.extraFieldLength=t[e++]|t[e++]<<8,this.filename=String.fromCharCode.apply(null,t.subarray(e,e+=this.fileNameLength)),this.extraField=t.subarray(e,e+=this.extraFieldLength),this.length=e-this.offset},o.Unzip.prototype.searchEndOfCentralDirectoryRecord=function(){var t,e=this.input;for(t=e.length-12;t>0;--t)if(e[t]===o.Unzip.CentralDirectorySignature[0]&&e[t+1]===o.Unzip.CentralDirectorySignature[1]&&e[t+2]===o.Unzip.CentralDirectorySignature[2]&&e[t+3]===o.Unzip.CentralDirectorySignature[3])return void(this.eocdrOffset=t);throw new Error("End of Central Directory Record not found")},o.Unzip.prototype.parseEndOfCentralDirectoryRecord=function(){var t,e=this.input;if(this.eocdrOffset||this.searchEndOfCentralDirectoryRecord(),t=this.eocdrOffset,e[t++]!==o.Unzip.CentralDirectorySignature[0]||e[t++]!==o.Unzip.CentralDirectorySignature[1]||e[t++]!==o.Unzip.CentralDirectorySignature[2]||e[t++]!==o.Unzip.CentralDirectorySignature[3])throw new Error("invalid signature");this.numberOfThisDisk=e[t++]|e[t++]<<8,this.startDisk=e[t++]|e[t++]<<8,this.totalEntriesThisDisk=e[t++]|e[t++]<<8,this.totalEntries=e[t++]|e[t++]<<8,this.centralDirectorySize=(e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24)>>>0,this.centralDirectoryOffset=(e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24)>>>0,this.commentLength=e[t++]|e[t++]<<8,this.comment=e.subarray(t,t+this.commentLength)},o.Unzip.prototype.parseFileHeader=function(){var t,e,i,n,r=[],s={};if(!this.fileHeaderList){for(void 0===this.centralDirectoryOffset&&this.parseEndOfCentralDirectoryRecord(),t=this.centralDirectoryOffset,i=0,n=this.totalEntries;i<n;++i)(e=new o.Unzip.FileHeader(this.input,t)).parse(),t+=e.length,r[i]=e,s[e.filename]=i;if(this.centralDirectorySize<t-this.centralDirectoryOffset)throw new Error("invalid file header size");this.fileHeaderList=r,this.filenameToIndex=s}},o.Unzip.prototype.getFileData=function(t,e){e=e||{};var i,n,r,s,a,h,l,c,u=this.input,f=this.fileHeaderList;if(f||this.parseFileHeader(),void 0===f[t])throw new Error("wrong index");if(n=f[t].relativeOffset,(i=new o.Unzip.LocalFileHeader(this.input,n)).parse(),n+=i.length,r=i.compressedSize,0!=(i.flags&o.Unzip.LocalFileHeader.Flags.ENCRYPT)){if(!e.password&&!this.password)throw new Error("please set password");for(h=this.createDecryptionKey(e.password||this.password),l=n,c=n+12;l<c;++l)this.decode(h,u[l]);for(l=n+=12,c=n+(r-=12);l<c;++l)u[l]=this.decode(h,u[l])}switch(i.compression){case o.Unzip.CompressionMethod.STORE:s=this.input.subarray(n,n+r);break;case o.Unzip.CompressionMethod.DEFLATE:s=new o.RawInflate(this.input,{index:n,bufferSize:i.plainSize}).decompress();break;default:throw new Error("unknown compression type")}if(this.verify&&(a=o.CRC32.calc(s),i.crc32!==a))throw new Error("wrong crc: file=0x"+i.crc32.toString(16)+", data=0x"+a.toString(16));return s},o.Unzip.prototype.getFilenames=function(){var t,e,i,n=[];for(this.fileHeaderList||this.parseFileHeader(),t=0,e=(i=this.fileHeaderList).length;t<e;++t)n[t]=i[t].filename;return n},o.Unzip.prototype.decompress=function(t,e){var i;if(this.filenameToIndex||this.parseFileHeader(),void 0===(i=this.filenameToIndex[t]))throw new Error(t+" not found");return this.getFileData(i,e)},o.Unzip.prototype.setPassword=function(t){this.password=t},o.Unzip.prototype.decode=function(t,e){return e^=this.getByte(t),this.updateKeys(t,e),e},o.Unzip.prototype.updateKeys=o.Zip.prototype.updateKeys,o.Unzip.prototype.createDecryptionKey=o.Zip.prototype.createEncryptionKey,o.Unzip.prototype.getByte=o.Zip.prototype.getByte,o.Util.stringToByteArray=function(t){var e,i,n=t.split("");for(e=0,i=n.length;e<i;e++)n[e]=(255&n[e].charCodeAt(0))>>>0;return n},o.Adler32=function(t){return"string"==typeof t&&(t=o.Util.stringToByteArray(t)),o.Adler32.update(1,t)},o.Adler32.update=function(t,e){for(var i,n=65535&t,r=t>>>16&65535,s=e.length,a=0;s>0;){s-=i=s>o.Adler32.OptimizationParameter?o.Adler32.OptimizationParameter:s;do{r+=n+=e[a++]}while(--i);n%=65521,r%=65521}return(r<<16|n)>>>0},o.Adler32.OptimizationParameter=1024,o.BitStream=function(t,e){if(this.index="number"==typeof e?e:0,this.bitindex=0,this.buffer=t instanceof Uint8Array?t:new Uint8Array(o.BitStream.DefaultBlockSize),2*this.buffer.length<=this.index)throw new Error("invalid index");this.buffer.length<=this.index&&this.expandBuffer()},o.BitStream.DefaultBlockSize=32768,o.BitStream.prototype.expandBuffer=function(){var t=this.buffer,e=t.length,i=new Uint8Array(e<<1);return i.set(t),this.buffer=i},o.BitStream.prototype.writeBits=function(t,e,i){var n,r=this.buffer,s=this.index,a=this.bitindex,h=r[s];if(i&&e>1&&(t=e>8?function(t){return o.BitStream.ReverseTable[255&t]<<24|o.BitStream.ReverseTable[t>>>8&255]<<16|o.BitStream.ReverseTable[t>>>16&255]<<8|o.BitStream.ReverseTable[t>>>24&255]}(t)>>32-e:o.BitStream.ReverseTable[t]>>8-e),e+a<8)h=h<<e|t,a+=e;else for(n=0;n<e;++n)h=h<<1|t>>e-n-1&1,8==++a&&(a=0,r[s++]=o.BitStream.ReverseTable[h],h=0,s===r.length&&(r=this.expandBuffer()));r[s]=h,this.buffer=r,this.bitindex=a,this.index=s},o.BitStream.prototype.finish=function(){var t=this.buffer,e=this.index;return this.bitindex>0&&(t[e]<<=8-this.bitindex,t[e]=o.BitStream.ReverseTable[t[e]],e++),t.subarray(0,e)},o.BitStream.ReverseTable=function(){var t,e=new Uint8Array(256);for(t=0;t<256;++t)e[t]=function(t){var e=t,i=7;for(t>>>=1;t;t>>>=1)e<<=1,e|=1&t,--i;return(e<<i&255)>>>0}(t);return e}(),o.CRC32.calc=function(t,e,i){return o.CRC32.update(t,0,e,i)},o.CRC32.update=function(t,e,i,n){var r=o.CRC32.Table,s="number"==typeof i?i:i=0,a="number"==typeof n?n:t.length;for(e^=4294967295,s=7&a;s--;++i)e=e>>>8^r[255&(e^t[i])];for(s=a>>3;s--;i+=8)e=(e=(e=(e=(e=(e=(e=(e=e>>>8^r[255&(e^t[i])])>>>8^r[255&(e^t[i+1])])>>>8^r[255&(e^t[i+2])])>>>8^r[255&(e^t[i+3])])>>>8^r[255&(e^t[i+4])])>>>8^r[255&(e^t[i+5])])>>>8^r[255&(e^t[i+6])])>>>8^r[255&(e^t[i+7])];return(4294967295^e)>>>0},o.CRC32.single=function(t,e){return(o.CRC32.Table[255&(t^e)]^t>>>8)>>>0},o.CRC32.Table_=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],o.CRC32.Table=new Uint32Array(o.CRC32.Table_),o.Deflate=function(t,e){this.input=t,this.output=new Uint8Array(o.Deflate.DefaultBufferSize),this.compressionType=o.Deflate.CompressionType.DYNAMIC,this.rawDeflate;var i,n={};for(i in!e&&(e={})||"number"==typeof e.compressionType&&(this.compressionType=e.compressionType),e)n[i]=e[i];n.outputBuffer=this.output,this.rawDeflate=new o.RawDeflate(this.input,n)},o.Deflate.DefaultBufferSize=32768,o.Deflate.CompressionType=o.RawDeflate.CompressionType,o.Deflate.compress=function(t,e){return new o.Deflate(t,e).compress()},o.Deflate.prototype.compress=function(){var t,e,i,n,r,s,a,h=0;switch(a=this.output,t=o.CompressionMethod.DEFLATE){case o.CompressionMethod.DEFLATE:e=Math.LOG2E*Math.log(o.RawDeflate.WindowSize)-8;break;default:throw new Error("invalid compression method")}switch(i=e<<4|t,a[h++]=i,0,t){case o.CompressionMethod.DEFLATE:switch(this.compressionType){case o.Deflate.CompressionType.NONE:r=0;break;case o.Deflate.CompressionType.FIXED:r=1;break;case o.Deflate.CompressionType.DYNAMIC:r=2;break;default:throw new Error("unsupported compression type")}break;default:throw new Error("invalid compression method")}return n=r<<6|0,n|=31-(256*i+n)%31,a[h++]=n,s=o.Adler32(this.input),this.rawDeflate.op=h,h=(a=this.rawDeflate.compress()).length,(a=new Uint8Array(a.buffer)).length<=h+4&&(this.output=new Uint8Array(a.length+4),this.output.set(a),a=this.output),(a=a.subarray(0,h+4))[h++]=s>>24&255,a[h++]=s>>16&255,a[h++]=s>>8&255,a[h++]=255&s,a},l="undefined"==typeof btoa?require("btoa"):btoa,"object"==typeof process&&"undefined"==typeof window&&(global.atob=function(t){return Buffer.from(t,"base64").toString("binary")});const g={licorice:"#000000",lead:"#1e1e1e",tungsten:"#3a3a3a",iron:"#545453",steel:"#6e6e6e",tin:"#878687",nickel:"#888787",aluminum:"#a09fa0",magnesium:"#b8b8b8",silver:"#d0d0d0",mercury:"#e8e8e8",snow:"#ffffff",cayenne:"#891100",mocha:"#894800",aspargus:"#888501",fern:"#458401",clover:"#028401",moss:"#018448",teal:"#008688",ocean:"#004a88",midnight:"#001888",eggplant:"#491a88",plum:"#891e88",maroon:"#891648",maraschino:"#ff2101",tangerine:"#ff8802",lemon:"#fffa03",lime:"#83f902",spring:"#05f802",seam_foam:"#03f987",turquoise:"#00fdff",aqua:"#008cff",blueberry:"#002eff",grape:"#8931ff",magenta:"#ff39ff",strawberry:"#ff2987",salmon:"#ff726e",cantaloupe:"#ffce6e",banana:"#fffb6d",honeydew:"#cefa6e",flora:"#68f96e",spindrift:"#68fbd0",ice:"#68fdff",sky:"#6acfff",orchid:"#6e76ff",lavender:"#d278ff",bubblegum:"#ff7aff",carnation:"#ff7fd3"},m={401:"Access unauthorized",403:"Access forbidden",404:"Not found"};class b{constructor(i){this.container=t({class:"igv-ui-alert-dialog-container"}),i.appendChild(this.container),this.container.setAttribute("tabIndex","-1");const n=t();this.container.appendChild(n);const r=t();n.appendChild(r),r.textContent="ERROR";let s=t({id:"igv-ui-alert-dialog-body"});this.container.appendChild(s),this.body=t({id:"igv-ui-alert-dialog-body-copy"}),s.appendChild(this.body);let o=t();this.container.appendChild(o),this.ok=t(),o.appendChild(this.ok),this.ok.textContent="OK";const a=()=>{"function"==typeof this.callback&&(this.callback("OK"),this.callback=void 0),this.body.innerHTML="",e(this.container)};this.ok.addEventListener("click",(t=>{t.stopPropagation(),a()})),this.container.addEventListener("keypress",(t=>{t.stopPropagation(),"Enter"===t.key&&a()})),u(this.container,n),e(this.container)}present(t,e){let n=t.message||t;m.hasOwnProperty(n)&&(n=m[n]),this.body.innerHTML=n,this.callback=e,i(this.container),this.container.focus()}}let w;const v={init(t){w||(w=new b(t))},presentAlert:function(t,e){w.present(t,e)}};class y{constructor(i){this.parent=i,this.container=t({class:"igv-ui-generic-dialog-container"}),i.appendChild(this.container);const n=t({class:"igv-ui-generic-dialog-header"});this.container.appendChild(n),this.label=t({class:"igv-ui-generic-dialog-one-liner"}),this.container.appendChild(this.label),this.label.text="Unlabeled",this.input_container=t({class:"igv-ui-generic-dialog-input"}),this.container.appendChild(this.input_container),this.input=document.createElement("input"),this.input_container.appendChild(this.input);const r=t({class:"igv-ui-generic-dialog-ok-cancel"});this.container.appendChild(r),this.ok=t(),r.appendChild(this.ok),this.ok.textContent="OK",this.cancel=t(),r.appendChild(this.cancel),this.cancel.textContent="Cancel",e(this.container),this.input.addEventListener("keyup",(t=>{13===t.keyCode&&("function"==typeof this.callback&&(this.callback(this.input.value),this.callback=void 0),this.input.value=void 0,e(this.container))})),this.ok.addEventListener("click",(()=>{"function"==typeof this.callback&&(this.callback(this.input.value),this.callback=void 0),this.input.value=void 0,e(this.container)}));const o=()=>{this.input.value="",e(this.container)};this.cancel.addEventListener("click",o),s(n,o),u(this.container,n)}present(t,e){this.label.textContent=t.label,this.input.value=t.value,this.callback=t.callback||t.click,i(this.container);const{x:n,y:r}=function(t){if(t.type.startsWith("touch")){const e=t.touches[0];return{x:e.pageX,y:e.pageY}}return{x:t.pageX,y:t.pageY}}(e);this.clampLocation(n,r)}clampLocation(t,e){const{width:i,height:n}=this.container.getBoundingClientRect(),{x:r,y:s,width:o,height:a}=this.parent.getBoundingClientRect(),h=Math.min(Math.max(e,s),s+a-n),l=Math.min(Math.max(t,r),r+o-i);this.container.style.left=`${l}px`,this.container.style.top=`${h}px`}}class x extends class{constructor({parent:i,top:n,left:r,width:o,height:a,border:h,closeHandler:l}){let c=t({class:"igv-ui-generic-container"});i.appendChild(c),e(c),this.container=c,void 0!==n&&(this.container.style.width=n+"px"),void 0!==r&&(this.container.style.width=r+"px"),void 0!==o&&(this.container.style.width=o+"px"),void 0!==a&&(this.container.style.height=a+"px"),h&&(this.container.style.border=h);const f=t();this.container.appendChild(f),s(f,(t=>{e(this.container),"function"==typeof l&&l(t)})),u(this.container,f)}show(){i(this.container)}hide(){e(this.container)}dispose(){this.container.parent&&this.container.parent.removeChild(this.container)}}{constructor({parent:t,top:e,left:i,width:n,height:r,defaultColors:s,colorHandler:o}){super({parent:t,top:e,left:i,width:n,height:r,border:"1px solid gray"}),k(this.container,o,s)}}const k=(e,i,n)=>{const r=Object.values(g);for(let n of r){const r=t({class:"igv-ui-color-swatch"});e.appendChild(r),S(r,n,i)}if(n)for(let r of n){const n=t({class:"igv-ui-color-swatch"});e.appendChild(n),S(n,r,i)}},S=(t,e,i)=>{t.style.backgroundColor=e,t.onmouseenter=()=>t.style.borderColor=e,t.onmouseenter=()=>t.style.borderColor="white",t.addEventListener("click",(t=>{t.stopPropagation(),i(e)})),t.addEventListener("touchend",(t=>{t.stopPropagation(),i(e)}))};class _{constructor(e){this.parent=e,this.popover=t({class:"igv-ui-popover"}),e.appendChild(this.popover);const i=t();this.popover.appendChild(i),s(i,(()=>this.hide())),u(this.popover,i),this.popoverContent=t(),this.popover.appendChild(this.popoverContent),this.popover.style.display="none"}presentContentWithEvent(t,e){this.popover.style.display="block",this.popoverContent.innerHTML=e,C(t,this.popover)}presentMenu(i,r){if(0===r.length)return;this.popover.style.display="block";const s=(o=r,a=this.popover,o.map((function(i,r){let s;if("string"==typeof i)s=t(),s.innerHTML=i;else if("Node"==typeof i)s=i;else{if("function"==typeof i.init&&i.init(),"checkbox"===i.type)s=function(e,i){const r=t({class:"igv-ui-trackgear-popover-check-container"}),s=n("check",!0===i?"#444":"transparent");s.style.borderColor="gray",s.style.borderWidth="1px",s.style.borderStyle="solid",r.appendChild(s);let o=t();return o.textContent=e,r.appendChild(o),r}("Show all bases",i.value);else if("color"===i.type){const n=new x({parent:a.parentElement,width:364,colorHandler:t=>i.click(t)});s=t(),"string"==typeof i.label&&(s.innerHTML=i.label);const r=t=>{n.show(),e(a),t.preventDefault(),t.stopPropagation()};s.addEventListener("click",r),s.addEventListener("touchend",r),s.addEventListener("mouseup",(function(t){t.preventDefault(),t.stopPropagation()}))}else s=t(),"string"==typeof i.label&&(s.innerHTML=i.label);if(i.click&&"color"!==i.type){function o(t){i.click(),e(a),t.preventDefault(),t.stopPropagation()}s.addEventListener("click",o),s.addEventListener("touchend",o),s.addEventListener("mouseup",(function(t){t.preventDefault(),t.stopPropagation()}))}}return{object:s,init:i.init}})));var o,a;for(let t of s)this.popoverContent.appendChild(t.object);C(i,this.popover)}hide(){this.popover.style.display="none",this.dispose()}dispose(){this.popover&&this.popover.parentNode.removeChild(this.popover);const t=Object.keys(this);for(let e of t)this[e]=void 0}}function C(t,e){const{x:i,y:n}=function(t,e){const{clientX:i,clientY:n}=t;return((t,{clientX:e,clientY:i})=>{const{left:n,top:r,width:s,height:o}=t.getBoundingClientRect(),a=e-n,h=i-r;return{x:a,y:h,xNormalized:a/s,yNormalized:h/o,width:s,height:o}})(e,{clientX:i,clientY:n})}(t,e.parentNode),{width:r}=e.parentNode.getBoundingClientRect(),{width:s}=e.getBoundingClientRect(),o=i+s;e.style.left=`${o>r?i-(o-r):i}px`,e.style.top=`${n}px`}if("undefined"!=typeof document){(function(t){for(let e of document.styleSheets)if(e=e.href?e.href.replace(/^.*[\\\/]/,""):"",e===t)return!0;return!1})("igv-ui.css")||((E=document.createElement("style")).setAttribute("type","text/css"),E.innerHTML='.igv-ui-popover {\n  cursor: default;\n  position: absolute;\n  z-index: 2048;\n  border-color: #7F7F7F;\n  border-radius: 4px;\n  border-style: solid;\n  border-width: 1px;\n  font-family: "Open Sans", sans-serif;\n  font-size: small;\n  background-color: white; }\n  .igv-ui-popover > div:first-child {\n    display: flex;\n    flex-direction: row;\n    flex-wrap: nowrap;\n    justify-content: flex-end;\n    align-items: center;\n    width: 100%;\n    height: 24px;\n    cursor: move;\n    border-top-left-radius: 4px;\n    border-top-right-radius: 4px;\n    border-bottom-color: #7F7F7F;\n    border-bottom-style: solid;\n    border-bottom-width: thin;\n    background-color: #eee; }\n    .igv-ui-popover > div:first-child > div {\n      margin-right: 4px;\n      height: 12px;\n      width: 12px;\n      color: #7F7F7F; }\n    .igv-ui-popover > div:first-child > div:hover {\n      color: #444; }\n  .igv-ui-popover > div:last-child {\n    overflow-y: auto;\n    overflow-x: hidden;\n    max-height: 400px;\n    background-color: white; }\n    .igv-ui-popover > div:last-child > div {\n      -webkit-user-select: all;\n      /* Chrome/Safari */\n      -moz-user-select: all;\n      /* Firefox */\n      margin-left: 4px;\n      margin-right: 4px;\n      max-width: 384px;\n      min-width: 220px;\n      overflow-x: hidden;\n      text-overflow: ellipsis;\n      white-space: nowrap; }\n      .igv-ui-popover > div:last-child > div > span {\n        font-weight: bolder; }\n    .igv-ui-popover > div:last-child hr {\n      width: 100%; }\n\n.igv-ui-alert-dialog-container {\n  box-sizing: content-box;\n  position: absolute;\n  z-index: 2048;\n  top: 50%;\n  left: 50%;\n  width: 400px;\n  height: 200px;\n  border-color: #7F7F7F;\n  border-radius: 4px;\n  border-style: solid;\n  border-width: thin;\n  outline: none;\n  font-family: "Open Sans", sans-serif;\n  font-size: 15px;\n  font-weight: 400;\n  background-color: white;\n  display: flex;\n  flex-flow: column;\n  flex-wrap: nowrap;\n  justify-content: space-between;\n  align-items: center; }\n  .igv-ui-alert-dialog-container > div:first-child {\n    display: flex;\n    flex-flow: row;\n    flex-wrap: nowrap;\n    justify-content: flex-start;\n    align-items: center;\n    width: 100%;\n    height: 24px;\n    cursor: move;\n    border-top-left-radius: 4px;\n    border-top-right-radius: 4px;\n    border-bottom-color: #7F7F7F;\n    border-bottom-style: solid;\n    border-bottom-width: thin;\n    background-color: #eee; }\n    .igv-ui-alert-dialog-container > div:first-child div:first-child {\n      padding-left: 8px; }\n  .igv-ui-alert-dialog-container #igv-ui-alert-dialog-body {\n    color: #373737;\n    width: 100%;\n    height: calc(100% - 24px - 64px);\n    overflow-y: scroll; }\n    .igv-ui-alert-dialog-container #igv-ui-alert-dialog-body #igv-ui-alert-dialog-body-copy {\n      cursor: pointer;\n      margin: 16px;\n      width: auto;\n      height: auto;\n      overflow-wrap: break-word;\n      word-break: break-word;\n      background-color: white;\n      border: unset; }\n  .igv-ui-alert-dialog-container > div:last-child {\n    width: 100%;\n    margin-bottom: 10px;\n    background-color: white;\n    display: flex;\n    flex-flow: row;\n    flex-wrap: nowrap;\n    justify-content: center;\n    align-items: center; }\n    .igv-ui-alert-dialog-container > div:last-child div {\n      margin: unset;\n      width: 40px;\n      height: 30px;\n      line-height: 30px;\n      text-align: center;\n      color: white;\n      font-family: "Open Sans", sans-serif;\n      font-size: small;\n      font-weight: 400;\n      border-color: #2B81AF;\n      border-style: solid;\n      border-width: thin;\n      border-radius: 4px;\n      background-color: #2B81AF; }\n    .igv-ui-alert-dialog-container > div:last-child div:hover {\n      cursor: pointer;\n      border-color: #25597f;\n      background-color: #25597f; }\n\n.igv-ui-color-swatch {\n  box-sizing: content-box;\n  display: flex;\n  flex-flow: row;\n  flex-wrap: wrap;\n  justify-content: center;\n  align-items: center;\n  width: 32px;\n  height: 32px;\n  border-style: solid;\n  border-width: 2px;\n  border-color: white;\n  border-radius: 4px; }\n\n.igv-ui-colorpicker-menu-close-button {\n  display: flex;\n  flex-flow: row;\n  flex-wrap: nowrap;\n  justify-content: flex-end;\n  align-items: center;\n  width: 100%;\n  height: 32px;\n  margin-top: 4px;\n  margin-bottom: 4px;\n  padding-right: 8px; }\n  .igv-ui-colorpicker-menu-close-button i.fa {\n    display: block;\n    margin-left: 4px;\n    margin-right: 4px;\n    color: #5f5f5f; }\n  .igv-ui-colorpicker-menu-close-button i.fa:hover,\n  .igv-ui-colorpicker-menu-close-button i.fa:focus,\n  .igv-ui-colorpicker-menu-close-button i.fa:active {\n    cursor: pointer;\n    color: #0f0f0f; }\n\n.igv-ui-generic-dialog-container {\n  box-sizing: content-box;\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 300px;\n  height: 200px;\n  border-color: #7F7F7F;\n  border-radius: 4px;\n  border-style: solid;\n  border-width: thin;\n  font-family: "Open Sans", sans-serif;\n  font-size: medium;\n  font-weight: 400;\n  z-index: 2048;\n  background-color: white;\n  display: flex;\n  flex-flow: column;\n  flex-wrap: nowrap;\n  justify-content: flex-start;\n  align-items: center; }\n  .igv-ui-generic-dialog-container .igv-ui-generic-dialog-header {\n    display: flex;\n    flex-flow: row;\n    flex-wrap: nowrap;\n    justify-content: flex-end;\n    align-items: center;\n    width: 100%;\n    height: 24px;\n    cursor: move;\n    border-top-left-radius: 4px;\n    border-top-right-radius: 4px;\n    border-bottom-color: #7F7F7F;\n    border-bottom-style: solid;\n    border-bottom-width: thin;\n    background-color: #eee; }\n    .igv-ui-generic-dialog-container .igv-ui-generic-dialog-header div {\n      margin-right: 4px;\n      margin-bottom: 2px;\n      height: 12px;\n      width: 12px;\n      color: #7F7F7F; }\n    .igv-ui-generic-dialog-container .igv-ui-generic-dialog-header div:hover {\n      cursor: pointer;\n      color: #444; }\n  .igv-ui-generic-dialog-container .igv-ui-generic-dialog-one-liner {\n    color: #373737;\n    width: 95%;\n    height: 24px;\n    line-height: 24px;\n    text-align: left;\n    margin-top: 8px;\n    padding-left: 8px;\n    overflow-wrap: break-word;\n    background-color: white; }\n  .igv-ui-generic-dialog-container .igv-ui-generic-dialog-label-input {\n    margin-top: 8px;\n    width: 95%;\n    height: 24px;\n    color: #373737;\n    line-height: 24px;\n    padding-left: 8px;\n    background-color: white;\n    display: flex;\n    flex-flow: row;\n    flex-wrap: nowrap;\n    justify-content: flex-start;\n    align-items: center; }\n    .igv-ui-generic-dialog-container .igv-ui-generic-dialog-label-input div {\n      width: 30%;\n      height: 100%;\n      font-size: 16px;\n      text-align: right;\n      padding-right: 8px;\n      background-color: white; }\n    .igv-ui-generic-dialog-container .igv-ui-generic-dialog-label-input input {\n      display: block;\n      height: 100%;\n      width: 100%;\n      padding-left: 4px;\n      font-family: "Open Sans", sans-serif;\n      font-weight: 400;\n      color: #373737;\n      text-align: left;\n      outline: none;\n      border-style: solid;\n      border-width: thin;\n      border-color: #7F7F7F;\n      background-color: white; }\n    .igv-ui-generic-dialog-container .igv-ui-generic-dialog-label-input input {\n      width: 50%;\n      font-size: 16px; }\n  .igv-ui-generic-dialog-container .igv-ui-generic-dialog-input {\n    margin-top: 8px;\n    width: calc(100% - 16px);\n    height: 24px;\n    color: #373737;\n    line-height: 24px;\n    display: flex;\n    flex-flow: row;\n    flex-wrap: nowrap;\n    justify-content: space-around;\n    align-items: center; }\n    .igv-ui-generic-dialog-container .igv-ui-generic-dialog-input input {\n      display: block;\n      height: 100%;\n      width: 100%;\n      padding-left: 4px;\n      font-family: "Open Sans", sans-serif;\n      font-weight: 400;\n      color: #373737;\n      text-align: left;\n      outline: none;\n      border-style: solid;\n      border-width: thin;\n      border-color: #7F7F7F;\n      background-color: white; }\n    .igv-ui-generic-dialog-container .igv-ui-generic-dialog-input input {\n      font-size: 16px; }\n  .igv-ui-generic-dialog-container .igv-ui-generic-dialog-ok-cancel {\n    width: 100%;\n    height: 28px;\n    display: flex;\n    flex-flow: row;\n    flex-wrap: nowrap;\n    justify-content: space-around;\n    align-items: center; }\n    .igv-ui-generic-dialog-container .igv-ui-generic-dialog-ok-cancel div {\n      margin-top: 32px;\n      color: white;\n      font-family: "Open Sans", sans-serif;\n      font-size: 14px;\n      font-weight: 400;\n      width: 75px;\n      height: 28px;\n      line-height: 28px;\n      text-align: center;\n      border-color: transparent;\n      border-style: solid;\n      border-width: thin;\n      border-radius: 2px; }\n    .igv-ui-generic-dialog-container .igv-ui-generic-dialog-ok-cancel div:first-child {\n      margin-left: 32px;\n      margin-right: 0;\n      background-color: #5ea4e0; }\n    .igv-ui-generic-dialog-container .igv-ui-generic-dialog-ok-cancel div:last-child {\n      margin-left: 0;\n      margin-right: 32px;\n      background-color: #c4c4c4; }\n    .igv-ui-generic-dialog-container .igv-ui-generic-dialog-ok-cancel div:first-child:hover {\n      cursor: pointer;\n      background-color: #3b5c7f; }\n    .igv-ui-generic-dialog-container .igv-ui-generic-dialog-ok-cancel div:last-child:hover {\n      cursor: pointer;\n      background-color: #7f7f7f; }\n  .igv-ui-generic-dialog-container .igv-ui-generic-dialog-ok {\n    width: 100%;\n    height: 36px;\n    margin-top: 32px;\n    display: flex;\n    flex-flow: row;\n    flex-wrap: nowrap;\n    justify-content: space-around;\n    align-items: center; }\n    .igv-ui-generic-dialog-container .igv-ui-generic-dialog-ok div {\n      width: 98px;\n      height: 36px;\n      line-height: 36px;\n      text-align: center;\n      color: white;\n      font-family: "Open Sans", sans-serif;\n      font-size: medium;\n      font-weight: 400;\n      border-color: white;\n      border-style: solid;\n      border-width: thin;\n      border-radius: 4px;\n      background-color: #2B81AF; }\n    .igv-ui-generic-dialog-container .igv-ui-generic-dialog-ok div:hover {\n      cursor: pointer;\n      background-color: #25597f; }\n\n.igv-ui-generic-container {\n  box-sizing: content-box;\n  position: absolute;\n  z-index: 2048;\n  background-color: white;\n  cursor: pointer;\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  justify-content: flex-start;\n  align-items: center; }\n  .igv-ui-generic-container div:first-child {\n    cursor: move;\n    display: flex;\n    flex-flow: row;\n    flex-wrap: nowrap;\n    justify-content: flex-end;\n    align-items: center;\n    height: 24px;\n    width: 100%;\n    background-color: #dddddd; }\n    .igv-ui-generic-container div:first-child div {\n      display: block;\n      color: #5f5f5f;\n      cursor: pointer;\n      width: 14px;\n      height: 14px;\n      margin-right: 8px;\n      margin-bottom: 4px; }\n\n.igv-ui-dialog {\n  z-index: 2048;\n  position: fixed;\n  width: fit-content;\n  height: fit-content;\n  display: flex;\n  flex-flow: column;\n  flex-wrap: nowrap;\n  justify-content: flex-start;\n  background-color: white;\n  border-color: #7F7F7F;\n  border-radius: 4px;\n  border-style: solid;\n  border-width: thin;\n  font-family: "Open Sans", sans-serif;\n  font-size: medium;\n  font-weight: 400; }\n  .igv-ui-dialog .igv-ui-dialog-header {\n    display: flex;\n    flex-flow: row;\n    flex-wrap: nowrap;\n    justify-content: flex-end;\n    align-items: center;\n    width: 100%;\n    height: 24px;\n    cursor: move;\n    border-top-left-radius: 4px;\n    border-top-right-radius: 4px;\n    border-bottom-color: #7F7F7F;\n    border-bottom-style: solid;\n    border-bottom-width: thin;\n    background-color: #eee; }\n    .igv-ui-dialog .igv-ui-dialog-header div {\n      margin-right: 4px;\n      margin-bottom: 2px;\n      height: 12px;\n      width: 12px;\n      color: #7F7F7F; }\n    .igv-ui-dialog .igv-ui-dialog-header div:hover {\n      cursor: pointer;\n      color: #444; }\n  .igv-ui-dialog .igv-ui-dialog-one-liner {\n    width: 95%;\n    height: 24px;\n    line-height: 24px;\n    text-align: left;\n    margin: 8px;\n    overflow-wrap: break-word;\n    background-color: white;\n    font-weight: bold; }\n  .igv-ui-dialog .igv-ui-dialog-ok-cancel {\n    width: 100%;\n    display: flex;\n    flex-flow: row;\n    flex-wrap: nowrap;\n    justify-content: space-around;\n    align-items: center; }\n    .igv-ui-dialog .igv-ui-dialog-ok-cancel div {\n      margin: 16px;\n      margin-top: 32px;\n      color: white;\n      font-family: "Open Sans", sans-serif;\n      font-size: 14px;\n      font-weight: 400;\n      width: 75px;\n      height: 28px;\n      line-height: 28px;\n      text-align: center;\n      border-color: transparent;\n      border-style: solid;\n      border-width: thin;\n      border-radius: 2px; }\n    .igv-ui-dialog .igv-ui-dialog-ok-cancel div:first-child {\n      background-color: #5ea4e0; }\n    .igv-ui-dialog .igv-ui-dialog-ok-cancel div:last-child {\n      background-color: #c4c4c4; }\n    .igv-ui-dialog .igv-ui-dialog-ok-cancel div:first-child:hover {\n      cursor: pointer;\n      background-color: #3b5c7f; }\n    .igv-ui-dialog .igv-ui-dialog-ok-cancel div:last-child:hover {\n      cursor: pointer;\n      background-color: #7f7f7f; }\n  .igv-ui-dialog .igv-ui-dialog-ok {\n    width: 100%;\n    height: 36px;\n    margin-top: 32px;\n    display: flex;\n    flex-flow: row;\n    flex-wrap: nowrap;\n    justify-content: space-around;\n    align-items: center; }\n    .igv-ui-dialog .igv-ui-dialog-ok div {\n      width: 98px;\n      height: 36px;\n      line-height: 36px;\n      text-align: center;\n      color: white;\n      font-family: "Open Sans", sans-serif;\n      font-size: medium;\n      font-weight: 400;\n      border-color: white;\n      border-style: solid;\n      border-width: thin;\n      border-radius: 4px;\n      background-color: #2B81AF; }\n    .igv-ui-dialog .igv-ui-dialog-ok div:hover {\n      cursor: pointer;\n      background-color: #25597f; }\n\n.igv-ui-panel, .igv-ui-panel-column, .igv-ui-panel-row {\n  z-index: 2048;\n  background-color: white;\n  font-family: "Open Sans", sans-serif;\n  font-size: medium;\n  font-weight: 400;\n  display: flex;\n  justify-content: flex-start;\n  align-items: flex-start; }\n\n.igv-ui-panel-column {\n  display: flex;\n  flex-direction: column; }\n\n.igv-ui-panel-row {\n  display: flex;\n  flex-direction: row; }\n\n.igv-ui-textbox {\n  background-color: white;\n  font-family: "Open Sans", sans-serif;\n  font-size: medium;\n  font-weight: 400;\n  display: flex;\n  justify-content: flex-start;\n  align-items: flex-start; }\n\n/*# sourceMappingURL=igv-ui.css.map */\n',document.head.insertBefore(E,document.head.childNodes[document.head.childNodes.length-1]))}var E;function T(t){return function(t,e){const i=document.createElement(t);e&&(e.class&&i.classList.add(e.class),e.id&&(i.id=e.id),e.style&&function(t,e){for(let i of Object.keys(e))t.style[i]=e[i]}(i,e.style));return i}("div",t)}function A(t){const e=getComputedStyle(t);"none"!==e.display&&(t._initialDisplay=e.display),t.style.display="none"}function R(t){if(t.type.startsWith("touch")){const e=t.touches[0];return{x:e.pageX,y:e.pageY}}return{x:t.pageX,y:t.pageY}}function I(){return("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)}function L(t,e){const{clientX:i,clientY:n}=t;return((t,{clientX:e,clientY:i})=>{const{left:n,top:r,width:s,height:o}=t.getBoundingClientRect(),a=e-n,h=i-r;return{x:a,y:h,xNormalized:a/s,yNormalized:h/o,width:s,height:o}})(e,{clientX:i,clientY:n})}function M(t,e){return function(t,e){e=e||"currentColor";let i=F[t];i||(console.error(`No icon named: ${t}`),i=F.question);const n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttributeNS(null,"viewBox","0 0 "+i[0]+" "+i[1]);const r=document.createElementNS("http://www.w3.org/2000/svg","path");return r.setAttributeNS(null,"fill",e),r.setAttributeNS(null,"d",i[4]),n.appendChild(r),n}(t,e)}const F={check:[512,512,[],"f00c","M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"],cog:[512,512,[],"f013","M444.788 291.1l42.616 24.599c4.867 2.809 7.126 8.618 5.459 13.985-11.07 35.642-29.97 67.842-54.689 94.586a12.016 12.016 0 0 1-14.832 2.254l-42.584-24.595a191.577 191.577 0 0 1-60.759 35.13v49.182a12.01 12.01 0 0 1-9.377 11.718c-34.956 7.85-72.499 8.256-109.219.007-5.49-1.233-9.403-6.096-9.403-11.723v-49.184a191.555 191.555 0 0 1-60.759-35.13l-42.584 24.595a12.016 12.016 0 0 1-14.832-2.254c-24.718-26.744-43.619-58.944-54.689-94.586-1.667-5.366.592-11.175 5.459-13.985L67.212 291.1a193.48 193.48 0 0 1 0-70.199l-42.616-24.599c-4.867-2.809-7.126-8.618-5.459-13.985 11.07-35.642 29.97-67.842 54.689-94.586a12.016 12.016 0 0 1 14.832-2.254l42.584 24.595a191.577 191.577 0 0 1 60.759-35.13V25.759a12.01 12.01 0 0 1 9.377-11.718c34.956-7.85 72.499-8.256 109.219-.007 5.49 1.233 9.403 6.096 9.403 11.723v49.184a191.555 191.555 0 0 1 60.759 35.13l42.584-24.595a12.016 12.016 0 0 1 14.832 2.254c24.718 26.744 43.619 58.944 54.689 94.586 1.667 5.366-.592 11.175-5.459 13.985L444.788 220.9a193.485 193.485 0 0 1 0 70.2zM336 256c0-44.112-35.888-80-80-80s-80 35.888-80 80 35.888 80 80 80 80-35.888 80-80z"],exclamation:[192,512,[],"f12a","M176 432c0 44.112-35.888 80-80 80s-80-35.888-80-80 35.888-80 80-80 80 35.888 80 80zM25.26 25.199l13.6 272C39.499 309.972 50.041 320 62.83 320h66.34c12.789 0 23.331-10.028 23.97-22.801l13.6-272C167.425 11.49 156.496 0 142.77 0H49.23C35.504 0 24.575 11.49 25.26 25.199z"],"exclamation-circle":[512,512,[],"f06a","M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"],"exclamation-triangle":[576,512,[],"f071","M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"],minus:[448,512,[],"f068","M424 318.2c13.3 0 24-10.7 24-24v-76.4c0-13.3-10.7-24-24-24H24c-13.3 0-24 10.7-24 24v76.4c0 13.3 10.7 24 24 24h400z"],"minus-circle":[512,512,[],"f056","M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zM124 296c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h264c6.6 0 12 5.4 12 12v56c0 6.6-5.4 12-12 12H124z"],"minus-square":[448,512,[],"f146","M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zM92 296c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h264c6.6 0 12 5.4 12 12v56c0 6.6-5.4 12-12 12H92z"],plus:[448,512,[],"f067","M448 294.2v-76.4c0-13.3-10.7-24-24-24H286.2V56c0-13.3-10.7-24-24-24h-76.4c-13.3 0-24 10.7-24 24v137.8H24c-13.3 0-24 10.7-24 24v76.4c0 13.3 10.7 24 24 24h137.8V456c0 13.3 10.7 24 24 24h76.4c13.3 0 24-10.7 24-24V318.2H424c13.3 0 24-10.7 24-24z"],"plus-circle":[512,512,[],"f055","M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92h-92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z"],"plus-square":[448,512,[],"f0fe","M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zm-32 252c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92H92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z"],question:[384,512,[],"f128","M202.021 0C122.202 0 70.503 32.703 29.914 91.026c-7.363 10.58-5.093 25.086 5.178 32.874l43.138 32.709c10.373 7.865 25.132 6.026 33.253-4.148 25.049-31.381 43.63-49.449 82.757-49.449 30.764 0 68.816 19.799 68.816 49.631 0 22.552-18.617 34.134-48.993 51.164-35.423 19.86-82.299 44.576-82.299 106.405V320c0 13.255 10.745 24 24 24h72.471c13.255 0 24-10.745 24-24v-5.773c0-42.86 125.268-44.645 125.268-160.627C377.504 66.256 286.902 0 202.021 0zM192 373.459c-38.196 0-69.271 31.075-69.271 69.271 0 38.195 31.075 69.27 69.271 69.27s69.271-31.075 69.271-69.271-31.075-69.27-69.271-69.27z"],save:[448,512,[],"f0c7","M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"],search:[512,512,[],"f002","M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"],share:[512,512,[],"f064","M503.691 189.836L327.687 37.851C312.281 24.546 288 35.347 288 56.015v80.053C127.371 137.907 0 170.1 0 322.326c0 61.441 39.581 122.309 83.333 154.132 13.653 9.931 33.111-2.533 28.077-18.631C66.066 312.814 132.917 274.316 288 272.085V360c0 20.7 24.3 31.453 39.687 18.164l176.004-152c11.071-9.562 11.086-26.753 0-36.328z"],spinner:[512,512,[],"f110","M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"],square:[448,512,[],"f0c8","M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48z"],"square-full":[512,512,[],"f45c","M512 512H0V0h512v512z"],times:[384,512,[],"f00d","M323.1 441l53.9-53.9c9.4-9.4 9.4-24.5 0-33.9L279.8 256l97.2-97.2c9.4-9.4 9.4-24.5 0-33.9L323.1 71c-9.4-9.4-24.5-9.4-33.9 0L192 168.2 94.8 71c-9.4-9.4-24.5-9.4-33.9 0L7 124.9c-9.4 9.4-9.4 24.5 0 33.9l97.2 97.2L7 353.2c-9.4 9.4-9.4 24.5 0 33.9L60.9 441c9.4 9.4 24.5 9.4 33.9 0l97.2-97.2 97.2 97.2c9.3 9.3 24.5 9.3 33.9 0z"],"times-circle":[512,512,[],"f057","M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z"],wrench:[512,512,[],"f0ad","M481.156 200c9.3 0 15.12 10.155 10.325 18.124C466.295 259.992 420.419 288 368 288c-79.222 0-143.501-63.974-143.997-143.079C223.505 65.469 288.548-.001 368.002 0c52.362.001 98.196 27.949 123.4 69.743C496.24 77.766 490.523 88 481.154 88H376l-40 56 40 56h105.156zm-171.649 93.003L109.255 493.255c-24.994 24.993-65.515 24.994-90.51 0-24.993-24.994-24.993-65.516 0-90.51L218.991 202.5c16.16 41.197 49.303 74.335 90.516 90.503zM104 432c0-13.255-10.745-24-24-24s-24 10.745-24 24 10.745 24 24 24 24-10.745 24-24z"]};function D(t,e){var i=document.createElement("div");t.appendChild(i),i.appendChild(M("times")),i.addEventListener("click",(function(t){t.preventDefault(),t.stopPropagation(),e()}))}var B={Huffman:{},Util:{},CRC32:{},CompressionMethod:{DEFLATE:8,RESERVED:15},Zip:function(t){t=t||{},this.files=[],this.comment=t.comment,this.password}};B.Zip.CompressionMethod={STORE:0,DEFLATE:8},B.Zip.OperatingSystem={MSDOS:0,UNIX:3,MACINTOSH:7},B.Zip.Flags={ENCRYPT:1,DESCRIPTOR:8,UTF8:2048},B.Zip.FileHeaderSignature=[80,75,1,2],B.Zip.LocalFileHeaderSignature=[80,75,3,4],B.Zip.CentralDirectorySignature=[80,75,5,6],B.Zip.prototype.addFile=function(t,e){(e=e||{}).filename;var i,n=t.length,r=0;if(t instanceof Array&&(t=new Uint8Array(t)),"number"!=typeof e.compressionMethod&&(e.compressionMethod=B.Zip.CompressionMethod.DEFLATE),e.compress)switch(e.compressionMethod){case B.Zip.CompressionMethod.STORE:break;case B.Zip.CompressionMethod.DEFLATE:r=B.CRC32.calc(t),t=this.deflateWithOption(t,e),i=!0;break;default:throw new Error("unknown compression method:"+e.compressionMethod)}this.files.push({buffer:t,option:e,compressed:i,encrypted:!1,size:n,crc32:r})},B.Zip.prototype.setPassword=function(t){this.password=t},B.Zip.prototype.compress=function(){var t,e,i,n,r,s,o,a,h,l,c,u,f,d,p,g,m,b,w,v,y,x,k,S,_,C,E=this.files,T=0,A=0;for(k=0,S=E.length;k<S;++k){if(d=(t=E[k]).option.filename?t.option.filename.length:0,p=t.option.extraField?t.option.extraField.length:0,g=t.option.comment?t.option.comment.length:0,!t.compressed)switch(t.crc32=B.CRC32.calc(t.buffer),t.option.compressionMethod){case B.Zip.CompressionMethod.STORE:break;case B.Zip.CompressionMethod.DEFLATE:t.buffer=this.deflateWithOption(t.buffer,t.option),t.compressed=!0;break;default:throw new Error("unknown compression method:"+t.option.compressionMethod)}if(void 0!==t.option.password||void 0!==this.password){for(x=this.createEncryptionKey(t.option.password||this.password),v=t.buffer,(y=new Uint8Array(v.length+12)).set(v,12),v=y,_=0;_<12;++_)v[_]=this.encode(x,11===k?255&t.crc32:256*Math.random()|0);for(C=v.length;_<C;++_)v[_]=this.encode(x,v[_]);t.buffer=v}T+=30+d+t.buffer.length,A+=46+d+g}for(s=22+(this.comment?this.comment.length:0),e=new Uint8Array(T+A+s),i=0,r=(n=T)+A,k=0,S=E.length;k<S;++k)d=(t=E[k]).option.filename?t.option.filename.length:0,p=0,g=t.option.comment?t.option.comment.length:0,o=i,e[i++]=B.Zip.LocalFileHeaderSignature[0],e[i++]=B.Zip.LocalFileHeaderSignature[1],e[i++]=B.Zip.LocalFileHeaderSignature[2],e[i++]=B.Zip.LocalFileHeaderSignature[3],e[n++]=B.Zip.FileHeaderSignature[0],e[n++]=B.Zip.FileHeaderSignature[1],e[n++]=B.Zip.FileHeaderSignature[2],e[n++]=B.Zip.FileHeaderSignature[3],20,e[n++]=20,e[n++]=t.option.os||B.Zip.OperatingSystem.MSDOS,e[i++]=e[n++]=20,e[i++]=e[n++]=0,a=0,(t.option.password||this.password)&&(a|=B.Zip.Flags.ENCRYPT),e[i++]=e[n++]=255&a,e[i++]=e[n++]=a>>8&255,h=t.option.compressionMethod,e[i++]=e[n++]=255&h,e[i++]=e[n++]=h>>8&255,l=t.option.date||new Date,e[i++]=e[n++]=(7&l.getMinutes())<<5|l.getSeconds()/2|0,e[i++]=e[n++]=l.getHours()<<3|l.getMinutes()>>3,e[i++]=e[n++]=(l.getMonth()+1&7)<<5|l.getDate(),e[i++]=e[n++]=(l.getFullYear()-1980&127)<<1|l.getMonth()+1>>3,c=t.crc32,e[i++]=e[n++]=255&c,e[i++]=e[n++]=c>>8&255,e[i++]=e[n++]=c>>16&255,e[i++]=e[n++]=c>>24&255,u=t.buffer.length,e[i++]=e[n++]=255&u,e[i++]=e[n++]=u>>8&255,e[i++]=e[n++]=u>>16&255,e[i++]=e[n++]=u>>24&255,f=t.size,e[i++]=e[n++]=255&f,e[i++]=e[n++]=f>>8&255,e[i++]=e[n++]=f>>16&255,e[i++]=e[n++]=f>>24&255,e[i++]=e[n++]=255&d,e[i++]=e[n++]=d>>8&255,e[i++]=e[n++]=255&p,e[i++]=e[n++]=p>>8&255,e[n++]=255&g,e[n++]=g>>8&255,e[n++]=0,e[n++]=0,e[n++]=0,e[n++]=0,e[n++]=0,e[n++]=0,e[n++]=0,e[n++]=0,e[n++]=255&o,e[n++]=o>>8&255,e[n++]=o>>16&255,e[n++]=o>>24&255,(m=t.option.filename)&&(e.set(m,i),e.set(m,n),i+=d,n+=d),(b=t.option.extraField)&&(e.set(b,i),e.set(b,n),i+=p,n+=p),(w=t.option.comment)&&(e.set(w,n),n+=g),e.set(t.buffer,i),i+=t.buffer.length;return e[r++]=B.Zip.CentralDirectorySignature[0],e[r++]=B.Zip.CentralDirectorySignature[1],e[r++]=B.Zip.CentralDirectorySignature[2],e[r++]=B.Zip.CentralDirectorySignature[3],e[r++]=0,e[r++]=0,e[r++]=0,e[r++]=0,e[r++]=255&S,e[r++]=S>>8&255,e[r++]=255&S,e[r++]=S>>8&255,e[r++]=255&A,e[r++]=A>>8&255,e[r++]=A>>16&255,e[r++]=A>>24&255,e[r++]=255&T,e[r++]=T>>8&255,e[r++]=T>>16&255,e[r++]=T>>24&255,g=this.comment?this.comment.length:0,e[r++]=255&g,e[r++]=g>>8&255,this.comment&&(e.set(this.comment,r),r+=g),e},B.Zip.prototype.deflateWithOption=function(t,e){return new B.RawDeflate(t,e.deflateOption).compress()},B.Zip.prototype.getByte=function(t){var e=65535&t[2]|2;return e*(1^e)>>8&255},B.Zip.prototype.encode=function(t,e){var i=this.getByte(t);return this.updateKeys(t,e),i^e},B.Zip.prototype.updateKeys=function(t,e){t[0]=B.CRC32.single(t[0],e),t[1]=1+(6681*(20173*(t[1]+(255&t[0]))>>>0)>>>0)>>>0,t[2]=B.CRC32.single(t[2],t[1]>>>24)},B.Zip.prototype.createEncryptionKey=function(t){var e,i,n=[305419896,591751049,878082192];for(n=new Uint32Array(n),e=0,i=t.length;e<i;++e)this.updateKeys(n,255&t[e]);return n},B.Huffman.buildHuffmanTable=function(t){var e,i,n,r,s,o,a,h,l,c,u,f=t.length,d=0,p=Number.POSITIVE_INFINITY;for(h=0,l=f;h<l;++h)t[h]>d&&(d=t[h]),t[h]<p&&(p=t[h]);for(e=1<<d,i=new Uint32Array(e),n=1,r=0,s=2;n<=d;){for(h=0;h<f;++h)if(t[h]===n){for(o=0,a=r,c=0;c<n;++c)o=o<<1|1&a,a>>=1;for(u=n<<16|h,c=o;c<e;c+=s)i[c]=u;++r}++n,r<<=1,s<<=1}return[i,d,p]};var N=B.Huffman.buildHuffmanTable;B.RawInflate=function(t,e){switch(this.buffer,this.blocks=[],this.bufferSize=32768,this.totalpos=0,this.ip=0,this.bitsbuf=0,this.bitsbuflen=0,this.input=new Uint8Array(t),this.output,this.op,this.bfinal=!1,this.bufferType=B.RawInflate.BufferType.ADAPTIVE,this.resize=!1,!e&&(e={})||(e.index&&(this.ip=e.index),e.bufferSize&&(this.bufferSize=e.bufferSize),e.bufferType&&(this.bufferType=e.bufferType),e.resize&&(this.resize=e.resize)),this.bufferType){case B.RawInflate.BufferType.BLOCK:this.op=B.RawInflate.MaxBackwardLength,this.output=new Uint8Array(B.RawInflate.MaxBackwardLength+this.bufferSize+B.RawInflate.MaxCopyLength);break;case B.RawInflate.BufferType.ADAPTIVE:this.op=0,this.output=new Uint8Array(this.bufferSize);break;default:throw new Error("invalid inflate mode")}},B.RawInflate.BufferType={BLOCK:0,ADAPTIVE:1},B.RawInflate.prototype.decompress=function(){for(;!this.bfinal;)this.parseBlock();switch(this.bufferType){case B.RawInflate.BufferType.BLOCK:return this.concatBufferBlock();case B.RawInflate.BufferType.ADAPTIVE:return this.concatBufferDynamic();default:throw new Error("invalid inflate mode")}},B.RawInflate.MaxBackwardLength=32768,B.RawInflate.MaxCopyLength=258,B.RawInflate.Order=new Uint16Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),B.RawInflate.LengthCodeTable=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258]),B.RawInflate.LengthExtraTable=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0]),B.RawInflate.DistCodeTable=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577]),B.RawInflate.DistExtraTable=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),B.RawInflate.FixedLiteralLengthTable=function(){var t,e,i=new Uint8Array(288);for(t=0,e=i.length;t<e;++t)i[t]=t<=143?8:t<=255?9:t<=279?7:8;return N(i)}(),B.RawInflate.FixedDistanceTable=function(){var t,e,i=new Uint8Array(30);for(t=0,e=i.length;t<e;++t)i[t]=5;return N(i)}(),B.RawInflate.prototype.parseBlock=function(){var t=this.readBits(3);switch(1&t&&(this.bfinal=!0),t>>>=1){case 0:this.parseUncompressedBlock();break;case 1:this.parseFixedHuffmanBlock();break;case 2:this.parseDynamicHuffmanBlock();break;default:throw new Error("unknown BTYPE: "+t)}},B.RawInflate.prototype.readBits=function(t){var e,i=this.bitsbuf,n=this.bitsbuflen,r=this.input,s=this.ip;if(s+(t-n+7>>3)>=r.length)throw new Error("input buffer is broken");for(;n<t;)i|=r[s++]<<n,n+=8;return e=i&(1<<t)-1,i>>>=t,n-=t,this.bitsbuf=i,this.bitsbuflen=n,this.ip=s,e},B.RawInflate.prototype.readCodeByTable=function(t){for(var e,i,n=this.bitsbuf,r=this.bitsbuflen,s=this.input,o=this.ip,a=s.length,h=t[0],l=t[1];r<l&&!(o>=a);)n|=s[o++]<<r,r+=8;if((i=(e=h[n&(1<<l)-1])>>>16)>r)throw new Error("invalid code length: "+i);return this.bitsbuf=n>>i,this.bitsbuflen=r-i,this.ip=o,65535&e},B.RawInflate.prototype.parseUncompressedBlock=function(){var t,e,i=this.input,n=this.ip,r=this.output,s=this.op,o=i.length,a=r.length;if(this.bitsbuf=0,this.bitsbuflen=0,n+1>=o)throw new Error("invalid uncompressed block header: LEN");if(t=i[n++]|i[n++]<<8,n+1>=o)throw new Error("invalid uncompressed block header: NLEN");if(t===~(i[n++]|i[n++]<<8))throw new Error("invalid uncompressed block header: length verify");if(n+t>i.length)throw new Error("input buffer is broken");switch(this.bufferType){case B.RawInflate.BufferType.BLOCK:for(;s+t>r.length;)t-=e=a-s,r.set(i.subarray(n,n+e),s),s+=e,n+=e,this.op=s,r=this.expandBufferBlock(),s=this.op;break;case B.RawInflate.BufferType.ADAPTIVE:for(;s+t>r.length;)r=this.expandBufferAdaptive({fixRatio:2});break;default:throw new Error("invalid inflate mode")}r.set(i.subarray(n,n+t),s),s+=t,n+=t,this.ip=n,this.op=s,this.output=r},B.RawInflate.prototype.parseFixedHuffmanBlock=function(){switch(this.bufferType){case B.RawInflate.BufferType.ADAPTIVE:this.decodeHuffmanAdaptive(B.RawInflate.FixedLiteralLengthTable,B.RawInflate.FixedDistanceTable);break;case B.RawInflate.BufferType.BLOCK:this.decodeHuffmanBlock(B.RawInflate.FixedLiteralLengthTable,B.RawInflate.FixedDistanceTable);break;default:throw new Error("invalid inflate mode")}},B.RawInflate.prototype.parseDynamicHuffmanBlock=function(){var t,e,i,n,r,s,o,a,h,l=this.readBits(5)+257,c=this.readBits(5)+1,u=this.readBits(4)+4,f=new Uint8Array(B.RawInflate.Order.length);for(a=0;a<u;++a)f[B.RawInflate.Order[a]]=this.readBits(3);for(t=N(f),n=new Uint8Array(l+c),a=0,h=l+c;a<h;)switch(r=this.readCodeByTable(t)){case 16:for(o=3+this.readBits(2);o--;)n[a++]=s;break;case 17:for(o=3+this.readBits(3);o--;)n[a++]=0;s=0;break;case 18:for(o=11+this.readBits(7);o--;)n[a++]=0;s=0;break;default:n[a++]=r,s=r}switch(e=N(n.subarray(0,l)),i=N(n.subarray(l)),this.bufferType){case B.RawInflate.BufferType.ADAPTIVE:this.decodeHuffmanAdaptive(e,i);break;case B.RawInflate.BufferType.BLOCK:this.decodeHuffmanBlock(e,i);break;default:throw new Error("invalid inflate mode")}},B.RawInflate.prototype.decodeHuffmanBlock=function(t,e){var i=this.output,n=this.op;this.currentLitlenTable=t;for(var r,s,o,a,h=i.length-B.RawInflate.MaxCopyLength,l=B.RawInflate.LengthCodeTable,c=B.RawInflate.LengthExtraTable,u=B.RawInflate.DistCodeTable,f=B.RawInflate.DistExtraTable;256!==(r=this.readCodeByTable(t));)if(r<256)n>=h&&(this.op=n,i=this.expandBufferBlock(),n=this.op),i[n++]=r;else for(a=l[s=r-257],c[s]>0&&(a+=this.readBits(c[s])),o=u[r=this.readCodeByTable(e)],f[r]>0&&(o+=this.readBits(f[r])),n>=h&&(this.op=n,i=this.expandBufferBlock(),n=this.op);a--;)i[n]=i[n++-o];for(;this.bitsbuflen>=8;)this.bitsbuflen-=8,this.ip--;this.op=n},B.RawInflate.prototype.decodeHuffmanAdaptive=function(t,e){var i=this.output,n=this.op;this.currentLitlenTable=t;for(var r,s,o,a,h=i.length,l=B.RawInflate.LengthCodeTable,c=B.RawInflate.LengthExtraTable,u=B.RawInflate.DistCodeTable,f=B.RawInflate.DistExtraTable;256!==(r=this.readCodeByTable(t));)if(r<256)n>=h&&(h=(i=this.expandBufferAdaptive()).length),i[n++]=r;else for(a=l[s=r-257],c[s]>0&&(a+=this.readBits(c[s])),o=u[r=this.readCodeByTable(e)],f[r]>0&&(o+=this.readBits(f[r])),n+a>h&&(h=(i=this.expandBufferAdaptive()).length);a--;)i[n]=i[n++-o];for(;this.bitsbuflen>=8;)this.bitsbuflen-=8,this.ip--;this.op=n},B.RawInflate.prototype.expandBufferBlock=function(t){var e=new Uint8Array(this.op-B.RawInflate.MaxBackwardLength),i=this.op-B.RawInflate.MaxBackwardLength,n=this.output;return e.set(n.subarray(B.RawInflate.MaxBackwardLength,e.length)),this.blocks.push(e),this.totalpos+=e.length,n.set(n.subarray(i,i+B.RawInflate.MaxBackwardLength)),this.op=B.RawInflate.MaxBackwardLength,n},B.RawInflate.prototype.expandBufferAdaptive=function(t){var e,i,n,r=this.input.length/this.ip+1|0,s=this.input,o=this.output;return t&&("number"==typeof t.fixRatio&&(r=t.fixRatio),"number"==typeof t.addRatio&&(r+=t.addRatio)),i=r<2?(n=(s.length-this.ip)/this.currentLitlenTable[2]/2*258|0)<o.length?o.length+n:o.length<<1:o.length*r,(e=new Uint8Array(i)).set(o),this.output=e,this.output},B.RawInflate.prototype.concatBufferBlock=function(){var t,e,i,n,r,s=0,o=this.totalpos+(this.op-B.RawInflate.MaxBackwardLength),a=this.output,h=this.blocks,l=new Uint8Array(o);if(0===h.length)return this.output.subarray(B.RawInflate.MaxBackwardLength,this.op);for(e=0,i=h.length;e<i;++e)for(n=0,r=(t=h[e]).length;n<r;++n)l[s++]=t[n];for(e=B.RawInflate.MaxBackwardLength,i=this.op;e<i;++e)l[s++]=a[e];return this.blocks=[],this.buffer=l,this.buffer},B.RawInflate.prototype.concatBufferDynamic=function(){var t,e=this.op;return this.resize?(t=new Uint8Array(e)).set(this.output.subarray(0,e)):t=this.output.subarray(0,e),this.buffer=t,this.buffer};N=B.Huffman.buildHuffmanTable;let P;function O(t){return"string"==typeof t||t instanceof String}function z(t){var e=String(t).split(/[.,]/);return e[0].split("").reverse().reduce((function(t,e,i){return i%3==0?t+","+e:t+e})).split("").reverse().join("")+(e[1]?"."+e[1]:"")}B.RawInflateStream=function(t,e,i){this.blocks=[],this.bufferSize=i||65e3,this.totalpos=0,this.ip=void 0===e?0:e,this.bitsbuf=0,this.bitsbuflen=0,this.input=new Uint8Array(t),this.output=new Uint8Array(this.bufferSize),this.op=0,this.bfinal=!1,this.blockLength,this.resize=!1,this.litlenTable,this.distTable,this.sp=0,this.status=B.RawInflateStream.Status.INITIALIZED,this.ip_,this.bitsbuflen_,this.bitsbuf_},B.RawInflateStream.BlockType={UNCOMPRESSED:0,FIXED:1,DYNAMIC:2},B.RawInflateStream.Status={INITIALIZED:0,BLOCK_HEADER_START:1,BLOCK_HEADER_END:2,BLOCK_BODY_START:3,BLOCK_BODY_END:4,DECODE_BLOCK_START:5,DECODE_BLOCK_END:6},B.RawInflateStream.prototype.decompress=function(t,e){var i=!1;for(void 0!==t&&(this.input=t),void 0!==e&&(this.ip=e);!i;)switch(this.status){case B.RawInflateStream.Status.INITIALIZED:case B.RawInflateStream.Status.BLOCK_HEADER_START:this.readBlockHeader()<0&&(i=!0);break;case B.RawInflateStream.Status.BLOCK_HEADER_END:case B.RawInflateStream.Status.BLOCK_BODY_START:switch(this.currentBlockType){case B.RawInflateStream.BlockType.UNCOMPRESSED:this.readUncompressedBlockHeader()<0&&(i=!0);break;case B.RawInflateStream.BlockType.FIXED:this.parseFixedHuffmanBlock()<0&&(i=!0);break;case B.RawInflateStream.BlockType.DYNAMIC:this.parseDynamicHuffmanBlock()<0&&(i=!0)}break;case B.RawInflateStream.Status.BLOCK_BODY_END:case B.RawInflateStream.Status.DECODE_BLOCK_START:switch(this.currentBlockType){case B.RawInflateStream.BlockType.UNCOMPRESSED:this.parseUncompressedBlock()<0&&(i=!0);break;case B.RawInflateStream.BlockType.FIXED:case B.RawInflateStream.BlockType.DYNAMIC:this.decodeHuffman()<0&&(i=!0)}break;case B.RawInflateStream.Status.DECODE_BLOCK_END:this.bfinal?i=!0:this.status=B.RawInflateStream.Status.INITIALIZED}return this.concatBuffer()},B.RawInflateStream.MaxBackwardLength=32768,B.RawInflateStream.MaxCopyLength=258,B.RawInflateStream.Order=new Uint16Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),B.RawInflateStream.LengthCodeTable=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258]),B.RawInflateStream.LengthExtraTable=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0]),B.RawInflateStream.DistCodeTable=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577]),B.RawInflateStream.DistExtraTable=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),B.RawInflateStream.FixedLiteralLengthTable=function(){var t,e,i=new Uint8Array(288);for(t=0,e=i.length;t<e;++t)i[t]=t<=143?8:t<=255?9:t<=279?7:8;return N(i)}(),B.RawInflateStream.FixedDistanceTable=function(){var t,e,i=new Uint8Array(30);for(t=0,e=i.length;t<e;++t)i[t]=5;return N(i)}(),B.RawInflateStream.prototype.readBlockHeader=function(){var t;if(this.status=B.RawInflateStream.Status.BLOCK_HEADER_START,this.save_(),(t=this.readBits(3))<0)return this.restore_(),-1;switch(1&t&&(this.bfinal=!0),t>>>=1){case 0:this.currentBlockType=B.RawInflateStream.BlockType.UNCOMPRESSED;break;case 1:this.currentBlockType=B.RawInflateStream.BlockType.FIXED;break;case 2:this.currentBlockType=B.RawInflateStream.BlockType.DYNAMIC;break;default:throw new Error("unknown BTYPE: "+t)}this.status=B.RawInflateStream.Status.BLOCK_HEADER_END},B.RawInflateStream.prototype.readBits=function(t){for(var e,i=this.bitsbuf,n=this.bitsbuflen,r=this.input,s=this.ip;n<t;){if(r.length<=s)return-1;i|=(e=r[s++])<<n,n+=8}return e=i&(1<<t)-1,i>>>=t,n-=t,this.bitsbuf=i,this.bitsbuflen=n,this.ip=s,e},B.RawInflateStream.prototype.readCodeByTable=function(t){for(var e,i,n=this.bitsbuf,r=this.bitsbuflen,s=this.input,o=this.ip,a=t[0],h=t[1];r<h;){if(s.length<=o)return-1;n|=s[o++]<<r,r+=8}if((i=(e=a[n&(1<<h)-1])>>>16)>r)throw new Error("invalid code length: "+i);return this.bitsbuf=n>>i,this.bitsbuflen=r-i,this.ip=o,65535&e},B.RawInflateStream.prototype.readUncompressedBlockHeader=function(){var t,e=this.input,i=this.ip;if(this.status=B.RawInflateStream.Status.BLOCK_BODY_START,i+4>=e.length)return-1;if((t=e[i++]|e[i++]<<8)===~(e[i++]|e[i++]<<8))throw new Error("invalid uncompressed block header: length verify");this.bitsbuf=0,this.bitsbuflen=0,this.ip=i,this.blockLength=t,this.status=B.RawInflateStream.Status.BLOCK_BODY_END},B.RawInflateStream.prototype.parseUncompressedBlock=function(){var t=this.input,e=this.ip,i=this.output,n=this.op,r=this.blockLength;for(this.status=B.RawInflateStream.Status.DECODE_BLOCK_START;r--;){if(n===i.length&&(i=this.expandBuffer({fixRatio:2})),e>=t.length)return this.ip=e,this.op=n,this.blockLength=r+1,-1;i[n++]=t[e++]}return r<0&&(this.status=B.RawInflateStream.Status.DECODE_BLOCK_END),this.ip=e,this.op=n,0},B.RawInflateStream.prototype.parseFixedHuffmanBlock=function(){return this.status=B.RawInflateStream.Status.BLOCK_BODY_START,this.litlenTable=B.RawInflateStream.FixedLiteralLengthTable,this.distTable=B.RawInflateStream.FixedDistanceTable,this.status=B.RawInflateStream.Status.BLOCK_BODY_END,0},B.RawInflateStream.prototype.save_=function(){this.ip_=this.ip,this.bitsbuflen_=this.bitsbuflen,this.bitsbuf_=this.bitsbuf},B.RawInflateStream.prototype.restore_=function(){this.ip=this.ip_,this.bitsbuflen=this.bitsbuflen_,this.bitsbuf=this.bitsbuf_},B.RawInflateStream.prototype.parseDynamicHuffmanBlock=function(){var t,e,i,n,r=new Uint8Array(B.RawInflateStream.Order.length);if(this.status=B.RawInflateStream.Status.BLOCK_BODY_START,this.save_(),t=this.readBits(5)+257,e=this.readBits(5)+1,i=this.readBits(4)+4,t<0||e<0||i<0)return this.restore_(),-1;try{(function(){var s,o,a,h,l,c,u=0;for(l=0;l<i;++l){if((s=this.readBits(3))<0)throw new Error("not enough input");r[B.RawInflateStream.Order[l]]=s}for(n=N(r),h=new Uint8Array(t+e),l=0,c=t+e;l<c;){if((o=this.readCodeByTable(n))<0)throw new Error("not enough input");switch(o){case 16:if((s=this.readBits(2))<0)throw new Error("not enough input");for(a=3+s;a--;)h[l++]=u;break;case 17:if((s=this.readBits(3))<0)throw new Error("not enough input");for(a=3+s;a--;)h[l++]=0;u=0;break;case 18:if((s=this.readBits(7))<0)throw new Error("not enough input");for(a=11+s;a--;)h[l++]=0;u=0;break;default:h[l++]=o,u=o}}this.litlenTable=N(h.subarray(0,t)),this.distTable=N(h.subarray(t))}).call(this)}catch(t){return this.restore_(),-1}return this.status=B.RawInflateStream.Status.BLOCK_BODY_END,0},B.RawInflateStream.prototype.decodeHuffman=function(){var t,e,i,n,r,s=this.output,o=this.op,a=this.litlenTable,h=this.distTable,l=s.length;for(this.status=B.RawInflateStream.Status.DECODE_BLOCK_START;;){if(this.save_(),(t=this.readCodeByTable(a))<0)return this.op=o,this.restore_(),-1;if(256===t)break;if(t<256)o===l&&(l=(s=this.expandBuffer()).length),s[o++]=t;else{if(e=t-257,n=B.RawInflateStream.LengthCodeTable[e],B.RawInflateStream.LengthExtraTable[e]>0){if((r=this.readBits(B.RawInflateStream.LengthExtraTable[e]))<0)return this.op=o,this.restore_(),-1;n+=r}if((t=this.readCodeByTable(h))<0)return this.op=o,this.restore_(),-1;if(i=B.RawInflateStream.DistCodeTable[t],B.RawInflateStream.DistExtraTable[t]>0){if((r=this.readBits(B.RawInflateStream.DistExtraTable[t]))<0)return this.op=o,this.restore_(),-1;i+=r}for(o+n>=l&&(l=(s=this.expandBuffer()).length);n--;)s[o]=s[o++-i];if(this.ip===this.input.length)return this.op=o,-1}}for(;this.bitsbuflen>=8;)this.bitsbuflen-=8,this.ip--;this.op=o,this.status=B.RawInflateStream.Status.DECODE_BLOCK_END},B.RawInflateStream.prototype.expandBuffer=function(t){var e,i,n,r=this.input.length/this.ip+1|0,s=this.input,o=this.output;return t&&("number"==typeof t.fixRatio&&(r=t.fixRatio),"number"==typeof t.addRatio&&(r+=t.addRatio)),i=r<2?(n=(s.length-this.ip)/this.litlenTable[2]/2*258|0)<o.length?o.length+n:o.length<<1:o.length*r,(e=new Uint8Array(i)).set(o),this.output=e,this.output},B.RawInflateStream.prototype.concatBuffer=function(){var t,e,i=this.op;return t=this.resize?new Uint8Array(this.output.subarray(this.sp,i)):this.output.subarray(this.sp,i),this.sp=i,i>B.RawInflateStream.MaxBackwardLength+this.bufferSize&&(this.op=this.sp=B.RawInflateStream.MaxBackwardLength,e=this.output,this.output=new Uint8Array(this.bufferSize+B.RawInflateStream.MaxBackwardLength),this.output.set(e.subarray(i-B.RawInflateStream.MaxBackwardLength,i))),t},B.Inflate=function(t,e){var i,n;switch(this.input=t,this.ip=0,this.rawinflate,this.verify,!e&&(e={})||(e.index&&(this.ip=e.index),e.verify&&(this.verify=e.verify)),i=t[this.ip++],n=t[this.ip++],15&i){case B.CompressionMethod.DEFLATE:this.method=B.CompressionMethod.DEFLATE;break;default:throw new Error("unsupported compression method")}if(((i<<8)+n)%31!=0)throw new Error("invalid fcheck flag:"+((i<<8)+n)%31);if(32&n)throw new Error("fdict flag is not supported");this.rawinflate=new B.RawInflate(t,{index:this.ip,bufferSize:e.bufferSize,bufferType:e.bufferType,resize:e.resize})},B.Inflate.BufferType=B.RawInflate.BufferType,B.Inflate.prototype.decompress=function(){var t,e=this.input;if(t=this.rawinflate.decompress(),this.ip=this.rawinflate.ip,this.verify&&(e[this.ip++]<<24|e[this.ip++]<<16|e[this.ip++]<<8|e[this.ip++])>>>0!==B.Adler32(t))throw new Error("invalid adler-32 checksum");return t},B.InflateStream=function(t){this.input=void 0===t?new Uint8Array:t,this.ip=0,this.rawinflate=new B.RawInflateStream(this.input,this.ip),this.method,this.output=this.rawinflate.output},B.InflateStream.prototype.decompress=function(t){var e;if(void 0!==t){var i=new Uint8Array(this.input.length+t.length);i.set(this.input,0),i.set(t,this.input.length),this.input=i}return void 0===this.method&&this.readHeader()<0?new Uint8Array:(e=this.rawinflate.decompress(this.input,this.ip),0!==this.rawinflate.ip&&(this.input=this.input.subarray(this.rawinflate.ip),this.ip=0),e)},B.InflateStream.prototype.readHeader=function(){var t=this.ip,e=this.input,i=e[t++],n=e[t++];if(void 0===i||void 0===n)return-1;switch(15&i){case B.CompressionMethod.DEFLATE:this.method=B.CompressionMethod.DEFLATE;break;default:throw new Error("unsupported compression method")}if(((i<<8)+n)%31!=0)throw new Error("invalid fcheck flag:"+((i<<8)+n)%31);if(32&n)throw new Error("fdict flag is not supported");this.ip=t},B.Gunzip=function(t,e){this.input=t,this.ip=0,this.member=[],this.decompressed=!1},B.Gunzip.prototype.getMembers=function(){return this.decompressed||this.decompress(),this.member.slice()},B.Gunzip.prototype.decompress=function(){for(var t=this.input.length;this.ip<t;)this.decodeMember();return this.decompressed=!0,this.concatMember()},B.Gunzip.prototype.decodeMember=function(){var t,e,i,n,r,s,o,a,h,l=new B.GunzipMember,c=this.input,u=this.ip;if(l.id1=c[u++],l.id2=c[u++],31!==l.id1||139!==l.id2)throw new Error("invalid file signature:"+l.id1+","+l.id2);switch(l.cm=c[u++],l.cm){case 8:break;default:throw new Error("unknown compression method: "+l.cm)}if(l.flg=c[u++],a=c[u++]|c[u++]<<8|c[u++]<<16|c[u++]<<24,l.mtime=new Date(1e3*a),l.xfl=c[u++],l.os=c[u++],(l.flg&B.Gzip.FlagsMask.FEXTRA)>0&&(l.xlen=c[u++]|c[u++]<<8,u=this.decodeSubField(u,l.xlen)),(l.flg&B.Gzip.FlagsMask.FNAME)>0){for(o=[],s=0;(r=c[u++])>0;)o[s++]=String.fromCharCode(r);l.name=o.join("")}if((l.flg&B.Gzip.FlagsMask.FCOMMENT)>0){for(o=[],s=0;(r=c[u++])>0;)o[s++]=String.fromCharCode(r);l.comment=o.join("")}if((l.flg&B.Gzip.FlagsMask.FHCRC)>0&&(l.crc16=65535&B.CRC32.calc(c,0,u),l.crc16!==(c[u++]|c[u++]<<8)))throw new Error("invalid header crc16");if(t=c[c.length-4]|c[c.length-3]<<8|c[c.length-2]<<16|c[c.length-1]<<24,c.length-u-4-4<512*t&&(n=t),e=new B.RawInflate(c,{index:u,bufferSize:n}),l.data=i=e.decompress(),u=e.ip,l.crc32=h=(c[u++]|c[u++]<<8|c[u++]<<16|c[u++]<<24)>>>0,B.CRC32.calc(i)!==h)throw new Error("invalid CRC-32 checksum: 0x"+B.CRC32.calc(i).toString(16)+" / 0x"+h.toString(16));if(l.isize=t=(c[u++]|c[u++]<<8|c[u++]<<16|c[u++]<<24)>>>0,(4294967295&i.length)!==t)throw new Error("invalid input size: "+(4294967295&i.length)+" / "+t);this.member.push(l),this.ip=u},B.Gunzip.prototype.decodeSubField=function(t,e){return t+e},B.Gunzip.prototype.concatMember=function(){var t,e,i,n=this.member,r=0,s=0;for(t=0,e=n.length;t<e;++t)s+=n[t].data.length;for(i=new Uint8Array(s),t=0;t<e;++t)i.set(n[t].data,r),r+=n[t].data.length;return i},B.GunzipMember=function(){this.id1,this.id2,this.cm,this.flg,this.mtime,this.xfl,this.os,this.crc16,this.xlen,this.crc32,this.isize,this.name,this.comment,this.data},B.GunzipMember.prototype.getName=function(){return this.name},B.GunzipMember.prototype.getData=function(){return this.data},B.GunzipMember.prototype.getMtime=function(){return this.mtime},B.Gzip=function(t,e){this.input=t,this.ip=0,this.output,this.op=0,this.flags={},this.filename,this.comment,this.deflateOptions,e&&(e.flags&&(this.flags=e.flags),"string"==typeof e.filename&&(this.filename=e.filename),"string"==typeof e.comment&&(this.comment=e.comment),e.deflateOptions&&(this.deflateOptions=e.deflateOptions)),this.deflateOptions||(this.deflateOptions={})},B.Gzip.DefaultBufferSize=32768,B.Gzip.prototype.compress=function(){var t,e,i,n,r,s,o,a,h=new Uint8Array(B.Gzip.DefaultBufferSize),l=0,c=this.input,u=this.ip,f=this.filename,d=this.comment;if(h[l++]=31,h[l++]=139,h[l++]=8,t=0,this.flags.fname&&(t|=B.Gzip.FlagsMask.FNAME),this.flags.fcomment&&(t|=B.Gzip.FlagsMask.FCOMMENT),this.flags.fhcrc&&(t|=B.Gzip.FlagsMask.FHCRC),h[l++]=t,e=(Date.now?Date.now():+new Date)/1e3|0,h[l++]=255&e,h[l++]=e>>>8&255,h[l++]=e>>>16&255,h[l++]=e>>>24&255,h[l++]=0,h[l++]=B.Gzip.OperatingSystem.UNKNOWN,void 0!==this.flags.fname){for(o=0,a=f.length;o<a;++o)(s=f.charCodeAt(o))>255&&(h[l++]=s>>>8&255),h[l++]=255&s;h[l++]=0}if(this.flags.comment){for(o=0,a=d.length;o<a;++o)(s=d.charCodeAt(o))>255&&(h[l++]=s>>>8&255),h[l++]=255&s;h[l++]=0}return this.flags.fhcrc&&(i=65535&B.CRC32.calc(h,0,l),h[l++]=255&i,h[l++]=i>>>8&255),this.deflateOptions.outputBuffer=h,this.deflateOptions.outputIndex=l,h=(r=new B.RawDeflate(c,this.deflateOptions)).compress(),(l=r.op)+8>h.buffer.byteLength?(this.output=new Uint8Array(l+8),this.output.set(new Uint8Array(h.buffer)),h=this.output):h=new Uint8Array(h.buffer),n=B.CRC32.calc(c),h[l++]=255&n,h[l++]=n>>>8&255,h[l++]=n>>>16&255,h[l++]=n>>>24&255,a=c.length,h[l++]=255&a,h[l++]=a>>>8&255,h[l++]=a>>>16&255,h[l++]=a>>>24&255,this.ip=u,l<h.length&&(this.output=h=h.subarray(0,l)),h},B.Gzip.OperatingSystem={FAT:0,AMIGA:1,VMS:2,UNIX:3,VM_CMS:4,ATARI_TOS:5,HPFS:6,MACINTOSH:7,Z_SYSTEM:8,CP_M:9,TOPS_20:10,NTFS:11,QDOS:12,ACORN_RISCOS:13,UNKNOWN:255},B.Gzip.FlagsMask={FTEXT:1,FHCRC:2,FEXTRA:4,FNAME:8,FCOMMENT:16},B.Heap=function(t){this.buffer=new Uint16Array(2*t),this.length=0},B.Heap.prototype.getParent=function(t){return 2*((t-2)/4|0)},B.Heap.prototype.getChild=function(t){return 2*t+2},B.Heap.prototype.push=function(t,e){var i,n,r,s=this.buffer;for(i=this.length,s[this.length++]=e,s[this.length++]=t;i>0&&(n=this.getParent(i),s[i]>s[n]);)r=s[i],s[i]=s[n],s[n]=r,r=s[i+1],s[i+1]=s[n+1],s[n+1]=r,i=n;return this.length},B.Heap.prototype.pop=function(){var t,e,i,n,r,s=this.buffer;for(e=s[0],t=s[1],this.length-=2,s[0]=s[this.length],s[1]=s[this.length+1],r=0;!((n=this.getChild(r))>=this.length)&&(n+2<this.length&&s[n+2]>s[n]&&(n+=2),s[n]>s[r]);)i=s[r],s[r]=s[n],s[n]=i,i=s[r+1],s[r+1]=s[n+1],s[n+1]=i,r=n;return{index:t,value:e,length:this.length}},B.RawDeflate=function(t,e){this.compressionType=B.RawDeflate.CompressionType.DYNAMIC,this.lazy=0,this.freqsLitLen,this.freqsDist,this.input=t instanceof Array?new Uint8Array(t):t,this.output,this.op=0,e&&(e.lazy&&(this.lazy=e.lazy),"number"==typeof e.compressionType&&(this.compressionType=e.compressionType),e.outputBuffer&&(this.output=e.outputBuffer instanceof Array?new Uint8Array(e.outputBuffer):e.outputBuffer),"number"==typeof e.outputIndex&&(this.op=e.outputIndex)),this.output||(this.output=new Uint8Array(32768))},B.RawDeflate.CompressionType={NONE:0,FIXED:1,DYNAMIC:2,RESERVED:3},B.RawDeflate.Lz77MinLength=3,B.RawDeflate.Lz77MaxLength=258,B.RawDeflate.WindowSize=32768,B.RawDeflate.MaxCodeLength=16,B.RawDeflate.HUFMAX=286,B.RawDeflate.FixedHuffmanTable=function(){var t,e=[];for(t=0;t<288;t++)switch(!0){case t<=143:e.push([t+48,8]);break;case t<=255:e.push([t-144+400,9]);break;case t<=279:e.push([t-256+0,7]);break;case t<=287:e.push([t-280+192,8]);break;default:throw"invalid literal: "+t}return e}(),B.RawDeflate.prototype.compress=function(){var t,e,i,n=this.input;switch(this.compressionType){case B.RawDeflate.CompressionType.NONE:for(e=0,i=n.length;e<i;)e+=(t=n.subarray(e,e+65535)).length,this.makeNocompressBlock(t,e===i);break;case B.RawDeflate.CompressionType.FIXED:this.output=this.makeFixedHuffmanBlock(n,!0),this.op=this.output.length;break;case B.RawDeflate.CompressionType.DYNAMIC:this.output=this.makeDynamicHuffmanBlock(n,!0),this.op=this.output.length;break;default:throw"invalid compression type"}return this.output},B.RawDeflate.prototype.makeNocompressBlock=function(t,e){var i,n,r,s,o=this.output,a=this.op;for(o=new Uint8Array(this.output.buffer);o.length<=a+t.length+5;)o=new Uint8Array(o.length<<1);return o.set(this.output),i=e?1:0,n=B.RawDeflate.CompressionType.NONE,o[a++]=i|n<<1,s=65536+~(r=t.length)&65535,o[a++]=255&r,o[a++]=r>>>8&255,o[a++]=255&s,o[a++]=s>>>8&255,o.set(t,a),a+=t.length,o=o.subarray(0,a),this.op=a,this.output=o,o},B.RawDeflate.prototype.makeFixedHuffmanBlock=function(t,e){var i,n,r,s=new B.BitStream(new Uint8Array(this.output.buffer),this.op);return i=e?1:0,n=B.RawDeflate.CompressionType.FIXED,s.writeBits(i,1,!0),s.writeBits(n,2,!0),r=this.lz77(t),this.fixedHuffman(r,s),s.finish()},B.RawDeflate.prototype.makeDynamicHuffmanBlock=function(t,e){var i,n,r,s,o,a,h,l,c,u,f,d,p,g,m,b,w,v=new B.BitStream(new Uint8Array(this.output.buffer),this.op),y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],x=new Array(19);for(i=e?1:0,n=B.RawDeflate.CompressionType.DYNAMIC,v.writeBits(i,1,!0),v.writeBits(n,2,!0),r=this.lz77(t),h=this.getLengths_(this.freqsLitLen,15),l=this.getCodesFromLengths_(h),c=this.getLengths_(this.freqsDist,7),u=this.getCodesFromLengths_(c),s=286;s>257&&0===h[s-1];s--);for(o=30;o>1&&0===c[o-1];o--);for(f=this.getTreeSymbols_(s,h,o,c),d=this.getLengths_(f.freqs,7),b=0;b<19;b++)x[b]=d[y[b]];for(a=19;a>4&&0===x[a-1];a--);for(p=this.getCodesFromLengths_(d),v.writeBits(s-257,5,!0),v.writeBits(o-1,5,!0),v.writeBits(a-4,4,!0),b=0;b<a;b++)v.writeBits(x[b],3,!0);for(b=0,w=f.codes.length;b<w;b++)if(g=f.codes[b],v.writeBits(p[g],d[g],!0),g>=16){switch(b++,g){case 16:m=2;break;case 17:m=3;break;case 18:m=7;break;default:throw"invalid code: "+g}v.writeBits(f.codes[b],m,!0)}return this.dynamicHuffman(r,[l,h],[u,c],v),v.finish()},B.RawDeflate.prototype.dynamicHuffman=function(t,e,i,n){var r,s,o,a,h,l,c,u;for(h=e[0],l=e[1],c=i[0],u=i[1],r=0,s=t.length;r<s;++r)if(o=t[r],n.writeBits(h[o],l[o],!0),o>256)n.writeBits(t[++r],t[++r],!0),a=t[++r],n.writeBits(c[a],u[a],!0),n.writeBits(t[++r],t[++r],!0);else if(256===o)break;return n},B.RawDeflate.prototype.fixedHuffman=function(t,e){var i,n,r;for(i=0,n=t.length;i<n;i++)if(r=t[i],B.BitStream.prototype.writeBits.apply(e,B.RawDeflate.FixedHuffmanTable[r]),r>256)e.writeBits(t[++i],t[++i],!0),e.writeBits(t[++i],5),e.writeBits(t[++i],t[++i],!0);else if(256===r)break;return e},B.RawDeflate.Lz77Match=function(t,e){this.length=t,this.backwardDistance=e},B.RawDeflate.Lz77Match.LengthCodeTable=function(t){return new Uint32Array(t)}(function(){var t,e,i=[];for(t=3;t<=258;t++)e=n(t),i[t]=e[2]<<24|e[1]<<16|e[0];function n(t){switch(!0){case 3===t:return[257,t-3,0];case 4===t:return[258,t-4,0];case 5===t:return[259,t-5,0];case 6===t:return[260,t-6,0];case 7===t:return[261,t-7,0];case 8===t:return[262,t-8,0];case 9===t:return[263,t-9,0];case 10===t:return[264,t-10,0];case t<=12:return[265,t-11,1];case t<=14:return[266,t-13,1];case t<=16:return[267,t-15,1];case t<=18:return[268,t-17,1];case t<=22:return[269,t-19,2];case t<=26:return[270,t-23,2];case t<=30:return[271,t-27,2];case t<=34:return[272,t-31,2];case t<=42:return[273,t-35,3];case t<=50:return[274,t-43,3];case t<=58:return[275,t-51,3];case t<=66:return[276,t-59,3];case t<=82:return[277,t-67,4];case t<=98:return[278,t-83,4];case t<=114:return[279,t-99,4];case t<=130:return[280,t-115,4];case t<=162:return[281,t-131,5];case t<=194:return[282,t-163,5];case t<=226:return[283,t-195,5];case t<=257:return[284,t-227,5];case 258===t:return[285,t-258,0];default:throw"invalid length: "+t}}return i}()),B.RawDeflate.Lz77Match.prototype.getDistanceCode_=function(t){var e;switch(!0){case 1===t:e=[0,t-1,0];break;case 2===t:e=[1,t-2,0];break;case 3===t:e=[2,t-3,0];break;case 4===t:e=[3,t-4,0];break;case t<=6:e=[4,t-5,1];break;case t<=8:e=[5,t-7,1];break;case t<=12:e=[6,t-9,2];break;case t<=16:e=[7,t-13,2];break;case t<=24:e=[8,t-17,3];break;case t<=32:e=[9,t-25,3];break;case t<=48:e=[10,t-33,4];break;case t<=64:e=[11,t-49,4];break;case t<=96:e=[12,t-65,5];break;case t<=128:e=[13,t-97,5];break;case t<=192:e=[14,t-129,6];break;case t<=256:e=[15,t-193,6];break;case t<=384:e=[16,t-257,7];break;case t<=512:e=[17,t-385,7];break;case t<=768:e=[18,t-513,8];break;case t<=1024:e=[19,t-769,8];break;case t<=1536:e=[20,t-1025,9];break;case t<=2048:e=[21,t-1537,9];break;case t<=3072:e=[22,t-2049,10];break;case t<=4096:e=[23,t-3073,10];break;case t<=6144:e=[24,t-4097,11];break;case t<=8192:e=[25,t-6145,11];break;case t<=12288:e=[26,t-8193,12];break;case t<=16384:e=[27,t-12289,12];break;case t<=24576:e=[28,t-16385,13];break;case t<=32768:e=[29,t-24577,13];break;default:throw"invalid distance"}return e},B.RawDeflate.Lz77Match.prototype.toLz77Array=function(){var t,e=this.length,i=this.backwardDistance,n=[],r=0;return t=B.RawDeflate.Lz77Match.LengthCodeTable[e],n[r++]=65535&t,n[r++]=t>>16&255,n[r++]=t>>24,t=this.getDistanceCode_(i),n[r++]=t[0],n[r++]=t[1],n[r++]=t[2],n},B.RawDeflate.prototype.lz77=function(t){var e,i,n,r,s,o,a,h,l,c={},u=B.RawDeflate.WindowSize,f=new Uint16Array(2*t.length),d=0,p=0,g=new Uint32Array(286),m=new Uint32Array(30),b=this.lazy;function w(t,e){var i,n,r=t.toLz77Array();for(i=0,n=r.length;i<n;++i)f[d++]=r[i];g[r[0]]++,m[r[3]]++,p=t.length+e-1,h=null}for(g[256]=1,e=0,i=t.length;e<i;++e){for(s=0,n=0,r=B.RawDeflate.Lz77MinLength;n<r&&e+n!==i;++n)s=s<<8|t[e+n];if(void 0===c[s]&&(c[s]=[]),o=c[s],p-- >0)o.push(e);else{for(;o.length>0&&e-o[0]>u;)o.shift();if(e+B.RawDeflate.Lz77MinLength>=i){for(h&&w(h,-1),n=0,r=i-e;n<r;++n)l=t[e+n],f[d++]=l,++g[l];break}o.length>0?(a=this.searchLongestMatch_(t,e,o),h?h.length<a.length?(l=t[e-1],f[d++]=l,++g[l],w(a,0)):w(h,-1):a.length<b?h=a:w(a,0)):h?w(h,-1):(l=t[e],f[d++]=l,++g[l]),o.push(e)}}return f[d++]=256,g[256]++,this.freqsLitLen=g,this.freqsDist=m,f.subarray(0,d)},B.RawDeflate.prototype.searchLongestMatch_=function(t,e,i){var n,r,s,o,a,h,l=0,c=t.length;t:for(o=0,h=i.length;o<h;o++){if(n=i[h-o-1],s=B.RawDeflate.Lz77MinLength,l>B.RawDeflate.Lz77MinLength){for(a=l;a>B.RawDeflate.Lz77MinLength;a--)if(t[n+a-1]!==t[e+a-1])continue t;s=l}for(;s<B.RawDeflate.Lz77MaxLength&&e+s<c&&t[n+s]===t[e+s];)++s;if(s>l&&(r=n,l=s),s===B.RawDeflate.Lz77MaxLength)break}return new B.RawDeflate.Lz77Match(l,e-r)},B.RawDeflate.prototype.getTreeSymbols_=function(t,e,i,n){var r,s,o,a,h,l,c=new Uint32Array(t+i),u=new Uint32Array(316),f=new Uint8Array(19);for(s=0,r=0;r<t;r++)c[s++]=e[r];for(r=0;r<i;r++)c[s++]=n[r];for(h=0,r=0,a=c.length;r<a;r+=s){for(s=1;r+s<a&&c[r+s]===c[r];++s);if(o=s,0===c[r])if(o<3)for(;o-- >0;)u[h++]=0,f[0]++;else for(;o>0;)(l=o<138?o:138)>o-3&&l<o&&(l=o-3),l<=10?(u[h++]=17,u[h++]=l-3,f[17]++):(u[h++]=18,u[h++]=l-11,f[18]++),o-=l;else if(u[h++]=c[r],f[c[r]]++,--o<3)for(;o-- >0;)u[h++]=c[r],f[c[r]]++;else for(;o>0;)(l=o<6?o:6)>o-3&&l<o&&(l=o-3),u[h++]=16,u[h++]=l-3,f[16]++,o-=l}return{codes:u.subarray(0,h),freqs:f}},B.RawDeflate.prototype.getLengths_=function(t,e){var i,n,r,s,o,a=t.length,h=new B.Heap(2*B.RawDeflate.HUFMAX),l=new Uint8Array(a);for(s=0;s<a;++s)t[s]>0&&h.push(s,t[s]);if(i=new Array(h.length/2),n=new Uint32Array(h.length/2),1===i.length)return l[h.pop().index]=1,l;for(s=0,o=h.length/2;s<o;++s)i[s]=h.pop(),n[s]=i[s].value;for(r=this.reversePackageMerge_(n,n.length,e),s=0,o=i.length;s<o;++s)l[i[s].index]=r[s];return l},B.RawDeflate.prototype.reversePackageMerge_=function(t,e,i){var n,r,s,o,a,h=new Uint16Array(i),l=new Uint8Array(i),c=new Uint8Array(e),u=new Array(i),f=new Array(i),d=new Array(i),p=(1<<i)-e,g=1<<i-1;function m(t){var i=f[t][d[t]];i===e?(m(t+1),m(t+1)):--c[i],++d[t]}for(h[i-1]=e,r=0;r<i;++r)p<g?l[r]=0:(l[r]=1,p-=g),p<<=1,h[i-2-r]=(h[i-1-r]/2|0)+e;for(h[0]=l[0],u[0]=new Array(h[0]),f[0]=new Array(h[0]),r=1;r<i;++r)h[r]>2*h[r-1]+l[r]&&(h[r]=2*h[r-1]+l[r]),u[r]=new Array(h[r]),f[r]=new Array(h[r]);for(n=0;n<e;++n)c[n]=i;for(s=0;s<h[i-1];++s)u[i-1][s]=t[s],f[i-1][s]=s;for(n=0;n<i;++n)d[n]=0;for(1===l[i-1]&&(--c[0],++d[i-1]),r=i-2;r>=0;--r){for(n=0,o=0,a=d[r+1],s=0;s<h[r];s++)(o=u[r+1][a]+u[r+1][a+1])>t[n]?(u[r][s]=o,f[r][s]=e,a+=2):(u[r][s]=t[n],f[r][s]=n,++n);d[r]=0,1===l[r]&&m(r)}return c},B.RawDeflate.prototype.getCodesFromLengths_=function(t){var e,i,n,r,s=new Uint16Array(t.length),o=[],a=[],h=0;for(e=0,i=t.length;e<i;e++)o[t[e]]=1+(0|o[t[e]]);for(e=1,i=B.RawDeflate.MaxCodeLength;e<=i;e++)a[e]=h,h+=0|o[e],h<<=1;for(e=0,i=t.length;e<i;e++)for(h=a[t[e]],a[t[e]]+=1,s[e]=0,n=0,r=t[e];n<r;n++)s[e]=s[e]<<1|1&h,h>>>=1;return s},B.Unzip=function(t,e){e=e||{},this.input=t instanceof Array?new Uint8Array(t):t,this.ip=0,this.eocdrOffset,this.numberOfThisDisk,this.startDisk,this.totalEntriesThisDisk,this.totalEntries,this.centralDirectorySize,this.centralDirectoryOffset,this.commentLength,this.comment,this.fileHeaderList,this.filenameToIndex,this.verify=e.verify||!1,this.password=e.password},B.Unzip.CompressionMethod=B.Zip.CompressionMethod,B.Unzip.FileHeaderSignature=B.Zip.FileHeaderSignature,B.Unzip.LocalFileHeaderSignature=B.Zip.LocalFileHeaderSignature,B.Unzip.CentralDirectorySignature=B.Zip.CentralDirectorySignature,B.Unzip.FileHeader=function(t,e){this.input=t,this.offset=e,this.length,this.version,this.os,this.needVersion,this.flags,this.compression,this.time,this.date,this.crc32,this.compressedSize,this.plainSize,this.fileNameLength,this.extraFieldLength,this.fileCommentLength,this.diskNumberStart,this.internalFileAttributes,this.externalFileAttributes,this.relativeOffset,this.filename,this.extraField,this.comment},B.Unzip.FileHeader.prototype.parse=function(){var t=this.input,e=this.offset;if(t[e++]!==B.Unzip.FileHeaderSignature[0]||t[e++]!==B.Unzip.FileHeaderSignature[1]||t[e++]!==B.Unzip.FileHeaderSignature[2]||t[e++]!==B.Unzip.FileHeaderSignature[3])throw new Error("invalid file header signature");this.version=t[e++],this.os=t[e++],this.needVersion=t[e++]|t[e++]<<8,this.flags=t[e++]|t[e++]<<8,this.compression=t[e++]|t[e++]<<8,this.time=t[e++]|t[e++]<<8,this.date=t[e++]|t[e++]<<8,this.crc32=(t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)>>>0,this.compressedSize=(t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)>>>0,this.plainSize=(t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)>>>0,this.fileNameLength=t[e++]|t[e++]<<8,this.extraFieldLength=t[e++]|t[e++]<<8,this.fileCommentLength=t[e++]|t[e++]<<8,this.diskNumberStart=t[e++]|t[e++]<<8,this.internalFileAttributes=t[e++]|t[e++]<<8,this.externalFileAttributes=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24,this.relativeOffset=(t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)>>>0,this.filename=String.fromCharCode.apply(null,t.subarray(e,e+=this.fileNameLength)),this.extraField=t.subarray(e,e+=this.extraFieldLength),this.comment=t.subarray(e,e+this.fileCommentLength),this.length=e-this.offset},B.Unzip.LocalFileHeader=function(t,e){this.input=t,this.offset=e,this.length,this.needVersion,this.flags,this.compression,this.time,this.date,this.crc32,this.compressedSize,this.plainSize,this.fileNameLength,this.extraFieldLength,this.filename,this.extraField},B.Unzip.LocalFileHeader.Flags=B.Zip.Flags,B.Unzip.LocalFileHeader.prototype.parse=function(){var t=this.input,e=this.offset;if(t[e++]!==B.Unzip.LocalFileHeaderSignature[0]||t[e++]!==B.Unzip.LocalFileHeaderSignature[1]||t[e++]!==B.Unzip.LocalFileHeaderSignature[2]||t[e++]!==B.Unzip.LocalFileHeaderSignature[3])throw new Error("invalid local file header signature");this.needVersion=t[e++]|t[e++]<<8,this.flags=t[e++]|t[e++]<<8,this.compression=t[e++]|t[e++]<<8,this.time=t[e++]|t[e++]<<8,this.date=t[e++]|t[e++]<<8,this.crc32=(t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)>>>0,this.compressedSize=(t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)>>>0,this.plainSize=(t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)>>>0,this.fileNameLength=t[e++]|t[e++]<<8,this.extraFieldLength=t[e++]|t[e++]<<8,this.filename=String.fromCharCode.apply(null,t.subarray(e,e+=this.fileNameLength)),this.extraField=t.subarray(e,e+=this.extraFieldLength),this.length=e-this.offset},B.Unzip.prototype.searchEndOfCentralDirectoryRecord=function(){var t,e=this.input;for(t=e.length-12;t>0;--t)if(e[t]===B.Unzip.CentralDirectorySignature[0]&&e[t+1]===B.Unzip.CentralDirectorySignature[1]&&e[t+2]===B.Unzip.CentralDirectorySignature[2]&&e[t+3]===B.Unzip.CentralDirectorySignature[3])return void(this.eocdrOffset=t);throw new Error("End of Central Directory Record not found")},B.Unzip.prototype.parseEndOfCentralDirectoryRecord=function(){var t,e=this.input;if(this.eocdrOffset||this.searchEndOfCentralDirectoryRecord(),t=this.eocdrOffset,e[t++]!==B.Unzip.CentralDirectorySignature[0]||e[t++]!==B.Unzip.CentralDirectorySignature[1]||e[t++]!==B.Unzip.CentralDirectorySignature[2]||e[t++]!==B.Unzip.CentralDirectorySignature[3])throw new Error("invalid signature");this.numberOfThisDisk=e[t++]|e[t++]<<8,this.startDisk=e[t++]|e[t++]<<8,this.totalEntriesThisDisk=e[t++]|e[t++]<<8,this.totalEntries=e[t++]|e[t++]<<8,this.centralDirectorySize=(e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24)>>>0,this.centralDirectoryOffset=(e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24)>>>0,this.commentLength=e[t++]|e[t++]<<8,this.comment=e.subarray(t,t+this.commentLength)},B.Unzip.prototype.parseFileHeader=function(){var t,e,i,n,r=[],s={};if(!this.fileHeaderList){for(void 0===this.centralDirectoryOffset&&this.parseEndOfCentralDirectoryRecord(),t=this.centralDirectoryOffset,i=0,n=this.totalEntries;i<n;++i)(e=new B.Unzip.FileHeader(this.input,t)).parse(),t+=e.length,r[i]=e,s[e.filename]=i;if(this.centralDirectorySize<t-this.centralDirectoryOffset)throw new Error("invalid file header size");this.fileHeaderList=r,this.filenameToIndex=s}},B.Unzip.prototype.getFileData=function(t,e){e=e||{};var i,n,r,s,o,a,h,l,c=this.input,u=this.fileHeaderList;if(u||this.parseFileHeader(),void 0===u[t])throw new Error("wrong index");if(n=u[t].relativeOffset,(i=new B.Unzip.LocalFileHeader(this.input,n)).parse(),n+=i.length,r=i.compressedSize,0!=(i.flags&B.Unzip.LocalFileHeader.Flags.ENCRYPT)){if(!e.password&&!this.password)throw new Error("please set password");for(a=this.createDecryptionKey(e.password||this.password),h=n,l=n+12;h<l;++h)this.decode(a,c[h]);for(h=n+=12,l=n+(r-=12);h<l;++h)c[h]=this.decode(a,c[h])}switch(i.compression){case B.Unzip.CompressionMethod.STORE:s=this.input.subarray(n,n+r);break;case B.Unzip.CompressionMethod.DEFLATE:s=new B.RawInflate(this.input,{index:n,bufferSize:i.plainSize}).decompress();break;default:throw new Error("unknown compression type")}if(this.verify&&(o=B.CRC32.calc(s),i.crc32!==o))throw new Error("wrong crc: file=0x"+i.crc32.toString(16)+", data=0x"+o.toString(16));return s},B.Unzip.prototype.getFilenames=function(){var t,e,i,n=[];for(this.fileHeaderList||this.parseFileHeader(),t=0,e=(i=this.fileHeaderList).length;t<e;++t)n[t]=i[t].filename;return n},B.Unzip.prototype.decompress=function(t,e){var i;if(this.filenameToIndex||this.parseFileHeader(),void 0===(i=this.filenameToIndex[t]))throw new Error(t+" not found");return this.getFileData(i,e)},B.Unzip.prototype.setPassword=function(t){this.password=t},B.Unzip.prototype.decode=function(t,e){return e^=this.getByte(t),this.updateKeys(t,e),e},B.Unzip.prototype.updateKeys=B.Zip.prototype.updateKeys,B.Unzip.prototype.createDecryptionKey=B.Zip.prototype.createEncryptionKey,B.Unzip.prototype.getByte=B.Zip.prototype.getByte,B.Util.stringToByteArray=function(t){var e,i,n=t.split("");for(e=0,i=n.length;e<i;e++)n[e]=(255&n[e].charCodeAt(0))>>>0;return n},B.Adler32=function(t){return"string"==typeof t&&(t=B.Util.stringToByteArray(t)),B.Adler32.update(1,t)},B.Adler32.update=function(t,e){for(var i,n=65535&t,r=t>>>16&65535,s=e.length,o=0;s>0;){s-=i=s>B.Adler32.OptimizationParameter?B.Adler32.OptimizationParameter:s;do{r+=n+=e[o++]}while(--i);n%=65521,r%=65521}return(r<<16|n)>>>0},B.Adler32.OptimizationParameter=1024,B.BitStream=function(t,e){if(this.index="number"==typeof e?e:0,this.bitindex=0,this.buffer=t instanceof Uint8Array?t:new Uint8Array(B.BitStream.DefaultBlockSize),2*this.buffer.length<=this.index)throw new Error("invalid index");this.buffer.length<=this.index&&this.expandBuffer()},B.BitStream.DefaultBlockSize=32768,B.BitStream.prototype.expandBuffer=function(){var t=this.buffer,e=t.length,i=new Uint8Array(e<<1);return i.set(t),this.buffer=i},B.BitStream.prototype.writeBits=function(t,e,i){var n,r=this.buffer,s=this.index,o=this.bitindex,a=r[s];if(i&&e>1&&(t=e>8?function(t){return B.BitStream.ReverseTable[255&t]<<24|B.BitStream.ReverseTable[t>>>8&255]<<16|B.BitStream.ReverseTable[t>>>16&255]<<8|B.BitStream.ReverseTable[t>>>24&255]}(t)>>32-e:B.BitStream.ReverseTable[t]>>8-e),e+o<8)a=a<<e|t,o+=e;else for(n=0;n<e;++n)a=a<<1|t>>e-n-1&1,8==++o&&(o=0,r[s++]=B.BitStream.ReverseTable[a],a=0,s===r.length&&(r=this.expandBuffer()));r[s]=a,this.buffer=r,this.bitindex=o,this.index=s},B.BitStream.prototype.finish=function(){var t=this.buffer,e=this.index;return this.bitindex>0&&(t[e]<<=8-this.bitindex,t[e]=B.BitStream.ReverseTable[t[e]],e++),t.subarray(0,e)},B.BitStream.ReverseTable=function(){var t,e=new Uint8Array(256);for(t=0;t<256;++t)e[t]=function(t){var e=t,i=7;for(t>>>=1;t;t>>>=1)e<<=1,e|=1&t,--i;return(e<<i&255)>>>0}(t);return e}(),B.CRC32.calc=function(t,e,i){return B.CRC32.update(t,0,e,i)},B.CRC32.update=function(t,e,i,n){var r=B.CRC32.Table,s="number"==typeof i?i:i=0,o="number"==typeof n?n:t.length;for(e^=4294967295,s=7&o;s--;++i)e=e>>>8^r[255&(e^t[i])];for(s=o>>3;s--;i+=8)e=(e=(e=(e=(e=(e=(e=(e=e>>>8^r[255&(e^t[i])])>>>8^r[255&(e^t[i+1])])>>>8^r[255&(e^t[i+2])])>>>8^r[255&(e^t[i+3])])>>>8^r[255&(e^t[i+4])])>>>8^r[255&(e^t[i+5])])>>>8^r[255&(e^t[i+6])])>>>8^r[255&(e^t[i+7])];return(4294967295^e)>>>0},B.CRC32.single=function(t,e){return(B.CRC32.Table[255&(t^e)]^t>>>8)>>>0},B.CRC32.Table_=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],B.CRC32.Table=new Uint32Array(B.CRC32.Table_),B.Deflate=function(t,e){this.input=t,this.output=new Uint8Array(B.Deflate.DefaultBufferSize),this.compressionType=B.Deflate.CompressionType.DYNAMIC,this.rawDeflate;var i,n={};for(i in!e&&(e={})||"number"==typeof e.compressionType&&(this.compressionType=e.compressionType),e)n[i]=e[i];n.outputBuffer=this.output,this.rawDeflate=new B.RawDeflate(this.input,n)},B.Deflate.DefaultBufferSize=32768,B.Deflate.CompressionType=B.RawDeflate.CompressionType,B.Deflate.compress=function(t,e){return new B.Deflate(t,e).compress()},B.Deflate.prototype.compress=function(){var t,e,i,n,r,s,o,a=0;switch(o=this.output,t=B.CompressionMethod.DEFLATE){case B.CompressionMethod.DEFLATE:e=Math.LOG2E*Math.log(B.RawDeflate.WindowSize)-8;break;default:throw new Error("invalid compression method")}switch(i=e<<4|t,o[a++]=i,0,t){case B.CompressionMethod.DEFLATE:switch(this.compressionType){case B.Deflate.CompressionType.NONE:r=0;break;case B.Deflate.CompressionType.FIXED:r=1;break;case B.Deflate.CompressionType.DYNAMIC:r=2;break;default:throw new Error("unsupported compression type")}break;default:throw new Error("invalid compression method")}return n=r<<6|0,n|=31-(256*i+n)%31,o[a++]=n,s=B.Adler32(this.input),this.rawDeflate.op=a,a=(o=this.rawDeflate.compress()).length,(o=new Uint8Array(o.buffer)).length<=a+4&&(this.output=new Uint8Array(o.length+4),this.output.set(o),o=this.output),(o=o.subarray(0,a+4))[a++]=s>>24&255,o[a++]=s>>16&255,o[a++]=s>>8&255,o[a++]=255&s,o},P="undefined"==typeof btoa?require("btoa"):btoa;const H=function(t){return t.split(/\n|\r\n|\r/g)};function U(t,e){var i,n,r=[],s=t.length,o=0,a=!1;if(s>0)for(r[o]=t.charAt(0),i=1;i<s;i++)'"'===(n=t.charAt(i))?a=!a:a||n!==e?r[o]+=n:r[++o]="";return r}function $(t){return t.includes("googleapis")&&!t.includes("urlshortener")||q(t)||V(t)}function q(t){return t.startsWith("gs://")||t.startsWith("https://www.googleapis.com/storage")||t.startsWith("https://storage.cloud.google.com")||t.startsWith("https://storage.googleapis.com")}function V(t){return t.indexOf("drive.google.com")>=0||t.indexOf("www.googleapis.com/drive")>0}function j(t){var e=W(t);return e?"https://www.googleapis.com/drive/v3/files/"+e+"?alt=media&supportsTeamDrives=true":t}function W(t){var e,i;if(t.includes("/open?id=")){if(e=t.indexOf("/open?id=")+9,i=t.indexOf("&"),e>0&&i>e)return t.substring(e,i);if(e>0)return t.substring(e)}else if(t.includes("/file/d/"))return e=t.indexOf("/file/d/")+8,i=t.lastIndexOf("/"),t.substring(e,i)}async function G(t){if(Z())return void console.warn("oAuth has already been initialized");gapi.apiKey=t.apiKey;const e=Object.assign({},t);return e.scope||(e.scope="profile"),t.client_id||(t.client_id=t.clientId),await async function(t){return new Promise((function(e,i){gapi.load(t,{callback:e,onerror:i})}))}("auth2"),new Promise((function(t,i){gapi.auth2.init(e).then(t,i)}))}function Z(){return"undefined"!=typeof gapi&&gapi.auth2&&gapi.auth2.getAuthInstance()}let X=!1;async function Y(t){if("undefined"==typeof gapi)throw Error("Google authentication requires the 'gapi' library");if(!gapi.auth2)throw Error("Google 'auth2' has not been initialized");if(X)return new Promise((function(e,i){let n;n=setInterval((()=>{try{!1===X&&(e(Y(t)),clearInterval(n))}catch(t){clearInterval(n),i(t)}}),100)}));X=!0;try{let e,i=gapi.auth2.getAuthInstance().currentUser.get();if(i.isSignedIn()){i.hasGrantedScopes(t)||await i.grant({scope:t});const{access_token:n,expires_at:r}=i.getAuthResponse();if(Date.now()<r-3e5)e={access_token:n,expires_at:r};else{const{access_token:t,expires_at:n}=i.reloadAuthResponse();e={access_token:t,expires_at:n}}}else{i=await async function(t){const e=new gapi.auth2.SigninOptionsBuilder;return e.setPrompt("select_account"),e.setScope(t),gapi.auth2.getAuthInstance().signIn(e)}(t);const{access_token:n,expires_at:r}=i.getAuthResponse();e={access_token:n,expires_at:r}}return e}finally{X=!1}}function K(){return gapi.apiKey}function Q(t){const e=t.split(","),i=e[0].split(":")[1];let n=e[1];n=i.indexOf("base64")>=0?atob(n):decodeURI(n);const r=new Uint8Array(n.length);for(let t=0;t<n.length;t++)r[t]=n.charCodeAt(t);let s;if(i.indexOf("gzip")>0){s=new B.Gunzip(r).decompress()}else s=r;return s}function J(t){for(var e=tt,i=e.parser.loose.exec(t),n={},r=14;r--;)n[e.key[r]]=i[r]||"";return n[e.q.name]={},n[e.key[12]].replace(e.q.parser,(function(t,i,r){i&&(n[e.q.name][i]=r)})),n}"object"==typeof process&&"undefined"==typeof window&&(global.atob=function(t){return Buffer.from(t,"base64").toString("binary")});const tt={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};function et(t){return t instanceof File}function it(t,e){const i=document.createElement("a");i.setAttribute("href",e),i.setAttribute("download",t),i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i)}const nt={gwascatalog:{fields:["bin","chr","start","end","name","pubMedID","author","pubDate","journal","title","trait","initSample","replSample","region","genes","riskAllele","riskAlFreq","pValue","pValueDesc","orOrBeta","ci95","platform","cnv"]},wgrna:{fields:["bin","chr","start","end","name","score","strand","thickStart","thickEnd","type"]},cpgislandext:{fields:["bin","chr","start","end","name","length","cpgNum","gcNum","perCpg","perGc","obsExp"]},clinVarMain:{fields:["chr1","start","end","name","score","strand","thickStart","thickEnd","reserved","blockCount","blockSizes","chromStarts","origName","clinSign","reviewStatus","type","geneId","snpId","nsvId","rcvAcc","testedInGtr","phenotypeList","phenotype","origin","assembly","cytogenetic","hgvsCod","hgvsProt","numSubmit","lastEval","guidelines","otherIds"]}},rt=new Set(["narrowpeak","broadpeak","regionpeak","peaks","bedgraph","wig","gff3","gff","gtf","fusionjuncspan","refflat","seg","aed","bed","vcf","bb","bigbed","bw","bigwig","bam","tdf","refgene","genepred","genepredext","bedpe","bp","snp","rmsk","cram","gwas"]);function st(t){var e,i;if((t=t.toLowerCase()).endsWith("refgene.txt.gz")||t.endsWith("refgene.txt.bgz")||t.endsWith("refgene.txt")||t.endsWith("refgene.sorted.txt.gz")||t.endsWith("refgene.sorted.txt.bgz"))return"refgene";switch((e=t.indexOf("?"))>0&&(t=t.substr(0,e)),t.endsWith(".gz")&&(t=t.substr(0,t.length-3)),(t.endsWith(".txt")||t.endsWith(".tab")||t.endsWith(".bgz"))&&(t=t.substr(0,t.length-4)),i=(e=t.lastIndexOf("."))<0?t:t.substr(e+1)){case"bw":return"bigwig";case"bb":return"bigbed";default:return rt.has(i)?i:void 0}}const ot=function(t,e){if(0!==t.length){var i=Math.floor(t.length*((100-e)/100));return 0===i?(t.sort((function(t,e){return e-t})),t[i]):function(t,e){var i,n=new lt;for(i=0;i<t.length;i++){var r=t[i];if(n.content.length<e||r>n.content[0]){if(n.content.length===e)n.pop();n.push(r)}}return n.content[0]}(t,i)}},at=function(t,e,i){return Math.min(Math.max(t,e),i)},ht=function(t){return Math.log(t)/Math.LN2};function lt(){this.content=[]}lt.prototype={push:function(t){this.content.push(t),this.bubbleUp(this.content.length-1)},pop:function(){var t=this.content[0],e=this.content.pop();return this.content.length>0&&(this.content[0]=e,this.sinkDown(0)),t},remove:function(t){for(var e=this.content.length,i=0;i<e;i++)if(this.content[i]===t){var n=this.content.pop();if(i===e-1)break;this.content[i]=n,this.bubbleUp(i),this.sinkDown(i);break}},size:function(){return this.content.length},bubbleUp:function(t){for(var e=this.content[t],i=e;t>0;){var n=Math.floor((t+1)/2)-1,r=this.content[n];if(i>=r)break;this.content[n]=e,this.content[t]=r,t=n}},sinkDown:function(t){for(var e=this.content.length,i=this.content[t],n=i;;){var r=2*(t+1),s=r-1,o=null;if(s<e){var a=this.content[s],h=a;a<n&&(o=s)}if(r<e)this.content[r]<(null==o?n:h)&&(o=r);if(null==o)break;this.content[t]=this.content[o],this.content[o]=i,t=o}}};const ct={rgbListFromHSV:()=>{let t=[];for(let e=1;e>=.5;e-=.1)for(let i=0;i<1;i+=1/28){const n="rgb("+ct.hsvToRgb(i,1,e).join(",")+")";t.push(n)}return t.pop(),t.push(ct.rgbColor(16,16,16)),t},rgbToHex:function(t){return(t=t.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4===t.length?"#"+("0"+parseInt(t[1],10).toString(16)).slice(-2)+("0"+parseInt(t[2],10).toString(16)).slice(-2)+("0"+parseInt(t[3],10).toString(16)).slice(-2):""},hexToRgb:function(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);if(null!==e)return"rgb("+parseInt(e[1],16)+","+parseInt(e[2],16)+","+parseInt(e[3],16)+")"},hsvToRgb:function(t,e,i){var n,r,s,o=Math.floor(6*t),a=6*t-o,h=i*(1-e),l=i*(1-a*e),c=i*(1-(1-a)*e);switch(o%6){case 0:n=i,r=c,s=h;break;case 1:n=l,r=i,s=h;break;case 2:n=h,r=i,s=c;break;case 3:n=h,r=l,s=i;break;case 4:n=c,r=h,s=i;break;case 5:n=i,r=h,s=l}return[Math.floor(255*n),Math.floor(255*r),Math.floor(255*s)]},hslToRgb:function(t,e,i){var n,r,s;if(0===e)n=r=s=i;else{var o=i<.5?i*(1+e):i+e-i*e,a=2*i-o;n=ct.hue2rgb(a,o,t+1/3),r=ct.hue2rgb(a,o,t),s=ct.hue2rgb(a,o,t-1/3)}return[255*n,255*r,255*s]},hue2rgb:(t,e,i)=>(i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t),rgbaColor:function(t,e,i,n){return"rgba("+(t=at(t,0,255))+","+(e=at(e,0,255))+","+(i=at(i,0,255))+","+(n=at(n,0,1))+")"},rgbColor:function(t,e,i){return"rgb("+(t=at(t,0,255))+","+(e=at(e,0,255))+","+(i=at(i,0,255))+")"},greyScale:function(t){var e=at(t,0,255);return"rgb("+e+","+e+","+e+")"},randomGrey:function(t,e){t=at(t,0,255),e=at(e,0,255);var i=Math.round(Math.random(t,e)).toString(10);return"rgb("+i+","+i+","+i+")"},randomRGB:function(t,e){return t=at(t,0,255),e=at(e,0,255),"rgb("+Math.round(Math.random(t,e)).toString(10)+","+Math.round(Math.random(t,e)).toString(10)+","+Math.round(Math.random(t,e)).toString(10)+")"},randomRGBConstantAlpha:function(t,e,i){return t=at(t,0,255),e=at(e,0,255),"rgba("+Math.round(Math.random(t,e)).toString(10)+","+Math.round(Math.random(t,e)).toString(10)+","+Math.round(Math.random(t,e)).toString(10)+","+i+")"},addAlpha:function(t,e){if("0"===t||"."===t)t="rgb(0,0,0)";else{const e=this.colorNameToHex(t);e&&(t=e)}var i=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(t);if(t.startsWith("rgba")){const i=t.lastIndexOf(",");return t.substring(0,i+1)+e.toString()+")"}return i&&(t=ct.hexToRgb(t)),t.startsWith("rgb")?t.replace("rgb","rgba").replace(")",", "+e+")"):t},getCompositeColor:function(t,e,i){return"rgb("+Math.floor(i*e[0]+(1-i)*t[0])+","+Math.floor(i*e[1]+(1-i)*t[1])+","+Math.floor(i*e[2]+(1-i)*t[2])+")"},createColorString:function(t){return(t=function(t){return void 0===t||((t.startsWith("'")||t.startsWith('"'))&&(t=t.substring(1)),(t.endsWith("'")||t.endsWith('"'))&&(t=t.substring(0,t.length-1))),t}(t)).includes(",")?t.startsWith("rgb")?t:"rgb("+t+")":t},darkenLighten:function(t,e){let i,n=this.colorNameToHex(t);i=n?ct.hexToRgb(n):t.startsWith("rgb(")?t:ct.hexToRgb(t);const r=i.replace(")","").substring(4).split(","),s=Math.max(0,Math.min(255,Number.parseInt(r[0].trim())+e)),o=Math.max(0,Math.min(255,Number.parseInt(r[1].trim())+e)),a=Math.max(0,Math.min(255,Number.parseInt(r[2].trim())+e));return"rgb("+s.toString()+","+o.toString()+","+a.toString()+")"},colorNameToHex:function(t){return{aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c","indigo ":"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32",darkgrey:"#a9a9a9",darkslategrey:"#2f4f4f",dimgrey:"#696969",grey:"#808080",lightgray:"#d3d3d3",lightslategrey:"#778899",slategrey:"#708090"}[t]}};let ut;function ft(t,e){e.addEventListener("mousedown",dt.bind(t))}function dt(t){t.stopPropagation(),t.preventDefault();!function(t){if(!t.getClientRects().length)return{top:0,left:0};const e=t.getBoundingClientRect(),i=t.ownerDocument.defaultView;e.top,i.pageYOffset,e.left,i.pageXOffset}(this);const e=pt.bind(this),i=gt.bind(this),n=getComputedStyle(this),r=parseInt(n.top.replace("px","")),s=parseInt(n.left.replace("px",""));ut={dragFunction:e,dragEndFunction:i,screenX:t.screenX,screenY:t.screenY,top:r,left:s},document.addEventListener("mousemove",e),document.addEventListener("mouseup",i),document.addEventListener("mouseleave",i),document.addEventListener("mouseexit",i)}function pt(t){if(!ut)return;t.stopPropagation(),t.preventDefault();const e=t.screenX-ut.screenX,i=t.screenY-ut.screenY;this.style.left=`${ut.left+e}px`,this.style.top=`${ut.top+i}px`}function gt(t){if(!ut)return;t.stopPropagation(),t.preventDefault();const e=ut.dragFunction,i=ut.dragEndFunction;document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",i),document.removeEventListener("mouseleave",i),document.removeEventListener("mouseexit",i),ut=void 0}
/*!
 * jQuery JavaScript Library v3.3.1 -ajax,-ajax/jsonp,-ajax/load,-ajax/parseXML,-ajax/script,-ajax/var/location,-ajax/var/nonce,-ajax/var/rquery,-ajax/xhr,-manipulation/_evalUrl,-event/ajax,-effects,-effects/Tween,-effects/animatedSelector
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright JS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2018-01-20T17:24Z
 */var mt=[],bt=window.document,wt=Object.getPrototypeOf,vt=mt.slice,yt=mt.concat,xt=mt.push,kt=mt.indexOf,St={},_t=St.toString,Ct=St.hasOwnProperty,Et=Ct.toString,Tt=Et.call(Object),At={},Rt=function(t){return"function"==typeof t&&"number"!=typeof t.nodeType},It=function(t){return null!=t&&t===t.window},Lt={type:!0,src:!0,noModule:!0};function Mt(t,e,i){var n,r=(e=e||bt).createElement("script");if(r.text=t,i)for(n in Lt)i[n]&&(r[n]=i[n]);e.head.appendChild(r).parentNode.removeChild(r)}function Ft(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?St[_t.call(t)]||"object":typeof t}var Dt="3.3.1 -ajax,-ajax/jsonp,-ajax/load,-ajax/parseXML,-ajax/script,-ajax/var/location,-ajax/var/nonce,-ajax/var/rquery,-ajax/xhr,-manipulation/_evalUrl,-event/ajax,-effects,-effects/Tween,-effects/animatedSelector",Bt=function(t,e){return new Bt.fn.init(t,e)},Nt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;function Pt(t){var e=!!t&&"length"in t&&t.length,i=Ft(t);return!Rt(t)&&!It(t)&&("array"===i||0===e||"number"==typeof e&&e>0&&e-1 in t)}Bt.fn=Bt.prototype={jquery:Dt,constructor:Bt,length:0,toArray:function(){return vt.call(this)},get:function(t){return null==t?vt.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=Bt.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return Bt.each(this,t)},map:function(t){return this.pushStack(Bt.map(this,(function(e,i){return t.call(e,i,e)})))},slice:function(){return this.pushStack(vt.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,i=+t+(t<0?e:0);return this.pushStack(i>=0&&i<e?[this[i]]:[])},end:function(){return this.prevObject||this.constructor()},push:xt,sort:mt.sort,splice:mt.splice},Bt.extend=Bt.fn.extend=function(){var t,e,i,n,r,s,o=arguments[0]||{},a=1,h=arguments.length,l=!1;for("boolean"==typeof o&&(l=o,o=arguments[a]||{},a++),"object"==typeof o||Rt(o)||(o={}),a===h&&(o=this,a--);a<h;a++)if(null!=(t=arguments[a]))for(e in t)i=o[e],o!==(n=t[e])&&(l&&n&&(Bt.isPlainObject(n)||(r=Array.isArray(n)))?(r?(r=!1,s=i&&Array.isArray(i)?i:[]):s=i&&Bt.isPlainObject(i)?i:{},o[e]=Bt.extend(l,s,n)):void 0!==n&&(o[e]=n));return o},Bt.extend({expando:"jQuery"+(Dt+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isPlainObject:function(t){var e,i;return!(!t||"[object Object]"!==_t.call(t))&&(!(e=wt(t))||"function"==typeof(i=Ct.call(e,"constructor")&&e.constructor)&&Et.call(i)===Tt)},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},globalEval:function(t){Mt(t)},each:function(t,e){var i,n=0;if(Pt(t))for(i=t.length;n<i&&!1!==e.call(t[n],n,t[n]);n++);else for(n in t)if(!1===e.call(t[n],n,t[n]))break;return t},trim:function(t){return null==t?"":(t+"").replace(Nt,"")},makeArray:function(t,e){var i=e||[];return null!=t&&(Pt(Object(t))?Bt.merge(i,"string"==typeof t?[t]:t):xt.call(i,t)),i},inArray:function(t,e,i){return null==e?-1:kt.call(e,t,i)},merge:function(t,e){for(var i=+e.length,n=0,r=t.length;n<i;n++)t[r++]=e[n];return t.length=r,t},grep:function(t,e,i){for(var n=[],r=0,s=t.length,o=!i;r<s;r++)!e(t[r],r)!==o&&n.push(t[r]);return n},map:function(t,e,i){var n,r,s=0,o=[];if(Pt(t))for(n=t.length;s<n;s++)null!=(r=e(t[s],s,i))&&o.push(r);else for(s in t)null!=(r=e(t[s],s,i))&&o.push(r);return yt.apply([],o)},guid:1,support:At}),"function"==typeof Symbol&&(Bt.fn[Symbol.iterator]=mt[Symbol.iterator]),Bt.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(t,e){St["[object "+e+"]"]=e.toLowerCase()}));var Ot=
/*!
 * Sizzle CSS Selector Engine v2.3.3
 * https://sizzlejs.com/
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2016-08-08
 */
function(t){var e,i,n,r,s,o,a,h,l,c,u,f,d,p,g,m,b,w,v,y="sizzle"+1*new Date,x=t.document,k=0,S=0,_=ot(),C=ot(),E=ot(),T=function(t,e){return t===e&&(u=!0),0},A={}.hasOwnProperty,R=[],I=R.pop,L=R.push,M=R.push,F=R.slice,D=function(t,e){for(var i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1},B="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",N="[\\x20\\t\\r\\n\\f]",P="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",O="\\[[\\x20\\t\\r\\n\\f]*("+P+")(?:"+N+"*([*^$|!~]?=)"+N+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+P+"))|)"+N+"*\\]",z=":("+P+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+O+")*)|.*)\\)|)",H=new RegExp(N+"+","g"),U=new RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g"),$=new RegExp("^[\\x20\\t\\r\\n\\f]*,[\\x20\\t\\r\\n\\f]*"),q=new RegExp("^[\\x20\\t\\r\\n\\f]*([>+~]|[\\x20\\t\\r\\n\\f])[\\x20\\t\\r\\n\\f]*"),V=new RegExp("=[\\x20\\t\\r\\n\\f]*([^\\]'\"]*?)[\\x20\\t\\r\\n\\f]*\\]","g"),j=new RegExp(z),W=new RegExp("^"+P+"$"),G={ID:new RegExp("^#("+P+")"),CLASS:new RegExp("^\\.("+P+")"),TAG:new RegExp("^("+P+"|[*])"),ATTR:new RegExp("^"+O),PSEUDO:new RegExp("^"+z),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)","i"),bool:new RegExp("^(?:"+B+")$","i"),needsContext:new RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)","i")},Z=/^(?:input|select|textarea|button)$/i,X=/^h\d$/i,Y=/^[^{]+\{\s*\[native \w/,K=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Q=/[+~]/,J=new RegExp("\\\\([\\da-f]{1,6}[\\x20\\t\\r\\n\\f]?|([\\x20\\t\\r\\n\\f])|.)","ig"),tt=function(t,e,i){var n="0x"+e-65536;return n!=n||i?e:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)},et=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,it=function(t,e){return e?"\0"===t?"":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t},nt=function(){f()},rt=bt((function(t){return!0===t.disabled&&("form"in t||"label"in t)}),{dir:"parentNode",next:"legend"});try{M.apply(R=F.call(x.childNodes),x.childNodes),R[x.childNodes.length].nodeType}catch(t){M={apply:R.length?function(t,e){L.apply(t,F.call(e))}:function(t,e){for(var i=t.length,n=0;t[i++]=e[n++];);t.length=i-1}}}function st(t,e,n,r){var s,a,l,c,u,p,b,w=e&&e.ownerDocument,k=e?e.nodeType:9;if(n=n||[],"string"!=typeof t||!t||1!==k&&9!==k&&11!==k)return n;if(!r&&((e?e.ownerDocument||e:x)!==d&&f(e),e=e||d,g)){if(11!==k&&(u=K.exec(t)))if(s=u[1]){if(9===k){if(!(l=e.getElementById(s)))return n;if(l.id===s)return n.push(l),n}else if(w&&(l=w.getElementById(s))&&v(e,l)&&l.id===s)return n.push(l),n}else{if(u[2])return M.apply(n,e.getElementsByTagName(t)),n;if((s=u[3])&&i.getElementsByClassName&&e.getElementsByClassName)return M.apply(n,e.getElementsByClassName(s)),n}if(i.qsa&&!E[t+" "]&&(!m||!m.test(t))){if(1!==k)w=e,b=t;else if("object"!==e.nodeName.toLowerCase()){for((c=e.getAttribute("id"))?c=c.replace(et,it):e.setAttribute("id",c=y),a=(p=o(t)).length;a--;)p[a]="#"+c+" "+mt(p[a]);b=p.join(","),w=Q.test(t)&&pt(e.parentNode)||e}if(b)try{return M.apply(n,w.querySelectorAll(b)),n}catch(t){}finally{c===y&&e.removeAttribute("id")}}}return h(t.replace(U,"$1"),e,n,r)}function ot(){var t=[];return function e(i,r){return t.push(i+" ")>n.cacheLength&&delete e[t.shift()],e[i+" "]=r}}function at(t){return t[y]=!0,t}function ht(t){var e=d.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function lt(t,e){var i=e&&t,n=i&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(n)return n;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function ct(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function ut(t){return function(e){var i=e.nodeName.toLowerCase();return("input"===i||"button"===i)&&e.type===t}}function ft(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&rt(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function dt(t){return at((function(e){return e=+e,at((function(i,n){for(var r,s=t([],i.length,e),o=s.length;o--;)i[r=s[o]]&&(i[r]=!(n[r]=i[r]))}))}))}function pt(t){return t&&void 0!==t.getElementsByTagName&&t}for(e in i=st.support={},s=st.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},f=st.setDocument=function(t){var e,r,o=t?t.ownerDocument||t:x;return o!==d&&9===o.nodeType&&o.documentElement?(p=(d=o).documentElement,g=!s(d),x!==d&&(r=d.defaultView)&&r.top!==r&&(r.addEventListener?r.addEventListener("unload",nt,!1):r.attachEvent&&r.attachEvent("onunload",nt)),i.attributes=ht((function(t){return t.className="i",!t.getAttribute("className")})),i.getElementsByTagName=ht((function(t){return t.appendChild(d.createComment("")),!t.getElementsByTagName("*").length})),i.getElementsByClassName=Y.test(d.getElementsByClassName),i.getById=ht((function(t){return p.appendChild(t).id=y,!d.getElementsByName||!d.getElementsByName(y).length})),i.getById?(n.filter.ID=function(t){var e=t.replace(J,tt);return function(t){return t.getAttribute("id")===e}},n.find.ID=function(t,e){if(void 0!==e.getElementById&&g){var i=e.getElementById(t);return i?[i]:[]}}):(n.filter.ID=function(t){var e=t.replace(J,tt);return function(t){var i=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return i&&i.value===e}},n.find.ID=function(t,e){if(void 0!==e.getElementById&&g){var i,n,r,s=e.getElementById(t);if(s){if((i=s.getAttributeNode("id"))&&i.value===t)return[s];for(r=e.getElementsByName(t),n=0;s=r[n++];)if((i=s.getAttributeNode("id"))&&i.value===t)return[s]}return[]}}),n.find.TAG=i.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):i.qsa?e.querySelectorAll(t):void 0}:function(t,e){var i,n=[],r=0,s=e.getElementsByTagName(t);if("*"===t){for(;i=s[r++];)1===i.nodeType&&n.push(i);return n}return s},n.find.CLASS=i.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&g)return e.getElementsByClassName(t)},b=[],m=[],(i.qsa=Y.test(d.querySelectorAll))&&(ht((function(t){p.appendChild(t).innerHTML="<a id='"+y+"'></a><select id='"+y+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&m.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")"),t.querySelectorAll("[selected]").length||m.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|"+B+")"),t.querySelectorAll("[id~="+y+"-]").length||m.push("~="),t.querySelectorAll(":checked").length||m.push(":checked"),t.querySelectorAll("a#"+y+"+*").length||m.push(".#.+[+~]")})),ht((function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=d.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&m.push("name[\\x20\\t\\r\\n\\f]*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&m.push(":enabled",":disabled"),p.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&m.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),m.push(",.*:")}))),(i.matchesSelector=Y.test(w=p.matches||p.webkitMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector||p.msMatchesSelector))&&ht((function(t){i.disconnectedMatch=w.call(t,"*"),w.call(t,"[s!='']:x"),b.push("!=",z)})),m=m.length&&new RegExp(m.join("|")),b=b.length&&new RegExp(b.join("|")),e=Y.test(p.compareDocumentPosition),v=e||Y.test(p.contains)?function(t,e){var i=9===t.nodeType?t.documentElement:t,n=e&&e.parentNode;return t===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):t.compareDocumentPosition&&16&t.compareDocumentPosition(n)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},T=e?function(t,e){if(t===e)return u=!0,0;var n=!t.compareDocumentPosition-!e.compareDocumentPosition;return n||(1&(n=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!i.sortDetached&&e.compareDocumentPosition(t)===n?t===d||t.ownerDocument===x&&v(x,t)?-1:e===d||e.ownerDocument===x&&v(x,e)?1:c?D(c,t)-D(c,e):0:4&n?-1:1)}:function(t,e){if(t===e)return u=!0,0;var i,n=0,r=t.parentNode,s=e.parentNode,o=[t],a=[e];if(!r||!s)return t===d?-1:e===d?1:r?-1:s?1:c?D(c,t)-D(c,e):0;if(r===s)return lt(t,e);for(i=t;i=i.parentNode;)o.unshift(i);for(i=e;i=i.parentNode;)a.unshift(i);for(;o[n]===a[n];)n++;return n?lt(o[n],a[n]):o[n]===x?-1:a[n]===x?1:0},d):d},st.matches=function(t,e){return st(t,null,null,e)},st.matchesSelector=function(t,e){if((t.ownerDocument||t)!==d&&f(t),e=e.replace(V,"='$1']"),i.matchesSelector&&g&&!E[e+" "]&&(!b||!b.test(e))&&(!m||!m.test(e)))try{var n=w.call(t,e);if(n||i.disconnectedMatch||t.document&&11!==t.document.nodeType)return n}catch(t){}return st(e,d,null,[t]).length>0},st.contains=function(t,e){return(t.ownerDocument||t)!==d&&f(t),v(t,e)},st.attr=function(t,e){(t.ownerDocument||t)!==d&&f(t);var r=n.attrHandle[e.toLowerCase()],s=r&&A.call(n.attrHandle,e.toLowerCase())?r(t,e,!g):void 0;return void 0!==s?s:i.attributes||!g?t.getAttribute(e):(s=t.getAttributeNode(e))&&s.specified?s.value:null},st.escape=function(t){return(t+"").replace(et,it)},st.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},st.uniqueSort=function(t){var e,n=[],r=0,s=0;if(u=!i.detectDuplicates,c=!i.sortStable&&t.slice(0),t.sort(T),u){for(;e=t[s++];)e===t[s]&&(r=n.push(s));for(;r--;)t.splice(n[r],1)}return c=null,t},r=st.getText=function(t){var e,i="",n=0,s=t.nodeType;if(s){if(1===s||9===s||11===s){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=r(t)}else if(3===s||4===s)return t.nodeValue}else for(;e=t[n++];)i+=r(e);return i},(n=st.selectors={cacheLength:50,createPseudo:at,match:G,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(J,tt),t[3]=(t[3]||t[4]||t[5]||"").replace(J,tt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||st.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&st.error(t[0]),t},PSEUDO:function(t){var e,i=!t[6]&&t[2];return G.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":i&&j.test(i)&&(e=o(i,!0))&&(e=i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(J,tt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=_[t+" "];return e||(e=new RegExp("(^|[\\x20\\t\\r\\n\\f])"+t+"("+N+"|$)"))&&_(t,(function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")}))},ATTR:function(t,e,i){return function(n){var r=st.attr(n,t);return null==r?"!="===e:!e||(r+="","="===e?r===i:"!="===e?r!==i:"^="===e?i&&0===r.indexOf(i):"*="===e?i&&r.indexOf(i)>-1:"$="===e?i&&r.slice(-i.length)===i:"~="===e?(" "+r.replace(H," ")+" ").indexOf(i)>-1:"|="===e&&(r===i||r.slice(0,i.length+1)===i+"-"))}},CHILD:function(t,e,i,n,r){var s="nth"!==t.slice(0,3),o="last"!==t.slice(-4),a="of-type"===e;return 1===n&&0===r?function(t){return!!t.parentNode}:function(e,i,h){var l,c,u,f,d,p,g=s!==o?"nextSibling":"previousSibling",m=e.parentNode,b=a&&e.nodeName.toLowerCase(),w=!h&&!a,v=!1;if(m){if(s){for(;g;){for(f=e;f=f[g];)if(a?f.nodeName.toLowerCase()===b:1===f.nodeType)return!1;p=g="only"===t&&!p&&"nextSibling"}return!0}if(p=[o?m.firstChild:m.lastChild],o&&w){for(v=(d=(l=(c=(u=(f=m)[y]||(f[y]={}))[f.uniqueID]||(u[f.uniqueID]={}))[t]||[])[0]===k&&l[1])&&l[2],f=d&&m.childNodes[d];f=++d&&f&&f[g]||(v=d=0)||p.pop();)if(1===f.nodeType&&++v&&f===e){c[t]=[k,d,v];break}}else if(w&&(v=d=(l=(c=(u=(f=e)[y]||(f[y]={}))[f.uniqueID]||(u[f.uniqueID]={}))[t]||[])[0]===k&&l[1]),!1===v)for(;(f=++d&&f&&f[g]||(v=d=0)||p.pop())&&((a?f.nodeName.toLowerCase()!==b:1!==f.nodeType)||!++v||(w&&((c=(u=f[y]||(f[y]={}))[f.uniqueID]||(u[f.uniqueID]={}))[t]=[k,v]),f!==e)););return(v-=r)===n||v%n==0&&v/n>=0}}},PSEUDO:function(t,e){var i,r=n.pseudos[t]||n.setFilters[t.toLowerCase()]||st.error("unsupported pseudo: "+t);return r[y]?r(e):r.length>1?(i=[t,t,"",e],n.setFilters.hasOwnProperty(t.toLowerCase())?at((function(t,i){for(var n,s=r(t,e),o=s.length;o--;)t[n=D(t,s[o])]=!(i[n]=s[o])})):function(t){return r(t,0,i)}):r}},pseudos:{not:at((function(t){var e=[],i=[],n=a(t.replace(U,"$1"));return n[y]?at((function(t,e,i,r){for(var s,o=n(t,null,r,[]),a=t.length;a--;)(s=o[a])&&(t[a]=!(e[a]=s))})):function(t,r,s){return e[0]=t,n(e,null,s,i),e[0]=null,!i.pop()}})),has:at((function(t){return function(e){return st(t,e).length>0}})),contains:at((function(t){return t=t.replace(J,tt),function(e){return(e.textContent||e.innerText||r(e)).indexOf(t)>-1}})),lang:at((function(t){return W.test(t||"")||st.error("unsupported lang: "+t),t=t.replace(J,tt).toLowerCase(),function(e){var i;do{if(i=g?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(i=i.toLowerCase())===t||0===i.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}})),target:function(e){var i=t.location&&t.location.hash;return i&&i.slice(1)===e.id},root:function(t){return t===p},focus:function(t){return t===d.activeElement&&(!d.hasFocus||d.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:ft(!1),disabled:ft(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!n.pseudos.empty(t)},header:function(t){return X.test(t.nodeName)},input:function(t){return Z.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:dt((function(){return[0]})),last:dt((function(t,e){return[e-1]})),eq:dt((function(t,e,i){return[i<0?i+e:i]})),even:dt((function(t,e){for(var i=0;i<e;i+=2)t.push(i);return t})),odd:dt((function(t,e){for(var i=1;i<e;i+=2)t.push(i);return t})),lt:dt((function(t,e,i){for(var n=i<0?i+e:i;--n>=0;)t.push(n);return t})),gt:dt((function(t,e,i){for(var n=i<0?i+e:i;++n<e;)t.push(n);return t}))}}).pseudos.nth=n.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})n.pseudos[e]=ct(e);for(e in{submit:!0,reset:!0})n.pseudos[e]=ut(e);function gt(){}function mt(t){for(var e=0,i=t.length,n="";e<i;e++)n+=t[e].value;return n}function bt(t,e,i){var n=e.dir,r=e.next,s=r||n,o=i&&"parentNode"===s,a=S++;return e.first?function(e,i,r){for(;e=e[n];)if(1===e.nodeType||o)return t(e,i,r);return!1}:function(e,i,h){var l,c,u,f=[k,a];if(h){for(;e=e[n];)if((1===e.nodeType||o)&&t(e,i,h))return!0}else for(;e=e[n];)if(1===e.nodeType||o)if(c=(u=e[y]||(e[y]={}))[e.uniqueID]||(u[e.uniqueID]={}),r&&r===e.nodeName.toLowerCase())e=e[n]||e;else{if((l=c[s])&&l[0]===k&&l[1]===a)return f[2]=l[2];if(c[s]=f,f[2]=t(e,i,h))return!0}return!1}}function wt(t){return t.length>1?function(e,i,n){for(var r=t.length;r--;)if(!t[r](e,i,n))return!1;return!0}:t[0]}function vt(t,e,i,n,r){for(var s,o=[],a=0,h=t.length,l=null!=e;a<h;a++)(s=t[a])&&(i&&!i(s,n,r)||(o.push(s),l&&e.push(a)));return o}function yt(t,e,i,n,r,s){return n&&!n[y]&&(n=yt(n)),r&&!r[y]&&(r=yt(r,s)),at((function(s,o,a,h){var l,c,u,f=[],d=[],p=o.length,g=s||function(t,e,i){for(var n=0,r=e.length;n<r;n++)st(t,e[n],i);return i}(e||"*",a.nodeType?[a]:a,[]),m=!t||!s&&e?g:vt(g,f,t,a,h),b=i?r||(s?t:p||n)?[]:o:m;if(i&&i(m,b,a,h),n)for(l=vt(b,d),n(l,[],a,h),c=l.length;c--;)(u=l[c])&&(b[d[c]]=!(m[d[c]]=u));if(s){if(r||t){if(r){for(l=[],c=b.length;c--;)(u=b[c])&&l.push(m[c]=u);r(null,b=[],l,h)}for(c=b.length;c--;)(u=b[c])&&(l=r?D(s,u):f[c])>-1&&(s[l]=!(o[l]=u))}}else b=vt(b===o?b.splice(p,b.length):b),r?r(null,o,b,h):M.apply(o,b)}))}function xt(t){for(var e,i,r,s=t.length,o=n.relative[t[0].type],a=o||n.relative[" "],h=o?1:0,c=bt((function(t){return t===e}),a,!0),u=bt((function(t){return D(e,t)>-1}),a,!0),f=[function(t,i,n){var r=!o&&(n||i!==l)||((e=i).nodeType?c(t,i,n):u(t,i,n));return e=null,r}];h<s;h++)if(i=n.relative[t[h].type])f=[bt(wt(f),i)];else{if((i=n.filter[t[h].type].apply(null,t[h].matches))[y]){for(r=++h;r<s&&!n.relative[t[r].type];r++);return yt(h>1&&wt(f),h>1&&mt(t.slice(0,h-1).concat({value:" "===t[h-2].type?"*":""})).replace(U,"$1"),i,h<r&&xt(t.slice(h,r)),r<s&&xt(t=t.slice(r)),r<s&&mt(t))}f.push(i)}return wt(f)}return gt.prototype=n.filters=n.pseudos,n.setFilters=new gt,o=st.tokenize=function(t,e){var i,r,s,o,a,h,l,c=C[t+" "];if(c)return e?0:c.slice(0);for(a=t,h=[],l=n.preFilter;a;){for(o in i&&!(r=$.exec(a))||(r&&(a=a.slice(r[0].length)||a),h.push(s=[])),i=!1,(r=q.exec(a))&&(i=r.shift(),s.push({value:i,type:r[0].replace(U," ")}),a=a.slice(i.length)),n.filter)!(r=G[o].exec(a))||l[o]&&!(r=l[o](r))||(i=r.shift(),s.push({value:i,type:o,matches:r}),a=a.slice(i.length));if(!i)break}return e?a.length:a?st.error(t):C(t,h).slice(0)},a=st.compile=function(t,e){var i,r=[],s=[],a=E[t+" "];if(!a){for(e||(e=o(t)),i=e.length;i--;)(a=xt(e[i]))[y]?r.push(a):s.push(a);(a=E(t,function(t,e){var i=e.length>0,r=t.length>0,s=function(s,o,a,h,c){var u,p,m,b=0,w="0",v=s&&[],y=[],x=l,S=s||r&&n.find.TAG("*",c),_=k+=null==x?1:Math.random()||.1,C=S.length;for(c&&(l=o===d||o||c);w!==C&&null!=(u=S[w]);w++){if(r&&u){for(p=0,o||u.ownerDocument===d||(f(u),a=!g);m=t[p++];)if(m(u,o||d,a)){h.push(u);break}c&&(k=_)}i&&((u=!m&&u)&&b--,s&&v.push(u))}if(b+=w,i&&w!==b){for(p=0;m=e[p++];)m(v,y,o,a);if(s){if(b>0)for(;w--;)v[w]||y[w]||(y[w]=I.call(h));y=vt(y)}M.apply(h,y),c&&!s&&y.length>0&&b+e.length>1&&st.uniqueSort(h)}return c&&(k=_,l=x),v};return i?at(s):s}(s,r))).selector=t}return a},h=st.select=function(t,e,i,r){var s,h,l,c,u,f="function"==typeof t&&t,d=!r&&o(t=f.selector||t);if(i=i||[],1===d.length){if((h=d[0]=d[0].slice(0)).length>2&&"ID"===(l=h[0]).type&&9===e.nodeType&&g&&n.relative[h[1].type]){if(!(e=(n.find.ID(l.matches[0].replace(J,tt),e)||[])[0]))return i;f&&(e=e.parentNode),t=t.slice(h.shift().value.length)}for(s=G.needsContext.test(t)?0:h.length;s--&&(l=h[s],!n.relative[c=l.type]);)if((u=n.find[c])&&(r=u(l.matches[0].replace(J,tt),Q.test(h[0].type)&&pt(e.parentNode)||e))){if(h.splice(s,1),!(t=r.length&&mt(h)))return M.apply(i,r),i;break}}return(f||a(t,d))(r,e,!g,i,!e||Q.test(t)&&pt(e.parentNode)||e),i},i.sortStable=y.split("").sort(T).join("")===y,i.detectDuplicates=!!u,f(),st}(window);Bt.find=Ot,Bt.expr=Ot.selectors,Bt.expr[":"]=Bt.expr.pseudos,Bt.uniqueSort=Bt.unique=Ot.uniqueSort,Bt.text=Ot.getText,Bt.isXMLDoc=Ot.isXML,Bt.contains=Ot.contains,Bt.escapeSelector=Ot.escape;var zt=function(t,e,i){for(var n=[],r=void 0!==i;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(r&&Bt(t).is(i))break;n.push(t)}return n},Ht=function(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i},Ut=Bt.expr.match.needsContext;function $t(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}var qt=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function Vt(t,e,i){return Rt(e)?Bt.grep(t,(function(t,n){return!!e.call(t,n,t)!==i})):e.nodeType?Bt.grep(t,(function(t){return t===e!==i})):"string"!=typeof e?Bt.grep(t,(function(t){return kt.call(e,t)>-1!==i})):Bt.filter(e,t,i)}Bt.filter=function(t,e,i){var n=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===n.nodeType?Bt.find.matchesSelector(n,t)?[n]:[]:Bt.find.matches(t,Bt.grep(e,(function(t){return 1===t.nodeType})))},Bt.fn.extend({find:function(t){var e,i,n=this.length,r=this;if("string"!=typeof t)return this.pushStack(Bt(t).filter((function(){for(e=0;e<n;e++)if(Bt.contains(r[e],this))return!0})));for(i=this.pushStack([]),e=0;e<n;e++)Bt.find(t,r[e],i);return n>1?Bt.uniqueSort(i):i},filter:function(t){return this.pushStack(Vt(this,t||[],!1))},not:function(t){return this.pushStack(Vt(this,t||[],!0))},is:function(t){return!!Vt(this,"string"==typeof t&&Ut.test(t)?Bt(t):t||[],!1).length}});var jt,Wt=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(Bt.fn.init=function(t,e,i){var n,r;if(!t)return this;if(i=i||jt,"string"==typeof t){if(!(n="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:Wt.exec(t))||!n[1]&&e)return!e||e.jquery?(e||i).find(t):this.constructor(e).find(t);if(n[1]){if(e=e instanceof Bt?e[0]:e,Bt.merge(this,Bt.parseHTML(n[1],e&&e.nodeType?e.ownerDocument||e:bt,!0)),qt.test(n[1])&&Bt.isPlainObject(e))for(n in e)Rt(this[n])?this[n](e[n]):this.attr(n,e[n]);return this}return(r=bt.getElementById(n[2]))&&(this[0]=r,this.length=1),this}return t.nodeType?(this[0]=t,this.length=1,this):Rt(t)?void 0!==i.ready?i.ready(t):t(Bt):Bt.makeArray(t,this)}).prototype=Bt.fn,jt=Bt(bt);var Gt=/^(?:parents|prev(?:Until|All))/,Zt={children:!0,contents:!0,next:!0,prev:!0};function Xt(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}Bt.fn.extend({has:function(t){var e=Bt(t,this),i=e.length;return this.filter((function(){for(var t=0;t<i;t++)if(Bt.contains(this,e[t]))return!0}))},closest:function(t,e){var i,n=0,r=this.length,s=[],o="string"!=typeof t&&Bt(t);if(!Ut.test(t))for(;n<r;n++)for(i=this[n];i&&i!==e;i=i.parentNode)if(i.nodeType<11&&(o?o.index(i)>-1:1===i.nodeType&&Bt.find.matchesSelector(i,t))){s.push(i);break}return this.pushStack(s.length>1?Bt.uniqueSort(s):s)},index:function(t){return t?"string"==typeof t?kt.call(Bt(t),this[0]):kt.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(Bt.uniqueSort(Bt.merge(this.get(),Bt(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),Bt.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return zt(t,"parentNode")},parentsUntil:function(t,e,i){return zt(t,"parentNode",i)},next:function(t){return Xt(t,"nextSibling")},prev:function(t){return Xt(t,"previousSibling")},nextAll:function(t){return zt(t,"nextSibling")},prevAll:function(t){return zt(t,"previousSibling")},nextUntil:function(t,e,i){return zt(t,"nextSibling",i)},prevUntil:function(t,e,i){return zt(t,"previousSibling",i)},siblings:function(t){return Ht((t.parentNode||{}).firstChild,t)},children:function(t){return Ht(t.firstChild)},contents:function(t){return $t(t,"iframe")?t.contentDocument:($t(t,"template")&&(t=t.content||t),Bt.merge([],t.childNodes))}},(function(t,e){Bt.fn[t]=function(i,n){var r=Bt.map(this,e,i);return"Until"!==t.slice(-5)&&(n=i),n&&"string"==typeof n&&(r=Bt.filter(n,r)),this.length>1&&(Zt[t]||Bt.uniqueSort(r),Gt.test(t)&&r.reverse()),this.pushStack(r)}}));var Yt=/[^\x20\t\r\n\f]+/g;function Kt(t){return t}function Qt(t){throw t}function Jt(t,e,i,n){var r;try{t&&Rt(r=t.promise)?r.call(t).done(e).fail(i):t&&Rt(r=t.then)?r.call(t,e,i):e.apply(void 0,[t].slice(n))}catch(t){i.apply(void 0,[t])}}Bt.Callbacks=function(t){t="string"==typeof t?function(t){var e={};return Bt.each(t.match(Yt)||[],(function(t,i){e[i]=!0})),e}(t):Bt.extend({},t);var e,i,n,r,s=[],o=[],a=-1,h=function(){for(r=r||t.once,n=e=!0;o.length;a=-1)for(i=o.shift();++a<s.length;)!1===s[a].apply(i[0],i[1])&&t.stopOnFalse&&(a=s.length,i=!1);t.memory||(i=!1),e=!1,r&&(s=i?[]:"")},l={add:function(){return s&&(i&&!e&&(a=s.length-1,o.push(i)),function e(i){Bt.each(i,(function(i,n){Rt(n)?t.unique&&l.has(n)||s.push(n):n&&n.length&&"string"!==Ft(n)&&e(n)}))}(arguments),i&&!e&&h()),this},remove:function(){return Bt.each(arguments,(function(t,e){for(var i;(i=Bt.inArray(e,s,i))>-1;)s.splice(i,1),i<=a&&a--})),this},has:function(t){return t?Bt.inArray(t,s)>-1:s.length>0},empty:function(){return s&&(s=[]),this},disable:function(){return r=o=[],s=i="",this},disabled:function(){return!s},lock:function(){return r=o=[],i||e||(s=i=""),this},locked:function(){return!!r},fireWith:function(t,i){return r||(i=[t,(i=i||[]).slice?i.slice():i],o.push(i),e||h()),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!n}};return l},Bt.extend({Deferred:function(t){var e=[["notify","progress",Bt.Callbacks("memory"),Bt.Callbacks("memory"),2],["resolve","done",Bt.Callbacks("once memory"),Bt.Callbacks("once memory"),0,"resolved"],["reject","fail",Bt.Callbacks("once memory"),Bt.Callbacks("once memory"),1,"rejected"]],i="pending",n={state:function(){return i},always:function(){return r.done(arguments).fail(arguments),this},catch:function(t){return n.then(null,t)},pipe:function(){var t=arguments;return Bt.Deferred((function(i){Bt.each(e,(function(e,n){var s=Rt(t[n[4]])&&t[n[4]];r[n[1]]((function(){var t=s&&s.apply(this,arguments);t&&Rt(t.promise)?t.promise().progress(i.notify).done(i.resolve).fail(i.reject):i[n[0]+"With"](this,s?[t]:arguments)}))})),t=null})).promise()},then:function(t,i,n){var r=0;function s(t,e,i,n){return function(){var o=this,a=arguments,h=function(){var h,l;if(!(t<r)){if((h=i.apply(o,a))===e.promise())throw new TypeError("Thenable self-resolution");l=h&&("object"==typeof h||"function"==typeof h)&&h.then,Rt(l)?n?l.call(h,s(r,e,Kt,n),s(r,e,Qt,n)):(r++,l.call(h,s(r,e,Kt,n),s(r,e,Qt,n),s(r,e,Kt,e.notifyWith))):(i!==Kt&&(o=void 0,a=[h]),(n||e.resolveWith)(o,a))}},l=n?h:function(){try{h()}catch(n){Bt.Deferred.exceptionHook&&Bt.Deferred.exceptionHook(n,l.stackTrace),t+1>=r&&(i!==Qt&&(o=void 0,a=[n]),e.rejectWith(o,a))}};t?l():(Bt.Deferred.getStackHook&&(l.stackTrace=Bt.Deferred.getStackHook()),window.setTimeout(l))}}return Bt.Deferred((function(r){e[0][3].add(s(0,r,Rt(n)?n:Kt,r.notifyWith)),e[1][3].add(s(0,r,Rt(t)?t:Kt)),e[2][3].add(s(0,r,Rt(i)?i:Qt))})).promise()},promise:function(t){return null!=t?Bt.extend(t,n):n}},r={};return Bt.each(e,(function(t,s){var o=s[2],a=s[5];n[s[1]]=o.add,a&&o.add((function(){i=a}),e[3-t][2].disable,e[3-t][3].disable,e[0][2].lock,e[0][3].lock),o.add(s[3].fire),r[s[0]]=function(){return r[s[0]+"With"](this===r?void 0:this,arguments),this},r[s[0]+"With"]=o.fireWith})),n.promise(r),t&&t.call(r,r),r},when:function(t){var e=arguments.length,i=e,n=Array(i),r=vt.call(arguments),s=Bt.Deferred(),o=function(t){return function(i){n[t]=this,r[t]=arguments.length>1?vt.call(arguments):i,--e||s.resolveWith(n,r)}};if(e<=1&&(Jt(t,s.done(o(i)).resolve,s.reject,!e),"pending"===s.state()||Rt(r[i]&&r[i].then)))return s.then();for(;i--;)Jt(r[i],o(i),s.reject);return s.promise()}});var te=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;Bt.Deferred.exceptionHook=function(t,e){window.console&&window.console.warn&&t&&te.test(t.name)&&window.console.warn("jQuery.Deferred exception: "+t.message,t.stack,e)},Bt.readyException=function(t){window.setTimeout((function(){throw t}))};var ee=Bt.Deferred();function ie(){bt.removeEventListener("DOMContentLoaded",ie),window.removeEventListener("load",ie),Bt.ready()}Bt.fn.ready=function(t){return ee.then(t).catch((function(t){Bt.readyException(t)})),this},Bt.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--Bt.readyWait:Bt.isReady)||(Bt.isReady=!0,!0!==t&&--Bt.readyWait>0||ee.resolveWith(bt,[Bt]))}}),Bt.ready.then=ee.then,"complete"===bt.readyState||"loading"!==bt.readyState&&!bt.documentElement.doScroll?window.setTimeout(Bt.ready):(bt.addEventListener("DOMContentLoaded",ie),window.addEventListener("load",ie));var ne=function(t,e,i,n,r,s,o){var a=0,h=t.length,l=null==i;if("object"===Ft(i))for(a in r=!0,i)ne(t,e,a,i[a],!0,s,o);else if(void 0!==n&&(r=!0,Rt(n)||(o=!0),l&&(o?(e.call(t,n),e=null):(l=e,e=function(t,e,i){return l.call(Bt(t),i)})),e))for(;a<h;a++)e(t[a],i,o?n:n.call(t[a],a,e(t[a],i)));return r?t:l?e.call(t):h?e(t[0],i):s},re=/^-ms-/,se=/-([a-z])/g;function oe(t,e){return e.toUpperCase()}function ae(t){return t.replace(re,"ms-").replace(se,oe)}var he=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};function le(){this.expando=Bt.expando+le.uid++}le.uid=1,le.prototype={cache:function(t){var e=t[this.expando];return e||(e={},he(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,i){var n,r=this.cache(t);if("string"==typeof e)r[ae(e)]=i;else for(n in e)r[ae(n)]=e[n];return r},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][ae(e)]},access:function(t,e,i){return void 0===e||e&&"string"==typeof e&&void 0===i?this.get(t,e):(this.set(t,e,i),void 0!==i?i:e)},remove:function(t,e){var i,n=t[this.expando];if(void 0!==n){if(void 0!==e){i=(e=Array.isArray(e)?e.map(ae):(e=ae(e))in n?[e]:e.match(Yt)||[]).length;for(;i--;)delete n[e[i]]}(void 0===e||Bt.isEmptyObject(n))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!Bt.isEmptyObject(e)}};var ce=new le,ue=new le,fe=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,de=/[A-Z]/g;function pe(t,e,i){var n;if(void 0===i&&1===t.nodeType)if(n="data-"+e.replace(de,"-$&").toLowerCase(),"string"==typeof(i=t.getAttribute(n))){try{i=function(t){return"true"===t||"false"!==t&&("null"===t?null:t===+t+""?+t:fe.test(t)?JSON.parse(t):t)}(i)}catch(t){}ue.set(t,e,i)}else i=void 0;return i}Bt.extend({hasData:function(t){return ue.hasData(t)||ce.hasData(t)},data:function(t,e,i){return ue.access(t,e,i)},removeData:function(t,e){ue.remove(t,e)},_data:function(t,e,i){return ce.access(t,e,i)},_removeData:function(t,e){ce.remove(t,e)}}),Bt.fn.extend({data:function(t,e){var i,n,r,s=this[0],o=s&&s.attributes;if(void 0===t){if(this.length&&(r=ue.get(s),1===s.nodeType&&!ce.get(s,"hasDataAttrs"))){for(i=o.length;i--;)o[i]&&0===(n=o[i].name).indexOf("data-")&&(n=ae(n.slice(5)),pe(s,n,r[n]));ce.set(s,"hasDataAttrs",!0)}return r}return"object"==typeof t?this.each((function(){ue.set(this,t)})):ne(this,(function(e){var i;if(s&&void 0===e)return void 0!==(i=ue.get(s,t))||void 0!==(i=pe(s,t))?i:void 0;this.each((function(){ue.set(this,t,e)}))}),null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each((function(){ue.remove(this,t)}))}}),Bt.extend({queue:function(t,e,i){var n;if(t)return e=(e||"fx")+"queue",n=ce.get(t,e),i&&(!n||Array.isArray(i)?n=ce.access(t,e,Bt.makeArray(i)):n.push(i)),n||[]},dequeue:function(t,e){e=e||"fx";var i=Bt.queue(t,e),n=i.length,r=i.shift(),s=Bt._queueHooks(t,e);"inprogress"===r&&(r=i.shift(),n--),r&&("fx"===e&&i.unshift("inprogress"),delete s.stop,r.call(t,(function(){Bt.dequeue(t,e)}),s)),!n&&s&&s.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return ce.get(t,i)||ce.access(t,i,{empty:Bt.Callbacks("once memory").add((function(){ce.remove(t,[e+"queue",i])}))})}}),Bt.fn.extend({queue:function(t,e){var i=2;return"string"!=typeof t&&(e=t,t="fx",i--),arguments.length<i?Bt.queue(this[0],t):void 0===e?this:this.each((function(){var i=Bt.queue(this,t,e);Bt._queueHooks(this,t),"fx"===t&&"inprogress"!==i[0]&&Bt.dequeue(this,t)}))},dequeue:function(t){return this.each((function(){Bt.dequeue(this,t)}))},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var i,n=1,r=Bt.Deferred(),s=this,o=this.length,a=function(){--n||r.resolveWith(s,[s])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";o--;)(i=ce.get(s[o],t+"queueHooks"))&&i.empty&&(n++,i.empty.add(a));return a(),r.promise(e)}});var ge=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,me=new RegExp("^(?:([+-])=|)("+ge+")([a-z%]*)$","i"),be=["Top","Right","Bottom","Left"],we=function(t,e){return"none"===(t=e||t).style.display||""===t.style.display&&Bt.contains(t.ownerDocument,t)&&"none"===Bt.css(t,"display")},ve=function(t,e,i,n){var r,s,o={};for(s in e)o[s]=t.style[s],t.style[s]=e[s];for(s in r=i.apply(t,n||[]),e)t.style[s]=o[s];return r};var ye={};function xe(t){var e,i=t.ownerDocument,n=t.nodeName,r=ye[n];return r||(e=i.body.appendChild(i.createElement(n)),r=Bt.css(e,"display"),e.parentNode.removeChild(e),"none"===r&&(r="block"),ye[n]=r,r)}function ke(t,e){for(var i,n,r=[],s=0,o=t.length;s<o;s++)(n=t[s]).style&&(i=n.style.display,e?("none"===i&&(r[s]=ce.get(n,"display")||null,r[s]||(n.style.display="")),""===n.style.display&&we(n)&&(r[s]=xe(n))):"none"!==i&&(r[s]="none",ce.set(n,"display",i)));for(s=0;s<o;s++)null!=r[s]&&(t[s].style.display=r[s]);return t}Bt.fn.extend({show:function(){return ke(this,!0)},hide:function(){return ke(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each((function(){we(this)?Bt(this).show():Bt(this).hide()}))}});var Se=/^(?:checkbox|radio)$/i,_e=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,Ce=/^$|^module$|\/(?:java|ecma)script/i,Ee={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function Te(t,e){var i;return i=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&$t(t,e)?Bt.merge([t],i):i}function Ae(t,e){for(var i=0,n=t.length;i<n;i++)ce.set(t[i],"globalEval",!e||ce.get(e[i],"globalEval"))}Ee.optgroup=Ee.option,Ee.tbody=Ee.tfoot=Ee.colgroup=Ee.caption=Ee.thead,Ee.th=Ee.td;var Re=/<|&#?\w+;/;function Ie(t,e,i,n,r){for(var s,o,a,h,l,c,u=e.createDocumentFragment(),f=[],d=0,p=t.length;d<p;d++)if((s=t[d])||0===s)if("object"===Ft(s))Bt.merge(f,s.nodeType?[s]:s);else if(Re.test(s)){for(o=o||u.appendChild(e.createElement("div")),a=(_e.exec(s)||["",""])[1].toLowerCase(),h=Ee[a]||Ee._default,o.innerHTML=h[1]+Bt.htmlPrefilter(s)+h[2],c=h[0];c--;)o=o.lastChild;Bt.merge(f,o.childNodes),(o=u.firstChild).textContent=""}else f.push(e.createTextNode(s));for(u.textContent="",d=0;s=f[d++];)if(n&&Bt.inArray(s,n)>-1)r&&r.push(s);else if(l=Bt.contains(s.ownerDocument,s),o=Te(u.appendChild(s),"script"),l&&Ae(o),i)for(c=0;s=o[c++];)Ce.test(s.type||"")&&i.push(s);return u}!function(){var t=bt.createDocumentFragment().appendChild(bt.createElement("div")),e=bt.createElement("input");e.setAttribute("type","radio"),e.setAttribute("checked","checked"),e.setAttribute("name","t"),t.appendChild(e),At.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",At.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue}();var Le=bt.documentElement,Me=/^key/,Fe=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,De=/^([^.]*)(?:\.(.+)|)/;function Be(){return!0}function Ne(){return!1}function Pe(){try{return bt.activeElement}catch(t){}}function Oe(t,e,i,n,r,s){var o,a;if("object"==typeof e){for(a in"string"!=typeof i&&(n=n||i,i=void 0),e)Oe(t,a,i,n,e[a],s);return t}if(null==n&&null==r?(r=i,n=i=void 0):null==r&&("string"==typeof i?(r=n,n=void 0):(r=n,n=i,i=void 0)),!1===r)r=Ne;else if(!r)return t;return 1===s&&(o=r,(r=function(t){return Bt().off(t),o.apply(this,arguments)}).guid=o.guid||(o.guid=Bt.guid++)),t.each((function(){Bt.event.add(this,e,r,n,i)}))}Bt.event={global:{},add:function(t,e,i,n,r){var s,o,a,h,l,c,u,f,d,p,g,m=ce.get(t);if(m)for(i.handler&&(i=(s=i).handler,r=s.selector),r&&Bt.find.matchesSelector(Le,r),i.guid||(i.guid=Bt.guid++),(h=m.events)||(h=m.events={}),(o=m.handle)||(o=m.handle=function(e){return void 0!==Bt&&Bt.event.triggered!==e.type?Bt.event.dispatch.apply(t,arguments):void 0}),l=(e=(e||"").match(Yt)||[""]).length;l--;)d=g=(a=De.exec(e[l])||[])[1],p=(a[2]||"").split(".").sort(),d&&(u=Bt.event.special[d]||{},d=(r?u.delegateType:u.bindType)||d,u=Bt.event.special[d]||{},c=Bt.extend({type:d,origType:g,data:n,handler:i,guid:i.guid,selector:r,needsContext:r&&Bt.expr.match.needsContext.test(r),namespace:p.join(".")},s),(f=h[d])||((f=h[d]=[]).delegateCount=0,u.setup&&!1!==u.setup.call(t,n,p,o)||t.addEventListener&&t.addEventListener(d,o)),u.add&&(u.add.call(t,c),c.handler.guid||(c.handler.guid=i.guid)),r?f.splice(f.delegateCount++,0,c):f.push(c),Bt.event.global[d]=!0)},remove:function(t,e,i,n,r){var s,o,a,h,l,c,u,f,d,p,g,m=ce.hasData(t)&&ce.get(t);if(m&&(h=m.events)){for(l=(e=(e||"").match(Yt)||[""]).length;l--;)if(d=g=(a=De.exec(e[l])||[])[1],p=(a[2]||"").split(".").sort(),d){for(u=Bt.event.special[d]||{},f=h[d=(n?u.delegateType:u.bindType)||d]||[],a=a[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=s=f.length;s--;)c=f[s],!r&&g!==c.origType||i&&i.guid!==c.guid||a&&!a.test(c.namespace)||n&&n!==c.selector&&("**"!==n||!c.selector)||(f.splice(s,1),c.selector&&f.delegateCount--,u.remove&&u.remove.call(t,c));o&&!f.length&&(u.teardown&&!1!==u.teardown.call(t,p,m.handle)||Bt.removeEvent(t,d,m.handle),delete h[d])}else for(d in h)Bt.event.remove(t,d+e[l],i,n,!0);Bt.isEmptyObject(h)&&ce.remove(t,"handle events")}},dispatch:function(t){var e,i,n,r,s,o,a=Bt.event.fix(t),h=new Array(arguments.length),l=(ce.get(this,"events")||{})[a.type]||[],c=Bt.event.special[a.type]||{};for(h[0]=a,e=1;e<arguments.length;e++)h[e]=arguments[e];if(a.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,a)){for(o=Bt.event.handlers.call(this,a,l),e=0;(r=o[e++])&&!a.isPropagationStopped();)for(a.currentTarget=r.elem,i=0;(s=r.handlers[i++])&&!a.isImmediatePropagationStopped();)a.rnamespace&&!a.rnamespace.test(s.namespace)||(a.handleObj=s,a.data=s.data,void 0!==(n=((Bt.event.special[s.origType]||{}).handle||s.handler).apply(r.elem,h))&&!1===(a.result=n)&&(a.preventDefault(),a.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,a),a.result}},handlers:function(t,e){var i,n,r,s,o,a=[],h=e.delegateCount,l=t.target;if(h&&l.nodeType&&!("click"===t.type&&t.button>=1))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==t.type||!0!==l.disabled)){for(s=[],o={},i=0;i<h;i++)void 0===o[r=(n=e[i]).selector+" "]&&(o[r]=n.needsContext?Bt(r,this).index(l)>-1:Bt.find(r,this,null,[l]).length),o[r]&&s.push(n);s.length&&a.push({elem:l,handlers:s})}return l=this,h<e.length&&a.push({elem:l,handlers:e.slice(h)}),a},addProp:function(t,e){Object.defineProperty(Bt.Event.prototype,t,{enumerable:!0,configurable:!0,get:Rt(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(t){return t[Bt.expando]?t:new Bt.Event(t)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==Pe()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===Pe()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&$t(this,"input"))return this.click(),!1},_default:function(t){return $t(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},Bt.removeEvent=function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i)},Bt.Event=function(t,e){if(!(this instanceof Bt.Event))return new Bt.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?Be:Ne,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&Bt.extend(this,e),this.timeStamp=t&&t.timeStamp||Date.now(),this[Bt.expando]=!0},Bt.Event.prototype={constructor:Bt.Event,isDefaultPrevented:Ne,isPropagationStopped:Ne,isImmediatePropagationStopped:Ne,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=Be,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=Be,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=Be,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},Bt.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(t){var e=t.button;return null==t.which&&Me.test(t.type)?null!=t.charCode?t.charCode:t.keyCode:!t.which&&void 0!==e&&Fe.test(t.type)?1&e?1:2&e?3:4&e?2:0:t.which}},Bt.event.addProp),Bt.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(t,e){Bt.event.special[t]={delegateType:e,bindType:e,handle:function(t){var i,n=this,r=t.relatedTarget,s=t.handleObj;return r&&(r===n||Bt.contains(n,r))||(t.type=s.origType,i=s.handler.apply(this,arguments),t.type=e),i}}})),Bt.fn.extend({on:function(t,e,i,n){return Oe(this,t,e,i,n)},one:function(t,e,i,n){return Oe(this,t,e,i,n,1)},off:function(t,e,i){var n,r;if(t&&t.preventDefault&&t.handleObj)return n=t.handleObj,Bt(t.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof t){for(r in t)this.off(r,e,t[r]);return this}return!1!==e&&"function"!=typeof e||(i=e,e=void 0),!1===i&&(i=Ne),this.each((function(){Bt.event.remove(this,t,i,e)}))}});var ze=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,He=/<script|<style|<link/i,Ue=/checked\s*(?:[^=]|=\s*.checked.)/i,$e=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function qe(t,e){return $t(t,"table")&&$t(11!==e.nodeType?e:e.firstChild,"tr")&&Bt(t).children("tbody")[0]||t}function Ve(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function je(t){return"true/"===(t.type||"").slice(0,5)?t.type=t.type.slice(5):t.removeAttribute("type"),t}function We(t,e){var i,n,r,s,o,a,h,l;if(1===e.nodeType){if(ce.hasData(t)&&(s=ce.access(t),o=ce.set(e,s),l=s.events))for(r in delete o.handle,o.events={},l)for(i=0,n=l[r].length;i<n;i++)Bt.event.add(e,r,l[r][i]);ue.hasData(t)&&(a=ue.access(t),h=Bt.extend({},a),ue.set(e,h))}}function Ge(t,e){var i=e.nodeName.toLowerCase();"input"===i&&Se.test(t.type)?e.checked=t.checked:"input"!==i&&"textarea"!==i||(e.defaultValue=t.defaultValue)}function Ze(t,e,i,n){e=yt.apply([],e);var r,s,o,a,h,l,c=0,u=t.length,f=u-1,d=e[0],p=Rt(d);if(p||u>1&&"string"==typeof d&&!At.checkClone&&Ue.test(d))return t.each((function(r){var s=t.eq(r);p&&(e[0]=d.call(this,r,s.html())),Ze(s,e,i,n)}));if(u&&(s=(r=Ie(e,t[0].ownerDocument,!1,t,n)).firstChild,1===r.childNodes.length&&(r=s),s||n)){for(a=(o=Bt.map(Te(r,"script"),Ve)).length;c<u;c++)h=r,c!==f&&(h=Bt.clone(h,!0,!0),a&&Bt.merge(o,Te(h,"script"))),i.call(t[c],h,c);if(a)for(l=o[o.length-1].ownerDocument,Bt.map(o,je),c=0;c<a;c++)h=o[c],Ce.test(h.type||"")&&!ce.access(h,"globalEval")&&Bt.contains(l,h)&&(h.src&&"module"!==(h.type||"").toLowerCase()?Bt._evalUrl&&Bt._evalUrl(h.src):Mt(h.textContent.replace($e,""),l,h))}return t}function Xe(t,e,i){for(var n,r=e?Bt.filter(e,t):t,s=0;null!=(n=r[s]);s++)i||1!==n.nodeType||Bt.cleanData(Te(n)),n.parentNode&&(i&&Bt.contains(n.ownerDocument,n)&&Ae(Te(n,"script")),n.parentNode.removeChild(n));return t}Bt.extend({htmlPrefilter:function(t){return t.replace(ze,"<$1></$2>")},clone:function(t,e,i){var n,r,s,o,a=t.cloneNode(!0),h=Bt.contains(t.ownerDocument,t);if(!(At.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||Bt.isXMLDoc(t)))for(o=Te(a),n=0,r=(s=Te(t)).length;n<r;n++)Ge(s[n],o[n]);if(e)if(i)for(s=s||Te(t),o=o||Te(a),n=0,r=s.length;n<r;n++)We(s[n],o[n]);else We(t,a);return(o=Te(a,"script")).length>0&&Ae(o,!h&&Te(t,"script")),a},cleanData:function(t){for(var e,i,n,r=Bt.event.special,s=0;void 0!==(i=t[s]);s++)if(he(i)){if(e=i[ce.expando]){if(e.events)for(n in e.events)r[n]?Bt.event.remove(i,n):Bt.removeEvent(i,n,e.handle);i[ce.expando]=void 0}i[ue.expando]&&(i[ue.expando]=void 0)}}}),Bt.fn.extend({detach:function(t){return Xe(this,t,!0)},remove:function(t){return Xe(this,t)},text:function(t){return ne(this,(function(t){return void 0===t?Bt.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)}))}),null,t,arguments.length)},append:function(){return Ze(this,arguments,(function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||qe(this,t).appendChild(t)}))},prepend:function(){return Ze(this,arguments,(function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=qe(this,t);e.insertBefore(t,e.firstChild)}}))},before:function(){return Ze(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this)}))},after:function(){return Ze(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)}))},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(Bt.cleanData(Te(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map((function(){return Bt.clone(this,t,e)}))},html:function(t){return ne(this,(function(t){var e=this[0]||{},i=0,n=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!He.test(t)&&!Ee[(_e.exec(t)||["",""])[1].toLowerCase()]){t=Bt.htmlPrefilter(t);try{for(;i<n;i++)1===(e=this[i]||{}).nodeType&&(Bt.cleanData(Te(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)}),null,t,arguments.length)},replaceWith:function(){var t=[];return Ze(this,arguments,(function(e){var i=this.parentNode;Bt.inArray(this,t)<0&&(Bt.cleanData(Te(this)),i&&i.replaceChild(e,this))}),t)}}),Bt.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(t,e){Bt.fn[t]=function(t){for(var i,n=[],r=Bt(t),s=r.length-1,o=0;o<=s;o++)i=o===s?this:this.clone(!0),Bt(r[o])[e](i),xt.apply(n,i.get());return this.pushStack(n)}}));var Ye=new RegExp("^("+ge+")(?!px)[a-z%]+$","i"),Ke=function(t){var e=t.ownerDocument.defaultView;return e&&e.opener||(e=window),e.getComputedStyle(t)},Qe=new RegExp(be.join("|"),"i");function Je(t,e,i){var n,r,s,o,a=t.style;return(i=i||Ke(t))&&(""!==(o=i.getPropertyValue(e)||i[e])||Bt.contains(t.ownerDocument,t)||(o=Bt.style(t,e)),!At.pixelBoxStyles()&&Ye.test(o)&&Qe.test(e)&&(n=a.width,r=a.minWidth,s=a.maxWidth,a.minWidth=a.maxWidth=a.width=o,o=i.width,a.width=n,a.minWidth=r,a.maxWidth=s)),void 0!==o?o+"":o}function ti(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}!function(){function t(){if(h){a.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",h.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",Le.appendChild(a).appendChild(h);var t=window.getComputedStyle(h);i="1%"!==t.top,o=12===e(t.marginLeft),h.style.right="60%",s=36===e(t.right),n=36===e(t.width),h.style.position="absolute",r=36===h.offsetWidth||"absolute",Le.removeChild(a),h=null}}function e(t){return Math.round(parseFloat(t))}var i,n,r,s,o,a=bt.createElement("div"),h=bt.createElement("div");h.style&&(h.style.backgroundClip="content-box",h.cloneNode(!0).style.backgroundClip="",At.clearCloneStyle="content-box"===h.style.backgroundClip,Bt.extend(At,{boxSizingReliable:function(){return t(),n},pixelBoxStyles:function(){return t(),s},pixelPosition:function(){return t(),i},reliableMarginLeft:function(){return t(),o},scrollboxSize:function(){return t(),r}}))}();var ei,ii,ni=/^(none|table(?!-c[ea]).+)/,ri=/^--/,si={position:"absolute",visibility:"hidden",display:"block"},oi={letterSpacing:"0",fontWeight:"400"},ai=["Webkit","Moz","ms"],hi=bt.createElement("div").style;function li(t){var e=Bt.cssProps[t];return e||(e=Bt.cssProps[t]=function(t){if(t in hi)return t;for(var e=t[0].toUpperCase()+t.slice(1),i=ai.length;i--;)if((t=ai[i]+e)in hi)return t}(t)||t),e}function ci(t,e,i){var n=me.exec(e);return n?Math.max(0,n[2]-(i||0))+(n[3]||"px"):e}function ui(t,e,i,n,r,s){var o="width"===e?1:0,a=0,h=0;if(i===(n?"border":"content"))return 0;for(;o<4;o+=2)"margin"===i&&(h+=Bt.css(t,i+be[o],!0,r)),n?("content"===i&&(h-=Bt.css(t,"padding"+be[o],!0,r)),"margin"!==i&&(h-=Bt.css(t,"border"+be[o]+"Width",!0,r))):(h+=Bt.css(t,"padding"+be[o],!0,r),"padding"!==i?h+=Bt.css(t,"border"+be[o]+"Width",!0,r):a+=Bt.css(t,"border"+be[o]+"Width",!0,r));return!n&&s>=0&&(h+=Math.max(0,Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-s-h-a-.5))),h}function fi(t,e,i){var n=Ke(t),r=Je(t,e,n),s="border-box"===Bt.css(t,"boxSizing",!1,n),o=s;if(Ye.test(r)){if(!i)return r;r="auto"}return o=o&&(At.boxSizingReliable()||r===t.style[e]),("auto"===r||!parseFloat(r)&&"inline"===Bt.css(t,"display",!1,n))&&(r=t["offset"+e[0].toUpperCase()+e.slice(1)],o=!0),(r=parseFloat(r)||0)+ui(t,e,i||(s?"border":"content"),o,n,r)+"px"}Bt.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=Je(t,"opacity");return""===i?"1":i}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(t,e,i,n){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r,s,o,a=ae(e),h=ri.test(e),l=t.style;if(h||(e=li(a)),o=Bt.cssHooks[e]||Bt.cssHooks[a],void 0===i)return o&&"get"in o&&void 0!==(r=o.get(t,!1,n))?r:l[e];"string"===(s=typeof i)&&(r=me.exec(i))&&r[1]&&(i=function(t,e,i,n){var r,s,o=20,a=n?function(){return n.cur()}:function(){return Bt.css(t,e,"")},h=a(),l=i&&i[3]||(Bt.cssNumber[e]?"":"px"),c=(Bt.cssNumber[e]||"px"!==l&&+h)&&me.exec(Bt.css(t,e));if(c&&c[3]!==l){for(h/=2,l=l||c[3],c=+h||1;o--;)Bt.style(t,e,c+l),(1-s)*(1-(s=a()/h||.5))<=0&&(o=0),c/=s;c*=2,Bt.style(t,e,c+l),i=i||[]}return i&&(c=+c||+h||0,r=i[1]?c+(i[1]+1)*i[2]:+i[2],n&&(n.unit=l,n.start=c,n.end=r)),r}(t,e,r),s="number"),null!=i&&i==i&&("number"===s&&(i+=r&&r[3]||(Bt.cssNumber[a]?"":"px")),At.clearCloneStyle||""!==i||0!==e.indexOf("background")||(l[e]="inherit"),o&&"set"in o&&void 0===(i=o.set(t,i,n))||(h?l.setProperty(e,i):l[e]=i))}},css:function(t,e,i,n){var r,s,o,a=ae(e);return ri.test(e)||(e=li(a)),(o=Bt.cssHooks[e]||Bt.cssHooks[a])&&"get"in o&&(r=o.get(t,!0,i)),void 0===r&&(r=Je(t,e,n)),"normal"===r&&e in oi&&(r=oi[e]),""===i||i?(s=parseFloat(r),!0===i||isFinite(s)?s||0:r):r}}),Bt.each(["height","width"],(function(t,e){Bt.cssHooks[e]={get:function(t,i,n){if(i)return!ni.test(Bt.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?fi(t,e,n):ve(t,si,(function(){return fi(t,e,n)}))},set:function(t,i,n){var r,s=Ke(t),o="border-box"===Bt.css(t,"boxSizing",!1,s),a=n&&ui(t,e,n,o,s);return o&&At.scrollboxSize()===s.position&&(a-=Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-parseFloat(s[e])-ui(t,e,"border",!1,s)-.5)),a&&(r=me.exec(i))&&"px"!==(r[3]||"px")&&(t.style[e]=i,i=Bt.css(t,e)),ci(0,i,a)}}})),Bt.cssHooks.marginLeft=ti(At.reliableMarginLeft,(function(t,e){if(e)return(parseFloat(Je(t,"marginLeft"))||t.getBoundingClientRect().left-ve(t,{marginLeft:0},(function(){return t.getBoundingClientRect().left})))+"px"})),Bt.each({margin:"",padding:"",border:"Width"},(function(t,e){Bt.cssHooks[t+e]={expand:function(i){for(var n=0,r={},s="string"==typeof i?i.split(" "):[i];n<4;n++)r[t+be[n]+e]=s[n]||s[n-2]||s[0];return r}},"margin"!==t&&(Bt.cssHooks[t+e].set=ci)})),Bt.fn.extend({css:function(t,e){return ne(this,(function(t,e,i){var n,r,s={},o=0;if(Array.isArray(e)){for(n=Ke(t),r=e.length;o<r;o++)s[e[o]]=Bt.css(t,e[o],!1,n);return s}return void 0!==i?Bt.style(t,e,i):Bt.css(t,e)}),t,e,arguments.length>1)}}),Bt.fn.delay=function(t,e){return t=Bt.fx&&Bt.fx.speeds[t]||t,e=e||"fx",this.queue(e,(function(e,i){var n=window.setTimeout(e,t);i.stop=function(){window.clearTimeout(n)}}))},ei=bt.createElement("input"),ii=bt.createElement("select").appendChild(bt.createElement("option")),ei.type="checkbox",At.checkOn=""!==ei.value,At.optSelected=ii.selected,(ei=bt.createElement("input")).value="t",ei.type="radio",At.radioValue="t"===ei.value;var di,pi=Bt.expr.attrHandle;Bt.fn.extend({attr:function(t,e){return ne(this,Bt.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each((function(){Bt.removeAttr(this,t)}))}}),Bt.extend({attr:function(t,e,i){var n,r,s=t.nodeType;if(3!==s&&8!==s&&2!==s)return void 0===t.getAttribute?Bt.prop(t,e,i):(1===s&&Bt.isXMLDoc(t)||(r=Bt.attrHooks[e.toLowerCase()]||(Bt.expr.match.bool.test(e)?di:void 0)),void 0!==i?null===i?void Bt.removeAttr(t,e):r&&"set"in r&&void 0!==(n=r.set(t,i,e))?n:(t.setAttribute(e,i+""),i):r&&"get"in r&&null!==(n=r.get(t,e))?n:null==(n=Bt.find.attr(t,e))?void 0:n)},attrHooks:{type:{set:function(t,e){if(!At.radioValue&&"radio"===e&&$t(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}},removeAttr:function(t,e){var i,n=0,r=e&&e.match(Yt);if(r&&1===t.nodeType)for(;i=r[n++];)t.removeAttribute(i)}}),di={set:function(t,e,i){return!1===e?Bt.removeAttr(t,i):t.setAttribute(i,i),i}},Bt.each(Bt.expr.match.bool.source.match(/\w+/g),(function(t,e){var i=pi[e]||Bt.find.attr;pi[e]=function(t,e,n){var r,s,o=e.toLowerCase();return n||(s=pi[o],pi[o]=r,r=null!=i(t,e,n)?o:null,pi[o]=s),r}}));var gi=/^(?:input|select|textarea|button)$/i,mi=/^(?:a|area)$/i;function bi(t){return(t.match(Yt)||[]).join(" ")}function wi(t){return t.getAttribute&&t.getAttribute("class")||""}function vi(t){return Array.isArray(t)?t:"string"==typeof t&&t.match(Yt)||[]}Bt.fn.extend({prop:function(t,e){return ne(this,Bt.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each((function(){delete this[Bt.propFix[t]||t]}))}}),Bt.extend({prop:function(t,e,i){var n,r,s=t.nodeType;if(3!==s&&8!==s&&2!==s)return 1===s&&Bt.isXMLDoc(t)||(e=Bt.propFix[e]||e,r=Bt.propHooks[e]),void 0!==i?r&&"set"in r&&void 0!==(n=r.set(t,i,e))?n:t[e]=i:r&&"get"in r&&null!==(n=r.get(t,e))?n:t[e]},propHooks:{tabIndex:{get:function(t){var e=Bt.find.attr(t,"tabindex");return e?parseInt(e,10):gi.test(t.nodeName)||mi.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),At.optSelected||(Bt.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),Bt.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){Bt.propFix[this.toLowerCase()]=this})),Bt.fn.extend({addClass:function(t){var e,i,n,r,s,o,a,h=0;if(Rt(t))return this.each((function(e){Bt(this).addClass(t.call(this,e,wi(this)))}));if((e=vi(t)).length)for(;i=this[h++];)if(r=wi(i),n=1===i.nodeType&&" "+bi(r)+" "){for(o=0;s=e[o++];)n.indexOf(" "+s+" ")<0&&(n+=s+" ");r!==(a=bi(n))&&i.setAttribute("class",a)}return this},removeClass:function(t){var e,i,n,r,s,o,a,h=0;if(Rt(t))return this.each((function(e){Bt(this).removeClass(t.call(this,e,wi(this)))}));if(!arguments.length)return this.attr("class","");if((e=vi(t)).length)for(;i=this[h++];)if(r=wi(i),n=1===i.nodeType&&" "+bi(r)+" "){for(o=0;s=e[o++];)for(;n.indexOf(" "+s+" ")>-1;)n=n.replace(" "+s+" "," ");r!==(a=bi(n))&&i.setAttribute("class",a)}return this},toggleClass:function(t,e){var i=typeof t,n="string"===i||Array.isArray(t);return"boolean"==typeof e&&n?e?this.addClass(t):this.removeClass(t):Rt(t)?this.each((function(i){Bt(this).toggleClass(t.call(this,i,wi(this),e),e)})):this.each((function(){var e,r,s,o;if(n)for(r=0,s=Bt(this),o=vi(t);e=o[r++];)s.hasClass(e)?s.removeClass(e):s.addClass(e);else void 0!==t&&"boolean"!==i||((e=wi(this))&&ce.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===t?"":ce.get(this,"__className__")||""))}))},hasClass:function(t){var e,i,n=0;for(e=" "+t+" ";i=this[n++];)if(1===i.nodeType&&(" "+bi(wi(i))+" ").indexOf(e)>-1)return!0;return!1}});var yi=/\r/g;Bt.fn.extend({val:function(t){var e,i,n,r=this[0];return arguments.length?(n=Rt(t),this.each((function(i){var r;1===this.nodeType&&(null==(r=n?t.call(this,i,Bt(this).val()):t)?r="":"number"==typeof r?r+="":Array.isArray(r)&&(r=Bt.map(r,(function(t){return null==t?"":t+""}))),(e=Bt.valHooks[this.type]||Bt.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,r,"value")||(this.value=r))}))):r?(e=Bt.valHooks[r.type]||Bt.valHooks[r.nodeName.toLowerCase()])&&"get"in e&&void 0!==(i=e.get(r,"value"))?i:"string"==typeof(i=r.value)?i.replace(yi,""):null==i?"":i:void 0}}),Bt.extend({valHooks:{option:{get:function(t){var e=Bt.find.attr(t,"value");return null!=e?e:bi(Bt.text(t))}},select:{get:function(t){var e,i,n,r=t.options,s=t.selectedIndex,o="select-one"===t.type,a=o?null:[],h=o?s+1:r.length;for(n=s<0?h:o?s:0;n<h;n++)if(((i=r[n]).selected||n===s)&&!i.disabled&&(!i.parentNode.disabled||!$t(i.parentNode,"optgroup"))){if(e=Bt(i).val(),o)return e;a.push(e)}return a},set:function(t,e){for(var i,n,r=t.options,s=Bt.makeArray(e),o=r.length;o--;)((n=r[o]).selected=Bt.inArray(Bt.valHooks.option.get(n),s)>-1)&&(i=!0);return i||(t.selectedIndex=-1),s}}}}),Bt.each(["radio","checkbox"],(function(){Bt.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=Bt.inArray(Bt(t).val(),e)>-1}},At.checkOn||(Bt.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})})),At.focusin="onfocusin"in window;var xi=/^(?:focusinfocus|focusoutblur)$/,ki=function(t){t.stopPropagation()};Bt.extend(Bt.event,{trigger:function(t,e,i,n){var r,s,o,a,h,l,c,u,f=[i||bt],d=Ct.call(t,"type")?t.type:t,p=Ct.call(t,"namespace")?t.namespace.split("."):[];if(s=u=o=i=i||bt,3!==i.nodeType&&8!==i.nodeType&&!xi.test(d+Bt.event.triggered)&&(d.indexOf(".")>-1&&(p=d.split("."),d=p.shift(),p.sort()),h=d.indexOf(":")<0&&"on"+d,(t=t[Bt.expando]?t:new Bt.Event(d,"object"==typeof t&&t)).isTrigger=n?2:3,t.namespace=p.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),e=null==e?[t]:Bt.makeArray(e,[t]),c=Bt.event.special[d]||{},n||!c.trigger||!1!==c.trigger.apply(i,e))){if(!n&&!c.noBubble&&!It(i)){for(a=c.delegateType||d,xi.test(a+d)||(s=s.parentNode);s;s=s.parentNode)f.push(s),o=s;o===(i.ownerDocument||bt)&&f.push(o.defaultView||o.parentWindow||window)}for(r=0;(s=f[r++])&&!t.isPropagationStopped();)u=s,t.type=r>1?a:c.bindType||d,(l=(ce.get(s,"events")||{})[t.type]&&ce.get(s,"handle"))&&l.apply(s,e),(l=h&&s[h])&&l.apply&&he(s)&&(t.result=l.apply(s,e),!1===t.result&&t.preventDefault());return t.type=d,n||t.isDefaultPrevented()||c._default&&!1!==c._default.apply(f.pop(),e)||!he(i)||h&&Rt(i[d])&&!It(i)&&((o=i[h])&&(i[h]=null),Bt.event.triggered=d,t.isPropagationStopped()&&u.addEventListener(d,ki),i[d](),t.isPropagationStopped()&&u.removeEventListener(d,ki),Bt.event.triggered=void 0,o&&(i[h]=o)),t.result}},simulate:function(t,e,i){var n=Bt.extend(new Bt.Event,i,{type:t,isSimulated:!0});Bt.event.trigger(n,null,e)}}),Bt.fn.extend({trigger:function(t,e){return this.each((function(){Bt.event.trigger(t,e,this)}))},triggerHandler:function(t,e){var i=this[0];if(i)return Bt.event.trigger(t,e,i,!0)}}),At.focusin||Bt.each({focus:"focusin",blur:"focusout"},(function(t,e){var i=function(t){Bt.event.simulate(e,t.target,Bt.event.fix(t))};Bt.event.special[e]={setup:function(){var n=this.ownerDocument||this,r=ce.access(n,e);r||n.addEventListener(t,i,!0),ce.access(n,e,(r||0)+1)},teardown:function(){var n=this.ownerDocument||this,r=ce.access(n,e)-1;r?ce.access(n,e,r):(n.removeEventListener(t,i,!0),ce.remove(n,e))}}}));var Si,_i=/\[\]$/,Ci=/\r?\n/g,Ei=/^(?:submit|button|image|reset|file)$/i,Ti=/^(?:input|select|textarea|keygen)/i;function Ai(t,e,i,n){var r;if(Array.isArray(e))Bt.each(e,(function(e,r){i||_i.test(t)?n(t,r):Ai(t+"["+("object"==typeof r&&null!=r?e:"")+"]",r,i,n)}));else if(i||"object"!==Ft(e))n(t,e);else for(r in e)Ai(t+"["+r+"]",e[r],i,n)}Bt.param=function(t,e){var i,n=[],r=function(t,e){var i=Rt(e)?e():e;n[n.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==i?"":i)};if(Array.isArray(t)||t.jquery&&!Bt.isPlainObject(t))Bt.each(t,(function(){r(this.name,this.value)}));else for(i in t)Ai(i,t[i],e,r);return n.join("&")},Bt.fn.extend({serialize:function(){return Bt.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var t=Bt.prop(this,"elements");return t?Bt.makeArray(t):this})).filter((function(){var t=this.type;return this.name&&!Bt(this).is(":disabled")&&Ti.test(this.nodeName)&&!Ei.test(t)&&(this.checked||!Se.test(t))})).map((function(t,e){var i=Bt(this).val();return null==i?null:Array.isArray(i)?Bt.map(i,(function(t){return{name:e.name,value:t.replace(Ci,"\r\n")}})):{name:e.name,value:i.replace(Ci,"\r\n")}})).get()}}),Bt.fn.extend({wrapAll:function(t){var e;return this[0]&&(Rt(t)&&(t=t.call(this[0])),e=Bt(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map((function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t})).append(this)),this},wrapInner:function(t){return Rt(t)?this.each((function(e){Bt(this).wrapInner(t.call(this,e))})):this.each((function(){var e=Bt(this),i=e.contents();i.length?i.wrapAll(t):e.append(t)}))},wrap:function(t){var e=Rt(t);return this.each((function(i){Bt(this).wrapAll(e?t.call(this,i):t)}))},unwrap:function(t){return this.parent(t).not("body").each((function(){Bt(this).replaceWith(this.childNodes)})),this}}),Bt.expr.pseudos.hidden=function(t){return!Bt.expr.pseudos.visible(t)},Bt.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},At.createHTMLDocument=((Si=bt.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Si.childNodes.length),Bt.parseHTML=function(t,e,i){return"string"!=typeof t?[]:("boolean"==typeof e&&(i=e,e=!1),e||(At.createHTMLDocument?((n=(e=bt.implementation.createHTMLDocument("")).createElement("base")).href=bt.location.href,e.head.appendChild(n)):e=bt),s=!i&&[],(r=qt.exec(t))?[e.createElement(r[1])]:(r=Ie([t],e,s),s&&s.length&&Bt(s).remove(),Bt.merge([],r.childNodes)));var n,r,s},Bt.offset={setOffset:function(t,e,i){var n,r,s,o,a,h,l=Bt.css(t,"position"),c=Bt(t),u={};"static"===l&&(t.style.position="relative"),a=c.offset(),s=Bt.css(t,"top"),h=Bt.css(t,"left"),("absolute"===l||"fixed"===l)&&(s+h).indexOf("auto")>-1?(o=(n=c.position()).top,r=n.left):(o=parseFloat(s)||0,r=parseFloat(h)||0),Rt(e)&&(e=e.call(t,i,Bt.extend({},a))),null!=e.top&&(u.top=e.top-a.top+o),null!=e.left&&(u.left=e.left-a.left+r),"using"in e?e.using.call(t,u):c.css(u)}},Bt.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each((function(e){Bt.offset.setOffset(this,t,e)}));var e,i,n=this[0];return n?n.getClientRects().length?(e=n.getBoundingClientRect(),i=n.ownerDocument.defaultView,{top:e.top+i.pageYOffset,left:e.left+i.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var t,e,i,n=this[0],r={top:0,left:0};if("fixed"===Bt.css(n,"position"))e=n.getBoundingClientRect();else{for(e=this.offset(),i=n.ownerDocument,t=n.offsetParent||i.documentElement;t&&(t===i.body||t===i.documentElement)&&"static"===Bt.css(t,"position");)t=t.parentNode;t&&t!==n&&1===t.nodeType&&((r=Bt(t).offset()).top+=Bt.css(t,"borderTopWidth",!0),r.left+=Bt.css(t,"borderLeftWidth",!0))}return{top:e.top-r.top-Bt.css(n,"marginTop",!0),left:e.left-r.left-Bt.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var t=this.offsetParent;t&&"static"===Bt.css(t,"position");)t=t.offsetParent;return t||Le}))}}),Bt.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(t,e){var i="pageYOffset"===e;Bt.fn[t]=function(n){return ne(this,(function(t,n,r){var s;if(It(t)?s=t:9===t.nodeType&&(s=t.defaultView),void 0===r)return s?s[e]:t[n];s?s.scrollTo(i?s.pageXOffset:r,i?r:s.pageYOffset):t[n]=r}),t,n,arguments.length)}})),Bt.each(["top","left"],(function(t,e){Bt.cssHooks[e]=ti(At.pixelPosition,(function(t,i){if(i)return i=Je(t,e),Ye.test(i)?Bt(t).position()[e]+"px":i}))})),Bt.each({Height:"height",Width:"width"},(function(t,e){Bt.each({padding:"inner"+t,content:e,"":"outer"+t},(function(i,n){Bt.fn[n]=function(r,s){var o=arguments.length&&(i||"boolean"!=typeof r),a=i||(!0===r||!0===s?"margin":"border");return ne(this,(function(e,i,r){var s;return It(e)?0===n.indexOf("outer")?e["inner"+t]:e.document.documentElement["client"+t]:9===e.nodeType?(s=e.documentElement,Math.max(e.body["scroll"+t],s["scroll"+t],e.body["offset"+t],s["offset"+t],s["client"+t])):void 0===r?Bt.css(e,i,a):Bt.style(e,i,r,a)}),e,o?r:void 0,o)}}))})),Bt.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(t,e){Bt.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}})),Bt.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),Bt.fn.extend({bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,n){return this.on(e,t,i,n)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)}}),Bt.proxy=function(t,e){var i,n,r;if("string"==typeof e&&(i=t[e],e=t,t=i),Rt(t))return n=vt.call(arguments,2),(r=function(){return t.apply(e||this,n.concat(vt.call(arguments)))}).guid=t.guid=t.guid||Bt.guid++,r},Bt.holdReady=function(t){t?Bt.readyWait++:Bt.ready(!0)},Bt.isArray=Array.isArray,Bt.parseJSON=JSON.parse,Bt.nodeName=$t,Bt.isFunction=Rt,Bt.isWindow=It,Bt.camelCase=ae,Bt.type=Ft,Bt.now=Date.now,Bt.isNumeric=function(t){var e=Bt.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))};const Ri=Bt,Ii={setProperties:function(t,e){for(var i in e)if(e.hasOwnProperty(i)){var n=e[i];t[i]=n}},strokeLine:function(t,e,i,n,r,s){e=Math.floor(e)+.5,i=Math.floor(i)+.5,n=Math.floor(n)+.5,r=Math.floor(r)+.5,s&&(t.save(),Ii.setProperties(t,s)),t.beginPath(),t.moveTo(e,i),t.lineTo(n,r),t.stroke(),s&&t.restore()},fillRect:function(t,e,i,n,r,s){e=Math.round(e),i=Math.round(i),s&&(t.save(),Ii.setProperties(t,s)),t.fillRect(e,i,n,r),s&&t.restore()},fillPolygon:function(t,e,i,n){n&&(t.save(),Ii.setProperties(t,n)),Li(t,e,i),t.fill(),n&&t.restore()},strokePolygon:function(t,e,i,n){n&&(t.save(),Ii.setProperties(t,n)),Li(t,e,i),t.stroke(),n&&t.restore()},fillText:function(t,e,i,n,r,s){if((r||s)&&t.save(),r&&Ii.setProperties(t,r),s){for(var o in t.translate(i,n),s){var a=s[o];"translate"===o&&t.translate(a.x,a.y),"rotate"===o&&t.rotate(a.angle*Math.PI/180)}t.fillText(e,0,0)}else t.fillText(e,i,n);(r||s)&&t.restore()},strokeText:function(t,e,i,n,r,s){if((r||s)&&t.save(),r&&Ii.setProperties(t,r),s){for(var o in t.translate(i,n),s){var a=s[o];"translate"===o&&t.translate(a.x,a.y),"rotate"===o&&t.rotate(a.angle*Math.PI/180)}t.strokeText(e,0,0)}else t.strokeText(e,i,n);(r||s)&&t.restore()},strokeCircle:function(t,e,i,n,r){r&&(t.save(),Ii.setProperties(t,r)),t.beginPath(),t.arc(e,i,n,0,2*Math.PI),t.stroke(),r&&t.restore()},fillCircle:function(t,e,i,n,r){r&&(t.save(),Ii.setProperties(t,r)),t.beginPath(),t.arc(e,i,n,0,2*Math.PI),t.fill(),r&&t.restore()},drawArrowhead:function(t,e,i,n,r){t.save(),n||(n=5),r&&(t.lineWidth=r),t.beginPath(),t.moveTo(e,i-n/2),t.lineTo(e,i+n/2),t.lineTo(e+n,i),t.lineTo(e,i-n/2),t.closePath(),t.fill(),t.restore()},dashedLine:function(t,e,i,n,r,s,o={}){void 0===s&&(s=2),t.setLineDash([s,s]),Ii.strokeLine(t,e,i,n,r,o),t.setLineDash([])},roundRect:function(t,e,i,n,r,s,o,a){void 0===a&&(a=!0),void 0===s&&(s=5),t.beginPath(),t.moveTo(e+s,i),t.lineTo(e+n-s,i),t.quadraticCurveTo(e+n,i,e+n,i+s),t.lineTo(e+n,i+r-s),t.quadraticCurveTo(e+n,i+r,e+n-s,i+r),t.lineTo(e+s,i+r),t.quadraticCurveTo(e,i+r,e,i+r-s),t.lineTo(e,i+s),t.quadraticCurveTo(e,i,e+s,i),t.closePath(),a&&t.stroke(),o&&t.fill()},polygon:function(t,e,i,n,r){void 0===r&&(r=!0),t.beginPath();var s=e.length;t.moveTo(e[0],i[0]);for(var o=1;o<s;o++)t.lineTo(e[o],i[o]);t.closePath(),r&&t.stroke(),n&&t.fill()}};function Li(t,e,i){var n,r=e.length;for(n=0;n<r;n++)e[n]=Math.round(e[n]),i[n]=Math.round(i[n]);for(t.beginPath(),t.moveTo(e[0],i[0]),n=1;n<r;n++)t.lineTo(e[n],i[n]);t.closePath()}class Mi{constructor(t,e,i,n){this.guid=I(),this.trackView=t,this.referenceFrame=i,this.browser=t.browser,this.$viewport=Ri('<div class="igv-viewport">'),e.append(this.$viewport),this.$viewport.data("viewportGUID",this.guid),this.$content=Ri("<div>",{class:"igv-viewport-content"}),this.$viewport.append(this.$content),this.$content.height(this.$viewport.height()),this.contentDiv=this.$content.get(0),this.$canvas=Ri('<canvas class ="igv-canvas">'),this.$content.append(this.$canvas),this.canvas=this.$canvas.get(0),this.ctx=this.canvas.getContext("2d"),this.setWidth(n),this.initializationHelper()}initializationHelper(){}setTrackLabel(t){}startSpinner(){}stopSpinner(){}checkZoomIn(){return!0}showMessage(t){this.messageDiv||(this.messageDiv=document.createElement("div"),this.messageDiv.className="igv-viewport-message",this.contentDiv.append(this.messageDiv)),this.messageDiv.textContent=t,this.messageDiv.style.display="inline-block"}hideMessage(t){this.messageDiv&&(this.messageDiv.style.display="none")}async renderSVGContext(t,e){if(this.$zoomInNotice&&this.$zoomInNotice.is(":visible"))return;let i=this.trackView.track.name||this.trackView.track.id;i=i.replace(/\W/g,"");const n=this.browser.referenceFrameList.indexOf(this.referenceFrame),r=i.toLowerCase()+"_genomic_state_index_"+n;if(0===n&&"function"==typeof this.trackView.track.paintAxis){const i=this.trackView.controlCanvas.getBoundingClientRect();t.addTrackGroupWithTranslationAndClipRect(r+"_axis",e.deltaX-i.width,e.deltaY,i.width,i.height,0),t.save(),this.trackView.track.paintAxis(t,i.width,i.height),t.restore()}const s=Ri(this.contentDiv).position().top,o=e.deltaX+n*t.multiLocusGap,a=e.deltaY+s,{width:h,height:l}=this.$viewport.get(0).getBoundingClientRect();t.addTrackGroupWithTranslationAndClipRect(r,o,a,h,l,-s),this.drawSVGWithContect(t,h,l)}drawSVGWithContect(t){}saveSVG(){}isVisible(){return this.$viewport.width()}setWidth(t){this.$viewport.width(t),this.canvas.style.width=`${t}px`,this.canvas.setAttribute("width",t)}getWidth(){return this.$viewport.width()}shift(){}setTop(t){}async loadFeatures(){}setContentHeight(t){}isLoading(){return!1}getContentHeight(){return this.$content.height()}getContentTop(){return this.contentDiv.offsetTop}containsPosition(t,e){return this.referenceFrame.chr===t&&e>=this.referenceFrame.start&&e<=this.referenceFrame.calculateEnd(this.getWidth())}dispose(){this.popover&&this.popover.dispose(),this.$canvas.off(),this.$canvas.empty(),this.$content.off(),this.$content.empty(),this.$viewport.off(),this.$viewport.empty();for(let t of Object.keys(this))this[t]=void 0}}
/*!!
 *  Canvas 2 Svg v1.0.19
 *  A low level canvas to SVG converter. Uses a mock canvas context to build an SVG document.
 *
 *  Licensed under the MIT license:
 *  http://www.opensource.org/licenses/mit-license.php
 *
 *  Author:
 *  Kerry Liu
 *
 *  Copyright (c) 2014 Gliffy Inc.
 */var Fi,Di,Bi,Ni,Pi;function Oi(t,e){var i,n=Object.keys(e);for(i=0;i<n.length;i++)t=t.replace(new RegExp("\\{"+n[i]+"\\}","gi"),e[n[i]]);return t}function zi(t){var e,i,n;if(!t)throw new Error("cannot create a random attribute name for an undefined object");e="ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",i="";do{for(i="",n=0;n<12;n++)i+=e[Math.floor(Math.random()*e.length)]}while(t[i]);return i}function Hi(t){var e={alphabetic:"alphabetic",hanging:"hanging",top:"text-before-edge",bottom:"text-after-edge",middle:"central"};return e[t]||e.alphabetic}Pi=function(t,e){var i,n,r,s={};for(t=t.split(","),e=e||10,i=0;i<t.length;i+=2)n="&"+t[i+1]+";",r=parseInt(t[i],e),s[n]="&#"+r+";";return s["\\xa0"]="&#160;",s}("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),Fi={strokeStyle:{svgAttr:"stroke",canvas:"#000000",svg:"none",apply:"stroke"},fillStyle:{svgAttr:"fill",canvas:"#000000",svg:null,apply:"fill"},lineCap:{svgAttr:"stroke-linecap",canvas:"butt",svg:"butt",apply:"stroke"},lineJoin:{svgAttr:"stroke-linejoin",canvas:"miter",svg:"miter",apply:"stroke"},miterLimit:{svgAttr:"stroke-miterlimit",canvas:10,svg:4,apply:"stroke"},lineWidth:{svgAttr:"stroke-width",canvas:1,svg:1,apply:"stroke"},globalAlpha:{svgAttr:"opacity",canvas:1,svg:1,apply:"fill stroke"},font:{canvas:"10px sans-serif"},shadowColor:{canvas:"#000000"},shadowOffsetX:{canvas:0},shadowOffsetY:{canvas:0},shadowBlur:{canvas:0},textAlign:{canvas:"start"},textBaseline:{canvas:"alphabetic"},lineDash:{svgAttr:"stroke-dasharray",canvas:[],svg:null,apply:"stroke"}},(Bi=function(t,e){this.__root=t,this.__ctx=e}).prototype.addColorStop=function(t,e){var i,n=this.__ctx.__createElement("stop");n.setAttribute("offset",t),e&&-1!==e.indexOf("rgba")?(i=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi.exec(e),n.setAttribute("stop-color",Oi("rgb({r},{g},{b})",{r:i[1],g:i[2],b:i[3]})),n.setAttribute("stop-opacity",i[4])):n.setAttribute("stop-color",e),this.__root.appendChild(n)},Ni=function(t,e){this.__root=t,this.__ctx=e},(Di=function(t){if(!(this instanceof Di))return new Di(t);if(this.config=t,this.width=t.width,this.height=t.height,this.enableMirroring=t.enableMirroring||!1,this.canvas=this,this.__document=document,t.ctx?this.__ctx=t.ctx:(this.__canvas=this.__document.createElement("canvas"),this.__ctx=this.__canvas.getContext("2d")),this.isSVG=!0,this.__setDefaultStyles(),this.__stack=[this.__getStyleState()],this.__groupStack=[],this.__root=this.__createElement("svg"),this.__root.setAttribute("width",this.width),this.__root.setAttribute("height",this.height),this.__root.setAttribute("overflow","visible"),t.viewbox){const e=t.viewbox.x+" "+t.viewbox.y+" "+t.viewbox.width+" "+t.viewbox.height;this.__root.setAttribute("viewBox",e),this.viewbox=t.viewbox}this.__ids={},this.__defs=this.__createElement("defs"),this.__root.appendChild(this.__defs),this.multiLocusGap=t.multiLocusGap;let e={id:"svg_output_backdrop",width:"100%",height:"100%",fill:t.backdropColor||"white"},i=this.__createElement("rect",e);this.__root.appendChild(i),this.__rootGroup=this.__createElement("g",{id:"root-group"}),this.__root.appendChild(this.__rootGroup),this.__currentElement=this.__rootGroup}).prototype.setWidth=function(t){this.width=t,this.__root.setAttribute("width",this.width);const e=this.config.viewbox.x+" "+this.config.viewbox.y+" "+t+" "+this.config.viewbox.height;this.__root.setAttribute("viewBox",e)},Di.prototype.setHeight=function(t){this.height=t,this.__root.setAttribute("height",this.height);const e=this.config.viewbox.x+" "+this.config.viewbox.y+" "+this.config.viewbox.width+" "+t;this.__root.setAttribute("viewBox",e)},Di.prototype.__createElement=function(t,e,i){void 0===e&&(e={});let n=this.__document.createElementNS("http://www.w3.org/2000/svg",t);i&&(n.setAttribute("fill","none"),n.setAttribute("stroke","none"));for(let t of Object.keys(e))n.setAttribute(t,e[t]);return n},Di.prototype.__setDefaultStyles=function(){var t,e,i=Object.keys(Fi);for(t=0;t<i.length;t++)this[e=i[t]]=Fi[e].canvas},Di.prototype.__applyStyleState=function(t){var e,i,n=Object.keys(t);for(e=0;e<n.length;e++)this[i=n[e]]=t[i]},Di.prototype.__getStyleState=function(){var t,e,i={},n=Object.keys(Fi);for(t=0;t<n.length;t++)i[e=n[t]]=this[e];return i},Di.prototype.__applyStyleToCurrentElement=function(t){var e=this.__currentElement,i=this.__currentElementsToStyle;i&&(e.setAttribute(t,""),e=i.element,i.children.forEach((function(e){e.setAttribute(t,"")})));var n,r,s,o,a,h=Object.keys(Fi);for(n=0;n<h.length;n++)if(r=Fi[h[n]],s=this[h[n]],r.apply)if(s instanceof Ni){if(s.__ctx)for(;s.__ctx.__defs.childNodes.length;)o=s.__ctx.__defs.childNodes[0].getAttribute("id"),this.__ids[o]=o,this.__defs.appendChild(s.__ctx.__defs.childNodes[0]);e.setAttribute(r.apply,Oi("url(#{id})",{id:s.__root.getAttribute("id")}))}else if(s instanceof Bi)e.setAttribute(r.apply,Oi("url(#{id})",{id:s.__root.getAttribute("id")}));else if(r&&-1!==r.apply.indexOf(t)&&r.svg!==s)if("stroke"!==r.svgAttr&&"fill"!==r.svgAttr||!s||-1===s.indexOf("rgba")){var l=r.svgAttr;if("globalAlpha"===h[n]&&(l=t+"-"+r.svgAttr,e.getAttribute(l)))continue;e.setAttribute(l,s)}else{a=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi.exec(s),e.setAttribute(r.svgAttr,Oi("rgb({r},{g},{b})",{r:a[1],g:a[2],b:a[3]}));var c=a[4],u=this.globalAlpha;null!=u&&(c*=u),e.setAttribute(r.svgAttr+"-opacity",c)}},Di.prototype.__closestGroupOrSvg=function(t){return"g"===(t=t||this.__currentElement).nodeName||"svg"===t.nodeName?t:this.__closestGroupOrSvg(t.parentNode)},Di.prototype.getSerializedSvg=function(t){var e,i,n,r,s,o=(new XMLSerializer).serializeToString(this.__root);if(t)for(e=Object.keys(Pi),i=0;i<e.length;i++)n=e[i],r=Pi[n],(s=new RegExp(n,"gi")).test(o)&&(o=o.replace(s,r));return o},Di.prototype.getSvg=function(){return this.__root},Di.prototype.save=function(){var t=this.__createElement("g"),e=this.__closestGroupOrSvg();this.__groupStack.push(e),e.appendChild(t),this.__currentElement=t,this.__stack.push(this.__getStyleState())},Di.prototype.restore=function(){this.__currentElement=this.__groupStack.pop(),this.__currentElementsToStyle=null,this.__currentElement||(this.__currentElement=this.__root.childNodes[1]);var t=this.__stack.pop();this.__applyStyleState(t)},Di.prototype.__addTransform=function(t){var e=this.__closestGroupOrSvg();if(e.childNodes.length>0){"path"===this.__currentElement.nodeName&&(this.__currentElementsToStyle||(this.__currentElementsToStyle={element:e,children:[]}),this.__currentElementsToStyle.children.push(this.__currentElement),this.__applyCurrentDefaultPath());var i=this.__createElement("g");e.appendChild(i),this.__currentElement=i}var n=this.__currentElement.getAttribute("transform");n?n+=" ":n="",n+=t,this.__currentElement.setAttribute("transform",n)},Di.prototype.addTrackGroupWithTranslationAndClipRect=function(t,e,i,n,r,s){const o=t+"_clip_rect";let a=this.__createElement("clipPath",{id:o});this.__defs.appendChild(a),a.appendChild(this.__createElement("rect",{x:"0",y:s.toString(),width:n.toString(),height:r.toString()}));let h=this.__createElement("g");this.__rootGroup.appendChild(h),h.setAttribute("transform",Oi("translate({x},{y})",{x:e,y:i})),h.setAttribute("id",t+"_group"),h.setAttribute("clip-path",Oi("url(#{id})",{id:o})),this.__currentElement=h},Di.prototype.scale=function(t,e){void 0===e&&(e=t),this.__addTransform(Oi("scale({x},{y})",{x:t,y:e}))},Di.prototype.rotate=function(t){var e=180*t/Math.PI;this.__addTransform(Oi("rotate({angle},{cx},{cy})",{angle:e,cx:0,cy:0}))},Di.prototype.translate=function(t,e){this.__addTransform(Oi("translate({x},{y})",{x:t,y:e}))},Di.prototype.transform=function(t,e,i,n,r,s){this.__addTransform(Oi("matrix({a},{b},{c},{d},{e},{f})",{a:t,b:e,c:i,d:n,e:r,f:s}))},Di.prototype.beginPath=function(){var t;this.__currentDefaultPath="",this.__currentPosition={},t=this.__createElement("path",{},!0),this.__closestGroupOrSvg().appendChild(t),this.__currentElement=t},Di.prototype.__applyCurrentDefaultPath=function(){var t=this.__currentElement;"path"===t.nodeName?t.setAttribute("d",this.__currentDefaultPath):console.error("Attempted to apply path command to node",t.nodeName)},Di.prototype.__addPathCommand=function(t){this.__currentDefaultPath+=" ",this.__currentDefaultPath+=t},Di.prototype.moveTo=function(t,e){"path"!==this.__currentElement.nodeName&&this.beginPath(),this.__currentPosition={x:t,y:e},this.__addPathCommand(Oi("M {x} {y}",{x:t,y:e}))},Di.prototype.closePath=function(){this.__currentDefaultPath&&this.__addPathCommand("Z")},Di.prototype.lineTo=function(t,e){this.__currentPosition={x:t,y:e},this.__currentDefaultPath&&this.__currentDefaultPath.indexOf("M")>-1?this.__addPathCommand(Oi("L {x} {y}",{x:t,y:e})):this.__addPathCommand(Oi("M {x} {y}",{x:t,y:e}))},Di.prototype.bezierCurveTo=function(t,e,i,n,r,s){this.__currentPosition={x:r,y:s},this.__addPathCommand(Oi("C {cp1x} {cp1y} {cp2x} {cp2y} {x} {y}",{cp1x:t,cp1y:e,cp2x:i,cp2y:n,x:r,y:s}))},Di.prototype.quadraticCurveTo=function(t,e,i,n){this.__currentPosition={x:i,y:n},this.__addPathCommand(Oi("Q {cpx} {cpy} {x} {y}",{cpx:t,cpy:e,x:i,y:n}))};var Ui=function(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]);return[t[0]/e,t[1]/e]};Di.prototype.arcTo=function(t,e,i,n,r){var s=this.__currentPosition&&this.__currentPosition.x,o=this.__currentPosition&&this.__currentPosition.y;if(void 0!==s&&void 0!==o){if(r<0)throw new Error("IndexSizeError: The radius provided ("+r+") is negative.");if(s===t&&o===e||t===i&&e===n||0===r)this.lineTo(t,e);else{var a=Ui([s-t,o-e]),h=Ui([i-t,n-e]);if(a[0]*h[1]!=a[1]*h[0]){var l=a[0]*h[0]+a[1]*h[1],c=Math.acos(Math.abs(l)),u=Ui([a[0]+h[0],a[1]+h[1]]),f=r/Math.sin(c/2),d=t+f*u[0],p=e+f*u[1],g=[-a[1],a[0]],m=[h[1],-h[0]],b=function(t){var e=t[0];return t[1]>=0?Math.acos(e):-Math.acos(e)},w=b(g),v=b(m);this.lineTo(d+g[0]*r,p+g[1]*r),this.arc(d,p,r,w,v)}else this.lineTo(t,e)}}},Di.prototype.stroke=function(){"path"===this.__currentElement.nodeName&&this.__currentElement.setAttribute("paint-order","fill stroke markers"),this.__applyCurrentDefaultPath(),this.__applyStyleToCurrentElement("stroke")},Di.prototype.fill=function(){"path"===this.__currentElement.nodeName&&this.__currentElement.setAttribute("paint-order","stroke fill markers"),this.__applyCurrentDefaultPath(),this.__applyStyleToCurrentElement("fill")},Di.prototype.rect=function(t,e,i,n){"path"!==this.__currentElement.nodeName&&this.beginPath(),this.moveTo(t,e),this.lineTo(t+i,e),this.lineTo(t+i,e+n),this.lineTo(t,e+n),this.lineTo(t,e),this.closePath()},Di.prototype.fillRect=function(t,e,i,n){n<0&&(e+=n,n=-n),i<0&&(t+=i,i=-i);var r,s,o,a={x:t,y:e,width:i,height:n};(!this.viewbox||(r=this.viewbox,s=a,r.x<s.x+s.width&&r.x+r.width>s.x&&r.y<s.y+s.height&&r.y+r.height>s.y))&&(o=this.__createElement("rect",a,!0),this.__closestGroupOrSvg().appendChild(o),this.__currentElement=o,this.__applyStyleToCurrentElement("fill"))},Di.prototype.strokeRect=function(t,e,i,n){var r;r=this.__createElement("rect",{x:t,y:e,width:i,height:n},!0),this.__closestGroupOrSvg().appendChild(r),this.__currentElement=r,this.__applyStyleToCurrentElement("stroke")},Di.prototype.__clearCanvas=function(){for(var t=this.__closestGroupOrSvg().getAttribute("transform"),e=this.__root.childNodes[1],i=e.childNodes,n=i.length-1;n>=0;n--)i[n]&&e.removeChild(i[n]);this.__currentElement=e,this.__groupStack=[],t&&this.__addTransform(t)},Di.prototype.clearRect=function(t,e,i,n){if(0!==t||0!==e||i!==this.width||n!==this.height){var r,s=this.__closestGroupOrSvg();r=this.__createElement("rect",{x:t,y:e,width:i,height:n,fill:"#FFFFFF"},!0),s.appendChild(r)}else this.__clearCanvas()},Di.prototype.createLinearGradient=function(t,e,i,n){var r=this.__createElement("linearGradient",{id:zi(this.__ids),x1:t+"px",x2:i+"px",y1:e+"px",y2:n+"px",gradientUnits:"userSpaceOnUse"},!1);return this.__defs.appendChild(r),new Bi(r,this)},Di.prototype.createRadialGradient=function(t,e,i,n,r,s){var o=this.__createElement("radialGradient",{id:zi(this.__ids),cx:n+"px",cy:r+"px",r:s+"px",fx:t+"px",fy:e+"px",gradientUnits:"userSpaceOnUse"},!1);return this.__defs.appendChild(o),new Bi(o,this)},Di.prototype.__parseFont=function(){var t=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-,\'\"\sa-z0-9]+?)\s*$/i.exec(this.font),e={style:t[1]||"normal",size:t[4]||"10px",family:t[6]||"sans-serif",weight:t[3]||"normal",decoration:t[2]||"normal",href:null};return"underline"===this.__fontUnderline&&(e.decoration="underline"),this.__fontHref&&(e.href=this.__fontHref),e},Di.prototype.__wrapTextLink=function(t,e){if(t.href){var i=this.__createElement("a");return i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",t.href),i.appendChild(e),i}return e},Di.prototype.__applyText=function(t,e,i,n){var r,s,o=this.__parseFont(),a=this.__closestGroupOrSvg(),h=this.__createElement("text",{"font-family":o.family,"font-size":o.size,"font-style":o.style,"font-weight":o.weight,"text-decoration":o.decoration,x:e,y:i,"text-anchor":(r=this.textAlign,s={left:"start",right:"end",center:"middle",start:"start",end:"end"},s[r]||s.start),"dominant-baseline":Hi(this.textBaseline)},!0);h.appendChild(this.__document.createTextNode(t)),this.__currentElement=h,this.__applyStyleToCurrentElement(n),a.appendChild(this.__wrapTextLink(o,h))},Di.prototype.fillText=function(t,e,i){this.__applyText(t,e,i,"fill")},Di.prototype.strokeText=function(t,e,i){this.__applyText(t,e,i,"stroke")},Di.prototype.measureText=function(t){return this.__ctx.font=this.font,this.__ctx.measureText(t)},Di.prototype.arc=function(t,e,i,n,r,s){if(n!==r){(n%=2*Math.PI)===(r%=2*Math.PI)&&(r=(r+2*Math.PI-.001*(s?-1:1))%(2*Math.PI));var o=t+i*Math.cos(r),a=e+i*Math.sin(r),h=t+i*Math.cos(n),l=e+i*Math.sin(n),c=s?0:1,u=0,f=r-n;f<0&&(f+=2*Math.PI),u=s?f>Math.PI?0:1:f>Math.PI?1:0,this.lineTo(h,l),this.__addPathCommand(Oi("A {rx} {ry} {xAxisRotation} {largeArcFlag} {sweepFlag} {endX} {endY}",{rx:i,ry:i,xAxisRotation:0,largeArcFlag:u,sweepFlag:c,endX:o,endY:a})),this.__currentPosition={x:o,y:a}}},Di.prototype.clip=function(){var t=this.__closestGroupOrSvg(),e=this.__createElement("clipPath"),i=zi(this.__ids),n=this.__createElement("g");this.__applyCurrentDefaultPath(),t.removeChild(this.__currentElement),e.setAttribute("id",i),e.appendChild(this.__currentElement),this.__defs.appendChild(e),t.setAttribute("clip-path",Oi("url(#{id})",{id:i})),t.appendChild(n),this.__currentElement=n},Di.prototype.drawImage=function(){var t,e,i,n,r,s,o,a,h,l,c,u,f,d=Array.prototype.slice.call(arguments),p=d[0],g=0,m=0;if(3===d.length)t=d[1],e=d[2],i=r=p.width,n=s=p.height;else if(5===d.length)t=d[1],e=d[2],i=d[3],n=d[4],r=p.width,s=p.height;else{if(9!==d.length)throw new Error("Invalid number of arguments passed to drawImage: "+arguments.length);g=d[1],m=d[2],r=d[3],s=d[4],t=d[5],e=d[6],i=d[7],n=d[8]}o=this.__closestGroupOrSvg(),this.__currentElement;var b="translate("+t+", "+e+")";if(p instanceof Di){if((a=p.getSvg().cloneNode(!0)).childNodes&&a.childNodes.length>1){for(h=a.childNodes[0];h.childNodes.length;)f=h.childNodes[0].getAttribute("id"),this.__ids[f]=f,this.__defs.appendChild(h.childNodes[0]);if(l=a.childNodes[1]){var w,v=l.getAttribute("transform");w=v?v+" "+b:b,l.setAttribute("transform",w),o.appendChild(l)}}}else"CANVAS"!==p.nodeName&&"IMG"!==p.nodeName||((c=this.__createElement("image")).setAttribute("width",i),c.setAttribute("height",n),c.setAttribute("preserveAspectRatio","none"),(g||m||r!==p.width||s!==p.height)&&((u=this.__document.createElement("canvas")).width=i,u.height=n,u.getContext("2d").drawImage(p,g,m,r,s,0,0,i,n),p=u),c.setAttribute("transform",b),c.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","CANVAS"===p.nodeName?p.toDataURL():p.getAttribute("src")),o.appendChild(c))},Di.prototype.createPattern=function(t,e){let i,n=this.__document.__createElement("pattern"),r=zi(this.__ids);return n.setAttribute("id",r),n.setAttribute("width",t.width),n.setAttribute("height",t.height),"CANVAS"===t.nodeName||"IMG"===t.nodeName?(i=this.__createElement("image"),i.setAttribute("width",t.width),i.setAttribute("height",t.height),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","CANVAS"===t.nodeName?t.toDataURL():t.getAttribute("src")),n.appendChild(i),this.__defs.appendChild(n)):t instanceof Di&&(n.appendChild(t.__root.childNodes[1]),this.__defs.appendChild(n)),new Ni(n,this)},Di.prototype.setLineDash=function(t){t&&t.length>0?this.lineDash=t.join(","):this.lineDash=null},Di.prototype.drawFocusRing=function(){},Di.prototype.createImageData=function(){},Di.prototype.getImageData=function(){},Di.prototype.putImageData=function(){},Di.prototype.globalCompositeOperation=function(){},Di.prototype.setTransform=function(){};var $i=Di;class qi extends Mi{constructor(t,e,i,n){super(t,e,i,n),this.$canvas.on("click",(t=>this.handleClick(t,this.canvas)))}setWidth(t){this.$viewport.width(t),this.ctx.canvas.style.width=`${t}px`,this.ctx.canvas.width=window.devicePixelRatio*t,this.ctx.canvas.style.height=`${this.$viewport.height()}px`,this.ctx.canvas.height=window.devicePixelRatio*this.$viewport.height(),this.ctx.scale(window.devicePixelRatio,window.devicePixelRatio)}handleClick(t,e){const{xNormalized:i,width:n}=L(t,e),{bpLength:r}=this.browser.genome.getChromosome(this.referenceFrame.chr),s=this.referenceFrame.bpPerPixel*n/r;let o=i;o-s/2<0&&(o=s/2),o+s/2>1&&(o=1-s/2);const a=Math.round((o-s/2)*r),h=Math.round((o+s/2)*r);this.referenceFrame.start=a,this.referenceFrame.initialEnd=h,this.referenceFrame.bpPerPixel=(h-a)/n,this.browser.referenceFrameList>1?this.browser.updateLocusSearchWidget(this.browser.referenceFrameList):this.browser.updateLocusSearchWidget([this.referenceFrame]),this.browser.updateViews()}checkZoomIn(){return!0}setTop(t){}saveSVG(){const{width:t,height:e}=this.$viewport.get(0).getBoundingClientRect(),i=new $i({width:t,height:e,viewbox:{x:0,y:-Ri(this.contentDiv).position().top,width:t,height:e}});this.drawSVGWithContect(i,t,e);const n=i.getSerializedSvg(!0),r=URL.createObjectURL(new Blob([n],{type:"application/octet-stream"}));it(`${this.trackView.track.id}.svg`,r)}drawSVGWithContect(t,e,i){const n={ctx:t,width:e,height:i,genome:this.browser.genome,referenceFrame:this.referenceFrame,ideogramWidth:this.$content.width()};t.save(),Vi(n),t.restore()}repaint(){Vi({ctx:this.ctx,width:this.$canvas.width(),height:this.$canvas.height(),genome:this.browser.genome,referenceFrame:this.referenceFrame,ideogramWidth:this.$content.width()})}}function Vi({ctx:t,width:e,height:i,genome:n,referenceFrame:r,ideogramWidth:s}){const o=r.chr,a=n.getChromosome(o);if(!a||e<=0||i<=0||"all"===o.toLowerCase())return;Ii.fillRect(t,0,0,e,i,{fillStyle:ct.greyScale(255)}),function({ctx:t,chr:e,referenceFrame:i,genome:n,width:r,height:s,stainColors:o}){var a,h,l,c,u,f,d,p,g,m,b,w;if(h=.5*(a=1),l=0,void 0===n)return;if(Ii.fillRect(t,0,0,r,s,{fillStyle:ct.greyScale(255)}),c=n.getCytobands(e)){if(f=l+s/2,d=[],p=[],0===c.length)return;for(g=r/i.genome.getChromosome(e).bpLength,t.beginPath(),Ii.roundRect(t,h,h+l,r-2*h,s-2*h,(s-2*h)/2,0,1),t.clip(),w=0;w<c.length;w++)m=g*(u=c[w]).start,b=g*u.end,"c"===u.type?("p"===u.name.charAt(0)?(d[0]=m,p[0]=s+l,d[1]=m,p[1]=l,d[2]=b,p[2]=f):(d[0]=b,p[0]=s+l,d[1]=b,p[1]=l,d[2]=m,p[2]=f),t.fillStyle="rgb(150, 0, 0)",t.strokeStyle="rgb(150, 0, 0)",Ii.polygon(t,d,p,1,0)):(t.fillStyle=ji(o,u),Ii.fillRect(t,m,a+l,b-m,s-2*a))}t.strokeStyle=ct.greyScale(41),Ii.roundRect(t,h,h+l,r-2*h,s-2*h,(s-2*h)/2,0,1)}({ctx:t,chr:o,referenceFrame:r,genome:n,width:e,height:i,stainColors:[]});const h=Math.round(r.bpPerPixel*s),l=r.start;let c=a.bpLength;const u=n.getCytobands(o);if(u&&u.length>0&&(c=Math.max(c,u[u.length-1].end)),h<c){const n=h/c,r=l/c;let s=Math.floor(r*e),o=Math.floor(n*e);s=Math.max(0,s),s=Math.min(e-o,s),t.save(),t.strokeStyle="red",t.lineWidth=o<2?1:2;const a=s+t.lineWidth/2;o=o<2?1:o-t.lineWidth;const u=t.lineWidth/2,f=i-t.lineWidth;t.strokeRect(a,u,o,f),t.restore()}}function ji(t,e){if("c"===e.type)return"rgb(150, 10, 10)";var i=e.stain,n=230;"p"===e.type&&(n=Math.floor(230-i/100*230));var r=t[n];return r||(r="rgb("+n+","+n+","+n+")",t[n]=r),r}const Wi=function(t,e,i,n){this.start=t,this.end=e,this.name=i,this.stain=0,"acen"===n?this.type="c":(this.type=n.charAt(1),"p"===this.type&&(this.stain=parseInt(n.substring(4))))},Gi=function(t,e,i,n){this.chr=t,this.start=e,this.end=i,this.features=n};Gi.prototype.contains=function(t,e,i){return this.chr===t&&this.start<=e&&this.end>=i},Gi.prototype.containsRange=function(t){return this.chr===t.chr&&this.start<=t.start&&this.end>=t.end};const Zi=function(t,e,i,n,r){this.name=t,this.order=e,this.bpStart=i,this.bpLength=n,this.rangeLocus=r},Xi={oauthTokens:{},setToken:function(t,e){e=e||"googleapis",this.oauthTokens[e]=t,"googleapis"===e&&(this.google.access_token=t)},getToken:function(t){let e;t=t||"googleapis";for(let i of Object.keys(this.oauthTokens)){if(Yi(i).test(t)){e=this.oauthTokens[i];break}}return e},removeToken:function(t){t=t||"googleapis";for(let e of Object.keys(this.oauthTokens)){Yi(e).test(t)&&(this.oauthTokens[e]=void 0)}"googleapis"===t&&(this.google.access_token=void 0)},google:{setToken:function(t){Xi.setToken(t)}}};function Yi(t){return new RegExp("^"+t.split(/\*+/).map(Ki).join(".*")+"$")}function Ki(t){return t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")}function Qi(t,e){const i=[];let n=0,r=0;for(e=e||t.byteLength-18;n<e;)try{const e=new Uint8Array(t,n,18),s=e[11]<<8|e[10],o=(e[12],e[13],e[15],e[14],1+(e[17]<<8|e[16])),a=12+s+n,h=t.byteLength-a,l=o-s-19;if(h<l||l<=0)break;const c=new Uint8Array(t,a,l),u=new B.RawInflate(c),f=u.decompress();n+=u.ip+26,r+=f.byteLength,i.push(f)}catch(t){console.error(t);break}if(1===i.length)return i[0];{const t=new Uint8Array(r);let e=0;for(let n=0;n<i.length;++n){var s=new Uint8Array(i[n]);en(s,0,t,e,s.length),e+=s.length}return t}}function Ji(t){const e=new Uint8Array(t);return e[17]<<8|e[16]+1}const tn="function"==typeof new Uint8Array(1).subarray;function en(t,e,i,n,r){if(0!==r){if(!t)throw"Undef src";if(!i)throw"Undef dest";0===e&&r===t.length?nn(t,i,n):tn?nn(t.subarray(e,e+r),i,n):1===t.BYTES_PER_ELEMENT&&r>100?nn(new Uint8Array(t.buffer,t.byteOffset+e,r),i,n):function(t,e,i,n,r){for(let s=0;s<r;++s)i[n+s]=t[e+s]}(t,e,i,n,r)}}function nn(t,e,i){e.set(t,i)}function rn(t){const e=new Set(["boolean","number","string","symbol"]),i=typeof t;return void 0!==t&&(e.has(i)||t.substring||t.toFixed)}function sn(t,e){var i={oauthToken:t.oauthToken,headers:t.headers,withCredentials:t.withCredentials,filename:t.filename};return Object.assign(i,e)}const on=function(t){var e,i;return t.length>0?(e=Number.MAX_VALUE,i=-Number.MAX_VALUE,t.forEach((function(t){Number.isNaN(t.value)||(e=Math.min(e,t.value),i=Math.max(i,t.value))})),i>0&&(e=Math.min(0,e)),i<0&&(i=0)):(e=0,i=100),{min:e,max:i}},an=function(t,e,i){let n=e.start,r=e.end;if(void 0===r)n-=i/2,r=n+i,r>t?(r=t,n=r-i):n<0&&(n=0,r=i);else if(r-n<i){const e=(r+n)/2;e-i/2<0?(n=0,r=n+i):e+i/2>t?(r=t,n=r-i):(n=e-i/2,r=n+i)}e.start=Math.ceil(n),e.end=Math.floor(r)};function hn(t){if(function(t){t.featureType&&(t.type=t.type||t.featureType,t.featureType=void 0);"junctions"===t.type?t.type="spliceJunctions":"bed"===t.type?(t.type="annotation",t.format=t.format||"bed"):"annotations"===t.type?t.type="annotation":"alignments"===t.type?t.type="alignment":"bam"===t.type?(t.type="alignment",t.format="bam"):"vcf"===t.type?(t.type="variant",t.format="vcf"):"t2d"===t.type?t.type="gwas":"FusionJuncSpan"!==t.type||t.format?"aed"===t.type&&(t.type="annotation",t.format=t.format||"aed"):t.format="fusionjuncspan"}(t),t.type)return t.type;let e;if("file"===t.sourceType||void 0===t.sourceType&&t.url)if(void 0===t.format){e=st(et(t.url)?t.url.name:t.url)}else e=t.format.toLowerCase();if(e)switch(e){case"bw":case"bigwig":case"wig":case"bedgraph":case"tdf":return"wig";case"vcf":return"variant";case"seg":return"seg";case"bam":case"cram":return"alignment";case"bedpe":case"bedpe-loop":return"interaction";case"bp":return"arc";case"gwas":return"gwas";case"bed":case"bigbed":case"bb":return"bedtype";default:return"annotation"}}async function ln(t){if(O(t)&&t.startsWith("https://drive.google.com")){if(void 0===K())throw Error("Google drive is referenced, but API key is not defined.  An API key is required for Google Drive access");const e=await async function(t){let e="https://www.googleapis.com/drive/v3/files/"+W(t)+"?supportsTeamDrives=true";const i=K();i&&(e+="&key="+i);const n=await fetch(e);let r=await n.json();if(r.error&&404===r.error.code){const{access_token:t}=await Y("https://www.googleapis.com/auth/drive.readonly");if(!t)throw Error(r.error);{const i=await fetch(e,{headers:{Authorization:`Bearer ${t}`}});if(r=await i.json(),r.error)throw Error(r.error)}}return r}(t);return e.originalFileName||e.name}return function(t){if(t instanceof File)return t.name;if(O(t)){let e=t.lastIndexOf("/"),i=e<0?t:t.substr(e+1);return e=i.indexOf("?"),e>0&&(i=i.substr(0,e)),i}throw Error("Expected File or string, got "+typeof t)}(t)}const cn=new class{constructor(t){this.requestsPerSecond=t.requestsPerSecond||10,this.lastStartTime=0,this.queued=[]}add(t,e){var i=this;return new Promise((function(e,n){i.queued.push({resolve:e,reject:n,asyncFunction:t}),i.dequeue()}))}addAll(t,e){var i=t.map(function(t){return this.add(t,e)}.bind(this));return Promise.all(i)}dequeue(){if(this.queued.length>0){var t=new Date,e=1e3/this.requestsPerSecond+1,i=t-this.lastStartTime;i>=e?this._execute():setTimeout(function(){this.dequeue()}.bind(this),e-i)}}async _execute(){this.lastStartTime=new Date;var t=this.queued.shift();const e=t.asyncFunction;try{const i=await e();t.resolve(i)}catch(e){t.reject(e)}}}({requestsPerSecond:9}),un={apiKey:void 0,setApiKey:function(t){this.apiKey=t},load:fn,loadArrayBuffer:async function(t,e){return(e=e||{}).responseType||(e.responseType="arraybuffer"),t instanceof File?pn(t,e):fn(t,e)},loadJson:async function(t,e){"POST"===((e=e||{}).method||(e.sendData?"POST":"GET"))&&(e.contentType="application/json");const i=await this.loadString(t,e);return i?JSON.parse(i):i},loadString:async function(t,e){return e=e||{},t instanceof File?async function(t,e){const i=e.range?t.slice(e.range.start,e.range.start+e.range.size):t;let n=0;e&&e.bgz||t.name.endsWith(".bgz")?n=2:t.name.endsWith(".gz")&&(n=1);if(0===n)return mn(i);return wn(await gn(i),n)}(t,e):async function(t,e){const i=(e=e||{}).filename||await ln(t);let n=3;e.bgz?n=2:i.endsWith(".gz")&&(n=1);e.responseType="arraybuffer";return wn(await un.load(t,e),n)}(t,e)}};async function fn(t,e){e=e||{};const i=typeof t;if((t=await("function"==typeof t?t():t))instanceof File)return pn(t,e);if("function"==typeof t.startsWith)return t.startsWith("data:")?Q(t):(t.startsWith("https://drive.google.com")&&(t=j(t)),V(t)?cn.add((async function(){return dn(t,e)})):dn(t,e));throw Error(`url must be either a 'File', 'string', 'function', or 'Promise'.  Actual type: ${i}`)}async function dn(t,e){t=function(t){return t.includes("//www.dropbox.com")?t.replace("//www.dropbox.com","//dl.dropboxusercontent.com"):t.includes("//drive.google.com")?j(t):t.includes("//www.broadinstitute.org/igvdata")?t.replace("//www.broadinstitute.org/igvdata","//data.broadinstitute.org/igvdata"):t.includes("//igvdata.broadinstitute.org")?t.replace("//igvdata.broadinstitute.org","https://dn7ywbm9isq8j.cloudfront.net"):t.startsWith("ftp://ftp.ncbi.nlm.nih.gov/geo")?t.replace("ftp://","https://"):t}(t);let i=(e=e||{}).oauthToken||function(t){const e=$(t)?void 0:J(t).host;let i=Xi.getToken(e);if(i)return i;if(void 0===e){const t=bn();if(t&&t.expires_at>Date.now())return t.access_token}}(t);return i&&(i=await("function"==typeof i?i():i)),new Promise((function(n,r){var s,o,a,h,l,c,u;$(t)&&(t.startsWith("gs://")?(o=(s=t).indexOf("/",5),l=s.indexOf("?"),t=o<0?s:(a=s.substring(5,o),c=l<0?s.substring(o+1):s.substring(o+1,l),h=encodeURIComponent(c),l>0&&(u=s.substring(l)),"https://www.googleapis.com/storage/v1/b/"+a+"/o/"+h+(u?u+"&alt=media":"?alt=media"))):q(t)&&(t.includes("altMedia=")||(t+=t.includes("?")?"&altMedia=true":"?altMedia=true")),V(t=function(t){let e=un.apiKey;e||"undefined"==typeof gapi||(e=gapi.apiKey);if(void 0!==e&&!t.includes("key=")){const i=t.includes("?")?"&":"?";t=t+i+"key="+e}return t}(t))&&function(t){if(t.includes("supportsTeamDrive"))return t;{const e=t.includes("?")?"&":"?";t=t+e+"supportsTeamDrive=true"}}(t),i||(i=bn()));const f=e.headers||{};i&&function(t,e){e&&(t["Cache-Control"]="no-cache",t.Authorization="Bearer "+e)}(f,i);const d=e.range,p=navigator.userAgent.indexOf("Chrome")>-1;0===navigator.vendor.indexOf("Apple")&&/\sSafari\//.test(navigator.userAgent);d&&p&&!function(t){return t.indexOf("X-Amz-Signature")>-1}(t)&&(t+=t.includes("?")?"&":"?",t+="someRandomSeed="+Math.random().toString(36));const g=new XMLHttpRequest,m=e.sendData||e.body,b=e.method||(m?"POST":"GET"),w=e.responseType,v=e.contentType,y=e.mimeType;if(g.open(b,t),d){var x=d.size?d.start+d.size-1:"";g.setRequestHeader("Range","bytes="+d.start+"-"+x)}if(v&&g.setRequestHeader("Content-Type",v),y&&g.overrideMimeType(y),w&&(g.responseType=w),f)for(let t of Object.keys(f)){const e=f[t];g.setRequestHeader(t,e)}!0===e.withCredentials&&(g.withCredentials=!0),g.onload=async function(i){0===g.status||g.status>=200&&g.status<=300?d&&206!==g.status&&0!==d.start?(g.response.length>1e5&&alert(`Warning: Range header ignored for URL: ${t}.  This can have performance impacts.`),n(g.response.slice(d.start,d.start+d.size))):n(g.response):"undefined"==typeof gapi||404!==g.status&&401!==g.status&&403!==g.status||!$(t)||e.retries?403===g.status?k("Access forbidden: "+t):416===g.status?k("Unsatisfiable range"):k(g.status):S()},g.onerror=function(i){$(t)&&!e.retries&&S(),k("Error accessing resource: "+t+" Status: "+g.status)},g.ontimeout=function(t){k("Timed out")},g.onabort=function(t){r(t)};try{g.send(m)}catch(t){r(t)}function k(t){if(!r)throw t;r(t)}async function S(){try{const i=await async function(t){if(Z()){const e=function(t){return V(t)?"https://www.googleapis.com/auth/drive.file":q(t)?"https://www.googleapis.com/auth/devstorage.read_only":"https://www.googleapis.com/auth/userinfo.profile"}(t),i=await Y(e);return i?i.access_token:void 0}throw Error("Authorization is required, but Google oAuth has not been initalized. Contact your site administrator for assistance.")}(t);e.retries=1,e.oauthToken=i;const r=await fn(t,e);n(r)}catch(t){if(t.error){const e=t.error.startsWith("popup_blocked")?"Google login popup blocked by browser.":t.error;alert(e)}else k(t)}}}))}async function pn(t,e){let i=e&&e.range?t.slice(e.range.start,e.range.start+e.range.size):t;return"arraybuffer"===e.responseType?gn(i):new Promise((function(e,n){const r=new FileReader;r.onload=function(t){e(r.result)},r.onerror=function(e){console.error("reject uploading local file "+t.name),n(null,r)},r.readAsBinaryString(i),console.warn("Deprecated method used: readAsBinaryString")}))}async function gn(t){return"function"==typeof t.arrayBuffer?t.arrayBuffer():new Promise((function(e,i){const n=new FileReader;n.onload=function(t){e(n.result)},n.onerror=function(t){console.error("reject uploading local file "+localfile.name),i(null,n)},n.readAsArrayBuffer(t)}))}async function mn(t){return"function"==typeof t.text?t.text():new Promise((function(e,i){const n=new FileReader;n.onload=function(t){e(n.result)},n.onerror=function(t){console.error("reject uploading local file "+localfile.name),i(null,n)},n.readAsText(t)}))}function bn(){if(Z()){const t=function(){let t=gapi.auth2.getAuthInstance().currentUser.get();if(t&&t.isSignedIn()){const{access_token:e,expires_at:i}=t.getAuthResponse();return{access_token:e,expires_at:i}}}();return t?t.access_token:void 0}}function wn(t,e){if(3===e&&t.byteLength>2){const i=new Uint8Array(t,0,2);31===i[0]&&139===i[1]&&(e=1)}let i;if(1===e){i=new B.Gunzip(new Uint8Array(t)).decompress()}else i=2===e?Qi(t):new Uint8Array(t);return"TextDecoder"in function(){if("undefined"!=typeof self)return self;return"undefined"!=typeof global?global:window}()?(new TextDecoder).decode(i):function(t){var e="",i=0;for(;i<t.length;){var n=t[i],r=0,s=0;if(n<=127?(r=0,s=255&n):n<=223?(r=1,s=31&n):n<=239?(r=2,s=15&n):n<=244&&(r=3,s=7&n),t.length-i-r>0)for(var o=0;o<r;)s=s<<6|63&(n=t[i+o+1]),o+=1;else s=65533,r=t.length-i;e+=String.fromCodePoint(s),i+=r+1}return e}(i)}const vn=H,yn=new Set(["fastaURL","indexURL","cytobandURL","indexed"]);class xn{constructor(t){"string"==typeof t.fastaURL&&t.fastaURL.startsWith("data:")?(this.file=function(t){const e=t.split(","),i=e[0].split(":")[1];let n=e[1];n=i.indexOf("base64")>=0?atob(n):decodeURI(n);const r=new Uint8Array(n.length);for(let t=0;t<n.length;t++)r[t]=n.charCodeAt(t);const s=new B.Gunzip(r).decompress();let o="";const a=s.length;for(let t=0;t<a;t++)o+=String.fromCharCode(s[t]);return o}(t.fastaURL),this.indexed=!1,this.isDataURI=!0):(this.file=t.fastaURL,this.indexed=!1!==t.indexed,this.indexed&&(this.indexFile=t.indexURL||t.indexFile||this.file+".fai")),this.withCredentials=t.withCredentials,this.chromosomeNames=[],this.chromosomes={},this.sequences={},this.offsets={};const e={};for(let i in t)t.hasOwnProperty(i)&&!yn.has(i)&&(e[i]=t[i]);this.config=e}async init(){return this.indexed?this.getIndex():this.loadAll()}async getSequence(t,e,i){return this.indexed?this.getSequenceIndexed(t,e,i):this.getSequenceNonIndexed(t,e,i)}async getSequenceIndexed(t,e,i){if(!this.interval||!this.interval.contains(t,e,i)){let n=e,r=i;if(i-e<5e4){const t=i-e,s=Math.round(e+t/2);n=Math.max(0,s-25e3),r=s+25e3}const s=await this.readSequence(t,n,r);this.interval=new Gi(t,n,r,s)}const n=e-this.interval.start,r=i-e;return this.interval.features?this.interval.features.substr(n,r):null}async getSequenceNonIndexed(t,e,i){this.offsets[t]&&(e-=this.offsets[t],i-=this.offsets[t]);let n="";if(e<0)for(let t=e;t<Math.min(i,0);t++)n+="*";if(i<=0)return Promise.resolve(n);const r=this.sequences[t],s=Math.min(i,r.length);return n+r.substring(e,s)}async getIndex(){if(this.index)return this.index;{const t=await un.load(this.indexFile,sn(this.config)),e=vn(t),i=e.length;let n=0,r=0;for(this.index={};n<i;){const t=e[n++].split("\t");if(5===t.length){const e=t[0],i=parseInt(t[1]),n={size:i,position:parseInt(t[2]),basesPerLine:parseInt(t[3]),bytesPerLine:parseInt(t[4])};this.chromosomeNames.push(e),this.index[e]=n,this.chromosomes[e]=new Zi(e,r++,0,i)}}return this.index}}async loadAll(){let t;t=this.isDataURI?this.file:await un.load(this.file,sn(this.config));const e=vn(t),i=e.length;let n,r,s,o,a=0,h=0,l=0;for(;a<i;)if(s=e[a++].trim(),s.startsWith("#")||0===s.length);else if(s.startsWith(">")){n&&(this.chromosomeNames.push(o),this.sequences[o]=n,this.chromosomes[o]=new Zi(o,l++,h,h+n.length,r));const t=s.substr(1).split(/\s+/)[0].split(":");if(o=t[0],n="",h=0,r=void 0,t.length>1&&t[1].indexOf("-")>0){const e=t[1].split("-");2===e.length&&/^[0-9]+$/.test(e[0])&&/^[0-9]+$/.test(e[1]);const i=Number.parseInt(e[0]);Number.parseInt(e[1])>i&&(h=i-1,this.offsets[o]=h,r=t[1])}}else n+=s;n&&(this.chromosomeNames.push(o),this.sequences[o]=n,this.chromosomes[o]=new Zi(o,l++,h,h+n.length,r))}async readSequence(t,e,i){await this.getIndex();const n=this.index[t];if(n){const r=Math.max(0,e),s=Math.min(n.size,i),o=n.bytesPerLine,a=n.basesPerLine,h=n.position,l=o-a,c=Math.floor(r/a),u=Math.floor(s/a),f=r-c*a,d=h+c*o+f,p=h+u*o+(s-u*a)-1-d+1;let g;if(p<=0?console.error("No sequence for "+t+":"+e+"-"+i):g=await un.load(this.file,sn(this.config,{range:{start:d,size:p}})),g){let t,e="",i=0,n=g.length;for(f>0&&(t=Math.min(s-r,a-f),e+=g.substr(i,t),i+=t+l);i<n;)t=Math.min(a,n-i),e+=g.substr(i,t),i+=t+l;return e}return null}return this.interval=new Gi(t,e,i,null),null}}function kn(){return"2.7.4"}const Sn=H,_n={loadGenome:async function(t){const e=t.cytobandURL,i=t.aliasURL,n=new xn(t);let r,s;return await n.init(),e&&(r=await function(t,e){if(t.startsWith("data:")){var i=r(t);return Promise.resolve(n(i))}return un.loadString(t,sn(e)).then((function(t){return n(t)}));function n(t){for(var e,i=[],n=0,r=Sn(t),s=r.length,o={},a=0;a<s;a++){var h=r[a].split("\t"),l=h[0];if(e||(e=l),l!==e&&(o[e]=i,i=[],e=l,n=0),5===h.length){var c=parseInt(h[1]),u=parseInt(h[2]),f=h[3],d=h[4];i[n++]=new Wi(c,u,f,d)}}return o}function r(t){let e;if(t.startsWith("data:application/gzip;base64"))e=Q(t);else{let i,n=t.split(","),r=n[0].split(":")[1],s=n[1];s=r.indexOf("base64")>=0?atob(s):decodeURI(s),i=new Uint8Array(s.length);for(let t=0;t<s.length;t++)i[t]=s.charCodeAt(t);e=new B.Gunzip(i).decompress()}let i="";const n=e.length;for(let t=0;t<n;t++)i+=String.fromCharCode(e[t]);return i}}(e,n.config)),i&&(s=await function(t,e){return un.loadString(t,sn(e)).then((function(t){var e=Sn(t),i=[];return e.forEach((function(t){!t.startsWith("#")&&t.length>0&&i.push(t.split("\t"))})),i}))}(i,n.config)),new Cn(t,n,r,s)},initializeGenomes:async function(t){if(!_n.KNOWN_GENOMES){const i={};if(!1!==t.loadDefaultGenomes){const t=`https://igv.org/genomes/genomes.json?randomSeed=${Math.random().toString(36)}&version=2.7.4`;e(await un.loadJson(t,{}))}const n=t.genomeList||t.genomes;if(n)if("string"==typeof n){e(await un.loadJson(n,{}))}else e(n);function e(t){return t.forEach((function(t){i[t.id]=t})),i}_n.KNOWN_GENOMES=i}},isWholeGenomeView:function(t){return"all"===t.toLowerCase()}};class Cn{constructor(t,e,i,n){this.config=t,this.id=t.id,this.sequence=e,this.chromosomeNames=e.chromosomeNames,this.chromosomes=e.chromosomes,this.ideograms=i,this.featureDB={},this.wholeGenomeView=void 0===t.wholeGenomeView||t.wholeGenomeView,this.wholeGenomeView&&Object.keys(e.chromosomes).length>1?function(t,e){let i;if(e.chromosomeOrder)t.wgChromosomeNames=e.chromosomeOrder.split(",").map((t=>t.trim())),i=t.wgChromosomeNames.map((e=>t.chromosomes[e])).filter((t=>void 0!==t));else{const e=Object.keys(t.chromosomes).map((e=>t.chromosomes[e].bpLength)).reduce(((t,e)=>Math.max(t,e)))/50;i=Object.values(t.chromosomes).filter((t=>t.bpLength>e));const n=i.filter((t=>r(t.name.replace("chr","")))),s=i.filter((t=>!r(t.name.replace("chr",""))));n.sort(((t,e)=>Number.parseInt(t.name.replace("chr",""))-Number.parseInt(e.name.replace("chr",""))));const o=n.map((t=>t.name));for(let t of s)o.push(t.name);t.wgChromosomeNames=o}const n=i.reduce(((t,e)=>t+e.bpLength),0);function r(t){return/^\d+$/.test(t)}t.chromosomes.all={name:"all",bpLength:n}}(this,t):this.wgChromosomeNames=e.chromosomeNames;var r={},s=this;r.all="all",this.chromosomeNames.forEach((function(t){var e=t.startsWith("chr")?t.substring(3):"chr"+t;r[e.toLowerCase()]=t,"chrM"===t&&(r.mt="chrM"),"MT"===t&&(r.chrm="MT"),r[t.toLowerCase()]=t})),n&&n.forEach((function(t){var e,i;for(i=0;i<t.length;i++)if(s.chromosomes[t[i]]){e=t[i];break}e&&t.forEach((function(t){t!==e&&(r[t.toLowerCase()]=e,r[t]=e)}))})),this.chrAliasTable=r}showWholeGenomeView(){return!1!==this.config.wholeGenomeView}toJSON(){return Object.assign({},this.config,{tracks:void 0})}getInitialLocus(){}getHomeChromosomeName(){if(this.showWholeGenomeView()&&this.chromosomes.hasOwnProperty("all"))return"all";{const t=this.chromosomes[this.chromosomeNames[0]];return t.rangeLocus?t.name+":"+t.rangeLocus:this.chromosomeNames[0]}}getChromosomeName(t){var e=this.chrAliasTable[t.toLowerCase()];return e||t}getChromosome(t){return t=this.getChromosomeName(t),this.chromosomes[t]}getCytobands(t){return this.ideograms?this.ideograms[t]:null}getLongestChromosome(){var t,e=this.chromosomes;for(let n in e){if(e.hasOwnProperty(n)){var i=e[n];(void 0===t||i.bpLength>t.bpLength)&&(t=i)}return t}}getChromosomes(){return this.chromosomes}getGenomeCoordinate(t,e){var i=this.getCumulativeOffset(t);if(void 0!==i)return i+e}getChromosomeCoordinate(t){let e;void 0===this.cumulativeOffsets&&(this.cumulativeOffsets=computeCumulativeOffsets.call(this));let i=0;for(let n of this.wgChromosomeNames){const r=this.cumulativeOffsets[n];if(r>t){return{chr:e,position:t-i}}e=n,i=r}return{chr:this.chromosomeNames[this.chromosomeNames.length-1],position:0}}getCumulativeOffset(t){void 0===this.cumulativeOffsets&&(this.cumulativeOffsets=function(){let t=this,e={},i=0;for(let n of t.wgChromosomeNames){e[n]=Math.floor(i);i+=t.getChromosome(n).bpLength}return e}.call(this));const e=this.getChromosomeName(t);return this.cumulativeOffsets[e]}getGenomeLength(){let t=this;if(!this.bpLength){let e=0;t.wgChromosomeNames.forEach((function(i){let n=t.chromosomes[i];e+=n.bpLength})),this.bpLength=e}return this.bpLength}}function En(t,e){let i=Ri("<div>",{class:"igv-menu-popup-check-container"}),n=Ri("<div>");i.append(n);let r=An("check",!0===e?"#444":"transparent");n.append(r);let s=Ri("<div>");return s.text(t),i.append(s),i}function Tn(t,e){return Ri(An(t,e))}function An(t,e){e=e||"currentColor";let i=Rn[t];i||(console.error(`No icon named: ${t}`),i=Rn.question);let n='<svg viewBox="0 0 '+i[0]+" "+i[1]+'">';return n+='<path fill="'+e+'" d="'+i[4]+'"></path>',n+="</svg>",n}const Rn={check:[512,512,[],"f00c","M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"],cog:[512,512,[],"f013","M444.788 291.1l42.616 24.599c4.867 2.809 7.126 8.618 5.459 13.985-11.07 35.642-29.97 67.842-54.689 94.586a12.016 12.016 0 0 1-14.832 2.254l-42.584-24.595a191.577 191.577 0 0 1-60.759 35.13v49.182a12.01 12.01 0 0 1-9.377 11.718c-34.956 7.85-72.499 8.256-109.219.007-5.49-1.233-9.403-6.096-9.403-11.723v-49.184a191.555 191.555 0 0 1-60.759-35.13l-42.584 24.595a12.016 12.016 0 0 1-14.832-2.254c-24.718-26.744-43.619-58.944-54.689-94.586-1.667-5.366.592-11.175 5.459-13.985L67.212 291.1a193.48 193.48 0 0 1 0-70.199l-42.616-24.599c-4.867-2.809-7.126-8.618-5.459-13.985 11.07-35.642 29.97-67.842 54.689-94.586a12.016 12.016 0 0 1 14.832-2.254l42.584 24.595a191.577 191.577 0 0 1 60.759-35.13V25.759a12.01 12.01 0 0 1 9.377-11.718c34.956-7.85 72.499-8.256 109.219-.007 5.49 1.233 9.403 6.096 9.403 11.723v49.184a191.555 191.555 0 0 1 60.759 35.13l42.584-24.595a12.016 12.016 0 0 1 14.832 2.254c24.718 26.744 43.619 58.944 54.689 94.586 1.667 5.366-.592 11.175-5.459 13.985L444.788 220.9a193.485 193.485 0 0 1 0 70.2zM336 256c0-44.112-35.888-80-80-80s-80 35.888-80 80 35.888 80 80 80 80-35.888 80-80z"],exclamation:[192,512,[],"f12a","M176 432c0 44.112-35.888 80-80 80s-80-35.888-80-80 35.888-80 80-80 80 35.888 80 80zM25.26 25.199l13.6 272C39.499 309.972 50.041 320 62.83 320h66.34c12.789 0 23.331-10.028 23.97-22.801l13.6-272C167.425 11.49 156.496 0 142.77 0H49.23C35.504 0 24.575 11.49 25.26 25.199z"],"exclamation-circle":[512,512,[],"f06a","M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"],"exclamation-triangle":[576,512,[],"f071","M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"],minus:[448,512,[],"f068","M424 318.2c13.3 0 24-10.7 24-24v-76.4c0-13.3-10.7-24-24-24H24c-13.3 0-24 10.7-24 24v76.4c0 13.3 10.7 24 24 24h400z"],"minus-circle":[512,512,[],"f056","M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zM124 296c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h264c6.6 0 12 5.4 12 12v56c0 6.6-5.4 12-12 12H124z"],"minus-square":[448,512,[],"f146","M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zM92 296c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h264c6.6 0 12 5.4 12 12v56c0 6.6-5.4 12-12 12H92z"],plus:[448,512,[],"f067","M448 294.2v-76.4c0-13.3-10.7-24-24-24H286.2V56c0-13.3-10.7-24-24-24h-76.4c-13.3 0-24 10.7-24 24v137.8H24c-13.3 0-24 10.7-24 24v76.4c0 13.3 10.7 24 24 24h137.8V456c0 13.3 10.7 24 24 24h76.4c13.3 0 24-10.7 24-24V318.2H424c13.3 0 24-10.7 24-24z"],"plus-circle":[512,512,[],"f055","M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92h-92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z"],"plus-square":[448,512,[],"f0fe","M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zm-32 252c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92H92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z"],question:[384,512,[],"f128","M202.021 0C122.202 0 70.503 32.703 29.914 91.026c-7.363 10.58-5.093 25.086 5.178 32.874l43.138 32.709c10.373 7.865 25.132 6.026 33.253-4.148 25.049-31.381 43.63-49.449 82.757-49.449 30.764 0 68.816 19.799 68.816 49.631 0 22.552-18.617 34.134-48.993 51.164-35.423 19.86-82.299 44.576-82.299 106.405V320c0 13.255 10.745 24 24 24h72.471c13.255 0 24-10.745 24-24v-5.773c0-42.86 125.268-44.645 125.268-160.627C377.504 66.256 286.902 0 202.021 0zM192 373.459c-38.196 0-69.271 31.075-69.271 69.271 0 38.195 31.075 69.27 69.271 69.27s69.271-31.075 69.271-69.271-31.075-69.27-69.271-69.27z"],save:[448,512,[],"f0c7","M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"],search:[512,512,[],"f002","M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"],share:[512,512,[],"f064","M503.691 189.836L327.687 37.851C312.281 24.546 288 35.347 288 56.015v80.053C127.371 137.907 0 170.1 0 322.326c0 61.441 39.581 122.309 83.333 154.132 13.653 9.931 33.111-2.533 28.077-18.631C66.066 312.814 132.917 274.316 288 272.085V360c0 20.7 24.3 31.453 39.687 18.164l176.004-152c11.071-9.562 11.086-26.753 0-36.328z"],spinner:[512,512,[],"f110","M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"],square:[448,512,[],"f0c8","M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48z"],"square-full":[512,512,[],"f45c","M512 512H0V0h512v512z"],times:[384,512,[],"f00d","M323.1 441l53.9-53.9c9.4-9.4 9.4-24.5 0-33.9L279.8 256l97.2-97.2c9.4-9.4 9.4-24.5 0-33.9L323.1 71c-9.4-9.4-24.5-9.4-33.9 0L192 168.2 94.8 71c-9.4-9.4-24.5-9.4-33.9 0L7 124.9c-9.4 9.4-9.4 24.5 0 33.9l97.2 97.2L7 353.2c-9.4 9.4-9.4 24.5 0 33.9L60.9 441c9.4 9.4 24.5 9.4 33.9 0l97.2-97.2 97.2 97.2c9.3 9.3 24.5 9.3 33.9 0z"],"times-circle":[512,512,[],"f057","M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z"],wrench:[512,512,[],"f0ad","M481.156 200c9.3 0 15.12 10.155 10.325 18.124C466.295 259.992 420.419 288 368 288c-79.222 0-143.501-63.974-143.997-143.079C223.505 65.469 288.548-.001 368.002 0c52.362.001 98.196 27.949 123.4 69.743C496.24 77.766 490.523 88 481.154 88H376l-40 56 40 56h105.156zm-171.649 93.003L109.255 493.255c-24.994 24.993-65.515 24.994-90.51 0-24.993-24.994-24.993-65.516 0-90.51L218.991 202.5c16.16 41.197 49.303 74.335 90.516 90.503zM104 432c0-13.255-10.745-24-24-24s-24 10.745-24 24 10.745 24 24 24 24-10.745 24-24z"]},In={trackMenuItemList:function(t){const e=new Set(["alignment","annotation","variant","eqtl","snp"]),i=t.track.config&&void 0!==t.track.config.visibilityWindow;let n=[];return"sequence"!==t.track.config.type&&(n.push(function(t){const e=e=>{const i=function(){let e=t.browser.inputDialog.input.value;e=""===e||void 0===e?"untitled":e.trim(),t.browser.setTrackLabelName(t,e)},n={label:"Track Name",value:Mn(t.track)||"unnamed",callback:i};t.browser.inputDialog.present(n,e)},i=Ri("<div>");return i.text("Set track name"),{object:i,click:e}}(t)),n.push(function(t){const e=e=>{const i=()=>{const e=parseFloat(t.browser.inputDialog.input.value,10);void 0!==e&&(void 0!==t.track.minHeight&&t.track.minHeight>e&&(t.track.minHeight=e),void 0!==t.track.maxHeight&&t.track.maxHeight<e&&(t.track.minHeight=e),t.setTrackHeight(e,!0),t.track.autoHeight=!1)},n={label:"Track Height",value:t.trackDiv.clientHeight,callback:i};t.browser.inputDialog.present(n,e)},i=Ri("<div>");return i.text("Set track height"),{object:i,click:e}}(t))),this.showColorPicker(t.track)&&(n.push(Ln({trackView:t,label:"Set track color",option:"color"})),n.push(Ln({trackView:t,label:"Set alt color",option:"altColor"}))),t.track.menuItemList&&(n=n.concat(t.track.menuItemList())),(i||e.has(t.track.config.type))&&(n.push("<hr/>"),n.push(function(t){const e=e=>{const i=()=>{let e=t.browser.inputDialog.input.value;e=""===e||void 0===e?-1:e.trim(),t.track.visibilityWindow=Number.parseInt(e),t.track.config.visibilityWindow=Number.parseInt(e),t.updateViews()},n={label:"Visibility Window",value:t.track.visibilityWindow,callback:i};t.browser.inputDialog.present(n,e)},i=Ri("<div>");return i.text("Set visibility window"),{object:i,click:e}}(t))),!1!==t.track.removable&&(n.push("<hr/>"),n.push(function(t){var e;return(e=Ri("<div>")).text("Remove track"),{object:e,click:function(){t.browser.removeTrack(t.track)}}}(t))),n},numericDataMenuItems:function(t){const e=[],i=Ri("<div>");i.text("Set data range");return e.push({object:i,click:function(){t.browser.dataRangeDialog.configure({trackView:t}),t.browser.dataRangeDialog.present(Ri(t.trackDiv))}}),void 0!==t.track.logScale&&e.push({object:En("Log scale",t.track.logScale),click:()=>{t.track.logScale=!t.track.logScale,t.repaintViews()}}),e.push({object:En("Autoscale",t.track.autoscale),click:()=>{t.track.autoscale=!t.track.autoscale,t.updateViews()}}),e},trackMenuItemListHelper:function(t,e){var i=[];return t.length>0&&(i=t.map((function(t,i){var n;if(t.name?(n=Ri("<div>")).text(t.name):t.object?n=t.object:"string"==typeof t.label?(n=Ri("<div>")).html(t.label):"string"==typeof t&&(n=t.startsWith("<")?Ri(t):Ri("<div>"+t+"</div>")),0===i&&n.addClass("igv-track-menu-border-top"),t.click){function r(i){t.click(i),e.hide(),i.preventDefault(),i.stopPropagation()}n.on("click",r),n.on("touchend",(function(t){r(t)})),n.on("mouseup",(function(t){t.preventDefault(),t.stopPropagation()}))}return{object:n,init:t.init||void 0}}))),i},showColorPicker:t=>void 0===t.type||"bedtype"===t.type||"alignment"===t.type||"annotation"===t.type||"variant"===t.type||"wig"===t.type};function Ln({trackView:t,label:e,option:i}){const n=Ri("<div>");return n.text(e),{object:n,click:()=>t.presentColorPicker(i)}}function Mn(t){return t.trackView.viewports[0].$trackLabel.text()}const Fn=In.trackMenuItemListHelper,Dn=function(t){this.$popover=Ri("<div>",{class:"igv-menu-popup"}),t.append(this.$popover);let e=Ri("<div>",{class:"igv-menu-popup-header"});this.$popover.append(e),D(e.get(0),(()=>this.$popover.hide())),this.$popoverContent=Ri("<div>"),this.$popover.append(this.$popoverContent),ft(this.$popover.get(0),e.get(0)),e.on("click.menu-popup-dismiss",(function(t){t.stopPropagation(),t.preventDefault()}))};Dn.prototype.presentMenuList=function(t,e,i){if(Bn(),i.length>0){this.$popoverContent.empty(),i=Fn(i,this.$popover);for(let t of i){t.init&&t.init();let e=t.object;0===i.indexOf(t)&&e.removeClass("igv-track-menu-border-top"),e.hasClass("igv-track-menu-border-top")||e.hasClass("igv-menu-popup-check-container")||e.is("div")&&e.addClass("igv-menu-popup-shim"),this.$popoverContent.append(e)}this.$popover.css({left:t+"px",top:e+"px"}),this.$popover.show()}},Dn.prototype.presentTrackContextMenu=function(t,e){this.$popoverContent.empty();const i=(n=e,r=this.$popover.get(0),n.map((t=>{let e;if("string"==typeof t&&"<hr/>"===t)e=document.createElement("hr");else if("string"==typeof t)e=T({class:"context-menu"}),e.innerHTML=t;else if("Node"==typeof t)e=t;else{if("function"==typeof t.init&&t.init(),"checkbox"===t.type)e=Icon.createCheckbox("Show all bases",t.value);else if("color"===t.type){const i=new x({parent:r.parentElement,width:364,colorHandler:e=>t.click(e)});e=T({class:"context-menu"}),"string"==typeof t.label&&(e.innerHTML=t.label);const n=t=>{i.show(),A(r),t.preventDefault(),t.stopPropagation()};e.addEventListener("click",n),e.addEventListener("touchend",n),e.addEventListener("mouseup",(function(t){t.preventDefault(),t.stopPropagation()}))}else e=T({class:"context-menu"}),"string"==typeof t.label&&(e.innerHTML=t.label);if(t.click&&"color"!==t.type){function i(e){t.click(),A(r),e.preventDefault(),e.stopPropagation()}e.addEventListener("click",i),e.addEventListener("touchend",i),e.addEventListener("mouseup",(function(t){t.preventDefault(),t.stopPropagation()}))}}return{object:e,init:t.init}})));var n,r;for(let t of i)this.$popoverContent.get(0).appendChild(t.object);!function(t,e){const{x:i,y:n}=L(t,e.parentNode),{width:r}=e.parentNode.getBoundingClientRect(),{width:s}=e.getBoundingClientRect(),o=i+s;e.style.left=`${o>r?i-(o-r):i}px`,e.style.top=`${n}px`}(t,this.$popover.get(0)),this.$popover.show()},Dn.prototype.dispose=function(){this.$popover.empty(),this.$popoverContent.empty(),Object.keys(this).forEach((function(t){this[t]=void 0}))};const Bn=()=>Ri(".igv-menu-popup").hide();class Nn extends Mi{constructor(t,e,i,n){super(t,e,i,n)}initializationHelper(){this.menuPopup=new Dn(this.trackView.$viewportContainer),this.menuPopup.$popover.hide(),this.addMouseHandlers(),this.$spinner=Ri('<div class="igv-viewport-spinner">'),this.$spinner.append(Tn("spinner")),this.$viewport.append(this.$spinner),this.stopSpinner();const{track:t}=this.trackView;"sequence"!==t.type&&(this.$zoomInNotice=this.createZoomInNotice(this.$content)),t.name&&(this.$trackLabel=Ri('<div class="igv-track-label">'),this.$viewport.append(this.$trackLabel),this.setTrackLabel(t.name),!1===this.browser.trackLabelsVisible&&this.$trackLabel.hide(),this.$trackLabel.click((e=>{let i;e.stopPropagation(),i="function"==typeof t.description?t.description():t.description?`<div title="${t.description}"><div>${t.description}</div></div>`:`<div title="${t.name}"><div>${t.name}</div></div>`,this.popover&&this.popover.dispose(),this.popover=new _(this.trackView.$viewportContainer.get(0)),this.popover.presentContentWithEvent(e,i)})),this.$trackLabel.mousedown((function(t){t.stopPropagation()})),this.$trackLabel.mouseup((function(t){t.stopPropagation()})),this.$trackLabel.mousemove((function(t){t.stopPropagation()})))}setTrackLabel(t){this.trackView.track.name=this.trackView.track.config.name=t,this.$trackLabel.empty(),this.$trackLabel.html(t);const e=this.$trackLabel.text();this.$trackLabel.attr("title",e)}startSpinner(){const t=this.$spinner;t&&(t.addClass("igv-fa5-spin"),t.show())}stopSpinner(){const t=this.$spinner;t&&(t.hide(),t.removeClass("igv-fa5-spin"))}checkZoomIn(){const t=()=>{const t=this.referenceFrame;if("all"!==this.referenceFrame.chr.toLowerCase()||this.trackView.track.supportsWholeGenome()){const e="function"==typeof this.trackView.track.getVisibilityWindow?this.trackView.track.getVisibilityWindow():this.trackView.track.visibilityWindow;return void 0!==e&&e>0&&t.bpPerPixel*this.$viewport.width()>e}return!0};if(!this.viewIsReady())return!1;if(this.$zoomInNotice){if(t()){if(this.canvas&&(this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.tile=void 0),this.$zoomInNotice.show(),this.trackView.track.autoHeight){const t=this.trackView.minHeight||0;this.setContentHeight(t)}return!1}return this.$zoomInNotice.hide(),!0}return!0}shift(){const t=this,e=t.referenceFrame;if(t.canvas&&t.tile&&t.tile.chr===t.referenceFrame.chr&&t.tile.bpPerPixel===e.bpPerPixel){const i=Math.round((t.tile.startBP-e.start)/e.bpPerPixel);t.canvas.style.left=i+"px"}}setTop(t){const e=-t,i=e+this.$viewport.height();Ri(this.contentDiv).css("top",t+"px"),(!this.canvasVerticalRange||this.canvasVerticalRange.bottom<i||this.canvasVerticalRange.top>e)&&this.repaint()}async loadFeatures(){const t=this.referenceFrame,e=t.chr,i=this.browser.genome.getChromosome(e).bpLength,n=3*Ri(this.contentDiv).width()*t.bpPerPixel,r=Math.floor(Math.max(0,t.start-n/3)),s=Math.ceil(Math.min(i,r+n));if(!this.loading||this.loading.start!==r||this.loading.end!==s){this.loading={start:r,end:s},this.startSpinner();try{const i=await this.getFeatures(this.trackView.track,e,r,s,t.bpPerPixel);let n=[];const h=(o=this.browser.roi,a=this.trackView.track.roi,o&&a?o.concat(a):o||a);if(h)for(let i of h){const o=await i.getFeatures(e,r,s,t.bpPerPixel);n.push({track:i,features:o})}return this.tile=new Pn(e,r,s,t.bpPerPixel,i,n),this.loading=!1,this.hideMessage(),this.stopSpinner(),this.tile}catch(t){this.trackView&&!0!==this.trackView.disposed&&(this.showMessage("Error loading track data"),v.presentAlert(t),console.error(t))}finally{this.loading=!1,this.stopSpinner()}var o,a}}async repaint(){if(void 0===this.tile)return;let{features:t,roiFeatures:e,bpPerPixel:i,startBP:n,endBP:r}=this.tile;let s;_n.isWholeGenomeView(this.browser.referenceFrameList[0].chr)?(i=this.referenceFrame.initialEnd/this.$viewport.width(),n=0,r=this.referenceFrame.initialEnd,s=this.$viewport.width()):s=Math.ceil((r-n)/i);const o=this.$viewport.height(),a=e?Math.max(this.getContentHeight(),o):this.getContentHeight();let h=Math.min(a,3*o);if(0===s||0===h)return void(this.canvas&&Ri(this.canvas).remove());const l=Math.max(0,-Ri(this.contentDiv).position().top-o);let c;c="FILL"===this.trackView.track.displayMode?window.devicePixelRatio:!1===this.trackView.track.supportHiDPI?1:window.devicePixelRatio;const u=Math.round((n-this.referenceFrame.start)/this.referenceFrame.bpPerPixel),f=Ri('<canvas class="igv-canvas">').get(0),d=f.getContext("2d");f.style.width=s+"px",f.style.height=h+"px",f.width=c*s,f.height=c*h,d.scale(c,c),f.style.left=u+"px",f.style.top=l+"px",d.translate(0,-l);const p={context:d,features:t,pixelWidth:s,pixelHeight:h,pixelTop:l,bpStart:n,bpEnd:r,bpPerPixel:i,referenceFrame:this.referenceFrame,selection:this.selection,viewport:this,viewportWidth:this.$viewport.width(),viewportContainerX:this.referenceFrame.toPixels(this.referenceFrame.start-n),viewportContainerWidth:this.browser.viewportContainerWidth()};this.draw(p,t,e),this.canvasVerticalRange={top:l,bottom:l+h},this.canvas&&Ri(this.canvas).remove(),Ri(this.contentDiv).append(f),this.canvas=f,this.ctx=d}draw(t,e,i){if(e&&(t.features=e,this.trackView.track.draw(t)),i)for(let e of i)t.features=e.features,e.track.draw(t)}async toSVG(t){if(this.$zoomInNotice&&this.$zoomInNotice.is(":visible"))return;const e=this.referenceFrame,i=t.bpPerPixel,n=t.features,r=t.roiFeatures,s=this.$viewport.width(),o=this.$viewport.height(),a=e.start,h=e.start+s*e.bpPerPixel,l=new $i({width:s,height:o,viewbox:{x:0,y:-Ri(this.contentDiv).position().top,width:s,height:o}}),c={viewport:this,context:l,top:-Ri(this.contentDiv).position().top,pixelTop:0,pixelWidth:s,pixelHeight:o,bpStart:a,bpEnd:h,bpPerPixel:i,referenceFrame:this.referenceFrame,selection:this.selection,viewportWidth:s,viewportContainerX:0,viewportContainerWidth:this.browser.viewportContainerWidth()};return this.draw(c,n,r),l.getSerializedSvg(!0)}setContentHeight(t){t=Math.min(t,32e3),Ri(this.contentDiv).height(t),this.tile&&(this.tile.invalidate=!0)}isLoading(){return this.loading}saveImage(){if(!this.ctx)return;const t=this.canvasVerticalRange?this.canvasVerticalRange.top:0,e=window.devicePixelRatio,i=this.$viewport.width()*e,n=this.$viewport.height()*e,r=-Ri(this.canvas).position().left*e,s=(-Ri(this.contentDiv).position().top-t)*e,o=this.ctx.getImageData(r,s,i,n),a=document.createElement("canvas"),h=a.getContext("2d");a.width=o.width,a.height=o.height,h.putImageData(o,0,0);it((this.$trackLabel.text()?this.$trackLabel.text():"image")+".png",a.toDataURL("image/png"))}saveSVG(){const{width:t,height:e}=this.$viewport.get(0).getBoundingClientRect(),i={width:t,height:e,viewbox:{x:0,y:-Ri(this.contentDiv).position().top,width:t,height:e}},n=new $i(i);this.drawSVGWithContect(n,t,e);const r=n.getSerializedSvg(!0),s=URL.createObjectURL(new Blob([r],{type:"application/octet-stream"}));it(`${this.$trackLabel?this.$trackLabel.text():this.trackView.track.id}.svg`,s)}drawSVGWithContect(t,e,i){let{start:n,bpPerPixel:r}=this.referenceFrame;t.save();const s={context:t,viewport:this,referenceFrame:this.referenceFrame,top:-Ri(this.contentDiv).position().top,pixelTop:0,pixelWidth:e,pixelHeight:i,bpStart:n,bpEnd:n+e*r,bpPerPixel:r,viewportWidth:e,viewportContainerX:0,viewportContainerWidth:this.browser.viewportContainerWidth(),selection:this.selection},o=this.tile?this.tile.features:[],a=this.tile?this.tile.roiFeatures:void 0;this.draw(s,o,a),this.$trackLabel&&!0===this.browser.trackLabelsVisible&&this.renderTrackLabelSVG(t),t.restore()}getCachedFeatures(){return this.tile?this.tile.features:[]}checkContentHeight(){let t=this.trackView.track;if("FILL"===t.displayMode)this.setContentHeight(this.$viewport.height());else if("function"==typeof t.computePixelHeight){let e=this.cachedFeatures;if(e){let i=t.computePixelHeight(e);i!==Ri(this.contentDiv).height()&&this.setContentHeight(i)}}}async getFeatures(t,e,i,n,r){if(this.tile&&this.tile.containsRange(e,i,n,r))return this.tile.features;if("function"==typeof t.getFeatures){const s=await t.getFeatures(e,i,n,r,this);return this.cachedFeatures=s,this.checkContentHeight(),s}}renderTrackLabelSVG(t){const{x:e,y:i,width:n,height:r}=((t,e)=>{const{x:i,y:n,width:r,height:s}=t.getBoundingClientRect(),{x:o,y:a,width:h,height:l}=e.getBoundingClientRect();return{x:o-i,y:a-n,width:h,height:l}})(this.$viewport.get(0),this.$trackLabel.get(0)),{width:s}=t.measureText(this.$trackLabel.text());t.fillStyle="white",t.fillRect(e,i,n,r),t.font="12px Arial",t.fillStyle="rgb(68, 68, 68)";const o=.25*(n-s),a=.7*(r-12);t.fillText(this.$trackLabel.text(),e+o,i+r-a),t.strokeStyle="rgb(68, 68, 68)",t.strokeRect(e,i,n,r)}createZoomInNotice(t){const e=Ri('<div class="zoom-in-notice-container">');t.append(e);const i=Ri("<div>");return e.append(i),i.text("Zoom in to see features"),e.hide(),e}viewIsReady(){return this.browser&&this.browser.referenceFrameList&&this.referenceFrame}addMouseHandlers(){const t=this,e=this.browser;let i,n,r=0;function s(e){if(t.browser.dragObject||t.browser.isScrolling)return t.browser.cancelTrackPan(),e.preventDefault(),e.stopPropagation(),void(t.enableClick=!1);t.browser.cancelTrackPan(),t.browser.endTrackDrag()}function o(t,e){const i=e.referenceFrame,n=L(t,e.contentDiv),r=L(t,e.canvas),s=i.start+i.toBP(n.x);if(void 0!==s&&null!==e.tile)return{event:t,viewport:e,referenceFrame:i,genomicLocation:s,x:n.x,y:n.y,canvasX:r.x,canvasY:r.y}}this.$viewport.on("contextmenu",(function(e){if(t.browser.dragObject)return!1;const i=o(e,t);if(void 0===i)return!1;e.preventDefault();let n=[];"function"==typeof t.trackView.track.contextMenuItemList&&(n=t.trackView.track.contextMenuItemList(i)),n.length>0&&n.push({label:Ri("<HR>")}),n.push({label:"Save Image (PNG)",click:()=>t.saveImage()}),n.push({label:"Save Image (SVG)",click:()=>t.saveSVG()}),t.menuPopup.presentTrackContextMenu(e,n)})),this.$viewport.on("mousedown",(function(n){t.enableClick=!0,e.mouseDownOnViewport(n,t),i=R(n)})),this.$viewport.on("touchstart",(function(n){t.enableClick=!0,e.mouseDownOnViewport(n,t),i=R(n)})),this.$viewport.on("mouseup",s),this.$viewport.on("touchend",s),this.$viewport.on("click",(function(i){t.enableClick&&function(i){if(3===i.which||i.ctrlKey)return;if(Ri(".igv-popover").hide(),e.dragObject||e.isScrolling)return;i.preventDefault(),i.stopPropagation();const s=L(i,t.$viewport.get(0)).x,a=L(i,t.canvas).x,h=t.referenceFrame,l=Math.floor(h.start+h.toBP(a)),c=Date.now();if(c-r<e.constants.doubleClickDelay){n&&(window.clearTimeout(n),n=void 0);const i=Math.round(h.start+h.toBP(s));let r;if("all"===t.referenceFrame.chr.toLowerCase()){const n=e.genome.getChromosomeCoordinate(i).chr;if(1===e.referenceFrameList.length)r=n;else{let i=e.referenceFrameList.map((function(t){return t.locusSearchString}));i[e.referenceFrameList.indexOf(t.referenceFrame)]=n,r=i.join(" ")}e.search(r)}else e.zoomWithScaleFactor(.5,i,t)}else i.shiftKey&&"function"==typeof t.trackView.track.shiftClick?t.trackView.track.shiftClick(l,i):"function"==typeof t.trackView.track.popupData&&(n=setTimeout((function(){const r=function(t,i){const n=o(t,i);if(void 0===n)return;let r=i.trackView.track;const s=r.popupData(n),a=e.fireEvent("trackclick",[r,s]);let h;void 0===a||!0===a?s&&s.length>0&&(h=s.map((t=>{if(t.name){const e=`<span>${t.name}</span>&nbsp&nbsp&nbsp${t.value}`;return`<div title="${t.value}">${e}</div>`}return"<hr>"===t?t:`<div title="${t}">${t}</div>`})).join("")):"string"==typeof a&&(h=a);return h}(i,t);r&&(t.popover&&t.popover.dispose(),t.popover=new _(t.trackView.$viewportContainer.get(0)),t.popover.presentContentWithEvent(i,r)),clearTimeout(n),n=void 0}),e.constants.doubleClickDelay));r=c}(i)}))}}var Pn=function(t,e,i,n,r,s){this.chr=t,this.startBP=e,this.endBP=i,this.bpPerPixel=n,this.features=r,this.roiFeatures=s};Pn.prototype.containsRange=function(t,e,i,n){return this.bpPerPixel===n&&e>=this.startBP&&i<=this.endBP&&t===this.chr},Pn.prototype.overlapsRange=function(t,e,i){return this.chr===t&&i>=this.startBP&&e<=this.endBP};class On{constructor(t){this.viewport=t,this.browser=t.browser,this.$rulerSweeper=Ri('<div class="igv-ruler-sweeper-div">'),Ri(t.contentDiv).append(this.$rulerSweeper),this.namespace=".sweeper_"+I(),this.addMouseHandlers()}disableMouseHandlers(){Ri(document).off(this.namespace),this.viewport.$viewport.off(this.namespace)}addMouseHandlers(){const t=this.browser,e=this;var i,n,r,s,o,a;this.disableMouseHandlers(),i=n=r=void 0,Ri(this.browser.$root).on("mousedown"+this.namespace,(function(t){n=!0,r=L(t,e.viewport.$viewport.get(0)).x,!0===i&&(e.$rulerSweeper.show(),o=1,s=r,e.$rulerSweeper.css({left:s+"px"}),e.$rulerSweeper.width(o))})),Ri(this.browser.$root).on("mousemove"+this.namespace,(function(t){var h;i&&n&&(h=L(t,e.viewport.$viewport.get(0)).x,h=Math.min(h,e.viewport.$viewport.width()),h=Math.max(h,0),a=h-r,o=Math.abs(a),e.$rulerSweeper.width(o),a<0&&(s=r+a,e.$rulerSweeper.css({left:s+"px"})))})),Ri(this.browser.$root).on("mouseup"+this.namespace,(function(r){let a;!0===i&&!0===n&&(i=n=void 0,e.$rulerSweeper.hide(),a={},a.start=e.bp(s),a.end=e.bp(s+o),o>1&&(an(t.genome.getChromosome(e.viewport.referenceFrame.chr).bpLength,a,t.minimumBases()),e.viewport.referenceFrame.bpPerPixel=(Math.round(a.end)-Math.round(a.start))/e.viewport.$viewport.width(),e.viewport.referenceFrame.start=Math.round(a.start),e.viewport.referenceFrame.initialEnd=Math.round(a.end),t.updateViews(e.viewport.referenceFrame)))})),this.viewport.$viewport.on("mousedown"+this.namespace,(function(t){i=!0}))}dispose(){this.disableMouseHandlers()}bp(t){return this.viewport.referenceFrame.start+t*this.viewport.referenceFrame.bpPerPixel}}class zn extends Nn{constructor(t,e,i,n){super(t,e,i,n)}initializationHelper(){this.rulerSweeper=new On(this),function(t,e,i){e.addClass("igv-viewport-ruler");const n=Ri('<div class="igv-multi-locus-panel-close-container">');e.append(n),n.append(Tn("times-circle")),n.click((()=>t.removeMultiLocusPanelWithReferenceFrame(i,!0)))}(this.browser,this.$viewport,this.referenceFrame),this.$rulerLabel=Ri('<div class = "igv-multi-locus-panel-label-div">'),this.$content.append(this.$rulerLabel),this.$rulerLabel.click((()=>this.browser.selectMultiLocusPanelWithReferenceFrame(this.referenceFrame))),this.namespace=`.ruler_track_viewport_${this.browser.referenceFrameList.indexOf(this.referenceFrame)}`,!0===_n.isWholeGenomeView(this.browser.referenceFrameList[0].chr)?Hn.call(this):this.$viewport.off(this.namespace)}updateLocusLabel(){const t=this.referenceFrame.presentLocus(this.$viewport.width());this.$rulerLabel.text(t)}}function Hn(){const t=this.browser.referenceFrameList.indexOf(this.referenceFrame),e=`click${this.namespace}`;this.$viewport.on(e,(e=>{const{x:i}=L(e,this.$viewport.get(0)),n=Math.round(this.referenceFrame.start+this.referenceFrame.toBP(i));let r;const{chr:s}=this.browser.genome.getChromosomeCoordinate(n);if(1===this.browser.referenceFrameList.length)r=s;else{let e=this.browser.referenceFrameList.map((({locusSearchString:t})=>t));e[t]=s,r=e.join(" ")}this.browser.search(r)}))}const Un=(t,e,i,n)=>"ruler"===t.track.type?new zn(t,t.$viewportContainer,e[i],n):"ideogram"===t.track.type?new qi(t,t.$viewportContainer,e[i],n):new Nn(t,t.$viewportContainer,e[i],n);var $n={color:1};$n.parent=$n,$n.left=$n,$n.right=$n;class qn{constructor(){this.root=$n}insert(t,e,i){var n=new Xn(new Zn(t,e,i));for(this.treeInsert(n),n.color=2;n!==this.root&&2===n.parent.color;)if(n.parent===n.parent.parent.left){let t=n.parent.parent.right;2===t.color?(n.parent.color=1,t.color=1,n.parent.parent.color=2,n=n.parent.parent):(n===n.parent.right&&(n=n.parent,jn.call(this,n)),n.parent.color=1,n.parent.parent.color=2,Wn.call(this,n.parent.parent))}else{let t=n.parent.parent.left;2===t.color?(n.parent.color=1,t.color=1,n.parent.parent.color=2,n=n.parent.parent):(n===n.parent.left&&(n=n.parent,Wn.call(this,n)),n.parent.color=1,n.parent.parent.color=2,jn.call(this,n.parent.parent))}this.root.color=1}findOverlapping(t,e){var i=new Zn(t,e,0);if(this.root===$n)return[];var n=Vn.call(this,i,this.root,[]);return n.length>1&&n.sort((function(t,e){return t.low-e.low})),n}logIntervals(){!function t(e,i){e.left!==$n&&t(e.left);e.right!==$n&&t(e.right)}(this.root)}mapIntervals(t){!function e(i){t(i.interval),i.left!==$n&&e(i.left);i.right!==$n&&e(i.right)}(this.root)}treeInsert(t){for(var e=this.root,i=$n;e!==$n;)i=e,e=t.interval.low<=e.interval.low?e.left:e.right;t.parent=i,i===$n?(this.root=t,t.left=t.right=$n):t.interval.low<=i.interval.low?i.left=t:i.right=t,Gn.call(this,t)}}function Vn(t,e,i){return e.interval.overlaps(t)&&i.push(e.interval),e.left!==$n&&e.left.max>=t.low&&Vn.call(this,t,e.left,i),e.right!==$n&&e.right.min<=t.high&&Vn.call(this,t,e.right,i),i}function jn(t){var e=t.right;t.right=e.left,e.left!==$n&&(e.left.parent=t),e.parent=t.parent,t.parent===$n?this.root=e:t.parent.left===t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e,Gn.call(this,t)}function Wn(t){var e=t.left;t.left=e.right,e.right!==$n&&(e.right.parent=t),e.parent=t.parent,t.parent===$n?this.root=e:t.parent.right===t?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e,Gn.call(this,t)}function Gn(t){for(;t!==$n;){var e=t.left.max>t.right.max?t.left.max:t.right.max,i=t.interval.high;t.max=e>i?e:i;var n=t.left.min<t.right.min?t.left.min:t.right.min,r=t.interval.low;t.min=n<r?n:r,t=t.parent}}class Zn{constructor(t,e,i){this.low=t,this.high=e,this.value=i}equals(t){return!!t&&(this===t||this.low===t.low&&this.high===t.high)}compareTo(t){return this.low<t.low?-1:this.low>t.low?1:this.high<t.high?-1:this.high>t.high?1:0}overlaps(t){try{return this.low<=t.high&&t.low<=this.high}catch(t){v.presentAlert(t,void 0)}}}function Xn(t){this.parent=$n,this.left=$n,this.right=$n,this.interval=t,this.color=2}const Yn=function(t,e,i){if(t&&0!==t.length){const n=function(t){const e=new qn,i=t.length,n=Math.max(10,Math.round(i/100));t.sort((function(t,e){return t.start===e.start?0:t.start>e.start?1:-1}));for(let r=0;r<i;r+=n){const s=Math.min(i,r+n),o=t.slice(r,s),a=o[0].start;let h=a;o.forEach((function(t){h=Math.max(h,t.end)})),e.insert(a,h,o)}return e}(t).findOverlapping(e,i);return 0===n.length?[]:(t=[],n.forEach((function(n){const r=n.value,s=r.length;for(let n=0;n<s;n++){const s=r[n];if(s.start>i)break;s.end>e&&t.push(s)}})),t.sort((function(t,e){return t.start-e.start})),t)}return[]};const Kn=z;class Qn{constructor(t){this.browser=t,this.height=40,this.name="",this.id="ruler",this.disableButtons=!0,this.ignoreTrackMenu=!0,this.order=.01*Number.MIN_SAFE_INTEGER,this.removable=!1,this.type="ruler"}updateLocusLabel(){for(let t of this.trackView.viewports)t.updateLocusLabel()}async getFeatures(t,e,i){return[]}computePixelHeight(t){return this.height}draw(t){if(_n.isWholeGenomeView(t.referenceFrame.chr))t.viewport.rulerSweeper.disableMouseHandlers(),this.drawWholeGenome(t);else{t.viewport.rulerSweeper.addMouseHandlers();const e=6,i=2,n=1+Math.floor(t.referenceFrame.toBP(t.pixelWidth));new Jn(n,t).drawTicks(t,e,i,this.height),Ii.strokeLine(t.context,0,this.height-i,t.pixelWidth,this.height-i)}}drawWholeGenome(t){t.context.save(),Ii.fillRect(t.context,0,0,t.pixelWidth,t.pixelHeight,{fillStyle:"white"});let e=t.pixelHeight;for(let i of this.browser.genome.wgChromosomeNames){let n=this.browser.genome.getCumulativeOffset(i),r=this.browser.genome.getChromosome(i).bpLength,s=Math.round(n/t.bpPerPixel),o=Math.round(r/t.bpPerPixel);this.renderChromosomeRect(t.context,s,0,o,e,i)}t.context.restore()}renderChromosomeRect(t,e,i,n,r,s){t.textAlign="center",t.textBaseline="middle",t.font="12px sans-serif",Ii.strokeLine(t,e+n,i,e+n,i+r,{strokeStyle:ct.greyScale(191)});const o=s.startsWith("chr")?s.substring(3):s;n>t.measureText(o).width&&Ii.fillText(t,o,e+n/2,i+r/2,{fillStyle:ct.greyScale(68)})}supportsWholeGenome(){return!0}dispose(){}}class Jn{constructor(t,e){function i(t,e,i,n){this.majorTick=!0===n?2*t:t,this.majorUnit=e,this.halfTick=t/2,this.unitMultiplier=i}(function(t,e){var n,r,s,o;const a=e.context.isSVG||!1;t<10&&i.call(this,1,"bp",1,a);(n=Math.floor(Math.log10(t)))>9?(r="gb",s=1e9):n>6?(r="mb",s=1e6):n>3?(r="kb",s=1e3):(r="bp",s=1);o=Kn(Math.floor(t/s))+" "+r,this.labelWidthBP=Math.round(e.referenceFrame.toBP(e.context.measureText(o).width)),t/Math.pow(10,n-1)<25?i.call(this,Math.pow(10,n-1),r,s,a):i.call(this,Math.pow(10,n)/2,r,s,a)}).call(this,t,e)}drawTicks(t,e,i,n){var r,s,o,a,h,l,c;for(r=Math.floor(t.bpStart/this.majorTick)-1,h=0,l=0,o=0;o<t.pixelWidth;)s=Math.floor(r*this.majorTick),o=Math.round(t.referenceFrame.toPixels(s-1-t.bpStart+.5)),a=Kn(Math.floor(s/this.unitMultiplier))+" "+this.majorUnit,h=t.context.measureText(a).width,l=Math.round(o-h/2),Ii.fillText(t.context,a,l,n-e/.75),Ii.strokeLine(t.context,o,n-e,o,n-i),++r;for(r=Math.floor(t.bpStart/this.halfTick)-1,o=0;o<t.pixelWidth;)s=Math.floor(r*this.halfTick),o=Math.round(t.referenceFrame.toPixels(s-1-t.bpStart+.5)),(c=s/this.unitMultiplier)===Math.floor(c)&&this.majorTick/this.labelWidthBP>8&&(a=Kn(Math.floor(c))+" "+this.majorUnit,l=o-(h=t.context.measureText(a).width)/2,Ii.fillText(t.context,a,l,n-e/.75)),Ii.strokeLine(t.context,o,n-e,o,n-i),++r}description(t){}}const tr=new Set(["ruler","sequence","ideogram"]);class er{constructor(t,e,i){this.browser=t,this.track=i,i.trackView=this;const n=Ri('<div class="igv-track">');this.trackDiv=n.get(0),e.append(n),this.namespace=".trackview_"+I(),i instanceof Qn&&(this.trackDiv.dataset.rulerTrack="rulerTrack"),i.height&&(this.trackDiv.style.height=i.height+"px"),this.appendLeftHandGutter(n),this.$viewportContainer=Ri('<div class="igv-viewport-container">'),n.append(this.$viewportContainer),ir(t,t.referenceFrameList,this),"ideogram"===i.type||"ruler"===i.type||this.attachDragWidget(n,this.$viewportContainer),!0===i.ignoreTrackMenu||this.appendRightHandGutter(n);const r=[],s=i.color||i.defaultColor;O(s)&&r.push(s),i.altColor&&O(i.altColor)&&r.push(i.altColor);const o=r.map((t=>t.startsWith("#")?t:t.startsWith("rgb(")?ct.rgbToHex(t):ct.colorNameToHex(t))),a={parent:this.trackDiv,top:void 0,left:void 0,width:432,height:void 0,defaultColors:o,colorHandler:t=>{this.track.color=t,this.repaintViews()}};this.colorPicker=new x(a),a.colorHandler=t=>{this.track.altColor=t,this.repaintViews()},this.altColorPicker=new x(a)}renderSVGContext(t,e){for(let i of this.viewports){const n=i.browser.referenceFrameList.indexOf(i.referenceFrame),{y:r,width:s}=i.$viewport.get(0).getBoundingClientRect();let o={deltaX:e.deltaX+n*s,deltaY:e.deltaY+r};i.renderSVGContext(t,o)}}attachScrollbar(t,e,i){"hidden"===e.find(".igv-viewport").css("overflow-y")&&(this.scrollbar=new or(e,i),this.scrollbar.$outerScroll.insertAfter(e))}removeViewportForReferenceFrame(t){let e=-1;for(let i=0;i<this.viewports.length;i++)if(this.viewports[i].referenceFrame===t){e=i;break}e>=0&&(this.viewports[e].$viewport.remove(),this.viewports.splice(e,1),this.updateViewportForMultiLocus())}updateViewportForMultiLocus(){"ruler"===this.track.type&&(this.viewports.length>1?(this.$viewportContainer.find(".igv-multi-locus-panel-close-container").show(),this.$viewportContainer.find(".igv-multi-locus-panel-label-div").show(),this.track.updateLocusLabel()):(this.$viewportContainer.find(".igv-multi-locus-panel-close-container").hide(),this.$viewportContainer.find(".igv-multi-locus-panel-label-div").hide()))}appendLeftHandGutter(t){const e=Ri('<div class="igv-left-hand-gutter">');if(this.leftHandGutter=e[0],t.append(e),"function"==typeof this.track.paintAxis){this.track.dataRange&&(e.click((t=>{this.browser.dataRangeDialog.configure({trackView:self}),this.browser.dataRangeDialog.present(Ri(self.trackDiv))})),e.addClass("igv-clickable"));const t=Ri('<canvas class ="igv-canvas">');e.append(t),this.controlCanvas=t.get(0),this.resizeControlCanvas(e.outerWidth(),e.outerHeight())}}appendRightHandGutter(t){let e=Ri('<div class="igv-right-hand-gutter">');t.append(e),this.createTrackGearPopup(e)}dataRange(){return this.track.dataRange?this.track.dataRange:void 0}setDataRange(t,e){void 0!==t&&(this.track.dataRange.min=t),void 0!==e&&(this.track.dataRange.max=e),this.track.autoscale=!1,this.repaintViews()}presentColorPicker(t){"altColor"===t?this.altColorPicker.show():this.colorPicker.show()}setTrackHeight(t,e){e||(this.track.minHeight&&(t=Math.max(this.track.minHeight,t)),this.track.maxHeight&&(t=Math.min(this.track.maxHeight,t))),this.track.height=t,this.track.config.height=t,Ri(this.trackDiv).height(t),"function"!=typeof this.track.computePixelHeight&&(this.viewports.forEach((function(e){e.setContentHeight(t),e.tile&&(e.tile.invalidate=!0)})),this.repaintViews()),this.resizeControlCanvas(Ri(this.leftHandGutter).outerWidth(),t),this.track.paintAxis&&this.track.paintAxis(this.controlCtx,Ri(this.controlCanvas).width(),Ri(this.controlCanvas).height()),this.scrollbar&&this.scrollbar.update()}isLoading(){for(let t=0;t<this.viewports.length;t++)if(this.viewports[t].isLoading())return!0}resize(t){for(let e of this.viewports)e.setWidth(t);const e=Ri(this.leftHandGutter);this.resizeControlCanvas(e.outerWidth(),e.outerHeight()),this.updateViews(!0)}repaintViews(){for(let t of this.viewports)t.repaint();this.track.paintAxis&&this.track.paintAxis(this.controlCtx,Ri(this.controlCanvas).width(),Ri(this.controlCanvas).height())}async updateViews(t){if(!this.browser||!this.browser.referenceFrameList)return;const e=this.viewports.filter((t=>t.isVisible()));e.forEach((function(t){t.shift()}));const i=this.viewportsToReload(t);for(let t of i)await t.loadFeatures();if(this.disposed)return;const n=this.browser.dragObject;if(!n&&this.track.autoscale){let t=[];for(let i of e){const e=i.referenceFrame,n=e.start,r=n+e.toBP(Ri(i.contentDiv).width());if(i.tile&&i.tile.features)if("function"==typeof i.tile.features.getMax){const e=i.tile.features.getMax(n,r);t.push({value:e})}else t=t.concat(Yn(i.tile.features,n,r))}"function"==typeof this.track.doAutoscale?this.track.dataRange=this.track.doAutoscale(t):this.track.dataRange=on(t)}if(n||!this.track.autoscale&&!this.track.autoscaleGroup)for(let t of i)t.repaint();else for(let t of e)t.repaint();this.adjustTrackHeight()}async getInViewFeatures(t){if(!this.browser||!this.browser.referenceFrameList)return[];const e=this.viewportsToReload(t).map((function(t){return t.loadFeatures()}));await Promise.all(e);let i=[];for(let t of this.viewports)if(t.tile&&t.tile.features){const e=t.referenceFrame,n=e.start,r=n+e.toBP(Ri(t.contentDiv).width());if("function"==typeof t.tile.features.getMax){const e=t.tile.features.getMax(n,r);i.push({value:e})}else i=i.concat(Yn(t.tile.features,n,r))}return i}checkContentHeight(){this.viewports.forEach((function(t){t.checkContentHeight()})),this.adjustTrackHeight()}adjustTrackHeight(){var t=sr(this.viewports);if(this.track.autoHeight?this.setTrackHeight(t,!1):this.track.paintAxis&&this.track.paintAxis(this.controlCtx,Ri(this.controlCanvas).width(),Ri(this.controlCanvas).height()),this.scrollbar){const t=this.viewports[0].getContentTop(),e=this.viewports.map((t=>t.getContentHeight())),i=Math.min(...e),n=Math.min(0,this.$viewportContainer.height()-i);t<n&&this.viewports.forEach((function(t){Ri(t.contentDiv).css("top",n+"px")})),this.scrollbar.update()}}resizeControlCanvas(t,e){var i=window.devicePixelRatio;if(this.leftHandGutter){this.controlCanvas&&Ri(this.controlCanvas).remove();var n=Ri('<canvas class ="igv-canvas">');this.controlCanvas=n[0],Ri(this.leftHandGutter).append(n),this.controlCanvas.height=i*e,this.controlCanvas.width=i*t,this.controlCanvas.style.height=e+"px",this.controlCanvas.style.width=t+"px",this.controlCtx=this.controlCanvas.getContext("2d"),this.controlCtx.scale(i,i)}}attachDragWidget(t,e){const i=this,n=this.browser;this.$trackDragScrim=Ri('<div class="igv-track-drag-scrim">'),e.append(this.$trackDragScrim),this.$trackDragScrim.hide(),i.$trackManipulationHandle=Ri('<div class="igv-track-manipulation-handle">'),t.append(i.$trackManipulationHandle),i.$trackManipulationHandle.on("mousedown",(function(t){t.preventDefault(),t.stopPropagation(),i.$trackDragScrim.show(),n.startTrackDrag(i)})),i.$trackManipulationHandle.on("mouseup",(function(t){t.preventDefault(),t.stopPropagation(),n.endTrackDrag(),i.$trackDragScrim.hide()})),t.on("mouseenter",(function(t){n.dragTrack&&(t.preventDefault(),t.stopPropagation(),n.updateTrackDrag(i))})),i.$trackManipulationHandle.on("mouseleave",(function(t){n.dragTrack||(t.preventDefault(),t.stopPropagation(),i.$trackDragScrim.hide())}))}viewportsToReload(t){return this.viewports.filter((function(e){if(!e.isVisible())return!1;if(e.checkZoomIn()){const i=e.referenceFrame,n=e.referenceFrame.chr,r=i.start,s=r+i.toBP(Ri(e.contentDiv).width()),o=i.bpPerPixel;return t||!e.tile||e.tile.invalidate||!e.tile.containsRange(n,r,s,o)}return!1}))}createTrackGearPopup(t){let e=Ri("<div>",{class:"igv-trackgear-container"});t.append(e),e.append(Tn("cog")),this.trackGearPopup=new Dn(t),this.trackGearPopup.$popover.hide(),e.click((t=>{t.preventDefault(),t.stopPropagation(),this.trackGearPopup.presentMenuList(-this.trackGearPopup.$popover.width(),0,In.trackMenuItemList(this))}))}dispose(){const t=this;this.$trackManipulationHandle&&this.$trackManipulationHandle.off(),this.scrollbar&&this.scrollbar.dispose(),Ri(document).off(this.namespace),"function"==typeof this.track.dispose&&this.track.dispose();var e=this.track;"function"==typeof e.dispose&&e.dispose(),Object.keys(e).forEach((function(t){e[t]=void 0})),this.viewports.forEach((function(t){t.dispose()})),Object.keys(this).forEach((function(e){t[e]=void 0})),this.disposed=!0}scrollBy(t){this.scrollbar.moveScrollerBy(t)}}function ir(t,e,i){const n=t.calculateViewportWidth(e.length);i.viewports=[];for(let t of e){const r=Un(i,e,e.indexOf(t),n);i.viewports.push(r)}if(nr(i.viewports,i.$viewportContainer),i.updateViewportForMultiLocus(),!1===tr.has(i.track.type))i.attachScrollbar(Ri(i.trackDiv),i.$viewportContainer,i.viewports);else{Ri("<div>",{class:"igv-scrollbar-shim"}).insertAfter(i.$viewportContainer)}}function nr(t,e){const i=Ri(".igv-track-container");i.find(".igv-multi-locus-separator").remove();const{x:n}=rr(i.get(0));if(e.find(".igv-viewport-multi-locus-gap-shim").remove(),t.length>1)for(let e of t)if(t.indexOf(e)<=t.length-2){const{$viewport:t}=e,r=Ri('<div class="igv-viewport-multi-locus-gap-shim">');r.insertAfter(t);const{x:s}=rr(r.get(0)),o=Ri('<div class="igv-multi-locus-separator">');i.append(o),o.get(0).style.left=s-n+"px"}}function rr(t){const{x:e,y:i}=t.getBoundingClientRect();return{x:e+(window.pageXOffset||document.documentElement.scrollLeft),y:i+(window.pageYOffset||document.documentElement.scrollTop)}}function sr(t){const e=t.map((t=>t.getContentHeight()));return Math.max(...e)}class or{constructor(t,e){let i;const n=t=>{t.preventDefault(),t.stopPropagation();const e=R(t);this.moveScrollerBy(e.y-i),i=e.y},r=t=>{Ri(document).off(this.namespace)},s=".trackscrollbar"+I();this.namespace=s,this.$outerScroll=Ri('<div class="igv-scrollbar-outer-div">'),this.$innerScroll=Ri("<div>"),this.$outerScroll.append(this.$innerScroll),this.$viewportContainer=t,this.viewports=e,this.$innerScroll.on("mousedown",(t=>{t.preventDefault();const e=R(t);i=e.y,Ri(document).on("mousemove"+s,n),Ri(document).on("mouseup"+s,r),Ri(document).on("mouseleave"+s,r),t.stopPropagation()})),this.$innerScroll.on("click",(t=>{t.stopPropagation()})),this.$outerScroll.on("click",(t=>{this.moveScrollerBy(t.offsetY-this.$innerScroll.height()/2),t.stopPropagation()}))}moveScrollerBy(t){const e=this.$innerScroll.position().top+t;this.moveScrollerTo(e)}moveScrollerTo(t){const e=this.$outerScroll.height(),i=this.$innerScroll.height(),n=Math.min(Math.max(0,t),e-i),r=sr(this.viewports),s=-Math.round(n*(r/this.$viewportContainer.height()));this.$innerScroll.css("top",n+"px");for(let t of this.viewports)t.setTop(s)}dispose(){Ri(window).off(this.namespace),this.$innerScroll.off()}update(){const t=this.$viewportContainer.height(),e=sr(this.viewports),i=Math.round(t/e*t);e>t?(this.$innerScroll.show(),this.$innerScroll.height(i)):this.$innerScroll.hide()}}function ar(t,e){if(!(t.length<6)){var i={chr1:t[0],start1:Number.parseInt(t[1]),end1:Number.parseInt(t[2]),chr2:t[3],start2:Number.parseInt(t[4]),end2:Number.parseInt(t[5])};if(!(isNaN(i.start1)||isNaN(i.end1)||isNaN(i.start2)||isNaN(i.end2))){if(t.length>6&&"."!==t[6]&&(i.name=t[6]),t.length>7&&"."!==t[7]&&(i.score=parseFloat(t[7])),t.length>8&&"."!==t[8]&&(i.strand1=t[8]),t.length>9&&"."!==t[9]&&(i.strand2=t[9]),e){const n=e.colorColumn;n&&n<t.length&&(i.color=ct.createColorString(t[n]));const r=e.thicknessColumn;r&&r<t.length&&(i.thickness=t[r]),t.length>10&&e.columnNames&&e.columnNames.length===t.length&&(i.extras=t.slice(10))}return i.chr1===i.chr2&&(i.chr=i.chr1,i.start=Math.min(i.start1,i.start2),i.end=Math.max(i.end1,i.end2)),i}}}function hr(t,e){if(!(t.length<8))return{chr:t[0],start:Number.parseInt(t[1]),end:Number.parseInt(t[2]),color:ct.createColorString(t[6]),value:Number.parseFloat(t[7])}}function lr(t,e){if(!(t.length<6))return{chr:t[0],start:t[1],end:t[2],chr1:t[8],start1:Number.parseInt(t[9]),end1:Number.parseInt(t[10]),chr2:t[13],start2:Number.parseInt(t[14]),end2:Number.parseInt(t[15]),name:t[3],score:Number.parseFloat(t[4]),value:Number.parseFloat(t[5]),color:"."===t[7]?void 0:"0"===t[7]?"rgb(0,0,0)":t[7]}}const cr=["Name","gene_name","gene","gene_id","alias","locus","name"];function ur(t,e){var i,n,r,s,o,a,h,l,c,u,f=e.format;if(t.length<9)return null;i=t[0],o=t[2],n=parseInt(t[3])-1,r=parseInt(t[4]),a="."===t[5]?0:parseFloat(t[5]),s=t[6],"."===t[7]||parseInt(t[7]);var d="gff3"===f?"=":/\s+/,p=fr(h=t[8],d);for(let[t,e]of Object.entries(p)){const i=t.toLowerCase();if("color"===i||"colour"===i)l=ct.createColorString(e);else if("gff3"===f)try{p[t]=unescape(e)}catch(i){p[t]=e,console.error(`Malformed gff3 attibute value: ${e}`)}}if(e.nameField)c=p[e.nameField];else for(u=0;u<cr.length;u++)if(p.hasOwnProperty(cr[u])){e.nameField=cr[u],c=p[e.nameField];break}return{id:p.ID||p.transcript_id,parent:p.Parent,name:c,type:o,chr:i,start:n,end:r,score:a,strand:s,color:l,attributeString:h,delim:d,popupData:dr}}function fr(t,e){var i={};for(let n of t.split(";")){const t=n.trim().split(e,2);if(2===t.length){const e=t[0].trim();let n=t[1].trim();n.startsWith('"')&&n.endsWith('"')&&(n=n.substr(1,n.length-2)),i[e]=n}}return i}function dr(t){const e=this.attributeString.split(";"),i=[];this.name&&i.push({name:"name:",value:this.name}),i.push({name:"type:",value:this.type});for(let t of e){const e=t.trim().split(this.delim,2);if(2===e.length&&void 0!==e[1]){const t=e[0].trim();if("name"===t.toLowerCase())continue;let n=e[1].trim();n.startsWith('"')&&n.endsWith('"')&&(n=n.substr(1,n.length-2)),i.push({name:t+":",value:n})}}return i.push({name:"position:",value:`${this.chr}:${z(this.start+1)}-${z(this.end)}`}),i}function pr(t,e){if(t.length<3)return;e&&e.gffTags;const i=t[0],n=parseInt(t[1]),r=t.length>2?parseInt(t[2]):n+1;if(isNaN(n)||isNaN(r))throw Error(`Unparsable bed record: ${t.join("\t")}`);const s={chr:i,start:n,end:r,score:1e3};try{if(t.length>3){if(t[3].indexOf(";")>0&&t[3].indexOf("=")>0){const e=fr(t[3],"=");for(let t of cr)if(e.hasOwnProperty(t)){s.name=e[t],delete e[t];break}s.attributes=e}s.name||(s.name="."===t[3]?"":t[3])}if(t.length>4&&(s.score="."===t[4]?0:parseFloat(t[4]),isNaN(s.score)))return s;if(t.length>5&&(s.strand=t[5],"."!==s.strand&&"+"!==s.strand&&"-"!==s.strand))return s;if(t.length>6&&(s.cdStart=parseInt(t[6]),isNaN(s.cdStart)))return s;if(t.length>7&&(s.cdEnd=parseInt(t[7]),isNaN(s.cdEnd)))return s;if(t.length>8&&"."!==t[8]&&"0"!==t[8]&&(s.color=ct.createColorString(t[8])),t.length>11){const e=parseInt(t[9]);if(e>1e3)return s;const i=t[10].replace(/,$/,"").split(","),r=t[11].replace(/,$/,"").split(",");if(i.length!==r.length||e!==i.length)return s;const o=[];for(let t=0;t<e;t++){const e=n+parseInt(r[t]),s=e+parseInt(i[t]);o.push({start:e,end:s})}vr(o,s.cdStart,s.cdEnd),s.exons=o}if(e){let i=e.thicknessColumn,n=e.colorColumn;n&&n<t.length&&(s.color=ct.createColorString(t[n])),i&&i<t.length&&(s.thickness=t[i])}}catch(t){}return s}function gr(t,e){if(t.length<=15)return;return{swScore:Number.parseInt(t[1]),milliDiv:Number.parseInt(t[2]),milliDel:Number.parseInt(t[3]),milliIns:Number.parseInt(t[4]),chr:t[5],start:Number.parseInt(t[6]),end:Number.parseInt(t[7]),strand:t[9],repName:t[10],repClass:t[11],repFamily:t[12],repStart:Number.parseInt(t[13]),repEnd:Number.parseInt(t[14]),repLeft:Number.parseInt(t[15])}}function mr(t,e){var i=void 0===e.shift?0:1;if(t.length<=9+i)return;const n=parseInt(t[5+i]),r=parseInt(t[6+i]);var s={name:t[0+i],chr:t[1+i],strand:t[2+i],start:parseInt(t[3+i]),end:parseInt(t[4+i]),cdStart:n,cdEnd:r,id:t[0+i]},o=parseInt(t[7+i]),a=t[8+i].split(","),h=t[9+i].split(","),l=[];for(let t=0;t<o;t++){const e=parseInt(a[t]),i=parseInt(h[t]);l.push({start:e,end:i})}return vr(l,n,r),s.exons=l,s}function br(t,e){var i=void 0===e.shift?0:1;if(t.length<=11+i)return;const n=parseInt(t[5+i]),r=parseInt(t[6+i]),s={name:t[11+i],chr:t[1+i],strand:t[2+i],start:parseInt(t[3+i]),end:parseInt(t[4+i]),cdStart:n,cdEnd:r,id:t[0+i]},o=parseInt(t[7+i]),a=t[8+i].split(","),h=t[9+i].split(","),l=[];for(let t=0;t<o;t++){const e=parseInt(a[t]),i=parseInt(h[t]);l.push({start:e,end:i})}return vr(l,n,r),s.exons=l,s}function wr(t,e){var i=void 0===e.shift?0:1;if(t.length<=10+i)return;const n=parseInt(t[6+i]),r=parseInt(t[7+i]);var s={name:t[0+i],id:t[1+i],chr:t[2+i],strand:t[3+i],start:parseInt(t[4+i]),end:parseInt(t[5+i]),cdStart:n,cdEnd:r},o=parseInt(t[8+i]),a=t[9+i].split(","),h=t[10+i].split(","),l=[];for(let t=0;t<o;t++){const e=parseInt(a[t]),i=parseInt(h[t]);l.push({start:e,end:i})}return vr(l,n,r),s.exons=l,s}function vr(t,e,i){for(let n of t){const t=n.end,r=n.start;t<e||r>i?n.utr=!0:(e>=r&&e<=t&&(n.cdStart=e),i>=r&&i<=t&&(n.cdEnd=i))}}function yr(t,e){var i,n,r,s,o,a,h;if(!(t.length<9))return i=t[0],n=parseInt(t[1]),r=parseInt(t[2]),o=t[3],a=parseFloat(t[4]),s=t[5].trim(),h=parseFloat(t[6]),0===a&&(a=h),{chr:i,start:n,end:r,name:o,score:a,strand:s,signal:h,pValue:parseFloat(t[7]),qValue:parseFloat(t[8])}}function xr(t,e){if(t.length<=3)return;const i={chr:t[0],start:parseInt(t[1]),end:parseInt(t[2]),value:parseFloat(t[3])};if(e){let n=e.colorColumn;n&&n<t.length&&(i.color=ct.createColorString(t[n]))}return i}function kr(t,e){const i=e.wig;if(i&&"fixedStep"===i.format){const e=i.index*i.step+i.start,n=e+i.span,r=parseFloat(t[0]);return++i.index,isNaN(r)?null:{chr:i.chrom,start:e,end:n,value:r}}if(i&&"variableStep"===i.format){if(t.length<2)return null;const e=parseInt(t[0],10)-1,n=e+i.span,r=parseFloat(t[1]);return isNaN(r)?null:{chr:i.chrom,start:e,end:n,value:r}}return xr(t)}function Sr(t,e){if(t.length<6)return;const i=["bin","chr","start","end","name","score","strand","refNCBI","refUCSC","observed","molType","class","valid","avHet","avHetSE","func","locType","weight","exceptions","submitterCount","submitters","alleleFreqCount","alleles","alleleNs","alleleFreqs","bitfields"],n={chr:t[1],start:Number.parseInt(t[2]),end:Number.parseInt(t[3]),name:t[4],score:Number.parseInt(t[5])},r=Math.min(t.length,i.length);for(let e=6;e<r;e++)n[i[e]]=t[e];return n}function _r(t,e){if(!(t.length<7)){var i=t[0],n=t[1],r=parseInt(t[2]),s=parseInt(t[3]),o=parseInt(t[4]),a=parseInt(t[5]),h=t[6],l={chr:i,name:n,junction_left:r,junction_right:s,num_junction_reads:o,num_spanning_frags:a,spanning_frag_coords:[],start:-1,end:-1},c=r,u=s;if(a>0)for(var f=h.split(","),d=0;d<f.length;d++){var p=f[d].split("-"),g=p[0],m=p[1];g<c&&(c=g),m>u&&(u=m),l.spanning_frag_coords.push({left:g,right:m})}return l.start=c,l.end=u,l}}function Cr(t,e){if(t.length<7)return null;const i={chr:t[0],start:parseInt(t[1])-1,end:parseInt(t[2]),"Strongest SNP-risk allele":t[3],"Disease/Phenotype":t[4],"P-value":t[5],"Odds ratio or beta":t[6]};return t.length>6&&(i.PUBMEDID=`<a target = "blank" href = "https://www.ncbi.nlm.nih.gov/pubmed/${t[7]}">${t[7]}</a>`),i}function Er(t,e){const i=e.customFormat;if(t.length<i.fields.length)return;const n=i.coords||0,r=t[i.chr],s=parseInt(t[i.start])-n,o={chr:r,start:s,end:void 0!==i.end?parseInt(t[i.end]):s+1};return i.fields&&i.fields.forEach((function(e,n){n!==i.chr&&n!==i.start&&n!==i.end&&(o[e]=t[n])})),o}function Tr(t,e){const i=e.columnNames;if(!i)throw Error("Sample names are not defined.   Missing column headers?");const n=i.length-3,r=t[0],s=parseInt(t[1]),o=parseInt(t[2]),a=t.slice(3).map(parseFloat);return a.length==n?{chr:r,start:s,end:o,values:a}:void console.warn(`${r}:${s}-${o} row contains ${a.length} sample columns instead of the expected ${n} columns. Skipping...`)}class Ar{constructor(t){this.config=t,this.header={},t.nameField&&(this.header.nameField=t.nameField),this.skipRows=0,t.decode?(this.decode=t.decode,this.delimiter=t.delimiter||"\t"):t.format&&(this.header.format=t.format.toLowerCase(),this.setDecoder(this.header.format)),this.delimiter||(this.delimiter="\t")}async parseHeader(t){let e,i,n=this.header;for(;void 0!==(i=await t.nextLine());)if(i.startsWith("track")||i.startsWith("#track")){let t=Rr(i);Object.assign(n,t)}else if(i.startsWith("browser"));else if(i.startsWith("#columns")){let t=Ir(i);Object.assign(n,t)}else if(i.startsWith("##gff-version 3"))n.format="gff3";else if(i.startsWith("#gffTags"))n.gffTags=!0;else{if(i.startsWith("fixedStep")||i.startsWith("variableStep"))break;if(i.startsWith("#")){const t=i.split(this.delimiter||"\t");t.length>1&&(e=t)}else{this.setDecoder(n.format);try{const t=i.split(this.delimiter||"\t"),r=Object.assign({columnNames:e},n);if(this.decode(t,r))break;t.length>1&&(e=t)}catch(t){}}}if(e){n.columnNames=e;for(let t=0;t<e.length;t++)"color"===e[t]||"colour"===e[t]?n.colorColumn=t:"thickness"===e[t]&&(n.thicknessColumn=t)}return this.header=n,n}async parseFeatures(t){const e=[],i=this.decode,n=this.header.format,r=this.delimiter||"\t";let s,o=0;for(;void 0!==(s=await t.nextLine());){if(o++,o<=this.skipRows)continue;if(!s||s.startsWith("track")||s.startsWith("#")||s.startsWith("browser"))continue;if("wig"===n&&s.startsWith("fixedStep")){this.header.wig=Lr(s);continue}if("wig"===n&&s.startsWith("variableStep")){this.header.wig=Mr(s);continue}const t=s.split(r);if(t.length<1)continue;const a=i(t,this.header);a&&e.push(a)}return i===ar&&function(t){if(0==t.length)return;const e=t[0];if(void 0===e.score&&void 0!==e.name){for(let e of t)if(!("number"==typeof(i=e.name)?i-i==0:"string"==typeof i&&""!==i.trim()&&(Number.isFinite?Number.isFinite(+i):isFinite(+i)))&&"."!==e.name)return;for(let e of t)e.score=parseFloat(e.name),delete e.name}var i;const n=t.filter((t=>t.chr1!==t.chr2));for(let e of n){const i=Object.assign({},e);i.dup=!0,t.push(i),e.chr=e.chr1,e.start=e.start1,e.end=e.end1,i.chr=i.chr2,i.start=i.start2,i.end=i.end2}}(e),e}setDecoder(t){switch(t){case"narrowpeak":case"broadpeak":case"regionpeak":case"peaks":this.decode=yr,this.delimiter=this.config.delimiter||/\s+/;break;case"bedgraph":this.decode=xr,this.delimiter=/\s+/;break;case"wig":this.decode=kr,this.delimiter=this.config.delimiter||/\s+/;break;case"gff3":case"gff":case"gtf":this.decode=ur,this.delimiter="\t";break;case"fusionjuncspan":this.decode=_r,this.delimiter=this.config.delimiter||/\s+/;break;case"gtexgwas":this.skipRows=1,this.decode=Cr,this.delimiter="\t";break;case"refflat":this.decode=wr,this.delimiter=this.config.delimiter||/\s+/;break;case"genepred":this.decode=mr,this.delimiter=this.config.delimiter||/\s+/;break;case"genepredext":this.decode=br,this.delimiter=this.config.delimiter||/\s+/;break;case"ensgene":this.decode=mr,this.header.shift=1,this.delimiter=this.config.delimiter||/\s+/;break;case"refgene":this.decode=br,this.delimiter=this.config.delimiter||/\s+/,this.header.shift=1;break;case"bed":this.decode=pr,this.delimiter=this.config.delimiter||/\s+/;break;case"bedpe":this.decode=ar,this.delimiter=this.config.delimiter||"\t";break;case"bedpe-domain":this.decode=hr,this.headerLine=!0,this.delimiter=this.config.delimiter||"\t";break;case"bedpe-loop":this.decode=ar,this.delimiter=this.config.delimiter||"\t",this.header={colorColumn:7};break;case"interact":this.decode=lr,this.delimiter=this.config.delimiter||/\s+/;break;case"snp":this.decode=Sr,this.delimiter="\t";break;case"rmsk":this.decode=gr,this.delimiter="\t";break;case"gcnv":this.decode=Tr,this.delimiter="\t";break;default:const i=(e=t,nt&&nt[e]?function(t){const e=t.fields,i=["chr","start","end"];for(let n=0;n<e.length;n++)for(let r of i)r===e[n]&&(t[r]=n);return t}(nt[e]):void 0);void 0!==i?(this.decode=Er,this.header.customFormat=i,this.delimiter=i.delimiter||"\t"):(this.decode=pr,this.delimiter=this.config.delimiter||/\s+/)}var e}}function Rr(t){const e={},i=t.split(/(?:")([^"]+)(?:")|([^\s"]+)(?=\s+|$)/g);let n;const r=[];for(let t of i)t&&0!==t.trim().length&&(t.endsWith("=")?n=t:n?(r.push(n+t),n=void 0):r.push(t));for(let t of r){if(!t)return;var s=t.split("=",2);if(2===s.length){const t=s[0].trim(),i=s[1].trim();if(e.hasOwnProperty(t)){let n=e[t];Array.isArray(n)?n.push(i):e[t]=[n,i]}else e[t]=i}}return"interact"==e.type?e.format="interact":"gcnv"===e.type&&(e.format="gcnv"),e}function Ir(t){let e={},i=t.split(/\s+/);if(2===i.length){i[1].split(";").forEach((function(t){let i=t.split("=");"color"===i[0]?e.colorColumn=Number.parseInt(i[1])-1:"thickness"===i[0]&&(e.thicknessColumn=Number.parseInt(i[1])-1)}))}return e}function Lr(t){const e=t.split(/\s+/);return{format:"fixedStep",chrom:e[1].split("=")[1],start:parseInt(e[2].split("=")[1],10)-1,step:parseInt(e[3].split("=")[1],10),span:e.length>4?parseInt(e[4].split("=")[1],10):1,index:0}}function Mr(t){const e=t.split(/\s+/);return{format:"variableStep",chrom:e[1].split("=")[1],span:e.length>2?parseInt(e[2].split("=")[1],10):1}}function Fr(t){return"string"==typeof t||t instanceof String?new Dr(t):new Br(t)}class Dr{constructor(t){this.data=t,this.ptr=0}nextLine(){var t=this.ptr,e=this.data.indexOf("\n",t),i=this.data;if(e>0)return this.ptr=e+1,e>t&&"\r"===i.charAt(e-1)?i.substring(t,e-1):i.substring(t,e);var n=i.length;return this.ptr=n,t>=n?void 0:i.substring(t)}}class Br{constructor(t){this.data=t,this.length=this.data.length,this.ptr=0}nextLine(){var t,e;if(e="",!(this.ptr>=this.length)){for(var i=this.ptr;i<this.length;i++)if("\r"!==(t=String.fromCharCode(this.data[i]))){if("\n"===t)break;e+=t}return this.ptr=i+1,e}}}class Nr{async parseHeader(t){let e;for(;void 0!==(e=await t.nextLine());)if(!e.startsWith("#")){const t=e.split("\t");this.header={headings:t};break}return this.header}async parseFeatures(t){const e=[];this.header||(this.header=await this.parseHeader(await t.nextLine()));const i=this.header.headings.length-1;let n;for(;void 0!==(n=await t.nextLine());){const t=n.split("\t");t.length>i&&e.push({sampleKey:t[0],sample:t[0],chr:t[1],start:parseInt(t[2]),end:parseInt(t[3]),value:parseFloat(t[i])})}return e}}class Pr{constructor(t,e){t.displayMode&&(t.displayMode=t.displayMode.toUpperCase()),this.config=t,this.browser=e,this.url=t.url,this.type=t.type,this.description=t.description,this.supportHiDPI=void 0===t.supportHiDPI||t.supportHiDPI,t.name||t.label?this.name=t.name||t.label:et(t.url)?this.name=t.url.name:this.name=t.url,this.id=void 0===this.config.id?this.name:this.config.id,this.order=t.order,this.color=t.color,this.altColor=t.altColor,"civic-ws"===t.sourceType?this.defaultColor="rgb(155,20,20)":this.defaultColor="rgb(0,0,150)",this.autoscaleGroup=t.autoscaleGroup,this.removable=void 0===t.removable||t.removable,this.height=t.height||100,this.autoHeight=t.autoHeight,this.minHeight=t.minHeight||Math.min(25,this.height),this.maxHeight=t.maxHeight||Math.max(1e3,this.height),this.visibilityWindow=t.visibilityWindow}getState(){const t={};for(let e of Object.keys(this.config))e.startsWith("_")||(t[e]=this.config[e]);for(let e of Object.keys(t)){if(e.startsWith("_"))continue;const i=this[e];i&&(rn(i)||"boolean"==typeof i)&&(t[e]=i)}this.color&&(t.color=this.color),this.altColor&&(t.altColor=this.altColor),!this.autoscale&&this.dataRange&&(t.min=this.dataRange.min,t.max=this.dataRange.max);for(let e of Object.keys(t)){if("function"==typeof t[e])throw Error(`Property '${e}' of track '${this.name} is a function. Functions cannot be saved in sessions.`);if(t[e]instanceof File)throw Error(`Property '${e}' of track '${this.name} is a local File. Local file references cannot be saved in sessions.`);if(t[e]instanceof Promise)throw Error(`Property '${e}' of track '${this.name} is a Promise. Promises cannot be saved in sessions.`)}return t}supportsWholeGenome(){return!1}getGenomeId(){return this.browser.genome?this.browser.genome.id:void 0}setTrackProperties(t){const e={};let i;for(let n of Object.keys(t))switch(n.toLowerCase()){case"usescore":e.useScore=1===t[n]||"1"===t[n]||"on"===t[n]||!0===t[n];break;case"visibility":switch(t[n]){case"2":case"3":case"pack":case"full":e.displayMode="EXPANDED";break;case"4":case"squish":e.displayMode="SQUISHED";break;case"1":case"dense":e.displayMode="COLLAPSED"}break;case"color":case"altcolor":e[n]=t[n].startsWith("rgb(")?t[n]:"rgb("+t[n]+")";break;case"featurevisiblitywindow":case"visibilitywindow":e.visibilityWindow=Number.parseInt(t[n]);break;case"maxheightpixels":i=t[n].split(":"),3===i.length&&(e.minHeight=Number.parseInt(i[2]),e.height=Number.parseInt(i[1]),e.maxHeight=Number.parseInt(i[0]));break;case"viewlimits":if(!this.config.autoscale){i=t[n].split(":");let r,s=0;1==i.length?r=Number.parseFloat(i[0]):2==i.length&&(s=Number.parseFloat(i[0]),r=Number.parseFloat(i[1])),e.autoscale=!1,e.dataRange={min:s,max:r}}case"name":e[n]=t[n]}for(let t of Object.keys(e))this.config.hasOwnProperty(t)||(this[t]=e[t])}getVisibilityWindow(){return this.visibilityWindow}clickedFeatures(t){const e=t.viewport.getCachedFeatures();if(!e||0===e.length)return[];const i=t.genomicLocation,n=t.referenceFrame.bpPerPixel>.2?3*t.referenceFrame.bpPerPixel:0,r=Math.floor(i)-n,s=Math.floor(i)+n;return Yn(e,r,s)}static extractPopupData(t,e){const i=new Set(["row","color","chr","start","end","cdStart","cdEnd","strand","alpha"]),n=[];let r,s;for(var o in t)if(t.hasOwnProperty(o)&&!i.has(o)&&rn(t[o])){let e=t[o];n.push({name:(a=o,a.length>0?a.charAt(0).toUpperCase()+a.slice(1):a),value:e}),"alleles"===o?r=t[o]:"alleleFreqs"===o&&(s=t[o])}var a;if(r&&s){r.endsWith(",")&&(r=r.substr(0,r.length-1)),s.endsWith(",")&&(s=s.substr(0,s.length-1));let i=r.split(","),o=s.split(",");if(o.length>1){let r=[];for(let t=0;t<o.length;t++)r.push({a:i[t],af:Number.parseFloat(o[t])});r.sort((function(t,e){return t.af-e.af}));let s=r[r.length-1].a;if(1===s.length)for(let i=r.length-2;i>=0;i--){let o=r[i].a;if(1===o.length){const i=Pr.getCravatLink(t.chr,t.start+1,s,o,e);i&&(n.push("<hr/>"),n.push(i))}}}}if(t.attributes)for(let e of Object.keys(t.attributes))n.push({name:e,value:t.attributes[e]});let h=`${t.chr}:${z(t.start+1)}-${z(t.end)}`;return t.strand&&(h+=` (${t.strand})`),n.push("<hr>"),n.push(h),n}static getCravatLink(t,e,i,n,r){if("hg38"===r||"GRCh38"===r){return`<a target="_blank" href="https://run.opencravat.org/result/nocache/variant.html?chrom=${t.startsWith("chr")?t:"chr"+t}&pos=${e}&ref_base=${i}&alt_base=${n}">Cravat ${i}->${n}</a>`}}}const Or=new Set(["A","C","T","G"].map((t=>t.charCodeAt(0))));function zr(t){return new Hr(t)}class Hr{constructor(t){this.chr=t[0],this.pos=parseInt(t[1]),this.names=t[2],this.referenceBases=t[3],this.alternateBases=t[4],this.quality=t[5],this.filter=t[6],this.info=function(t){var e={};t&&t.split(";").forEach((function(t){var i=t.split("=");e[i[0]]=i[1]}));return e}(t[7]),this.init()}init(){const t=this.referenceBases,e=this.alternateBases;if(this.info&&(this.info.VT?this.type=this.info.VT:this.info.SVTYPE?this.type="SV":this.info.PERIOD&&(this.type="STR")),void 0===this.type&&(this.type=function(t,e){const i=t.length;if(void 0===e)return"UNKNOWN";if(0===e.trim().length||"<NON_REF>"===e||"<*>"===e||"."===e)return"NONVARIANT";{const t=e.split(",").map((function(t){return 1===i&&1===t.length?"SNP":"<NON_REF>"===t?"NONVARIANT":"OTHER"}));let n=t[0];for(let e of t)if(e!==n)return"MIXED";return n}}(t,e)),"NONVARIANT"===this.type&&(this.heterozygosity=0),this.info.END)this.start=this.pos-1,this.info.CHR2&&this.info.CHR2!==this.chr?this.end=this.start+1:this.end=Number.parseInt(this.info.END);else if("NONVARIANT"===this.type)this.start=this.pos-1,this.end=this.start+t.length;else{const i=e.split(",").filter((t=>t.length>0));this.alleles=[],this.start=void 0,this.end=void 0;for(let e of i)if(this.alleles.push(e),"SV"!==this.type&&Ur(e)){let i=e.length,n=t.length,r=0;for(t.charCodeAt(0)===e.charCodeAt(0)&&(r++,i--,n--);i>0&&n>0;){const s=r+i-1,o=r+n-1;if(e.charCodeAt(s)!==t.charCodeAt(o))break;i--,n--}for(;i>0&&n>0;){const s=r,o=r;if(e.charCodeAt(s)!==t.charCodeAt(o))break;r++,i--,n--}const s=this.pos+r-1,o=s+n;this.start=void 0===this.start?s:Math.min(this.start,s),this.end=void 0===this.end?o:Math.max(this.end,o)}void 0===this.start&&(this.start=this.pos-1,this.end=this.pos)}}popupData(t,e){var i,n,r=this;const s=this.end===this.pos?this.pos:`${this.pos}-${this.end}`;if(i=[{name:"Chr",value:this.chr},{name:"Pos",value:s},{name:"Names",value:this.names?this.names:""},{name:"Ref",value:this.referenceBases},{name:"Alt",value:this.alternateBases.replace("<","&lt;")},{name:"Qual",value:this.quality},{name:"Filter",value:this.filter}],"SNP"===this.type){let t=this.referenceBases;if(1===t.length){let n=this.alternateBases.split(",");for(let r of n)if(1===r.length){let n=Pr.getCravatLink(this.chr,this.pos,t,r,e);n&&(i.push("<hr/>"),i.push(n))}}}return this.hasOwnProperty("heterozygosity")&&i.push({name:"Heterozygosity",value:this.heterozygosity}),this.info&&(i.push("<hr>"),Object.keys(this.info).forEach((function(t){i.push({name:t,value:$r(r.info[t])})}))),this.calls&&1===this.calls.length&&(i.push("<hr>"),n=this.alleles[this.calls[0].genotype[0]]+this.alleles[this.calls[0].genotype[1]],i.push({name:"Genotype",value:n})),i}isRefBlock(){return"NONVARIANT"===this.type}}function Ur(t){for(let e=0;e<t.length;e++)if(!Or.has(t.charCodeAt(e)))return!1;return!0}function $r(t,e){return void 0===e&&(e=","),Array.isArray(t)?t.join(e):t}class qr{construtor(){}async parseHeader(t){const e={};let i=await t.nextLine();if(!i.startsWith("##fileformat"))throw new Error("Invalid VCF file: missing fileformat line");for(e.version=i.substr(13);void 0!==(i=await t.nextLine())&&i.startsWith("#");){let t;const r={};if(i.startsWith("##")){if(i.startsWith("##INFO")||i.startsWith("##FILTER")||i.startsWith("##FORMAT")){const s=i.indexOf("<"),o=i.lastIndexOf(">");if(!(s>2&&o>0))continue;const a=i.substring(2,s-1);e[a]||(e[a]={});const h=U(i.substring(s+1,o-1),",");for(let e of h){var n=e.split("=");n.length>1&&("ID"===n[0]?t=n[1]:r[n[0]]=n[1])}t&&(e[a][t]=r)}}else if(i.startsWith("#CHROM")){const t=i.split("\t");if(t.length>8){e.callSets=[];for(let i=9;i<t.length;i++)e.callSets.push({id:i,name:t[i]})}}}return this.header=e,e}async parseFeatures(t){const e=[],i=this.header.callSets,n=8+(i?i.length+1:0);let r;for(;void 0!==(r=await t.nextLine());)if(r&&!r.startsWith("#")){const t=r.split("\t");if(t.length===n){const n=zr(t);if(n.header=this.header,e.push(n),t.length>9){const e=Vr(t[8].split(":"));n.calls={};for(let r=9;r<t.length;r++){const a=t[r];var s=i[r-9],o={callSetName:s.name,info:{}};n.calls[s.id]=o,a.split(":").forEach((function(t,i){switch(i){case e.genotypeIndex:o.genotype=[],t.split(/[\|\/]/).forEach((function(t){o.genotype.push("."===t?t:parseInt(t))}));break;default:o.info[e.fields[i]]=t}}))}}}}return e}}function Vr(t){const e={genotypeIndex:-1,fields:t};for(let i=0;i<t.length;i++)"GT"===t[i]&&(e.genotypeIndex=i);return e}class jr{constructor(t){if(this.config=t,t.columns){if(void 0===t.columns.chromosome||void 0===t.columns.position||void 0===t.columns.value)throw Error("columns property must define chrCol, posCol, and valueCol");this.posCol=t.columns.position-1,this.chrCol=t.columns.chromosome-1,this.pvalueCol=t.columns.value-1}else this.posCol=2,this.chrCol=1,this.pvalueCol=3}async parseHeader(t){const e=await t.nextLine();return this.parseHeaderLine(e)}parseHeaderLine(t){if(this.columns=t.split(/\t/),!this.config.columns)for(let t=0;t<this.columns.length;t++){switch(this.columns[t].toLowerCase()){case"chr":case"chromosome":case"chr_id":this.chrCol=t;break;case"bp":case"pos":case"position":case"chr_pos":this.posCol=t;break;case"p":case"pval":case"pvalue":case"p-value":case"p.value":this.pvalueCol=t}}return this.columns}async parseFeatures(t){const e=[],i=t.nextLine();let n;for(this.columns||this.parseHeaderLine(i);void 0!==(n=t.nextLine());){const t=n.split(/\t/);if(t.length===this.columns.length){const i=t[this.chrCol],r=parseInt(t[this.posCol])-1,s=r+1,o=parseFloat(t[this.pvalueCol]);e.push(new Wr({chr:i,start:r,end:s,value:o,line:n,columns:this.columns}))}}return e}}class Wr{constructor({chr:t,start:e,end:i,value:n,line:r,columns:s}){this.chr=t,this.start=e,this.end=i,this.value=n,this.line=r,this.columns=s}popupData(){const t=this.line.split(/\t/);return this.columns.map((function(e,i){return{name:e,value:t[i]}}))}getAttribute(t){const e=this.line.split(/\t/);for(let i=0;i<this.columns.length;i++)if(this.columns[i]===t)return e[i]}}var Gr=new RegExp("([^:]*)\\(([^)]*)\\)"),Zr=new RegExp("([^:]*):([^(]*)\\(([^)]*)\\)");class Xr{constructor(t){const e=t?t.decode:void 0;this.nameField=t?t.nameField:void 0,this.skipRows=0,this.decode=e||es,this.delimiter="\t"}async parseHeader(t){let e,i;for(;(e=await t.nextLine())&&(e.startsWith("track")||e.startsWith("#")||e.startsWith("browser"));)if(e.startsWith("track")||e.startsWith("#track")){let t=Qr(e);i?Object.assign(i,t):i=t}else if(e.startsWith("#columns")){let t=Jr(e);i?Object.assign(i,t):i=t}else e.startsWith("##gff-version 3")&&(this.format="gff3",i||(i={}),i.format="gff3");return this.header=i,i}async parseFeatures(t){const e=[],i=this.decode,n=this.delimiter||"\t";let r,s=0;for(;void 0!==(r=t.nextLine());){if(s++,s<=this.skipRows||r.startsWith("track")||r.startsWith("#")||r.startsWith("browser"))continue;let t=o();if(t.length<1)continue;if(!this.aed){this.aed=Kr(t);continue}const n=i.call(this,t,undefined);n&&e.push(n)}return e;function o(){for(var t,e,i=[],s="",o=!1;r||""===r;){for(t=0;t<r.length;t++)(e=r.charAt(t))===n?o?s+=e:(i.push(s),s=""):'"'===e?t+1<r.length&&'"'===r.charAt(t+1)?(o&&(s+='"'),t++):o=!o:s+=e;if(!o)break;s+="\n",r=nextLine()}return i.push(s),i}}}function Yr(t){var e=Zr.exec(t);if(e)return{namespace:e[1],name:e[2],type:e[3]};if(e=Gr.exec(t))return{namespace:"?",name:e[1],type:e[2]};throw new Error("Error parsing the header row of AED file - column not in ns:name(ns:type) format")}function Kr(t){var e,i,n;for(e={columns:[],metadata:{}},i=0;i<t.length;i++)n=Yr(t[i]),e.columns.push(n);return e}function Qr(t){const e={},i=t.split(/(?:")([^"]+)(?:")|([^\s"]+)(?=\s+|$)/g);let n;const r=[];for(let t of i)t&&0!==t.trim().length&&(t.endsWith("=")>0?n=t:n?(r.push(n+t),n=void 0):r.push(t));for(let t of r){if(!t)return;var s=t.split("=",2);if(2===s.length){const t=s[0].trim(),i=s[1].trim();e[t]=i}}return e}function Jr(t){let e={},i=t.split(/\s+/);if(2===i.length){i[1].split(";").forEach((function(t){let i=t.split("=");"color"===i[0]?e.colorColumn=Number.parseInt(i[1])-1:"thickness"===i[0]&&(e.thicknessColumn=Number.parseInt(i[1])-1)}))}return e}function ts(t,e){var i,n,r=t.columns;this.aed=t,this.allColumns=e,this.chr=null,this.start=null,this.end=null,this.score=1e3,this.strand=".",this.cdStart=null,this.cdEnd=null,this.name=null,this.color=null;for(let t=0;t<e.length;t++)if(i=e[t]){"aed:Integer"===(n=r[t]).type&&(i=parseInt(i));var s=[];if(n.namespace.length>0)for(let t=0;t<n.namespace.length;t++)s.push(n.namespace.charCodeAt(t));"bio"===n.namespace.trim()?"sequence"===n.name?this.chr=i:"start"===n.name?this.start=i:"end"===n.name?this.end=i:"cdsMin"===n.name?this.cdStart=i:"cdsMax"===n.name?this.cdEnd=i:"strand"===n.name&&(this.strand=i):"aed"===n.namespace?"name"===n.name&&(this.name=i):"style"===n.namespace&&"color"===n.name&&(this.color=ct.createColorString(i))}}function es(t,e){var i,n,r,s,o,a,h=0,l=this.aed.columns;if(t.length===l.length){for(a=0;a<t.length;a++)s=l[a],""!==(r=t[a])&&h++,"name"===s.name&&"aed"===s.namespace?i=r:"value"===s.name&&"aed"===s.namespace&&(n=r);if(2===h&&i&&n)return o=Yr(i),this.aed.metadata[o.namespace]||(this.aed.metadata[o.namespace]={}),void(this.aed.metadata[o.namespace][o.name]||(this.aed.metadata[o.namespace][o.name]={type:o.type,value:n}));var c=new ts(this.aed,t);if(c.chr&&(c.start||0===c.start)&&c.end)return c}}ts.prototype.popupData=function(){for(var t=[],e=this.aed,i=0;i<this.allColumns.length;i++){var n=this.allColumns[i],r=e.columns[i].name;"sequence"!==r&&"color"!==r&&n&&t.push({name:r,value:n})}return t};class is{constructor(t,e){this.littleEndian=void 0===e||e,this.position=0,this.view=t,this.length=t.byteLength}available(){return this.length-this.position}remLength(){return this.length-this.position}hasNext(){return this.position<this.length-1}getByte(){var t=this.view.getUint8(this.position,this.littleEndian);return this.position++,t}getShort(){var t=this.view.getInt16(this.position,this.littleEndian);return this.position+=2,t}getUShort(){var t=this.view.getUint16(this.position,this.littleEndian);return this.position+=2,t}getInt(){var t=this.view.getInt32(this.position,this.littleEndian);return this.position+=4,t}getUInt(){var t=this.view.getUint32(this.position,this.littleEndian);return this.position+=4,t}getLong(){var t=[];t[0]=this.view.getUint8(this.position),t[1]=this.view.getUint8(this.position+1),t[2]=this.view.getUint8(this.position+2),t[3]=this.view.getUint8(this.position+3),t[4]=this.view.getUint8(this.position+4),t[5]=this.view.getUint8(this.position+5),t[6]=this.view.getUint8(this.position+6),t[7]=this.view.getUint8(this.position+7);var e=0;if(this.littleEndian)for(let i=t.length-1;i>=0;i--)e=256*e+t[i];else for(let i=0;i<t.length;i++)e=256*e+t[i];return this.position+=8,e}getString(t){for(var e,i="";0!==(e=this.view.getUint8(this.position++))&&(i+=String.fromCharCode(e),!t||i.length!==t););return i}getFixedLengthString(t){var e,i,n="";for(e=0;e<t;e++)(i=this.view.getUint8(this.position++))>0&&(n+=String.fromCharCode(i));return n}getFixedLengthTrimmedString(t){var e,i,n="";for(e=0;e<t;e++)(i=this.view.getUint8(this.position++))>32&&(n+=String.fromCharCode(i));return n}getFloat(){var t=this.view.getFloat32(this.position,this.littleEndian);return this.position+=4,t}getDouble(){var t=this.view.getFloat64(this.position,this.littleEndian);return this.position+=8,t}skip(t){return this.position+=t,this.position}getVPointer(){var t=this.position,e=this.view.getUint8(t+1)<<8|this.view.getUint8(t),i=4294967296*(255&this.view.getUint8(t+6))+16777216*(255&this.view.getUint8(t+5))+65536*(255&this.view.getUint8(t+4))+256*(255&this.view.getUint8(t+3))+(255&this.view.getUint8(t+2));return this.position+=8,new ns(i,e)}}class ns{constructor(t,e){this.block=t,this.offset=e}isLessThan(t){return this.block<t.block||this.block===t.block&&this.offset<t.offset}isGreaterThan(t){return this.block>t.block||this.block===t.block&&this.offset>t.offset}print(){return this.block+":"+this.offset}}class rs{constructor(t){this.tabix=!0}parse(t,e){const i=new is(new DataView(t)),n=i.getInt();if(21582659!==n)throw 38359875===n?Error("CSI version 2 is not supported.  Please enter an issue at https://github.com/igvteam/igv.js"):Error("Not a CSI index");this.indices=[],this.blockMin=Number.MAX_SAFE_INTEGER,this.blockMax=0,this.sequenceIndexMap={},this.minShift=i.getInt(),this.depth=i.getInt();if(i.getInt()>=28){i.getInt(),i.getInt(),i.getInt(),i.getInt(),i.getInt(),i.getInt();const t=i.getInt(),n=i.position+t;let r=0;for(;i.position<n;){let t=i.getString();e&&(t=e.getChromosomeName(t)),this.sequenceIndexMap[t]=r,r++}}const r=this.bin_limit()+1,s=i.getInt();for(let t=0;t<s;t++){const e=[],n=[],s=i.getInt();for(let t=0;t<s;t++){const t=i.getInt();if(n[t]=i.getVPointer(),t>r){i.getInt(),i.getVPointer(),i.getVPointer(),i.getLong(),i.getLong()}else{e[t]=[];const n=i.getInt();for(let r=0;r<n;r++){const n=i.getVPointer(),r=i.getVPointer();n&&r&&(n.block<this.blockMin&&(this.blockMin=n.block),r.block>this.blockMax&&(this.blockMax=r.block),e[t].push([n,r]))}}}s>0&&(this.indices[t]={binIndex:e,loffset:n})}}blocksForRange(t,e,i){const n=this.indices[t];if(n){const t=this.reg2bins(e,i);if(0==t.length)return[];const r=[];for(let e of t)for(let t=e[0];t<=e[1];t++)if(n.binIndex[t]){const e=n.binIndex[t],i=e.length;for(let n=0;n<i;++n){const i=e[n][0],s=e[n][1];r.push({minv:i,maxv:s,bin:t})}}return function(t,e){const i=[];let n=null;return 0===t.length?t:(t.sort((function(t,e){const i=t.minv.block-e.minv.block;return 0!==i?i:t.minv.offset-e.minv.offset})),t.forEach((function(t){var r,s;e&&!t.maxv.isGreaterThan(e)||(null===n?(i.push(t),n=t):(r=n,(s=t).minv.block-r.maxv.block<65e3&&s.maxv.block-r.minv.block<5e6?t.maxv.isGreaterThan(n.maxv)&&(n.maxv=t.maxv):(i.push(t),n=t)))})),i)}(r,n.loffset[t[0]])}return[]}reg2bins(t,e){(t-=1)<1&&(t=1),e>2**50&&(e=2**34),e-=1;let i=0,n=0,r=this.minShift+3*this.depth;const s=[];for(;i<=this.depth;r-=3,n+=1<<3*i,i+=1){const i=n+(t>>r),o=n+(e>>r);if(o-i+s.length>this.maxBinNumber)throw new Error(`query ${t}-${e} is too large for current binning scheme (shift ${this.minShift}, depth ${this.depth}), try a smaller query or a coarser index binning scheme`);s.push([i,o])}return s}bin_limit(){return((1<<3*(this.depth+1))-1)/7}}async function ss(t,e,i){const n=[];let r=Number.MAX_SAFE_INTEGER,s=0;const o=new is(new DataView(t)),a=o.getInt(),h={};if(!(21578050===a||e&&21578324===a))throw new Error(indexURL+" is not a "+(e?"tabix":"bai")+" file");{const t=o.getInt();if(e){o.getInt(),o.getInt(),o.getInt(),o.getInt(),o.getInt(),o.getInt(),o.getInt();for(let e=0;e<t;e++){let t=o.getString();i&&(t=i.getChromosomeName(t)),h[t]=e}}for(let e=0;e<t;e++){const t={},i=[],a=o.getInt();for(let e=0;e<a;e++){const e=o.getInt();if(37450===e){o.getInt(),o.getVPointer(),o.getVPointer(),o.getLong(),o.getLong()}else{t[e]=[];const i=o.getInt();for(let n=0;n<i;n++){const i=o.getVPointer(),n=o.getVPointer();i&&n&&(i.block<r&&(r=i.block),n.block>s&&(s=n.block),t[e].push([i,n]))}}}const h=o.getInt();for(let t=0;t<h;t++){const t=o.getVPointer();i.push(t)}a>0&&(n[e]={binIndex:t,linearIndex:i})}}return new os(n,r,s,h,e)}class os{constructor(t,e,i,n,r){this.firstAlignmentBlock=e,this.lastAlignmentBlock=i,this.indices=t,this.sequenceIndexMap=n,this.tabix=r}blocksForRange(t,e,i){const n=this.indices[t];if(n){const t=function(t,e){const i=[];e>=1<<29&&(e=1<<29);return--e,i.push(0),i.push([1+(t>>26),1+(e>>26)]),i.push([9+(t>>23),9+(e>>23)]),i.push([73+(t>>20),73+(e>>20)]),i.push([585+(t>>17),585+(e>>17)]),i.push([4681+(t>>14),4681+(e>>14)]),i}(e,i),r=[];for(let e of t)for(let t=e[0];t<=e[1];t++)if(n.binIndex[t]){const e=n.binIndex[t],i=e.length;for(let n=0;n<i;++n){const i=e[n][0],s=e[n][1];r.push({minv:i,maxv:s,bin:t})}}const s=n.linearIndex.length;let o=null;const a=Math.min(e>>14,s-1),h=Math.min(i>>14,s-1);for(let t=a;t<=h;++t){const e=n.linearIndex[t];e&&(o&&!e.isLessThan(o)||(o=e))}return function(t,e){const i=[];let n=null;return 0===t.length?t:(t.sort((function(t,e){const i=t.minv.block-e.minv.block;return 0!==i?i:t.minv.offset-e.minv.offset})),t.forEach((function(t){var r,s;e&&!t.maxv.isGreaterThan(e)||(null===n?(i.push(t),n=t):(r=n,(s=t).minv.block-r.maxv.block<65e3&&s.maxv.block-r.minv.block<5e6?t.maxv.isGreaterThan(n.maxv)&&(n.maxv=t.maxv):(i.push(t),n=t)))})),i)}(r,o)}return[]}}class as{constructor(t){this.chrIndex=t}blocksForRange(t,e,i){const n=this.chrIndex[t];if(n){const t=n.blocks,r=n.longestFeature,s=n.binWidth,o=Math.max(e-r,0),a=Math.floor(o/s);if(a>=t.length)return[];{const e=Math.min(Math.floor((i-1)/s),t.length-1),n=t[a].min,r=t[e].max;if(0===r-n)return[];return[{minv:{block:n,offset:0},maxv:{block:r,offset:0}}]}}}}async function hs(t,e,i){let n=await un.loadArrayBuffer(t,sn(e)),r=new DataView(n);if(31===r.getUint8(0)&&139===r.getUint8(1)){n=new B.Gunzip(new Uint8Array(n)).decompress().buffer,r=new DataView(n)}switch(r.getInt32(0,!0)){case 21578050:return async function(t,e){return ss(t,!1,e)}(n,i);case 21578324:return async function(t,e){return ss(t,!0,e)}(n,i);case 21582659:return async function(t,e){const i=new rs;return i.parse(t,e),i}(n,i);case 1480870228:return async function(t,e){const i={},n=new is(new DataView(t));!function(t){t.getInt(),t.getInt();const e=t.getInt();if(t.getString(),t.getLong(),t.getLong(),t.getString(),t.getInt(),e>=3){let e=t.getInt();for(;e-- >0;)t.getString(),t.getString()}}(n);let r=n.getInt();for(;r-- >0;){const t=s(n);i[t.chr]=t}return new as(i);function s(t){let i=t.getString();e&&(i=e.getChromosomeName(i));const n=t.getInt(),r=t.getInt(),s=t.getInt();t.getInt(),t.getInt();let o=t.getLong();const a=new Array;for(let e=0;e<r;e++){const e=t.getLong();a.push({min:o,max:e}),o=e}return{chr:i,blocks:a,longestFeature:s,binWidth:n}}}(n,i);case 38359875:throw Error("CSI version 2 is not supported.");default:throw Error(`Unrecognized index type: ${t}`)}}class ls{constructor(t){this.config=t,this.filePtr=0,this.bufferPtr=0,this.buffer}async nextLine(){let t;try{for(;;){const e=this.buffer?this.buffer.length:0;for(;this.bufferPtr<e;){const e=String.fromCharCode(this.buffer[this.bufferPtr++]);if("\r"!==e){if("\n"===e)return t;t=t?t+e:e}}if(this.eof)return t;await this.readNextBlock()}}catch(e){return console.warn(e),this.eof=!0,t}}async readNextBlock(){const t=sn(this.config,{range:{start:this.filePtr,size:26}}),e=Ji(await un.loadArrayBuffer(this.config.url,t));if(0===e)this.eof=!0,this.buffer=void 0;else{const t=sn(this.config,{range:{start:this.filePtr,size:e}}),i=await un.loadArrayBuffer(this.config.url,t);i.byteLength<e&&(this.eof=!0),this.buffer=Qi(i),this.bufferPtr=0,this.filePtr+=i.byteLength}}}const cs=O;class us{constructor(t,e){var i;this.config=t||{},this.genome=e,this.indexURL=t.indexURL,this.indexed=t.indexed,et(this.config.url)?this.filename=this.config.url.name:cs(this.config.url)&&this.config.url.startsWith("data:")?(this.indexed=!1,this.dataURI=t.url):(i=J(this.config.url),this.filename=t.filename||i.file),this.parser=this.getParser(this.config),"vcf"!==this.config.format||this.config.indexURL||console.warn("Warning: index file not specified.  The entire vcf file will be loaded.")}async readFeatures(t,e,i){return await this.getIndex()?(this.indexed=!0,this.loadFeaturesWithIndex(t,e,i)):this.dataURI?(this.indexed=!1,this.loadFeaturesFromDataURI()):(this.indexed=!1,this.loadFeaturesNoIndex())}async readHeader(){if(this.dataURI)return this.loadFeaturesFromDataURI(this.dataURI),this.header;if(this.config.indexURL){const t=await this.getIndex();if(!t)throw new Error("Unable to load index: "+this.config.indexURL);let e;if(t.tabix)e=new ls(this.config);else{const i=Object.values(t.chrIndex).flatMap((t=>t.blocks)).map((t=>t.max)).reduce(((t,e)=>Math.min(t,e)),Number.MAX_SAFE_INTEGER),n=sn(this.config,{bgz:t.tabix,range:{start:0,size:i}});e=Fr(await un.loadString(this.config.url,n))}return this.header=await this.parser.parseHeader(e),this.header}{const t=sn(this.config),e=await un.loadString(this.config.url,t);let i=Fr(e);return this.header=await this.parser.parseHeader(i),i=Fr(e),this.features=await this.parser.parseFeatures(i),this.header}}getParser(t){switch(t.format){case"vcf":return new qr(t);case"seg":return new Nr;case"gwas":return new jr(t);case"aed":return new Xr(t);default:return new Ar(t)}}async loadFeaturesNoIndex(){if(this.features){const t=this.features;return delete this.features,t}{const t=sn(this.config),e=await un.loadString(this.config.url,t);if(!this.header){const t=Fr(e);this.header=await this.parser.parseHeader(t)}const i=Fr(e);return await this.parser.parseFeatures(i)}}async loadFeaturesWithIndex(t,e,i){const n=this.config,r=this.parser,s=this.index.tabix,o=s?this.index.sequenceIndexMap[t]:t;if(void 0===o)return[];const a=this.genome,h=this.index.blocksForRange(o,e,i);if(h&&0!==h.length){const o=[];for(let l of h){const h=l.minv.block,c=l.minv.offset,u=l.maxv.offset;let f;if(s){let t=0;if(u>0){const e=sn(n,{range:{start:l.maxv.block,size:26}});t=Ji(await un.loadArrayBuffer(n.url,e))}f=l.maxv.block+t}else f=l.maxv.block;const d=sn(n,{range:{start:h,size:f-h+1}});let p;if(s){p=Qi(await un.loadArrayBuffer(n.url,d))}else p=await un.loadString(n.url,d);const g=Fr(c?p.slice(c):p),m=await r.parseFeatures(g);let b=!1;for(let n=0;n<m.length;n++){const r=m[n];if((a?a.getChromosomeName(r.chr):r.chr)!==t){if(0===o.length)continue;break}if(r.start>i){o.push(r);break}r.end>=e&&r.start<=i&&(b||(b=!0,n>0&&o.push(m[n-1])),o.push(r))}}return o.sort((function(t,e){return t.start-e.start})),o}return[]}async getIndex(){return this.index||!this.config.indexURL||(this.index=await this.loadIndex()),this.index}async loadIndex(){return hs(this.config.indexURL,this.config,this.genome)}async loadFeaturesFromDataURI(){if(this.features){const t=this.features;return delete this.features,t}{const t=Q(this.dataURI);let e=Fr(t);return this.header=await this.parser.parseHeader(e),this.header instanceof String&&this.header.startsWith("##gff-version 3")&&(this.format="gff3"),e=Fr(t),this.features=await this.parser.parseFeatures(e),this.features}}}class fs{constructor(t,e,i){this.treeMap=this.buildTreeMap(t,e),this.range=i,this.count=t.length}containsRange(t){return void 0===this.range||this.range.contains(t.chr,t.start,t.end)}queryFeatures(t,e,i){const n=this.treeMap[t];if(!n)return[];const r=n.findOverlapping(e,i);if(0===r.length)return[];{const n=[],s=this.allFeatures[t];if(s){for(let t of r){const r=t.value;for(let t=r.start;t<r.end;t++){let r=s[t];if(r.start>i)break;r.end>=e&&n.push(r)}}n.sort((function(t,e){return t.start-e.start}))}return n}}getAllFeatures(){return this.allFeatures}buildTreeMap(t,e){const i={},n=[];if(this.allFeatures={},t){for(let i of t){let t=i.chr;e&&(t=e.getChromosomeName(t));let r=this.allFeatures[t];r||(n.push(t),r=[],this.allFeatures[t]=r),r.push(i)}for(let t of n){const e=this.allFeatures[t];e.sort((function(t,e){return t.start===e.start?0:t.start>e.start?1:-1})),i[t]=ds(e)}}return i}}function ds(t){const e=new qn,i=t.length,n=Math.max(10,Math.round(i/10));for(let r=0;r<i;r+=n){const s=Math.min(i,r+n),o=new ps(r,s),a=t[r].start;let h=a;for(let e=r;e<s;e++)h=Math.max(h,t[e].end);e.insert(a,h,o)}return e}class ps{constructor(t,e){this.start=t,this.end=e}}const gs=O;class ms{constructor(t){this.config=t}async readFeatures(t,e,i){let n;n="function"==typeof this.config.url?this.config.url({chr:t,start:e,end:i}):this.config.url.replace("$CHR",t).replace("$START",e).replace("$END",i);let r,s=Object.assign({},this.config);void 0!==this.config.body&&("function"==typeof this.config.body?s.body=this.config.body({chr:t,start:e,end:i}):s.body=this.config.body.replace("$CHR",t).replace("$START",e).replace("$END",i));const o=await un.load(n,s);if(o&&(r="function"==typeof this.config.parser?this.config.parser(o):gs(o)?JSON.parse(o):o),this.config.mappings){let t=Object.keys(this.config.mappings);for(let e of r)for(let i of t)e[i]=e[this.config.mappings[i]]}return r}}const bs=function(t,e){this.config=t,this.genome=e,this.expandQueryInterval=!1};bs.prototype.readFeatures=function(t,e,i){const n=Math.max(0,Math.floor(e));let r=Math.ceil(i);if(this.genome){const e=this.genome.getChromosome(t);e&&r>e.bpLength&&(r=e.bpLength)}const s=this.config.url+"?db="+this.config.db+"&table="+this.config.tableName+"&chr="+t+"&start="+n+"&end="+r;return un.loadJson(s,this.config).then((function(t){return t?(t.forEach((function(t){t.hasOwnProperty("exonStarts")&&t.hasOwnProperty("exonEnds")&&t.hasOwnProperty("exonCount")&&t.hasOwnProperty("cdsStart")&&t.hasOwnProperty("cdsEnd")&&function(t){var e,i,n,r,s,o;e=t.exonCount,i=t.exonStarts.split(","),n=t.exonEnds.split(","),r=[];for(var a=0;a<e;a++){var h={start:s=parseInt(i[a]),end:o=parseInt(n[a])};(t.cdsStart>o||t.cdsEnd<t.cdsStart)&&(h.utr=!0),t.cdsStart>=s&&t.cdsStart<=o&&(h.cdStart=t.cdsStart),t.cdsEnd>=s&&t.cdsEnd<=o&&(h.cdEnd=t.cdsEnd),r.push(h)}t.exons=r}(t)})),t):null}))};const ws=new Set(["transcript","primary_transcript","processed_transcript","mRNA","mrna"]),vs=new Set(["CDS","cds"]),ys=new Set(["start_codon","stop_codon"]),xs=new Set(["5UTR","3UTR","UTR","five_prime_UTR","three_prime_UTR","3'-UTR","5'-UTR"]),ks=new Set(["exon","coding-exon"]),Ss=new Set;for(let t of[ws,vs,ys,xs,ks])for(let e of t)Ss.add(e);class _s{constructor(t){this.format=t.format,this.filterTypes=void 0===t.filterTypes?new Set(["chromosome"]):new Set(t.filterTypes)}combineFeatures(t){let e;if("gff3"===this.format){const i=this.combineFeaturesById(t);e=this.combineFeaturesGFF(i)}else e=this.combineFeaturesGTF(t);return e.sort((function(t,e){return t.start-e.start})),e}combineFeaturesById(t){const e=[],i={};for(let n of t)if(void 0===n.id)e.push(n);else{let t=i[n.chr];if(t||(t={},i[n.chr]=t),t.hasOwnProperty(n.id)){const e=t[n.id];if(e.hasOwnProperty("exons"))e.start=Math.min(e.start,n.start),e.end=Math.max(e.end,n.end),e.exons.push(n);else{const i={id:n.id,type:n.type,chr:n.chr,strand:n.strand,start:Math.min(n.start,e.start),end:Math.max(n.end,e.end),exons:[e,n]};n.parent&&""!==n.parent.trim()&&(i.parent=n.parent),t[n.id]=i}}else t[n.id]=n}for(let t of Object.keys(i)){const n=i[t];for(let t of Object.keys(n))e.push(n[t])}return e}combineFeaturesGTF(t){const e=Object.create(null),i=[],n=new Set,r=this.filterTypes;t=t.filter((t=>void 0===r||!r.has(t.type)));for(let r of t)if(ws.has(r.type)){const t=r.id;if(void 0!==t){const s=new Cs(r);e[t]=s,i.push(s),n.add(r)}}for(let r of t)if(ks.has(r.type)){const t=r.id;if(t){let s=e[t];void 0===s&&(s=new Cs(r),e[t]=s,i.push(s)),s.addExon(r),n.add(r)}}for(let r of t)if(vs.has(r.type)||xs.has(r.type)||ys.has(r.type)){const t=r.id;if(t){let s=e[t];void 0===s&&(s=new Cs(r),e[t]=s,i.push(s)),xs.has(r.type)?s.addUTR(r):vs.has(r.type)?s.addCDS(r):ys.has(r.type),n.add(r)}}for(let t of i)"function"==typeof t.finish&&t.finish();const s=t.filter((t=>!n.has(t)));for(let t of s)i.push(t);return i}combineFeaturesGFF(t){const e=t.filter((t=>"gene"===t.type)),i=Object.create(null);for(let t of e)i[t.id]=t;const n=Object.create(null),r=[],s=new Set,o=this.filterTypes;t=t.filter((t=>void 0===o||!o.has(t.type)));for(let e of t)if(ws.has(e.type)){const t=e.id;if(void 0!==t){const o=new Cs(e);n[t]=o,r.push(o),s.add(e);const a=i[e.parent];a&&(o.gene=i[e.parent],s.add(a))}}for(let e of t)if(ks.has(e.type)){const t=l(e);if(t)for(let i of t){let t=n[i];void 0!==t&&(t.addExon(e),s.add(e))}}for(let e of t)if(vs.has(e.type)||xs.has(e.type)||ys.has(e.type)){const t=l(e);if(t)for(let i of t){let t=n[i];void 0!==t&&(xs.has(e.type)?t.addUTR(e):vs.has(e.type)?t.addCDS(e):ys.has(e.type),s.add(e))}}const a=t.filter((t=>"intron"===t.type));for(let t of a){const e=l(t);for(let i of e)if(n[i]){s.add(t);break}}r.forEach((function(t){"function"==typeof t.finish&&t.finish()}));const h=t.filter((t=>!s.has(t)));for(let t of h)r.push(t);return r;function l(t){return t.parent&&""!==t.parent.trim()?t.parent.trim().split(","):null}}}var Cs=function(t){Object.assign(this,t),this.exons=[]};Cs.prototype.addExon=function(t){this.exons.push(t),this.start=Math.min(this.start,t.start),this.end=Math.max(this.end,t.end)},Cs.prototype.addCDS=function(t){let e;const i=this.exons;for(let n=0;n<i.length;n++)if(i[n].start<=t.start&&i[n].end>=t.end){e=i[n];break}e?(e.cdStart=e.cdStart?Math.min(t.start,e.cdStart):t.start,e.cdEnd=e.cdEnd?Math.max(t.end,e.cdEnd):t.end,e.children||(e.children=[]),e.children.push(t)):(t.cdStart=t.start,t.cdEnd=t.end,i.push(t)),this.start=Math.min(this.start,t.start),this.end=Math.max(this.end,t.end),this.cdStart=this.cdStart?Math.min(t.start,this.cdStart):t.start,this.cdEnd=this.cdEnd?Math.max(t.end,this.cdEnd):t.end},Cs.prototype.addUTR=function(t){let e;const i=this.exons;for(let n=0;n<i.length;n++)if(i[n].start<=t.start&&i[n].end>=t.end){e=i[n];break}e?(t.start===e.start&&t.end===e.end?e.utr=!0:(t.end<e.end&&(e.cdStart=t.end),t.start>e.start&&(e.cdEnd=t.start)),e.children||(e.children=[]),e.children.push(t)):(t.utr=!0,i.push(t)),this.start=Math.min(this.start,t.start),this.end=Math.max(this.end,t.end)},Cs.prototype.finish=function(){var t=this.cdStart,e=this.cdEnd;this.exons.sort((function(t,e){return t.start-e.start})),t&&this.exons.forEach((function(i){(i.end<t||i.start>e)&&(i.utr=!0)}))},Cs.prototype.popupData=function(t){const e=this.attributeString.split(";"),i=[];if(this.gene&&"function"==typeof this.gene.popupData){const e=this.gene.popupData(t);for(let t of e)i.push(t);i.push("<hr>")}this.name&&i.push({name:"name",value:this.name}),i.push({name:"type",value:this.type});for(let t of e){var n=t.trim().split(this.delim,2);if(2===n.length&&void 0!==n[1]){const t=n[0].trim();if("name"===t.toLowerCase())continue;let e=n[1].trim();e.startsWith('"')&&e.endsWith('"')&&(e=e.substr(1,e.length-2)),i.push({name:t,value:e})}}i.push({name:"position",value:`${this.chr}:${z(this.start+1)}-${z(this.end)}`});for(let e of this.exons)if(t>=e.start&&t<e.end&&"function"==typeof e.popupData){i.push("<hr>");const n=e.popupData(t);for(let t of n)i.push(t);if(e.children)for(let n of e.children){i.push("<hr>");const e=n.popupData(t);for(let t of e)i.push(t)}}return i};const Es=function(t){this.config=t,this.url=t.url,this.tissueId=t.tissueSiteDetailId,this.indexed=!0,this.datasetId=t.datasetId||"gtex_v8"};Es.prototype.readFeatures=async function(t,e,i){let n=t.startsWith("chr")?t:"chr"+t,r=Math.floor(e),s=Math.ceil(i),o=this.datasetId,a=this.url+"?chromosome="+n+"&start="+r+"&end="+s+"&tissueSiteDetailId="+this.tissueId+"&datasetId="+o;const h=await un.loadJson(a,{withCredentials:this.config.withCredentials});return h&&h.singleTissueEqtl?(h.singleTissueEqtl.forEach((function(t){t.chr=t.chromosome,t.position=t.pos,t.start=t.pos-1,t.end=t.start+1,t.snp=t.snpId,t.geneName=t.geneSymbol,t.geneId=t.gencodeId})),h.singleTissueEqtl):void 0};const Ts=function(t){this.config=t,this.url=t.url,this.cellConditionId=t.cellConditionId,this.valueThreshold=t.valueThreshold?t.valueThreshold:.05};Ts.prototype.readFeatures=function(t,e,i){var n=this,r=this.url+"?chromosome="+t+"&start="+e+"&end="+i+"&cell_condition_id="+this.cellConditionId;return new Promise((function(t,e){un.loadJson(r,{withCredentials:n.config.withCredentials}).then((function(e){e?(e.eqtls.forEach((function(t){t.chr=t.chromosome,t.start=t.position,t.end=t.position+1})),t(e.eqtls)):t(null)})).catch((function(t){e(t)}))}))};const As=un.apiKey;function Rs(t){var e=t.url+"/"+t.entity+"/"+t.entityId;return t.headers={"Cache-Control":"no-cache"},un.loadJson(e,t)}function Is(t){return new Promise((function(e,i){var n=t.results?t.results:[],r=t.url,s=t.body,o=t.decode,a="?",h=t.fields;return As&&(r=r+a+"key="+As,a="&"),h&&(r=r+a+"fields="+h),function t(a){a?s.pageToken=a:void 0!==s.pageToken&&delete s.pageToken;var h=JSON.stringify(s);un.loadJson(r,{sendData:h,contentType:"application/json",headers:{"Cache-Control":"no-cache"}}).then((function(i){var r,s;i?((s=o?o(i):i)&&s.forEach((function(t){n.push(t)})),(r=i.nextPageToken)?t(r):e(n)):e(n)})).catch((function(t){i(t)}))}()}))}const Ls=function(t,e){this.config=t,this.genome=e,this.url=t.url,this.variantSetId=t.variantSetId,this.callSetIds=t.callSetIds,this.includeCalls=void 0===t.includeCalls||t.includeCalls};Ls.prototype.readHeader=function(){var t=this;return t.header?Promise.resolve(t.header):(t.header={},!1===t.includeCalls?Promise.resolve(t.header):Is({url:t.url+"/callsets/search",fields:"nextPageToken,callSets(id,name)",body:{variantSetIds:Array.isArray(t.variantSetId)?t.variantSetId:[t.variantSetId],pageSize:"10000"},decode:function(e){if(t.callSetIds){var i=[],n=new Set;return t.callSetIds.forEach((function(t){n.add(t)})),e.callSets.forEach((function(t){n.has(t.id)&&i.push(t)})),i}return e.callSets}}).then((function(e){return t.header.callSets=e,t.header})))},Ls.prototype.readFeatures=function(t,e,i){const n=this,r=this.genome;return n.readHeader().then((function(t){return new Promise((function(t,e){n.chrAliasTable?t(n.chrAliasTable):n.readMetadata().then((function(e){n.metadata=e.metadata,n.chrAliasTable={},e.referenceBounds&&r&&e.referenceBounds.forEach((function(t){var e=t.referenceName,i=r.getChromosomeName(e);n.chrAliasTable[i]=e})),t(n.chrAliasTable)}))}))})).then((function(r){var s=r.hasOwnProperty(t)?r[t]:t;return Is({url:n.url+"/variants/search",fields:n.includeCalls?void 0:"nextPageToken,variants(id,variantSetId,names,referenceName,start,end,referenceBases,alternateBases,quality,filter,info)",body:{variantSetIds:Array.isArray(n.variantSetId)?n.variantSetId:[n.variantSetId],callSetIds:n.callSetIds?n.callSetIds:void 0,referenceName:s,start:e.toString(),end:i.toString(),pageSize:"10000"},decode:function(t){var e,i=[];return t.variants.forEach((function(t){(e=function(t){var e,i=new Hr;return i.chr=t.referenceName,i.start=parseInt(t.start),i.end=parseInt(t.end),i.pos=i.start+1,i.names=$r(t.names,"; "),i.referenceBases=t.referenceBases,i.alternateBases=$r(t.alternateBases),i.quality=t.quality,i.filter=$r(t.filter),i.info={},t.info&&Object.keys(t.info).forEach((function(e){var n,r=t.info[e];n=Array.isArray(r)?r.join(","):r,i.info[e]=n})),i.calls={},t.calls&&t.calls.forEach((function(t){e=t.callSetId,i.calls[e]=t})),init(i),i}(t)).isRefBlock()||i.push(e)})),i}})}))},Ls.prototype.readMetadata=function(){return Rs({url:this.url,entity:"variantsets",entityId:this.variantSetId})};class Ms{constructor(t){this.config=t}async readFeatures(t,e,i){const n=(await un.loadJson(this.config.url+"/variants/?count=50000")).records,r=[];for(let t of n)if(t.coordinates){t.id;const e=t.coordinates;e.chromosome&&r.push(new Fs(e.chromosome,e.start-1,e.stop,t)),e.chromosome2&&r.push(new Fs(e.chromosome2,e.start2-1,e.stop2,t))}return r}}class Fs{constructor(t,e,i,n){if(this.chr=t,this.start=e,this.end=i,this.id=n.id,this.entrezName=n.entrez_name,this.name=n.name,this.actionabilityScore=n.civic_actionability_score,n.coordinates.reference_bases&&(this.refBases=n.coordinates.reference_bases),n.coordinates.variant_bases&&(this.altBases=n.coordinates.variant_bases),n.variant_types&&(this.variant_types=n.variant_types),this.locationString=this.chr+":"+z(this.start+1)+"-"+z(this.end),void 0!==this.actionabilityScore){let t;if(this.actionabilityScore<=10)t=.2;else{const e=Math.min(30,this.actionabilityScore);t=.2+.8*Math.log10((e-10)/2)}this.alpha=t}}popupData(){const t=i("CIViC","https://civicdb.org/links/variants/"+this.id),e=(this.refBases!==this.altBases&&this.refBases&&1===this.refBases.length&&this.altBases&&this.altBases.length,[t]);if(e.push({name:"Entrez",value:i(this.entrezName,"https://ghr.nlm.nih.gov/gene/"+this.entrezName)}),e.push({name:"Name",value:this.name}),this.variant_types&&this.variant_types.length>0){const t=1===this.variant_types.length?"Type":"Types";let i;for(let t of this.variant_types)i?i+=", "+t.display_name:i=t.display_name;e.push({name:t,value:i})}return e.push({name:"Actionability",value:this.actionabilityScore}),e.push({name:"Location",value:this.locationString}),e;function i(t,e){return"<a target='_blank' href='"+e+"'>"+t+"</a>"}}}function Ds(t,e){e=e||Number.MAX_SAFE_INTEGER;const i=[];t.sort((function(t,e){return t.start-e.start})),i.push(-1e3);for(let n of t){let t=0;const r=Math.min(i.length,e);for(t=0;t<r;t++)if(n.start>i[t]){n.row=t,i[t]=n.end;break}n.row=t,i[t]=n.end}}class Bs{constructor(t,e){this.config=t||{},this.genome=e,this.sourceType=void 0===t.sourceType?"file":t.sourceType,this.visibilityWindow=t.visibilityWindow;const i=new Set(["bigwig","bw","bigbed","bb","tdf"]);if(t.features&&Array.isArray(t.features)){let i=function(t){if(!t||0===t.length)return;if(void 0===t[0].chr&&void 0!==t[0].chr1){const e=[];for(let i of t)i.chr1===i.chr2?(i.chr=i.chr1,i.start=Math.min(i.start1,i.start2),i.end=Math.max(i.end1,i.end2)):e.push(i);for(let i of e){const e=Object.assign({dup:!0},i);t.push(e),i.chr=i.chr1,i.start=i.start1,i.end=i.end1,e.chr=e.chr2,e.start=e.start2,e.end=e.end2}}return t}(t.features);Ns(i),t.mappings&&function(t,e){let i=Object.keys(e);t.forEach((function(t){i.forEach((function(i){t[i]=t[e[i]]}))}))}(i,t.mappings),this.queryable=!1,this.featureCache=new fs(i,e)}else t.reader?(this.reader=t.reader,this.queryable=void 0===t.queryable||t.queryable,this.expandQuery=!!t.expandQuery):"ga4gh"===t.sourceType?(this.reader=new Ls(t,e),this.queryable=!0):"immvar"===t.sourceType?(this.reader=new Ts(t),this.queryable=!0):"eqtl"===t.type&&"gtex-ws"===t.sourceType?(this.reader=new Es(t),this.queryable=!0,this.expandQuery=!!t.expandQuery):"ucscservice"===t.sourceType?(this.reader=new bs(t.source),this.queryable=!0):"custom"===t.sourceType||void 0!==t.source?(this.reader=new ms(t.source),this.queryable=void 0===t.source.queryable||t.source.queryable,this.expandQuery=!!t.expandQuery):"civic-ws"===t.sourceType?(this.reader=new Ms(t),this.queryable=!1,this.expandQuery=!!t.expandQuery):(this.reader=new us(t,e),void 0!==t.queryable?this.queryable=t.queryable:i.has(t.format)&&(this.queryable=i.has(t.format)||this.reader.indexed))}supportsWholeGenome(){return!this.queryable&&(void 0===this.visibilityWindow||this.visibilityWindow<=0)}async trackType(){const t=await this.getHeader();return t?t.type:void 0}async getHeader(){if(!this.header)if(this.reader&&"function"==typeof this.reader.readHeader){const t=await this.reader.readHeader();t?(this.header=t,t.format&&(this.config.format=t.format)):this.header={}}else this.header={};return this.header}async getFeatures({chr:t,start:e,end:i,bpPerPixel:n,visibilityWindow:r}){const s=this.genome,o=s?s.getChromosomeName(t):t,a="all"===o.toLowerCase();return(a&&!this.getWGFeatures||this.config.disableCache||!this.featureCache||!this.featureCache.containsRange(new Gi(o,e,i)))&&await this.loadFeatures(e,i,r,o),a?(this.wgFeatures||(this.queryable?this.wgFeatures=[]:this.wgFeatures=this.getWGFeatures(this.featureCache.getAllFeatures())),this.wgFeatures):this.featureCache.queryFeatures(o,e,i)}async loadFeatures(t,e,i,n){const r=this.reader;let s=t,o=e;if((!i||i<=0)&&!1!==this.expandQuery){const t=this.genome?this.genome.getChromosome(n):void 0;s=0,o=t?t.bpLength:Number.MAX_SAFE_INTEGER}else if(i>e-t&&!1!==this.expandQuery){const n=Math.min(4.1*(e-t),i);s=Math.max(0,(t+e-n)/2),o=t+n}let a=await r.readFeatures(n,s,o);void 0===this.queryable&&(this.queryable=r.indexed);const h=this.queryable?new Gi(n,s,o):void 0;if(a){if("gtf"!==this.config.format&&"gff3"!==this.config.format&&"gff"!==this.config.format||(a=new _s(this.config).combineFeatures(a)),"wig"!==this.config.format&&"junctions"!==this.config.type){Ns(a,this.config.maxRows||Number.MAX_SAFE_INTEGER)}this.featureCache=new fs(a,this.genome,h),this.config.searchable&&this.addFeaturesToDB(a)}else this.featureCache=new fs([],h)}addFeaturesToDB(t){for(let e of t)e.name&&(this.genome.featureDB[e.name.toUpperCase()]=e),e.gene&&e.gene.name&&(this.genome.featureDB[e.gene.name.toUpperCase()]=e)}getWGFeatures(t){const e=this.genome,i=new Set(e.wgChromosomeNames),n=[];for(let r of e.wgChromosomeNames){const s=t[r];if(s)for(let t of s){let r=e.getChromosomeName(t.chr);if(i.has(r)){const i=Object.assign({},t);i.chr="all",i.start=e.getGenomeCoordinate(t.chr,t.start),i.end=e.getGenomeCoordinate(t.chr,t.end),i._f=t,i.exons&&delete i.exons,i.popupData=function(t){return"function"==typeof this._f.popupData?this._f.popupData():Pr.extractPopupData(this._f,e.id)},n.push(i)}}}return n.sort((function(t,e){return t.start-e.start})),n}}function Ns(t,e){if(e=e||1e3,null==t||0===t.length)return;const i={},n=[];for(let e of t){const t=e.chr;let r=i[t];r||(r=[],i[t]=r,n.push(t)),r.push(e)}for(let t of n)Ds(i[t],e)}class Ps{constructor(t,e,i){this.path=t.url,this.bufferSize=i||512e3,this.range={start:-1,size:-1},this.config=t}async dataViewForRange(t,e){if(!(this.data&&this.range.start<=t.start&&this.range.start+this.range.size>=t.start+t.size)){let e;e=t.size?Math.max(this.bufferSize,t.size):this.bufferSize;const i={start:t.start,size:e},n=await un.loadArrayBuffer(this.path,sn(this.config,{range:i}));this.data=n,this.range=i}const i=this.data.byteLength,n=t.start-this.range.start;return e?new Uint8Array(this.data,n,i-n):new DataView(this.data,n,i-n)}}class Os{constructor(t,e){this.path=t.url,this.genome=e,this.rpTreeCache={},this.config=t}async readWGFeatures(t,e){await this.loadHeader();const i=this.chromTree.idToChrom.length-1,n=this.chromTree.idToChrom[0],r=this.chromTree.idToChrom[i];return this.readFeatures(n,0,r,Number.MAX_VALUE,t,e)}async readFeatures(t,e,i,n,r,s){await this.loadHeader();const o=this.chromTree.chromToID[t],a=this.chromTree.chromToID[i];if(void 0===o||void 0===a)return[];let h,l;if("bigwig"===this.type){const t=await this.getZoomHeaders();let e=r?function(t,e){let i;for(let n=0;n<e.length;n++){const r=e[n];if(r.reductionLevel<t){i=r;break}}return i}(r,t):void 0;e?(h=e.indexOffset,l=Zs):(h=this.header.fullIndexOffset,l=Ws)}else h=this.header.fullIndexOffset,l=Gs.call(this);const c=await this.loadRPTree(h),u=await c.findLeafItemsOverlapping(o,e,a,n);if(u&&0!==u.length){let t=Number.MAX_VALUE,i=0;for(let e of u)t=Math.min(t,e.dataOffset),i=Math.max(i,e.dataOffset+e.dataSize);const r=i-t,h=await un.loadArrayBuffer(this.config.url,sn(this.config,{range:{start:t,size:r}})),c=[],f=new Uint8Array(h);for(let i of u){const r=f.subarray(i.dataOffset-t,i.dataOffset+i.dataSize);let h;if(this.header.uncompressBuffSize>0){h=new B.Inflate(r).decompress()}else h=r;l.call(this,new DataView(h.buffer),o,e,a,n,c,this.chromTree.idToChrom,s)}return c.sort((function(t,e){return t.start-e.start})),c}return[]}async getZoomHeaders(){return this.zoomLevelHeaders||await this.loadHeader(),this.zoomLevelHeaders}async loadHeader(){if(this.header)return this.header;{let t,e=await un.loadArrayBuffer(this.path,sn(this.config,{range:{start:0,size:64}}));this.littleEndian=!0;let i=new is(new DataView(e)),n=i.getUInt();if(2291137574===n)this.type="bigwig";else if(2273964779===n)this.type="bigbed";else{this.littleEndian=!1,i.littleEndian=!1,i.position=0;let t=i.getUInt();654085990===t?this.type="bigwig":3958540679===t&&(this.type="bigbed")}t={bwVersion:i.getUShort(),nZoomLevels:i.getUShort(),chromTreeOffset:i.getLong(),fullDataOffset:i.getLong(),fullIndexOffset:i.getLong(),fieldCount:i.getUShort(),definedFieldCount:i.getUShort(),autoSqlOffset:i.getLong(),totalSummaryOffset:i.getLong(),uncompressBuffSize:i.getInt(),extensionOffset:i.getLong()};const r=64;let s={start:r,size:t.fullDataOffset-r+5};e=await un.loadArrayBuffer(this.path,sn(this.config,{range:s}));const o=t.nZoomLevels;i=new is(new DataView(e)),this.zoomLevelHeaders=[],this.firstZoomDataOffset=Number.MAX_SAFE_INTEGER;for(let t=1;t<=o;t++){const e=o-t,n=new zs(e,i);this.firstZoomDataOffset=Math.min(n.dataOffset,this.firstZoomDataOffset),this.zoomLevelHeaders[e]=n}if(t.autoSqlOffset>0){i.position=t.autoSqlOffset-r;const e=i.getString();e&&(this.autoSql=function(t){let e;const i=[];let n=!1;const r=t.trim().split(/\s*[\r\n]+\s*/g);for(let t of r)if(t.startsWith("table"))e=t.split(/\s+/)[1].trim();else if(t.startsWith("("))n=!0;else if(t.startsWith(")"));else if(n&&t.length>0){const e=t.indexOf(";"),n=t.substr(0,e).split(/\s+/),r=t.substr(e+1).replace(/"/g,"").trim();i.push({type:n[0],name:n[1],description:r})}return{table:e,fields:i}}(e))}if(t.totalSummaryOffset>0&&(i.position=t.totalSummaryOffset-r,this.totalSummary=new Vs(i)),!(t.chromTreeOffset>0))throw"BigWig chromosome tree offset <= 0";return i.position=t.chromTreeOffset-r,this.chromTree=new $s(i,r,this.genome),i.position=t.fullDataOffset-r,t.dataCount=i.getInt(),this.setDefaultVisibilityWindow(t),this.header=t,this.header}}async loadRPTree(t){let e=this.rpTreeCache[t];return e||(e=new Hs(t,this.config,this.littleEndian),await e.load(),this.rpTreeCache[t]=e,e)}async getType(){return await this.loadHeader(),this.type}async getTrackType(){return await this.loadHeader(),"bigwig"===this.type?"wig":this.autoSql&&"chromatinInteract"===this.autoSql.table?"interact":"annotation"}setDefaultVisibilityWindow(t){if("bigwig"===this.type)this.visibilityWindow=-1;else{let e=this.genome?this.genome.getGenomeLength():3088286401;this.visibilityWindow=t.dataCount<1e3?-1:e/t.dataCount*1e3}}}class zs{constructor(t,e){this.index=t,this.reductionLevel=e.getInt(),this.reserved=e.getInt(),this.dataOffset=e.getLong(),this.indexOffset=e.getLong()}}class Hs{constructor(t,e,i){this.config=e,this.fileOffset=t,this.path=e.url,this.littleEndian=i}async load(){const t=this.fileOffset+48,e=new Ps(this.config,512e3);return this.rootNode=await this.readNode(t,e),this}async readNode(t,e){let i=await e.dataViewForRange({start:t,size:4},!1),n=new is(i,this.littleEndian);const r=1===n.getByte(),s=(n.getByte(),n.getUShort());let o={start:t+=4,size:s*(r?32:24)};i=await e.dataViewForRange(o,!1);const a=new Array(s);if(n=new is(i),r){for(let t=0;t<s;t++){let e={isLeaf:!0,startChrom:n.getInt(),startBase:n.getInt(),endChrom:n.getInt(),endBase:n.getInt(),dataOffset:n.getLong(),dataSize:n.getLong()};a[t]=e}return new Us(a)}for(let t=0;t<s;t++){let e={isLeaf:!1,startChrom:n.getInt(),startBase:n.getInt(),endChrom:n.getInt(),endBase:n.getInt(),childOffset:n.getLong()};a[t]=e}return new Us(a)}async findLeafItemsOverlapping(t,e,i,n){let r=this;return new Promise((function(s,o){let a=[],h=new Set,l=new Ps(r.config,512e3);h.add(0),function c(u,f){if(qs(u,t,e,i,n)){u.items.forEach((function(s){qs(s,t,e,i,n)&&(s.isLeaf?a.push(s):s.childNode?c(s.childNode):(h.add(s.childOffset),r.readNode(s.childOffset,l).then((function(t){s.childNode=t,c(t,s.childOffset)})).catch(o)))}))}void 0!==f&&h.delete(f);0===h.size&&s(a)}(r.rootNode,0)}))}}class Us{constructor(t){this.items=t;let e,i,n=Number.MAX_SAFE_INTEGER,r=0,s=Number.MAX_SAFE_INTEGER,o=0;for(e=0;e<t.length;e++)i=t[e],n=Math.min(n,i.startChrom),r=Math.max(r,i.endChrom),s=Math.min(s,i.startBase),o=Math.max(o,i.endBase);this.startChrom=n,this.endChrom=r,this.startBase=s,this.endBase=o}}class $s{constructor(t,e,i){let n=t.getInt(),r=t.getInt(),s=t.getInt(),o=t.getInt(),a=t.getLong(),h=t.getLong(),l={},c=[];this.header={magic:n,blockSize:r,keySize:s,valSize:o,itemCount:a,reserved:h},this.chromToID=l,this.idToChrom=c,function t(n,r){r>=0&&(n.position=r);let o,a,h,u,f,d,p,g=n.getByte(),m=(n.getByte(),n.getUShort());if(1===g)for(o=0;o<m;o++)a=n.getFixedLengthTrimmedString(s),h=n.getInt(),u=n.getInt(),i&&(a=i.getChromosomeName(a)),l[a]=h,c[h]=a;else for(o=0;o<m;o++)a=n.getFixedLengthTrimmedString(s),f=n.getLong(),d=f-e,p=n.position,t(n,d),n.position=p}(t,-1)}}function qs(t,e,i,n,r){return!!t&&((n>t.startChrom||n===t.startChrom&&r>=t.startBase)&&(e<t.endChrom||e===t.endChrom&&i<=t.endBase))}class Vs{constructor(t){t?(this.basesCovered=t.getLong(),this.minVal=t.getDouble(),this.maxVal=t.getDouble(),this.sumData=t.getDouble(),this.sumSquares=t.getDouble(),js.call(this)):(this.basesCovered=0,this.minVal=0,this.maxVal=0,this.sumData=0,this.sumSquares=0,this.mean=0,this.stddev=0)}}function js(){let t=this.basesCovered;if(t>0){this.mean=this.sumData/t,this.stddev=Math.sqrt(this.sumSquares/(t-1));let e=this.minVal<0?this.mean-2*this.stddev:0,i=this.maxVal>0?this.mean+2*this.stddev:0;this.defaultRange={min:e,max:i}}}function Ws(t,e,i,n,r,s,o){const a=new is(t),h=a.getInt();let l=a.getInt(),c=a.getInt();const u=a.getInt(),f=a.getInt(),d=a.getByte();a.getByte();let p=a.getUShort();if(h>=e&&h<=n)for(;p-- >0;){let t;switch(d){case 1:l=a.getInt(),c=a.getInt(),t=a.getFloat();break;case 2:l=a.getInt(),t=a.getFloat(),c=l+f;break;case 3:t=a.getFloat(),c=l+f,l+=u}if(!(h<e||h===e&&c<i)){if(h>n||h===n&&l>=r)break;if(Number.isFinite(t)){const e=o[h];s.push({chr:e,start:l,end:c,value:t})}}}}function Gs(){const t=function(t,e,i){if(i&&"chromatinInteract"===i.table)return function(t,e){return t.chr1=e[5],t.start1=Number.parseInt(e[6]),t.end1=Number.parseInt(e[7]),t.chr2=e[10],t.start2=Number.parseInt(e[11]),t.end2=Number.parseInt(e[12]),t.name=e[0],t.score=Number.parseFloat(e[1]),t.value=Number.parseFloat(e[2]),t.color="."===e[4]?void 0:"0"===e[4]?"rgb(0,0,0)":e[4],t};{const n=t-3;return function(r,s){if(n>0&&(r.name=s[0]),n>1&&(r.score=parseFloat(s[1])),n>2&&(r.strand=s[2]),n>3&&(r.cdStart=parseInt(s[3])),n>4&&(r.cdEnd=parseInt(s[4])),n>5&&"."!==s[5]&&"0"!==s[5]&&"-1"!==s[5]){const t=ct.createColorString(s[5]);r.color=t.startsWith("rgb")?t:void 0}if(n>8){const t=parseInt(s[6]),e=s[7].split(","),i=s[8].split(","),n=[];for(let s=0;s<t;s++){const t=r.start+parseInt(i[s]),o=t+parseInt(e[s]);n.push({start:t,end:o})}r.exons=n}if(i)for(let n=t;n<e;n++)if(n<i.fields.length){const t=i.fields[n].name,e=s[n-3];r[t]=e}}}}(this.header.definedFieldCount,this.header.fieldCount,this.autoSql);return function(e,i,n,r,s,o,a){const h=new is(e);for(;h.remLength()>=13;){const e=h.getInt(),l=a[e],c=h.getInt(),u=h.getInt(),f=h.getString();if(!(e<i||e===i&&u<n)){if(e>r||e===r&&c>=s)break;if(u>0){const e={chr:l,start:c,end:u};o.push(e);const i=f.split("\t");t(e,i)}}}}}function Zs(t,e,i,n,r,s,o,a){const h=new is(t);for(;h.remLength()>=32;){const t=h.getInt(),l=o[t],c=h.getInt(),u=h.getInt(),f=h.getInt(),d=h.getFloat(),p=h.getFloat(),g=h.getFloat();h.getFloat();let m;switch(a){case"min":m=d;break;case"max":m=p;break;default:m=0===f?0:g/f}if(!(t<e||t===e&&u<i)){if(t>n||t===n&&c>=r)break;Number.isFinite(m)&&s.push({chr:l,start:c,end:u,value:m})}}}class Xs{constructor(t,e){this.reader=new Os(t,e),this.genome=e,this.format=t.format||"bigwig",this.wgValues={}}async getFeatures({chr:t,start:e,end:i,bpPerPixel:n,windowFunction:r}){const s="all"===t.toLowerCase()?await this.getWGValues(r):await this.reader.readFeatures(t,e,t,i,n,r);return"bigwig"===this.reader.type||Ds(s),s}async getHeader(){return this.reader.loadHeader()}getDefaultRange(){return void 0!==this.reader.totalSummary?this.reader.totalSummary.defaultRange:void 0}async defaultVisibilityWindow(){return this.reader.defaultVisibilityWindow}async getWGValues(t){const e=this.genome;if(this.wgValues[t])return this.wgValues[t];{const i=e.getGenomeLength()/1e3,n=await this.reader.readWGFeatures(i,t);let r=[];for(let t of n){const i=t.chr,n=e.getCumulativeOffset(i),s=Object.assign({},t);s.chr="all",s.start=n+t.start,s.end=n+t.end,r.push(s)}return this.wgValues[t]=r,r}}supportsWholeGenome(){return"bigwig"===this.reader.type||this.defaultVisibilityWindow()<=0}async trackType(){return this.reader.getTrackType()}}class Ys{constructor(t,e){this.config=t,this.genome=e,this.path=t.url,this.groupCache={},this.datasetCache={}}async readHeader(){if(void 0!==this.magic)return this;let t=await un.loadArrayBuffer(this.path,sn(this.config,{range:{start:0,size:64e3}})),e=new is(new DataView(t));this.magic=e.getInt(),this.version=e.getInt(),this.indexPos=e.getLong(),this.indexSize=e.getInt();e.getInt();if(this.version>=2){let t=e.getInt();for(this.windowFunctions=[];t-- >0;)this.windowFunctions.push(e.getString())}this.trackType=e.getString(),this.trackLine=e.getString();let i=e.getInt();for(this.trackNames=[];i-- >0;)this.trackNames.push(e.getString());this.genomeID=e.getString(),this.flags=e.getInt(),this.compressed=0!=(1&this.flags),t=await un.loadArrayBuffer(this.path,sn(this.config,{range:{start:this.indexPos,size:this.indexSize}})),e=new is(new DataView(t)),this.datasetIndex={};let n=e.getInt();for(;n-- >0;){const t=e.getString(),i=e.getLong(),n=e.getInt();this.datasetIndex[t]={position:i,size:n}}for(this.groupIndex={},n=e.getInt();n-- >0;){const t=e.getString(),i=e.getLong(),n=e.getInt();this.groupIndex[t]={position:i,size:n}}return this}async readDataset(t,e,i){const n=t+"_"+e+"_"+i;if(this.datasetCache[n])return this.datasetCache[n];{await this.readHeader();const r=this.version<2?"":"/"+e,s="all"===t.toLowerCase()||void 0===i?"0":i.toString();let o;o="raw"===e?"/"+t+"/raw":"/"+t+"/z"+s+r;const a=this.datasetIndex[o];if(void 0===a)return;const h=await un.loadArrayBuffer(this.path,sn(this.config,{range:{start:a.position,size:a.size}}));if(!h)return;const l=new is(new DataView(h));let c=l.getInt();const u={};for(;c-- >0;)u[l.getString()]=l.getString();const f=l.getString(),d=l.getFloat();let p=l.getInt();const g=[];for(;p-- >0;)g.push({position:l.getLong(),size:l.getInt()});const m={name:o,attributes:u,dataType:f,tileWidth:d,tiles:g};return this.datasetCache[n]=m,m}}async readRootGroup(){const t=this.genome,e=this.groupCache["/"];if(e)return e;{const e=await this.readGroup("/"),i=e.chromosomes,n=e.maxZoom;n&&(this.maxZoom=Number(n));const r=e.totalCount;r&&(e.totalCount=Number.parseFloat(r));const s={};return i&&i.split(",").forEach((function(e){const i=t.getChromosomeName(e);s[i]=e})),this.chrAliasTable=s,this.groupCache["/"]=e,e}}async readGroup(t){const e=this.groupCache[t];if(e)return e;{await this.readHeader();const e=this.groupIndex[t];if(void 0===e)return;const i=await un.loadArrayBuffer(this.path,sn(this.config,{range:{start:e.position,size:e.size}}));if(!i)return;const n=new is(new DataView(i)),r={name:t};let s=n.getInt();for(;s-- >0;){const t=n.getString(),e=n.getString();r[t]=e}return this.groupCache[t]=r,r}}async readTiles(t,e){if(t.sort((function(t,e){return t.position-e.position})),0===(t=t.filter((function(t){return t.size>0}))).length)return Promise.resolve([]);const i=t[0],n=t[t.length-1],r=i.position,s=n.position+n.size-r,o=await un.loadArrayBuffer(this.path,sn(this.config,{range:{start:r,size:s}})),a=[];for(let i of t){const t=i.position-r,n=i.size;if(n>0){let i;if(this.compressed){i=new B.Inflate(new Uint8Array(o,t,n)).decompress().buffer}else i=o.slice(t,t+n);const r=new is(new DataView(i)),s=r.getString();let h;switch(s){case"fixedStep":h=Ks(r,e);break;case"variableStep":h=Qs(r,e);break;case"bed":case"bedWithName":h=Js(r,e,s);break;default:throw"Unknown tile type: "+s}a.push(h)}}return a}async readTile(t,e){let i=await un.loadArrayBuffer(this.path,sn(this.config,{range:{start:t.position,size:t.size}}));if(this.compressed){i=new B.Inflate(new Uint8Array(i)).decompress().buffer}const n=new is(new DataView(i)),r=n.getString();switch(r){case"fixedStep":return Ks(n,e);case"variableStep":return Qs(n,e);case"bed":case"bedWithName":return Js(n,e,r);default:throw"Unknown tile type: "+r}}}function Ks(t,e){const i=t.getInt(),n=t.getInt(),r=t.getFloat(),s=[];let o=e;for(;o-- >0;){let e=i;const n=[];for(;e-- >0;)n.push(t.getFloat());s.push(n)}return{type:"fixedStep",start:n,span:r,data:s,nTracks:e,nPositions:i}}function Qs(t,e){const i=t.getInt(),n=t.getFloat(),r=t.getInt(),s=[];let o=r;for(;o-- >0;)s.push(t.getInt());t.getInt();const a=[];let h=e;for(;h-- >0;){o=r;const e=[];for(;o-- >0;)e.push(t.getFloat());a.push(e)}return{type:"variableStep",tileStart:i,span:n,start:s,data:a,nTracks:e,nPositions:r}}function Js(t,e,i){const n=t.getInt();let r=n;const s=[];for(;r-- >0;)s.push(t.getInt());r=n;const o=[];for(;r-- >0;)o.push(t.getInt());t.getInt();const a=[];let h=e;for(;h-- >0;){let e=n;const i=[];for(;e-- >0;)i.push(t.getFloat());a.push(i)}if("bedWithName"===i){r=n;const e=[];for(;r-- >0;)e.push(t.getString())}return{type:i,start:s,end:o,data:a,nTracks:e,nPositions:n}}class to{constructor(t,e){this.genome=e,this.windowFunction=t.windowFunction||"mean",this.reader=new Ys(t,e)}async getFeatures({chr:t,start:e,end:i,bpPerPixel:n}){const r=new Gi(t,e,i),s=this.genome;if(!this.rootGroup&&(this.rootGroup=await this.reader.readRootGroup(),!this.normalizationFactor)){const t=this.rootGroup.totalCount;t&&(this.normalizationFactor=1e6/t)}if("all"===t.toLowerCase())return[];r.bpPerPixel=n;const o=function(t,e,i){var n=i.getChromosome(t).bpLength;return Math.ceil(Math.log(Math.max(0,n/(700*e)))/ro)}(t,n,s);let a=this.reader.chrAliasTable[t],h=this.reader.maxZoom;void 0===a&&(a=t),void 0===h&&(h=-1);const l=o>h?"raw":this.windowFunction,c=await this.reader.readDataset(a,l,o);if(null==c)return[];const u=c.tileWidth,f=Math.floor(e/u),d=Math.floor(i/u),p=await this.reader.readTiles(c.tiles.slice(f,d+1),1),g=[];for(let r of p)switch(r.type){case"bed":eo(r,t,e,i,n,g);break;case"variableStep":io(r,t,e,i,n,g);break;case"fixedStep":no(r,t,e,i,n,g);break;default:throw"Unknown tile type: "+r.type}return g.sort((function(t,e){return t.start-e.start})),g}supportsWholeGenome(){return!1}}function eo(t,e,i,n,r,s){const o=t.nPositions,a=t.start,h=t.end,l=t.data[0];for(let t=0;t<o;t++){const r=a[t],o=h[t];if(!(o<i)){if(r>n)break;s.push({chr:e,start:r,end:o,value:l[t]})}}}function io(t,e,i,n,r,s){const o=t.nPositions,a=t.start,h=t.span,l=t.data[0];for(let t=0;t<o;t++){const r=a[t],o=r+h;if(!(o<i)){if(r>n)break;s.push({chr:e,start:r,end:o,value:l[t]})}}}function no(t,e,i,n,r,s){const o=t.nPositions;let a=t.start;const h=t.span,l=t.data[0];for(let t=0;t<o;t++){const r=a+h;if(a>n)break;r>=i&&(Number.isNaN(l[t])||s.push({chr:e,start:a,end:r,value:l[t]})),a=r}}var ro=Math.log(2);function so(t,e){const i=t.format?t.format.toLowerCase():void 0;return"bigwig"===i||"bigbed"===i||"bb"===i?new Xs(t,e):"tdf"===i?new to(t,e):new Bs(t,e)}const oo={Set1:["rgb(228,26,28)","rgb(55,126,184)","rgb(77,175,74)","rgb(166,86,40)","rgb(152,78,163)","rgb(255,127,0)","rgb(247,129,191)","rgb(153,153,153)","rgb(255,255,51)"],Dark2:["rgb(27,158,119)","rgb(217,95,2)","rgb(117,112,179)","rgb(231,41,138)","rgb(102,166,30)","rgb(230,171,2)","rgb(166,118,29)","rgb(102,102,102)"],Set2:["rgb(102, 194,165)","rgb(252,141,98)","rgb(141,160,203)","rgb(231,138,195)","rgb(166,216,84)","rgb(255,217,47)","rgb(229,196,148)","rgb(179,179,179)"],Set3:["rgb(141,211,199)","rgb(255,255,179)","rgb(190,186,218)","rgb(251,128,114)","rgb(128,177,211)","rgb(253,180,98)","rgb(179,222,105)","rgb(252,205,229)","rgb(217,217,217)","rgb(188,128,189)","rgb(204,235,197)","rgb(255,237,111)"],Pastel1:["rgb(251,180,174)","rgb(179,205,227)","rgb(204,235,197)","rgb(222,203,228)","rgb(254,217,166)","rgb(255,255,204)","rgb(229,216,189)","rgb(253,218,236)"],Pastel2:["rgb(173,226,207)","rgb(253,205,172)","rgb(203,213,232)","rgb(244,202,228)","rgb(230,245,201)","rgb(255,242,174)","rgb(243,225,206)"],Accent:["rgb(127,201,127)","rgb(190,174,212)","rgb(253,192,134)","rgb(255,255,153)","rgb(56,108,176)","rgb(240,2,127)","rgb(191,91,23)"]};function ao(t){this.colors=oo[t],Array.isArray(this.colors)||(this.colors=[]),this.colorTable={},this.nextIdx=0,this.colorGenerator=new ho}function ho(){this.hue=Math.random(),this.goldenRatio=.618033988749895,this.hexwidth=2}ao.prototype.getColor=function(t){return this.colorTable.hasOwnProperty(t)||(this.nextIdx<this.colors.length?this.colorTable[t]=this.colors[this.nextIdx]:this.colorTable[t]=this.colorGenerator.get(),this.nextIdx++),this.colorTable[t]},ho.prototype.hsvToRgb=function(t,e,i){var n=Math.floor(6*t),r=6*t-n,s=i*(1-e),o=i*(1-r*e),a=i*(1-(1-r)*e),h=255,l=255,c=255;switch(n){case 0:h=i,l=a,c=s;break;case 1:h=o,l=i,c=s;break;case 2:h=s,l=i,c=a;break;case 3:h=s,l=o,c=i;break;case 4:h=a,l=s,c=i;break;case 5:h=i,l=s,c=o}return[Math.floor(256*h),Math.floor(256*l),Math.floor(256*c)]},ho.prototype.padHex=function(t){return t.length>this.hexwidth?t:new Array(this.hexwidth-t.length+1).join("0")+t},ho.prototype.get=function(t,e){this.hue+=this.goldenRatio,this.hue%=1,"number"!=typeof t&&(t=.5),"number"!=typeof e&&(e=.95);var i=this.hsvToRgb(this.hue,t,e);return"#"+this.padHex(i[0].toString(16))+this.padHex(i[1].toString(16))+this.padHex(i[2].toString(16))};const lo=new ho;const co={getTissueInfo:function(t,e){let i=(e=e||"https://gtexportal.org/rest/v1")+"/dataset/tissueInfo?datasetId="+(t=t||"gtex_v8");return un.loadJson(i,{})},trackConfiguration:function(t,e){return{type:"eqtl",sourceType:"gtex-ws",url:(e=e||"https://gtexportal.org/rest/v1")+"/association/singleTissueEqtlByLocation",tissueSiteDetailId:t.tissueSiteDetailId,name:t.tissueSiteDetailId.split("_").join(" "),visibilityWindow:25e4}}};let uo=new ao("Dark2");["GT/AG","CT/AC","GC/AG","CT/GC","AT/AC","GT/AT","non-canonical"].forEach((t=>{uo.getColor(t)}));const fo={};class po extends Pr{constructor(t,e){super(t,e),this.maxRows=void 0===t.maxRows?1e3:t.maxRows,this.displayMode=t.displayMode||"EXPANDED",this.labelDisplayMode=t.labelDisplayMode,t._featureSource?(this.featureSource=t._featureSource,delete t._featureSource):this.featureSource=t.featureSource?t.featureSource:so(t,e.genome),this.autoHeight=t.autoHeight,this.margin=void 0===t.margin?10:t.margin,this.featureHeight=t.featureHeight||14,"FusionJuncSpan"===t.type?(this.squishedRowHeight=t.squishedRowHeight||50,this.expandedRowHeight=t.expandedRowHeight||50,this.height=t.height||this.margin+2*this.expandedRowHeight):"snp"===t.type?(this.expandedRowHeight=t.expandedRowHeight||10,this.squishedRowHeight=t.squishedRowHeight||5,this.height=t.height||30):(this.squishedRowHeight=t.squishedRowHeight||15,this.expandedRowHeight=t.expandedRowHeight||30,this.height=t.height||this.margin+2*this.expandedRowHeight),void 0!==this.height&&this.height||(this.height=100),"spliceJunctions"===t.type&&void 0===t.colorByNumReadsThreshold&&(t.colorByNumReadsThreshold=5),t.render?this.render=t.render:"FusionJuncSpan"===t.type?this.render=vo:"spliceJunctions"===t.type?(this.render=yo,this.displayMode="COLLAPSED"):"snp"===t.type?(this.render=Co,this.snpColors=["rgb(0,0,0)","rgb(0,0,255)","rgb(0,255,0)","rgb(255,0,0)"],this.colorBy="function"):(this.render=bo,this.arrowSpacing=30,function(t){t.browser.on&&(t.browser.on("trackdragend",e),t.browser.on("trackremoved",i));function e(){t.trackView&&t.trackView.tile&&"SQUISHED"!==t.displayMode&&t.trackView.repaintViews()}function i(n){t.browser.un&&t===n&&(t.browser.un("trackdrag",e),t.browser.un("trackremoved",i))}}(this)),this.useScore=t.useScore}async postInit(){return"function"==typeof this.featureSource.getHeader&&(this.header=await this.featureSource.getHeader()),this.header&&this.setTrackProperties(this.header),void 0===this.visibilityWindow&&"function"==typeof this.featureSource.defaultVisibilityWindow&&(this.visibilityWindow=await this.featureSource.defaultVisibilityWindow(),this.featureSource.visibilityWindow=this.visibilityWindow),this}supportsWholeGenome(){return(!1===this.config.indexed||!this.config.indexURL)&&!1!==this.config.supportsWholeGenome}async getFeatures(t,e,i,n){const r=this.visibilityWindow;return this.featureSource.getFeatures({chr:t,start:e,end:i,bpPerPixel:n,visibilityWindow:r})}computePixelHeight(t){if("spliceJunctions"===this.type)return this.height;if("COLLAPSED"===this.displayMode)return this.margin+this.expandedRowHeight;{let e=0;if(t&&"function"==typeof t.forEach)for(let i of t)i.row&&i.row>e&&(e=i.row);return this.margin+(e+1)*("SQUISHED"===this.displayMode?this.squishedRowHeight:this.expandedRowHeight)}}draw(t){const e=t.features,i=t.context,n=t.bpPerPixel,r=t.bpStart,s=t.pixelWidth,o=t.pixelHeight,a=r+s*n+1;if(this.config.isMergedTrack||Ii.fillRect(i,0,t.pixelTop,s,o,{fillStyle:"rgb(255, 255, 255)"}),e){const h=[];t.rowLastX=[];for(let i of e){const e=i.row||0;void 0===h[e]?h[e]=1:h[e]++,t.rowLastX[e]=-Number.MAX_SAFE_INTEGER}"spliceJunctions"==this.config.type&&(fo.referenceFrame=t.viewport.referenceFrame,fo.referenceFrameStart=fo.referenceFrame.start,fo.referenceFrameEnd=fo.referenceFrameStart+fo.referenceFrame.toBP(Ri(t.viewport.contentDiv).width()),fo.featureZoomOutTracker={});let l=[];for(let c of e){if(c.end<r)continue;if(c.start>a)break;const e="COLLAPSED"===this.displayMode?0:c.row,u=s/h[e];t.drawLabel=t.labelAllFeatures||u>10;const f=Math.ceil((c.end-r)/n),d=l[e];if((!d||f>d||"spliceJunctions"===this.config.type)&&(this.render.call(this,c,r,n,o,i,t),"spliceJunctions"!==this.config.type)){const t=Math.floor((c.start-r)/n);d&&t-d<=0&&(i.globalAlpha=.5,Ii.strokeLine(i,t,0,t,o,{strokeStyle:"rgb(255, 255, 255)"}),i.globalAlpha=1),l[e]=f}}}}clickedFeatures(t){const e=t.y-this.margin,i=super.clickedFeatures(t);let n;switch(this.displayMode){case"SQUISHED":n=Math.floor(e/this.squishedRowHeight);break;case"EXPANDED":n=Math.floor(e/this.expandedRowHeight);break;default:n=void 0}return i.filter((function(t){return void 0===n||void 0===t.row||n===t.row}))}popupData(t,e){e||(e=this.clickedFeatures(t));const i=t.genomicLocation,n=[];for(let t of e){if(!("spliceJunctions"!==this.config.type||t.isVisible&&t.attributes))continue;const e="function"==typeof t.popupData?t.popupData(i):Pr.extractPopupData(t,this.getGenomeId());e&&(n.length>0&&n.push("<HR>"),Array.prototype.push.apply(n,e))}return n}menuItemList(){const t=this,e=[];return this.render===Co&&(["function","class"].forEach((function(i){e.push({object:En("Color by "+i,i===t.colorBy),click:function(){t.colorBy=i,t.trackView.repaintViews()}})})),e.push({object:Ri('<div class="igv-track-menu-border-top">')})),e.push({object:Ri('<div class="igv-track-menu-border-top">')}),["COLLAPSED","SQUISHED","EXPANDED"].forEach((function(i){e.push({object:En({COLLAPSED:"Collapse",SQUISHED:"Squish",EXPANDED:"Expand"}[i],i===t.displayMode),click:function(){t.displayMode=i,t.config.displayMode=i,t.trackView.checkContentHeight(),t.trackView.repaintViews()}})})),e}description(){if(Co===this.render){let t="<html>"+this.name+"<hr>";return t+="<em>Color By Function:</em><br>",t+='<span style="color:red">Red</span>: Coding-Non-Synonymous, Splice Site<br>',t+='<span style="color:green">Green</span>: Coding-Synonymous<br>',t+='<span style="color:blue">Blue</span>: Untranslated<br>',t+='<span style="color:black">Black</span>: Intron, Locus, Unknown<br><br>',t+="<em>Color By Class:</em><br>",t+='<span style="color:red">Red</span>: Deletion<br>',t+='<span style="color:green">Green</span>: MNP<br>',t+='<span style="color:blue">Blue</span>: Microsatellite, Named<br>',t+='<span style="color:black">Black</span>: Indel, Insertion, SNP',t+="</html>",t}return this.name}dispose(){this.trackView=void 0}}function go(t,e,i){let n=(t.start-e)/i,r=(t.end-e)/i,s=r-n;return s<3&&(s=3,n-=1.5),{px:n,px1:r,pw:s}}function mo(t){let e;if(this.altColor&&"-"===t.strand)e=this.altColor;else if(this.color)e=this.color;else if(this.config.colorBy){const i=t[this.config.colorBy.field];i&&(e=this.config.colorBy.pallete[i])}else e=t.color?t.color:this.defaultColor;if(t.alpha&&1!==t.alpha)e=ct.addAlpha(e,t.alpha);else if(this.useScore&&t.score&&!Number.isNaN(t.score)){const i=function(t,e,i){const n=(e-t)/9,r=Math.floor((i-t)/n);return Math.min(1,.2+.8*r/9)}(this.config.min?this.config.min:0,this.config.max?this.config.max:1e3,t.score);t.alpha=i,e=ct.addAlpha(e,i)}return e}function bo(t,e,i,n,r,s){this.browser;let o,a,h=mo.call(this,t);r.fillStyle=h,r.strokeStyle=h,"SQUISHED"===this.displayMode&&void 0!==t.row?(o=this.featureHeight/2,a=this.margin+this.squishedRowHeight*t.row):"EXPANDED"===this.displayMode&&void 0!==t.row?(o=this.featureHeight,a=this.margin+this.expandedRowHeight*t.row):(o=this.featureHeight,a=this.margin);const l=a+o/2,c=o/2,u=l-c/2,f=t.exons?t.exons.length:0,d=go(t,e,i),p=this.arrowSpacing,g="+"===t.strand?1:"-"===t.strand?-1:0;if(0===f){if(r.fillRect(d.px,a,d.pw,o),0!==g){r.fillStyle="white",r.strokeStyle="white";for(let t=d.px+p/2;t<d.px1;t+=p)Ii.strokeLine(r,t-2*g,l-2,t,l),Ii.strokeLine(r,t-2*g,l+2,t,l);r.fillStyle=h,r.strokeStyle=h}}else{Ii.strokeLine(r,d.px+1,l,d.px1-1,l);const n=s.pixelWidth,m=Math.max(0,d.px)+p/2,b=Math.min(n,d.px1);for(let t=m;t<b;t+=p)Ii.strokeLine(r,t-2*g,l-2,t,l),Ii.strokeLine(r,t-2*g,l+2,t,l);for(let s=0;s<f;s++){const f=t.exons[s];let d,m=Math.round((f.start-e)/i),b=Math.round((f.end-e)/i),w=Math.max(1,b-m);if(!(m+w<0)){if(m>n)break;if(f.utr)r.fillRect(m,u,w,c);else if(f.cdStart&&(d=Math.round((f.cdStart-e)/i),r.fillRect(m,u,d-m,c),w-=d-m,m=d),f.cdEnd&&(d=Math.round((f.cdEnd-e)/i),r.fillRect(d,u,b-d,c),w-=b-d,b=d),r.fillRect(m,a,w,o),w>p+5&&0!==g){r.fillStyle="white",r.strokeStyle="white";for(let t=m+p/2;t<b;t+=p)Ii.strokeLine(r,t-2*g,l-2,t,l),Ii.strokeLine(r,t-2*g,l+2,t,l);r.fillStyle=h,r.strokeStyle=h}}}}const m=Math.round(s.viewportContainerX),b=m+s.viewportWidth;s.drawLabel&&wo.call(this,r,t,d.px,d.px1,a,m,b,s.referenceFrame,s)}function wo(t,e,i,n,r,s,o,a,h){let l,c,u=e.name;if(void 0===u&&e.gene&&(u=e.gene.name),void 0===u&&(u=e.id||e.ID),!u||"."===u)return;n<s||i>o?(l=i,c=n):(l=Math.max(i,s),c=Math.min(n,o));let f,d=mo.call(this,e),p=!1;if(a.selection&&co.gtexLoaded&&(p=!0,f=a.selection.colorForGene(u)),"SQUISHED"!==this.displayMode){const i={textAlign:"SLANT"===this.labelDisplayMode?void 0:"center",fillStyle:f||d,strokeStyle:f||d};let n;"COLLAPSED"===this.displayMode&&"SLANT"===this.labelDisplayMode&&(n={rotate:{angle:45}});const s=l+(c-l)/2,o=function(t,e){return e?t+20:t+25}(r,n),a=t.measureText(u),g=s-a.width/2,m=s+a.width/2;(h.labelAllFeatures||g>h.rowLastX[e.row]||p)&&(h.rowLastX[e.row]=m,h.labelTransform?(t.save(),h.labelTransform(t,s),Ii.fillText(t,u,s,o,i,void 0),t.restore()):Ii.fillText(t,u,s,o,i,n))}}function vo(t,e,i,n,r){var s,o="EXPANDED"===this.displayMode?this.expandedRowHeight:this.squishedRowHeight;"COLLAPSED"===this.display&&(s=this.margin),("SQUISHED"===this.displayMode&&void 0!==t.row||"EXPANDED"===this.displayMode&&void 0!==t.row)&&(s=this.margin+o*t.row);var a=s+.5*o,h=a-.5*o,l=a+.5*o,c=Math.round((t.junction_left-e)/i),u=Math.round((t.junction_right-e)/i);r.beginPath(),r.moveTo(c,a),r.bezierCurveTo(c,h,u,h,u,a),r.lineWidth=1+Math.log(t.num_junction_reads)/Math.log(2),r.strokeStyle="blue",r.stroke();for(var f=t.spanning_frag_coords,d=0;d<f.length;d++){var p=f[d],g=Math.round((p.left-e)/i),m=Math.round((p.right-e)/i);r.beginPath(),r.moveTo(g,a),r.bezierCurveTo(g,l,m,l,m,a),r.lineWidth=1,r.strokeStyle="purple",r.stroke()}}function yo(t,e,i,n,r){t.isVisible=!1;const s=Math.round((t.start-e)/i),o=Math.round((t.end-e)/i),a=(s+o)/2;if(o-s<=3){if(a in fo.featureZoomOutTracker)return;fo.featureZoomOutTracker[a]=!0}if(this.config.hideAnnotatedJunctions&&"true"===t.attributes.annotated_junction)return;if(this.config.hideUnannotatedJunctions&&"false"===t.attributes.annotated_junction)return;if(this.config.hideMotifs&&this.config.hideMotifs.includes(t.attributes.motif))return;if(this.config.hideStrand===t.strand)return;if(this.config.minJunctionEndsVisible){let e=0;if(t.start>=fo.referenceFrameStart&&t.start<=fo.referenceFrameEnd&&(e+=1),t.end>=fo.referenceFrameStart&&t.end<=fo.referenceFrameEnd&&(e+=1),e<this.config.minJunctionEndsVisible)return}let h,l,c,u;if(t.attributes.uniquely_mapped){if(h=parseInt(t.attributes.uniquely_mapped),h<this.config.minUniquelyMappedReads)return;if(l=parseInt(t.attributes.multi_mapped),c=h+l,c<this.config.minTotalReads)return;if(c>0&&l/c>this.config.maxFractionMultiMappedReads)return;if(t.attributes.maximum_spliced_alignment_overhang&&parseInt(t.attributes.maximum_spliced_alignment_overhang)<this.config.minSplicedAlignmentOverhang)return}if(t.attributes.num_samples_with_this_junction){if(u=parseInt(t.attributes.num_samples_with_this_junction),this.config.minSamplesWithThisJunction&&u<this.config.minSamplesWithThisJunction)return;if(this.config.maxSamplesWithThisJunction&&u>this.config.maxSamplesWithThisJunction)return;if(t.attributes.num_samples_total&&(t.attributes.percent_samples_with_this_junction=100*u/parseFloat(t.attributes.num_samples_total),this.config.minPercentSamplesWithThisJunction&&(t.attributes.percent_samples_with_this_junction<this.config.minPercentSamplesWithThisJunction||t.attributes.percent_samples_with_this_junction>this.config.maxPercentSamplesWithThisJunction)))return}const f=this.margin,d=this.height,p=f+.5*d;let g=f;const m=f+d-10,b=(s+a)/2,w=(a+o)/2;let v,y,x=1;t.attributes.line_width?x=parseFloat(t.attributes.line_width):(void 0===this.config.thicknessBasedOn||"numUniqueReads"===this.config.thicknessBasedOn?x=h:"numReads"===this.config.thicknessBasedOn?x=c:"numSamplesWithThisJunction"===this.config.thicknessBasedOn&&void 0!==u&&(x=u),x=1+Math.log(x+1)/Math.log(12)),void 0===this.config.bounceHeightBasedOn||"random"===this.config.bounceHeightBasedOn?v=(t.start+t.end)%7:"distance"===this.config.bounceHeightBasedOn?v=6*(t.end-t.start)/(fo.referenceFrameEnd-fo.referenceFrameStart):"thickness"===this.config.bounceHeightBasedOn&&(v=2*x),g+=d*Math.max(7-v,0)/10,y=t.attributes.color?t.attributes.color:void 0===this.config.colorBy||"numUniqueReads"===this.config.colorBy?h>this.config.colorByNumReadsThreshold?"blue":"#AAAAAA":"numReads"===this.config.colorBy?c>this.config.colorByNumReadsThreshold?"blue":"#AAAAAA":"isAnnotatedJunction"===this.config.colorBy?"true"===t.attributes.annotated_junction?"#b0b0ec":"orange":"strand"===this.config.colorBy?"+"===t.strand?"#b0b0ec":"#ecb0b0":"motif"===this.config.colorBy?uo.getColor(t.attributes.motif):"#AAAAAA";let k="";t.attributes.label?k=t.attributes.label.replace(/_/g," "):void 0===this.config.labelWith||"uniqueReadCount"===this.config.labelWith?k=h:"totalReadCount"===this.config.labelWith?k=c:"numSamplesWithThisJunction"===this.config.labelWith?void 0!==u&&(k=u):"percentSamplesWithThisJunction"===this.config.labelWith?void 0!==t.attributes.percent_samples_with_this_junction&&(k=t.attributes.percent_samples_with_this_junction.toFixed(0)+"%"):"motif"===this.config.labelWith&&void 0!==t.attributes.motif&&(k+=t.attributes.motif),"uniqueReadCount"===this.config.labelWithInParen?k+=" ("+h+")":"totalReadCount"===this.config.labelWithInParen?k+=" ("+c+")":"multiMappedReadCount"===this.config.labelWithInParen?l>0&&(k+=" (+"+l+")"):"numSamplesWithThisJunction"===this.config.labelWithInParen?void 0!==u&&(k+=" ("+u+")"):"percentSamplesWithThisJunction"===this.config.labelWithInParen?void 0!==t.attributes.percent_samples_with_this_junction&&(k+=" ("+t.attributes.percent_samples_with_this_junction.toFixed(0)+"%)"):"motif"===this.config.labelWithInParen&&void 0!==t.attributes.motif&&(k+=` ${t.attributes.motif}`),t.isVisible=!0,r.beginPath(),r.moveTo(s,m),r.bezierCurveTo(b,g,w,g,o,m),r.lineWidth=x,r.strokeStyle=y,r.stroke();const S=(t,e,i,n)=>{t.beginPath(),t.moveTo(e,i),t.lineTo(e-n/2,i-n),t.lineTo(e+n/2,i-n),t.lineTo(e,i),t.closePath(),t.fill()};if(t.attributes.left_shape||t.attributes.right_shape){r.fillStyle=y;const e=r.lineWidth>2?10:7;t.attributes.left_shape&&S(r,s,m,e),t.attributes.right_shape&&S(r,o,m,e)}r.fillText(k,a-r.measureText(k).width/2,(7*g+p)/8)}const xo=new Set(["nonsense","missense","stop-loss","frameshift","cds-indel"]),ko=new Set(["coding-synon"]),So=new Set(["splice-3","splice-5"]),_o=new Set(["untranslated-5","untranslated-3"]);function Co(t,e,i,n,r){var s,o,a,h,l=go(t,e,i),c=this.margin,u=this.snpColors.length;switch(s="squished"===this.displayMode?this.squishedRowHeight:this.expandedRowHeight,this.colorBy){case"function":h=t.func,o=h.split(",").map((function(t){return xo.has(t)||So.has(t)?u-1:ko.has(t)?u-2:_o.has(t)?u-3:0})).reduce((function(t,e){return Math.max(t,e)}));break;case"class":o="deletion"===(a=t.class)?u-1:"mnp"===a?u-2:"microsatellite"===a||"named"===a?u-3:0}r.fillStyle=this.snpColors[o],r.fillRect(l.px,c,l.pw,s)}const Eo=1e-4*Number.MIN_SAFE_INTEGER,To={A:"T",C:"G",G:"C",T:"A"},Ao={TTT:"F",TTC:"F",TTA:"L",TTG:"L",CTT:"L",CTC:"L",CTA:"L",CTG:"L",ATT:"I",ATC:"I",ATA:"I",ATG:"M",GTT:"V",GTC:"V",GTA:"V",GTG:"V",TCT:"S",TCC:"S",TCA:"S",TCG:"S",CCT:"P",CCC:"P",CCA:"P",CCG:"P",ACT:"T",ACC:"T",ACA:"T",ACG:"T",GCT:"A",GCC:"A",GCA:"A",GCG:"A",TAT:"Y",TAC:"Y",TAA:"STOP",TAG:"STOP",CAT:"H",CAC:"H",CAA:"Q",CAG:"Q",AAT:"N",AAC:"N",AAA:"K",AAG:"K",GAT:"D",GAC:"D",GAA:"E",GAG:"E",TGT:"C",TGC:"C",TGA:"STOP",TGG:"W",CGT:"R",CGC:"R",CGA:"R",CGG:"R",AGT:"S",AGC:"S",AGA:"R",AGG:"R",GGT:"G",GGC:"G",GGA:"G",GGG:"G"};class Ro{constructor(t,e){this.type="sequence",this.browser=e,this.removable=!1,this.config=t,this.name="",this.id="sequence",this.sequenceType=t.sequenceType||"dna",this.height=25,this.disableButtons=!1,this.order=t.order||Eo,this.ignoreTrackMenu=!1,this.reversed=!1,this.frameTranslate=!1}menuItemList(){return[{name:this.reversed?"Forward":"Reverse",click:()=>{this.reversed=!this.reversed,this.trackView.repaintViews()}},{name:this.frameTranslate?"Close Translation":"Three-frame Translate",click:()=>{if(this.frameTranslate=!this.frameTranslate,this.frameTranslate){for(let t of this.trackView.viewports)t.setContentHeight(115);this.trackView.setTrackHeight(115)}else{for(let t of this.trackView.viewports)t.setContentHeight(25);this.trackView.setTrackHeight(25)}this.trackView.repaintViews()}}]}translateSequence(t){const e=[[],[],[]];for(let s of[0,1,2])for(var i,n,r=s;t.length-r>=3;)i={},n=t.slice(r,r+3),this.reversed&&(n=n.split("").reverse().join("")),i.codons=n,i.aminoA=Ao[n.toUpperCase()],e[s].push(i),i=null,r+=3;return e}async getFeatures(t,e,i,n){if(n&&n>1)return null;return{bpStart:e,sequence:await this.browser.genome.sequence.getSequence(t,e,i)}}draw(t){const e=t.context;if(t.features){const i=t.features.sequence,n=t.features.bpStart,r=1+t.bpStart+t.pixelWidth*t.bpPerPixel;let s=15;for(let o=n;o<=r;o++){let r=Math.floor(o-n);if(r<i.length){let n=i[r];this.reversed&&(n=To[n.toUpperCase()]);let a=o-t.bpStart,h=a/t.bpPerPixel,l=(a+1)/t.bpPerPixel,c=this.fillColor(n);if(t.bpPerPixel>.1)Ii.fillRect(e,h,5,l-h,s-5,{fillStyle:c});else{let t=.5*(h+l-e.measureText(n).width);Ii.strokeText(e,n,t,s,{strokeStyle:c})}}}if(this.frameTranslate){let n;this.reversed?(n=i.split("").map((function(t){return To[t]})),n=n.join("")):n=i;let r=s,o=this.translateSequence(n);for(let i of o){let n=o.indexOf(i),s=n,a=25;r=0===n?r+10:r+30;for(let n of i){let o,h=i.indexOf(n),l=h+s+2*h,c=0==h%2?"rgb(160,160,160)":"rgb(224,224,224)",u=Math.floor(l/t.bpPerPixel),f=Math.floor((l+3)/t.bpPerPixel),d=Math.round((u+f)/2);n.aminoA.indexOf("STOP")>-1?(c="rgb(255, 0, 0)",o="STOP"):o=n.aminoA,"M"===n.aminoA&&(c="rgb(0, 153, 0)",o="START"),Ii.fillRect(e,u,r,f-u,a,{fillStyle:c}),t.bpPerPixel<=.1&&Ii.strokeText(e,o,d-e.measureText(o).width/2,r+15)}}}}}supportsWholeGenome(){return!1}computePixelHeight(t){return this.height}fillColor(t){return this.color?this.color:"dna"===this.sequenceType?this.browser.nucleotideColors[t]||"gray":"rgb(0, 0, 150)"}}function Io(t,e,i){var n,r,s,o,a,h,l,c={font:"normal 10px Arial",textAlign:"right",strokeStyle:"black"};function u(t){return 0===t?"0":Math.abs(t)>=10?t.toFixed():Math.abs(t)>=1?t.toFixed(1):t.toFixed(2)}void 0!==this.dataRange&&void 0!==this.dataRange.max&&void 0!==this.dataRange.min&&(Ii.fillRect(t,0,0,e,i,{fillStyle:"rgb(255, 255, 255)"}),n=(l=.95*e)-8,.01,a={x:r=l,y:s=o=.01*i},Ii.strokeLine(t,n,s,r,o,c),Ii.fillText(t,u(this.dataRange.max),n+4,s+12,c),h={x:r,y:s=o=.99*i},Ii.strokeLine(t,n,s,r,o,c),Ii.fillText(t,u(this.dataRange.min),n+4,s-4,c),Ii.strokeLine(t,a.x,a.y,h.x,h.y,c))}class Lo extends Pr{constructor(t,e){super(t,e),this.type="wig",this.height=t.height||50,this.featureType="numeric";const i=t.format?t.format.toLowerCase():t.format;this.featureSource="bigwig"===i?new Xs(t,e.genome):"tdf"===i?new to(t,e.genome):so(t,e.genome),this.autoscale=t.autoscale||void 0===t.max,this.autoscale||(this.dataRange={min:t.min||0,max:t.max}),this.windowFunction=t.windowFunction||"mean",this.paintAxis=Io,this.graphType=t.graphType||"bar",this.normalize=t.normalize,this.scaleFactor=t.scaleFactor}async postInit(){const t=await this.getHeader();t&&this.setTrackProperties(t)}async getFeatures(t,e,i,n){const r=await this.featureSource.getFeatures({chr:t,start:e,end:i,bpPerPixel:n,windowFunction:this.windowFunction});if(this.normalize&&this.featureSource.normalizationFactor){const t=this.featureSource.normalizationFactor;for(let e of r)e.value*=t}if(this.scaleFactor){const t=this.scaleFactor;for(let e of r)e.value*=t}return r}menuItemList(){return In.numericDataMenuItems(this.trackView)}async getHeader(){return"function"==typeof this.featureSource.getHeader&&(this.header=await this.featureSource.getHeader()),this.header}draw(t){const e=t.features,i=t.context,n=t.bpPerPixel,r=t.bpStart,s=t.pixelWidth,o=t.pixelHeight,a=r+s*n+1;let h=-1,l=-1;const c=this.color||"rgb(150,150,150)";let u;"string"==typeof c&&c.startsWith("rgb(")&&(u=ct.addAlpha(c,.1));const f=t=>(this.dataRange.max-t)/(this.dataRange.max-this.dataRange.min)*o;if(e&&e.length>0&&(void 0===this.dataRange.min&&(this.dataRange.min=0),this.dataRange.max>this.dataRange.min)){const s=0==this.dataRange.min?o:f(0);for(let t of e){if(t.end<r)continue;if(t.start>a)break;const e=Math.floor((t.start-r)/n);if(isNaN(e))continue;let o=f(t.value);const u=Math.ceil((t.end-r)/n),d=Math.max(1,u-e);let p=t.value<0&&this.altColor?this.altColor:c;const g="function"==typeof p?p(t.value):p;if("points"===this.graphType){const t=this.config.pointSize||3,n=e+d/2;Ii.fillCircle(i,n,o,t/2,{fillStyle:g,strokeStyle:g})}else{let n=o-s;Math.abs(n)<1&&(n=n<0?-1:1);const r=e+d;(r>h||t.value>=0&&t.value>l||t.value<0&&t.value<1)&&Ii.fillRect(i,e,s,d,n,{fillStyle:g}),l=t.value,h=r}}if(this.dataRange.min<0){const e=this.dataRange.max/(this.dataRange.max-this.dataRange.min)*t.pixelHeight;Ii.strokeLine(i,0,e,t.pixelWidth,e,{strokeStyle:u})}}if(this.config.hasOwnProperty("guideLines"))for(let e of this.config.guideLines)if(e.hasOwnProperty("color")&&e.hasOwnProperty("y")&&e.hasOwnProperty("dotted")){let i=f(e.y),n={strokeStyle:e.color,strokeWidth:2};e.dotted?Ii.dashedLine(t.context,0,i,t.pixelWidth,i,5,n):Ii.strokeLine(t.context,0,i,t.pixelWidth,i,n)}}popupData(t,e){if(e||(e=this.clickedFeatures(t)),e&&e.length>0){let i=[],n=function(t,e,i){var n,r,s=0,o=t.length-1,a=s+o>>1;for(;!h(t[a],e,i)&&s<o;)e<t[a].start?o=a-1:e>t[a].end&&(s=a+1),a=s+o>>1;if(h(t[a],e,i)){if(h(n=t[a],e,0))return n;for(r=a;r-- >=0&&(h(t[r]),!i);){if(h(t[r],e,0))return t[r];for(l(t[r],e)<l(n,e)&&(n=t[r]),r=a;r++<t.length&&(h(t[r]),!i);){if(h(t[r],e,0))return t[r];l(t[r],e)<l(n,e)&&(n=t[r])}}return n}return;function h(t,e,i){return e>=t.start-i&&e<=t.end+i}function l(t,e){return Math.min(Math.abs(t.start-e),Math.abs(t.end-e))}}(e,t.genomicLocation,2*t.viewport.referenceFrame.bpPerPixel);if(n){let t=n.end-n.start==1?z(n.start+1):z(n.start+1)+"-"+z(n.end);i.push({name:"Position:",value:t}),i.push({name:"Value:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",value:z(n.value)})}return i}return[]}supportsWholeGenome(){return"function"==typeof this.featureSource.supportsWholeGenome&&this.featureSource.supportsWholeGenome()}dispose(){this.trackView=void 0}}function Mo(t){this.thresholds=t.thresholds,this.colors=t.colors}function Fo(t){this.scale=t,this.lowColor="rgb("+t.lowR+","+t.lowG+","+t.lowB+")",this.highColor="rgb("+t.highR+","+t.highG+","+t.highB+")",this.diff=t.high-t.low}Mo.prototype.getColor=function(t){for(let e of this.thresholds)if(t<e)return this.colors[this.thresholds.indexOf(e)];return this.colors[this.colors.length-1]},Fo.prototype.getColor=function(t){var e,i=this.scale;return t<=i.low?this.lowColor:t>=i.high?this.highColor:(e=(t-i.low)/this.diff,"rgb("+Math.floor(i.lowR+e*(i.highR-i.lowR))+","+Math.floor(i.lowG+e*(i.highG-i.lowG))+","+Math.floor(i.lowB+e*(i.highB-i.lowB))+")")};class Do{constructor(t){this.color=t}getColor(){return this.color}}class Bo extends Pr{constructor(t,e){super(t,e),this.isLog=t.isLog,this.displayMode=t.displayMode||"SQUISHED",this.maxHeight=t.maxHeight||500,this.squishedRowHeight=t.sampleSquishHeight||t.squishedRowHeight||2,this.expandedRowHeight=t.sampleExpandHeight||t.expandedRowHeight||12,this.posColorScale=t.posColorScale||new Fo({low:.1,lowR:255,lowG:255,lowB:255,high:1.5,highR:255,highG:0,highB:0}),this.negColorScale=t.negColorScale||new Fo({low:-1.5,lowR:0,lowG:0,lowB:255,high:-.1,highR:255,highG:255,highB:255}),t.samples?(this.sampleKeys=t.samples,this.explicitSamples=!0):this.sampleKeys=[],this.featureSource=so(this.config,e.genome),this.initialSort=t.sort}async postInit(){"function"==typeof this.featureSource.getHeader&&(this.header=await this.featureSource.getHeader()),this.header&&this.setTrackProperties(this.header)}menuItemList(){const t=this,e=[],i={SQUISHED:"Squish",EXPANDED:"Expand",FILL:"Fill"};return e.push("<hr/>"),e.push("Sample Height"),["SQUISHED","EXPANDED","FILL"].forEach((function(n){e.push({object:En(i[n],n===t.displayMode),click:function(){t.displayMode=n,t.config.displayMode=n,t.trackView.checkContentHeight(),t.trackView.repaintViews()}})})),e}async getFeatures(t,e,i){const n=await this.featureSource.getFeatures({chr:t,start:e,end:i});if(this.initialSort){const t=this.initialSort;this.sortSamples(t.chr,t.start,t.end,t.direction,n),this.initialSort=void 0}return n}draw(t){const e=this,i=(ht(2),t.context),n=t.pixelTop,r=t.pixelWidth,s=t.pixelHeight;Ii.fillRect(i,0,t.pixelTop,r,s,{fillStyle:"rgb(255, 255, 255)"});const o=t.features;if(o&&o.length>0){void 0===e.isLog&&function(t){if(void 0===e.isLog){e.isLog=!1;for(let i of t)if(i.value<0)return void(e.isLog=!0)}}(o);const s=t.bpPerPixel,a=t.bpStart,h=a+r*s+1,l=s;this.updateSampleKeys(o);const c={};let u,f;switch(this.sampleKeys.forEach((function(t,e){c[t]=e})),this.displayMode){case"FILL":u=t.pixelHeight/this.sampleKeys.length,f=0;break;case"SQUISHED":u=this.squishedRowHeight,f=0;break;default:u=this.expandedRowHeight,f=1}const d=t.pixelTop+t.pixelHeight;for(let t of o){if(t.end<a)continue;if(t.start>h)break;const r=t.sampleKey||t.sample;t.row=c[r];const s=n+t.row*u+f;if(s+u<n||s>d)continue;let o=t.value;e.isLog||(o=ht(o/2));const p=Math.max(t.start,a),g=Math.round((p-a)/l),m=Math.min(t.end,h),b=Math.round((m-a)/l),w=Math.max(1,b-g);let v;v=o<-.1?e.negColorScale.getColor(o):o>.1?e.posColorScale.getColor(o):"white",i.fillStyle=v;let y=u;if(u<.25){const t=.1+2*Math.abs(o);y=Math.min(1,t*u)}t.pixelRect={x:g,y:s,w:w,h:y-2*f},i.fillRect(g,s,w,y-2*f)}}}computePixelHeight(t){if(!t)return 0;const e="SQUISHED"===this.displayMode?this.squishedRowHeight:this.expandedRowHeight;return this.updateSampleKeys(t),this.sampleKeys.length*e}async sortSamples(t,e,i,n,r){if(r||(r=await this.featureSource.getFeatures({chr:t,start:e,end:i})),!r)return;this.updateSampleKeys(r);const s={},o=i-e+1;for(let t of r){if(t.end<e)continue;if(t.start>i)break;const n=Math.max(e,t.start),r=(Math.min(i,t.end)-n)/o,a=t.sampleKey||t.sample,h=s[a]||0;s[a]=h+r*t.value}const a="ASC"===n?1:-1;this.sampleKeys.sort((function(t,e){let i=s[t],n=s[e];return i||(i=a*Number.MAX_VALUE),n||(n=a*Number.MAX_VALUE),i===n?0:i>n?a:-1*a})),this.trackView.repaintViews()}clickedFeatures(t){const e=super.clickedFeatures(t);return i=e,n=t.y,i.filter((function(t){const e=t.pixelRect;return e&&n>=e.y&&n<=e.y+e.h}));var i,n}popupData(t,e){e||(e=this.clickedFeatures(t));const i=[];for(let t of e);return e.forEach((function(t){!function(t,e){const i=new Set(["row","color","sampleKey","uniqueSampleKey","uniquePatientKey"]);let n;t.hasOwnProperty("realChr")?(n=Object.assign({},t),n.chr=t.realChr,n.start=t.realStart,n.end=t.realEnd,delete n.realChr,delete n.realStart,delete n.realEnd):n=t;for(let t of Object.keys(n))!i.has(t)&&rn(n[t])&&e.push({name:t,value:n[t]})}(t,i)})),i}contextMenuItemList(t){const e=t.viewport.referenceFrame,i=t.genomicLocation,n=this.config.sort?"ASC"===this.config.sort.direction?"DESC":"ASC":"DESC",r=e.toBP(2.5),s=e=>{const i=t.viewport.getCachedFeatures();this.sortSamples(e.chr,e.start,e.end,e.direction,i)};return[{label:"Sort by value",click:e=>{const o={direction:n,chr:t.viewport.referenceFrame.chr,start:i-r,end:i+r};s(o),this.config.sort=o}}]}supportsWholeGenome(){return(!1===this.config.indexed||!this.config.indexURL)&&!1!==this.config.supportsWholeGenome}updateSampleKeys(t){if(this.explicitSamples)return;const e=new Set(this.sampleKeys);for(let i of t){const t=i.sampleKey||i.sample;e.has(t)||(e.add(t),this.sampleKeys.push(t))}}}class No extends Pr{constructor(t,e){if(!t.tracks)throw Error("Error: no tracks defined for merged track"+t);super(t,e)}async postInit(){this.tracks=[];for(let t of this.config.tracks){t.type||hn(t),t.isMergedTrack=!0;const e=await this.browser.createTrack(t);e?(e.autoscale=!1,this.tracks.push(e)):console.warn("Could not create track "+t)}Object.defineProperty(this,"height",{get(){return this._height},set(t){this._height=t;for(let e of this.tracks)e.height=t,e.config.height=t}}),this.height=this.config.height||100}async getFeatures(t,e,i,n){const r=this.tracks.map((r=>r.getFeatures(t,e,i,n)));return Promise.all(r)}draw(t){var e,i,n,r,s,o,a,h;for(n=t.features,t.referenceFrame.chr,o=n,a=0,h=-Number.MAX_VALUE,o.forEach((function(t,e){t.forEach((function(t){void 0===t.value||Number.isNaN(t.value)||(a=Math.min(a,t.value),h=Math.max(h,t.value))}))})),s={min:a,max:h},e=0,i=this.tracks.length;e<i;e++)(r=Object.assign({},t)).features=n[e],this.tracks[e].dataRange=s,this.tracks[e].draw(r)}paintAxis(t,e,i){var n,r,s;for(!0,n=0,r=this.tracks.length;n<r;n++)if("function"==typeof(s=this.tracks[n]).paintAxis){s.paintAxis(t,e,i);break}}popupData(t,e){const i=e||t.viewport.getCachedFeatures();if(i&&i.length===this.tracks.length){const e=[];for(let n=0;n<this.tracks.length;n++){n>0&&e.push("<hr/>"),e.push(`<b>${this.tracks[n].name}</b>`);const r=this.tracks[n].popupData(t,i[n]);e.push(...r)}return e}}}class Po{constructor(t){this.paired=!0,this.firstAlignment=t,this.chr=t.chr,this.readName=t.readName,t.start<t.mate.position?(this.start=t.start,this.scStart=t.scStart,this.connectingStart=t.start+t.lengthOnRef,this.connectingEnd=t.mate.position):(this.start=t.mate.position,this.scStart=this.start,this.connectingStart=t.mate.position,this.connectingEnd=t.start),this.end=Math.max(t.mate.position,t.start+t.lengthOnRef),this.lengthOnRef=this.end-this.start;let e=Math.max(this.end,t.scStart+t.scLengthOnRef);this.scLengthOnRef=e-this.scStart}setSecondAlignment(t){this.secondAlignment=t;const e=this.firstAlignment;t.start>e.start?this.connectingEnd=t.start:this.connectingStart=t.start+t.lengthOnRef,this.start=Math.min(e.start,t.start),this.end=Math.max(e.start+e.lengthOnRef,t.start+t.lengthOnRef),this.lengthOnRef=this.end-this.start,this.scStart=Math.min(e.scStart,t.scStart);const i=Math.max(e.scStart+e.scLengthOnRef,t.scStart+t.scLengthOnRef);this.scLengthOnRef=i-this.scStart}containsLocation(t,e){const i=e?this.scStart:this.start,n=e?this.scLengthOnRef:this.lengthOnRef;return t>=i&&t<=i+n}alignmentContaining(t,e){return this.firstAlignment.containsLocation(t,e)?this.firstAlignment:this.secondAlignment&&this.secondAlignment.containsLocation(t,e)?this.secondAlignment:void 0}popupData(t){let e=this.firstAlignment.popupData(t);return this.secondAlignment&&(e.push("-------------------------------"),e=e.concat(this.secondAlignment.popupData(t))),e}isPaired(){return!0}firstOfPairStrand(){return this.firstAlignment.isFirstOfPair()?this.firstAlignment.strand:this.secondAlignment&&this.secondAlignment.isFirstOfPair()?this.secondAlignment.strand:this.firstAlignment.mate.strand}}const Oo=O,zo=function(t){return t.split("").reduce((function(t,e){return(t=(t<<5)-t+e.charCodeAt(0))&t}),0)};class Ho{constructor(){this.alignments=[],this.score=void 0}findAlignment(t){const e=(t,e)=>e>=t.start&&e<t.start+t.lengthOnRef;let i;for(let n=0;n<this.alignments.length;n++){const r=this.alignments[n];if(t>=r.start&&t<r.start+r.lengthOnRef){r.paired?r.firstAlignment&&e(r.firstAlignment,t)?i=r.firstAlignment:r.secondAlignment&&e(r.secondAlignment,t)&&(i=r.secondAlignment):i=r;break}}return i}updateScore(t,e){this.score=this.calculateScore(t,e)}calculateScore({position:t,sortOption:e,direction:i,tag:n},r){e||(e="BASE");const s=this.findAlignment(t);if(void 0===s)return i?Number.MAX_VALUE:-Number.MAX_VALUE;let o;switch(e){case"NUCLEOTIDE":case"BASE":{const e=s.readBaseAt(t),n=s.readBaseQualityAt(t);return e?function(t,e,i,n){let r;const s=Math.floor(n)-i.start;s<i.sequence.length&&(r=i.sequence.charAt(s));if(!r)return;if(void 0===t)return Number.MAX_VALUE;if("N"===t)return 2;if(r===t||"="===t)return 4-e/1e3;if("X"===t||r!==t){const r=Math.floor(n)-i.coverageMap.bpStart;if(r>0&&r<i.coverageMap.coverage.length){const n=i.coverageMap.coverage[r];return-(n["pos"+t]+n["neg"+t]+e/1e3)}return-(1+e/1e3)}return 0}(e,n,r,t):i?Number.MAX_VALUE:-Number.MAX_VALUE}case"STRAND":return s.strand?1:-1;case"START":return s.start;case"TAG":{const t=s.tags()[n];return void 0!==t?Oo(t)?zo(t):t:Number.MAX_VALUE}case"INSERT_SIZE":return-Math.abs(s.fragmentLength);case"GAP_SIZE":return-s.gapSizeAt(t);case"MATE_CHR":return o=s.mate,o?o.chr===s.chr?Number.MAX_VALUE-1:zo(o.chr):Number.MAX_VALUE;case"MQ":return void 0===s.mq?Number.MAX_VALUE:-s.mq;default:return Number.MAX_VALUE}}}function Uo(t){return t.isPaired()&&t.mate&&t.isMateMapped()&&t.chr===t.mate.chr&&(t.isFirstOfPair()||t.isSecondOfPair())&&!(t.isSecondary()||t.isSupplementary())}function $o(t){const e=[];for(let i of t)for(let t of i.alignments)t instanceof Po?(t.firstAlignment&&e.push(t.firstAlignment),t.secondAlignment&&e.push(t.secondAlignment)):e.push(t);return e}function qo(t,e,i,n){if(t){if(0===t.length)return[];{t.sort((function(t,e){return n?t.scStart-e.scStart:t.start-e.start}));const r=t[0];let s=Math.max(e,n?r.scStart:r.start),o=s;const a=[];for(let e of t){const t=n?e.scStart:e.start,i=Math.max(0,t-s);void 0===a[i]&&(a[i]=[]),a[i].push(e)}let h=0,l=0;const c=[],u=2;try{for(;h<t.length;){const t=new Ho;for(;o<=i;){let e,r;for(;!e&&o<=i;)r=o-s,void 0===a[r]?++o:e=a[r];if(!e)break;const l=e.pop();0===e.length&&(a[r]=void 0),t.alignments.push(l),o=n?l.scStart+l.scLengthOnRef+u:l.start+l.lengthOnRef+u,++h}if(t.alignments.length>0&&c.push(t),o=s,h===l)break;l=h}}catch(t){throw console.error(t),t}return c}}}class Vo{constructor(t,e,i,n,r,s,o){this.chr=t,this.start=Math.floor(e),this.end=Math.ceil(i),this.length=i-e,this.alleleFreqThreshold=void 0===o?.2:o,this.coverageMap=new Wo(t,e,i,this.alleleFreqThreshold),this.alignments=[],this.downsampledIntervals=[],this.samplingWindowSize=void 0===n?100:n,this.samplingDepth=void 0===r?1e3:r,this.pairsSupported=void 0===s||s,this.paired=!1,this.pairsCache={},this.downsampledReads=new Set,this.currentBucket=new jo(this.start,this.start+this.samplingWindowSize,this),this.filter=function(t){return t.isMapped()&&!t.isFailsVendorQualityCheck()},this.pairedEndStats=new Xo}push(t){!1!==this.filter(t)&&(t.isPaired()&&this.pairedEndStats.push(t),this.coverageMap.incCounts(t),this.pairsSupported&&this.downsampledReads.has(t.readName)||(t.start>=this.currentBucket.end&&(this.finishBucket(),this.currentBucket=new jo(t.start,t.start+this.samplingWindowSize,this)),this.currentBucket.addAlignment(t)))}forEach(t){this.alignments.forEach(t)}finish(){void 0!==this.currentBucket&&this.finishBucket(),this.alignments.sort((function(t,e){return t.start-e.start})),this.pairsCache=void 0,this.downsampledReads=void 0,this.pairedEndStats.compute()}contains(t,e,i){return this.chr===t&&this.start<=e&&this.end>=i}hasDownsampledIntervals(){return this.downsampledIntervals&&this.downsampledIntervals.length>0}finishBucket(){this.alignments=this.alignments.concat(this.currentBucket.alignments),this.currentBucket.downsampledCount>0&&this.downsampledIntervals.push(new Zo(this.currentBucket.start,this.currentBucket.end,this.currentBucket.downsampledCount)),this.paired=this.paired||this.currentBucket.paired}setViewAsPairs(t){let e;e=t?function(t){const e={},i=[];for(let n of t)for(let t of n.alignments)if(Uo(t)){let n=e[t.readName];n?(n.setSecondAlignment(t),e[t.readName]=void 0):(n=new Po(t),e[t.readName]=n,i.push(n))}else i.push(t);return i}(this.packedAlignmentRows):$o(this.packedAlignmentRows),this.packedAlignmentRows=qo(e,this.start,this.end)}setShowSoftClips(t){const e=this.allAlignments();this.packedAlignmentRows=qo(e,this.start,this.end,t)}allAlignments(){const t=[];for(let e of this.packedAlignmentRows)for(let i of e.alignments)t.push(i);return t}getMax(t,e){return this.coverageMap.getMax(t,e)}}class jo{constructor(t,e,i){this.start=t,this.end=e,this.alignments=[],this.downsampledCount=0,this.samplingDepth=i.samplingDepth,this.pairsSupported=i.pairsSupported,this.downsampledReads=i.downsampledReads,this.pairsCache=i.pairsCache}addAlignment(t){var e,i,n;if(this.pairsSupported&&Uo(t)&&(n=this.pairsCache[t.readName]))return n.setSecondAlignment(t),void(this.pairsCache[t.readName]=void 0);this.alignments.length<this.samplingDepth?this.pairsSupported&&Uo(t)?(n=new Po(t),this.paired=!0,this.pairsCache[t.readName]=n,this.alignments.push(n)):this.alignments.push(t):((e=Math.floor(Math.random()*(this.samplingDepth+this.downsampledCount-1)))<this.samplingDepth?(i=this.alignments[e],this.pairsSupported&&Uo(t)?(void 0!==this.pairsCache[i.readName]&&(this.pairsCache[i.readName]=void 0),n=new Po(t),this.paired=!0,this.pairsCache[t.readName]=n,this.alignments[e]=n):this.alignments[e]=t,this.downsampledReads.add(i.readName)):this.downsampledReads.add(t.readName),this.downsampledCount++)}}class Wo{constructor(t,e,i,n){this.chr=t,this.bpStart=e,this.length=i-e,this.coverage=new Array(this.length),this.maximum=0,this.threshold=n,this.qualityWeight=!0}getMax(t,e){let i=0;const n=this.coverage.length;for(let r=0;r<n;r++){const n=this.bpStart+r;if(n>e)break;const s=this.coverage[r];n>=t&&s&&(i=Math.max(i,s.total))}return i}incCounts(t){var e=this;if(void 0===t.blocks?i(t):t.blocks.forEach((function(t){i(t)})),t.gaps)for(let i of t.gaps)if("D"===i.type){const t=i.start-e.bpStart;for(let n=t;n<t+i.len;n++)n<0||(this.coverage[n]||(this.coverage[n]=new Go(e.threshold)),this.coverage[n].del++)}if(t.insertions)for(let i of t.insertions){const t=i.start-this.bpStart;t<0||(this.coverage[t]||(this.coverage[t]=new Go(e.threshold)),this.coverage[t].ins++)}function i(i){if("S"===i.type)return;const n=t.seq,r=t.qual,s=i.seqOffset;for(let o=i.start-e.bpStart,a=0;a<i.len;o++,a++){e.coverage[o]||(e.coverage[o]=new Go(e.threshold));const i=n.charAt(s+a),h=t.strand?"pos"+i:"neg"+i,l=r&&s+a<r.length?r[s+a]:30;e.coverage[o][h]+=1,e.coverage[o]["qual"+i]+=l,e.coverage[o].total+=1,e.coverage[o].qual+=l,e.maximum=Math.max(e.coverage[o].total,e.maximum)}}}}class Go{constructor(t){this.qualityWeight=!0,this.posA=0,this.negA=0,this.posT=0,this.negT=0,this.posC=0,this.negC=0,this.posG=0,this.negG=0,this.posN=0,this.negN=0,this.pos=0,this.neg=0,this.qualA=0,this.qualT=0,this.qualC=0,this.qualG=0,this.qualN=0,this.qual=0,this.total=0,this.del=0,this.ins=0,this.threshold=t}isMismatch(t){const e=this.threshold*(this.qualityWeight&&this.qual?this.qual:this.total);let i=0;for(let e of["A","T","C","G"])e!==t&&(i+=this.qualityWeight&&this.qual?this["qual"+e]:this["pos"+e]+this["neg"+e]);return i>=e}}class Zo{constructor(t,e,i){this.start=t,this.end=e,this.counts=i}popupData(t){return[{name:"start",value:this.start+1},{name:"end",value:this.end},{name:"# downsampled:",value:this.counts}]}}class Xo{constructor(t,e){this.totalCount=0,this.frCount=0,this.rfCount=0,this.ffCount=0,this.sumF=0,this.sumF2=0}push(t){if(t.isProperPair()){var e=Math.abs(t.fragmentLength);this.sumF+=e,this.sumF2+=e*e;var i=t.pairOrientation;if("string"==typeof i&&4===i.length)switch(""+i.charAt(0)+i.charAt(2)){case"FF":case"RR":this.ffCount++;break;case"FR":this.frCount++;break;case"RF":this.rfCount++}this.totalCount++}}compute(){if(this.totalCount>100){this.ffCount/this.totalCount>.9?this.orienation="ff":this.frCount/this.totalCount>.9?this.orienation="fr":this.rfCount/this.totalCount>.9&&(this.orienation="rf");var t=this.sumF/this.totalCount,e=Math.sqrt((this.totalCount*this.sumF2-this.sumF*this.sumF)/(this.totalCount*this.totalCount));this.lowerFragmentLength=t-3*e,this.upperFragmentLength=t+3*e}}}const Yo={c:1,C:1,s:2,S:2,i:4,I:4,f:4};class Ko{constructor(){this.hidden=!1}isMapped(){return 0==(4&this.flags)}isPaired(){return 0!=(1&this.flags)}isProperPair(){return 0!=(2&this.flags)}isFirstOfPair(){return 0!=(64&this.flags)}isSecondOfPair(){return 0!=(128&this.flags)}isSecondary(){return 0!=(256&this.flags)}isSupplementary(){return 0!=(2048&this.flags)}isFailsVendorQualityCheck(){return 0!=(512&this.flags)}isDuplicate(){return 0!=(1024&this.flags)}isMateMapped(){return 0==(8&this.flags)}isNegativeStrand(){return 0!=(16&this.flags)}isMateNegativeStrand(){return 0!=(32&this.flags)}tags(){return this.tagDict||(this.tagBA?(this.tagDict=function(t){let e=0;const i=t.length,n={};for(;e<i;){const i=String.fromCharCode(t[e])+String.fromCharCode(t[e+1]);e+=2;const s=String.fromCharCode(t[e++]);let o;if("A"===s)o=String.fromCharCode(t[e]),e++;else if("i"===s||"I"===s)o=Jo(t,e),e+=4;else if("c"===s||"C"===s)o=t[e],e++;else if("s"===s||"S"===s)o=ta(t,e),e+=2;else if("f"===s)o=ea(t,e),e+=4;else if("Z"===s)for(o="";;){var r=t[e++];if(0===r)break;o+=String.fromCharCode(r)}else{if("B"!==s){o="Error unknown type: "+s,n[i]=o;break}{const r=String.fromCharCode(t[e++]);let s=Yo[r];if(void 0===s){n[i]=`Error: unknown element type '${r}'`;break}e+=4+Jo(t,e)*s,o="[not shown]"}}n[i]=o}return n}(this.tagBA),this.tagBA=void 0):this.tagDict={}),this.tagDict}containsLocation(t,e){const i=e?this.scStart:this.start,n=e?this.scLengthOnRef:this.lengthOnRef;return t>=i&&t<=i+n}popupData(t){const e=[];if(t=Math.floor(t),this.insertions){const n=this.seq;for(let r of this.insertions){var i=r.start;if(t===i||t===i-1)return e.push({name:"Insertion",value:n.substr(r.seqOffset,r.len)}),e.push({name:"Location",value:i}),e}}e.push({name:"Read Name",value:this.readName}),e.push("<hr>"),e.push({name:"Alignment Start",value:z(1+this.start),borderTop:!0}),e.push({name:"Read Strand",value:!0===this.strand?"(+)":"(-)",borderTop:!0}),e.push({name:"Cigar",value:this.cigar}),e.push({name:"Mapped",value:s(this.isMapped())}),e.push({name:"Mapping Quality",value:this.mq}),e.push({name:"Secondary",value:s(this.isSecondary())}),e.push({name:"Supplementary",value:s(this.isSupplementary())}),e.push({name:"Duplicate",value:s(this.isDuplicate())}),e.push({name:"Failed QC",value:s(this.isFailsVendorQualityCheck())}),this.isPaired()&&(e.push("<hr>"),e.push({name:"First in Pair",value:!this.isSecondOfPair(),borderTop:!0}),e.push({name:"Mate is Mapped",value:s(this.isMateMapped())}),this.pairOrientation&&e.push({name:"Pair Orientation",value:this.pairOrientation}),this.isMateMapped()&&(e.push({name:"Mate Chromosome",value:this.mate.chr}),e.push({name:"Mate Start",value:this.mate.position+1}),e.push({name:"Mate Strand",value:!0===this.mate.strand?"(+)":"(-)"}),e.push({name:"Insert Size",value:this.fragmentLength}))),e.push("<hr>");const n=this.tags();let r=!0;for(let t in n)n.hasOwnProperty(t)&&(r?(e.push({name:t,value:n[t],borderTop:!0}),r=!1):e.push({name:t,value:n[t]}));return e.push("<hr>"),e.push({name:"Genomic Location: ",value:z(1+t)}),e.push({name:"Read Base:",value:this.readBaseAt(t)}),e.push({name:"Base Quality:",value:this.readBaseQualityAt(t)}),e;function s(t){return t?"Yes":"No"}}readBaseAt(t){const e=Qo(this.blocks,t);if(e){if("*"===this.seq)return"*";{const i=e.seqIndexAt(t);return this.seq[i]}}}readBaseQualityAt(t){const e=Qo(this.blocks,t);if(e){if("*"===this.qual)return 30;{const i=e.seqIndexAt(t);return i>=0&&this.qual&&i<this.qual.length?this.qual[i]:30}}}gapSizeAt(t){if(this.gaps)for(let e of this.gaps)if(t>=e.start&&t<e.start+e.len)return e.len;return 0}}function Qo(t,e){for(let i=0;i<t.length;i++){const n=t[i];if(e>=n.start&&e<n.start+n.len)return n}}function Jo(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}function ta(t,e){return t[e+1]<<8|t[e]}function ea(t,e){return new DataView(t.buffer).getFloat32(e,!0)}class ia{constructor(t){t&&Object.assign(this,t)}seqIndexAt(t){return Math.floor(t)-this.start+this.seqOffset}}class na{constructor(t){t||(t={}),this.vendorFailed=void 0===t.vendorFailed||t.vendorFailed,this.duplicates=void 0===t.duplicates||t.duplicates,this.secondary=t.secondary||!1,this.supplementary=t.supplementary||!1,this.mqThreshold=void 0===t.mqThreshold?0:t.mqThreshold,t.readgroups&&(this.readgroups=new Set(t.readgroups))}pass(t){if(this.vendorFailed&&t.isFailsVendorQualityCheck())return!1;if(this.duplicates&&t.isDuplicate())return!1;if(this.secondary&&t.isSecondary())return!1;if(this.supplementary&&t.isSupplementary())return!1;if(t.mq<this.mqThreshold)return!1;if(this.readgroups){var e=t.tags().RG;return this.readgroups.has(e)}return!0}}const ra=["=","A","C","x","G","x","x","x","T","x","x","x","x","x","x","N"],sa=["M","I","D","N","S","H","P","=","X","?","?","?","?","?","?","?"],oa=la(new Uint8Array([66,65,77,1]),0),aa={readHeader:function(t,e,i){return un.loadArrayBuffer(t,e).then((function(t){var e;return e=Qi(t),aa.decodeBamHeader(e,i)}))},decodeBamHeader:function(t,e){var i,n,r,s,o;if((i=la(t,0))!==oa)throw new Error("BAM header errror: bad magic number.  This could be caused by either a corrupt or missing file.");n=la(t,4);for(var a=0;a<n;++a)String.fromCharCode(t[a+8]);var h=la(t,n+8),l=n+12;for(r={},s=[],o={},a=0;a<h;++a){for(var c=la(t,l),u="",f=0;f<c-1;++f)u+=String.fromCharCode(t[l+4+f]);la(t,l+c+4);r[u]=a,s[a]=u,e&&(o[e.getChromosomeName(u)]=u),l=l+8+c}return{magicNumber:i,size:l,chrNames:s,chrToIndex:r,chrAliasTable:o}},bam_tag2cigar:function(t,e,i,n,r,s){function o(t){return"C"===t||"c"===t||"A"===t?1:"S"===t||"s"===t?2:"I"===t||"i"===t||"f"===t?4:0}if(1!==s.length||r.start<0)return!1;for(var a=i+(n+1>>1)+n;a+4<e;){if("CG"===String.fromCharCode(t[a])+String.fromCharCode(t[a+1]))break;var h=String.fromCharCode(t[a+2]);if("B"===h)a+=8+o(h=String.fromCharCode(t[a+3]))*la(t,a+4);else if("Z"===h||"H"===h)for(a+=3;0!==t[a++];);else a+=3+o(h)}if(a>=e)return!1;if("B"!==String.fromCharCode(t[a+2])||"I"!==String.fromCharCode(t[a+3]))return!1;var l=la(t,a+4),c=a+8;if(c+4*l>e)return!1;var u="",f=0;s.length=0,a=c;for(var d=0;d<l;++d,a+=4){var p=la(t,a),g=p>>4,m=sa[15&p];"M"!==m&&"EQ"!==m&&"X"!==m&&"D"!==m&&"N"!==m&&"="!==m||(f+=g),u=u+g+m,s.push({len:g,ltr:m})}return r.cigar=u,r.lengthOnRef=f,!0},decodeBamRecords:function(t,e,i,n,r,s,o,a){for(;e<t.length;){const f=e+la(t,e)+4,d=new Ko,p=la(t,e+4),g=la(t,e+8);if(f>t.length)return;if(p<0){e=f;continue}if(void 0!==r&&(p>r||g>o))return!0;if(void 0!==r&&p<r){e=f;continue}const m=la(t,e+12),b=(65280&m)>>8,w=255&m,v=la(t,e+16),y=(4294901760&v)>>16,x=65535&v,k=la(t,e+20),S=la(t,e+24),_=la(t,e+28),C=la(t,e+32);let E=[];for(let i=0;i<w-1;++i)E.push(String.fromCharCode(t[e+36+i]));E=E.join("");let T=0,A="",R=e+36+w;const I=[];let L;for(let e=0;e<x;++e){var h=la(t,R),l=h>>4,c=sa[15&h];"M"!==c&&"EQ"!==c&&"X"!==c&&"D"!==c&&"N"!==c&&"="!==c||(T+=l),A=A+l+c,R+=4,L={len:l,ltr:c},I.push(L)}if(d.chr=n[p],d.start=g,d.flags=y,d.strand=!(16&y),d.readName=E,d.cigar=A,d.lengthOnRef=T,d.fragmentLength=C,d.mq=b,aa.bam_tag2cigar(t,f,R,k,d,I),d.end=d.start+d.lengthOnRef,d.end<s){e=f;continue}let M=[];const F=k+1>>1;for(let e=0;e<F;++e){var u=t[R+e];M.push(ra[(240&u)>>4]),M.push(ra[15&u])}M=M.slice(0,k).join(""),R+=F;const D=[];for(let e=0;e<k;++e)D.push(t[R+e]);R+=k,S>=0&&(d.mate={chr:n[S],position:_,strand:!(32&y)}),d.seq=M,d.qual=D,d.tagBA=new Uint8Array(t.buffer.slice(R,f)),this.setPairOrientation(d),(void 0===a||a.pass(d))&&(ha(d,I),i.push(d)),e=f}},decodeSamRecords:function(t,e,i,n,r,s){var o,a,h,l,c,u,f,d,p,g;for(l=(o=H(t)).length,!1,a=0;a<l;a++)if(c=o[a].split("\t"),(p=new Ko).chr=c[2],p.start=Number.parseInt(c[3])-1,p.flags=Number.parseInt(c[1]),p.readName=c[0],p.strand=!(16&p.flags),p.mq=Number.parseInt(c[4]),p.cigar=c[5],p.fragmentLength=Number.parseInt(c[8]),p.seq=c[9],"*"!==p.chr&&p.isMapped()&&p.chr===i){if(p.start>r)break;if(d=0,(g=ca(p.cigar)).forEach((function(t){var e=t.len,i=t.ltr;"M"!==i&&"EQ"!==i&&"X"!==i&&"D"!==i&&"N"!==i&&"="!==i||(d+=e)})),p.lengthOnRef=d,!(p.start+d<n)){for(u=c[10],p.qual=[],h=0;h<u.length;h++)p.qual[h]=u.charCodeAt(h)-33;p.tagDict=c.length<11?{}:ua(c.slice(11)),p.isMateMapped()&&(f=c[6],p.mate={chr:"="===f?p.chr:f,position:Number.parseInt(c[7]),strand:!(32&p.flags)}),this.setPairOrientation(p),(void 0===s||s.pass(p))&&(ha(p,g),e.push(p))}}},setReaderDefaults:function(t,e){t.filter=new na(e.filter),e.readgroup&&(t.filter.readgroups=new Set([e.readgroup])),t.alleleFreqThreshold=void 0===e.alleleFreqThreshold?.2:e.alleleFreqThreshold,t.samplingWindowSize=void 0===e.samplingWindowSize?100:e.samplingWindowSize,t.samplingDepth=void 0===e.samplingDepth?500:e.samplingDepth,t.samplingDepth>1e4&&(t.samplingDepth=1e4),e.viewAsPairs?t.pairsSupported=!0:t.pairsSupported=void 0===e.pairsSupported||e.pairsSupported},setPairOrientation:function(t){if(t.isMapped()&&t.mate&&t.isMateMapped()&&t.mate.chr===t.chr){var e=t.strand?"F":"R",i=t.mate,n=i.strand?"F":"R",r=" ",s=" ";t.isFirstOfPair()?(r="1",s="2"):t.isSecondOfPair()&&(r="2",s="1");var o=[],a=t.fragmentLength,h=t.end-t.start;if(0===a)a=(t.start<i.position?i.position+h:i.position-h)-t.start;a>0?(o[0]=e,o[1]=r,o[2]=n,o[3]=s):(o[2]=e,o[3]=r,o[0]=n,o[1]=s),t.pairOrientation=o.join("")}}};function ha(t,e){const i=[];let n,r,s=0,o=t.start;t.scStart=t.start,t.scLengthOnRef=t.lengthOnRef;for(let a of e){let e;switch(a.ltr){case"H":case"P":break;case"S":e=o,t.scLengthOnRef+=a.len,0===i.length&&(t.scStart-=a.len,e-=a.len),i.push(new ia({start:e,seqOffset:s,len:a.len,type:"S"})),s+=a.len;break;case"N":case"D":void 0===r&&(r=[]),r.push({start:o,len:a.len,type:a.ltr}),o+=a.len;break;case"I":void 0===n&&(n=[]),n.push(new ia({start:o,len:a.len,seqOffset:s,type:"I"})),s+=a.len;break;case"M":case"EQ":case"=":case"X":i.push(new ia({start:o,seqOffset:s,len:a.len,type:"M"})),s+=a.len,o+=a.len}}t.blocks=i,t.insertions=n,t.gaps=r}function la(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}function ca(t){var e,i,n,r,s,o,a,h,l;for(e=[],i=[],s=null,r=t.length,n=0;n<r;n++)o=t.charAt(n),l=void 0,(l=o.charCodeAt(0))>=48&&l<=57?i.push(o):(a=o,h=Number.parseInt(i.join("")),i=[],null!==s&&s.ltr===a?s.len+=h:(s={len:h,ltr:a},e.push(s)));return e}function ua(t){var e={};return t.forEach((function(t){var i=t.split(":");e[i[0]]=i[2]})),e}const fa=O;class da{constructor(t,e){this.config=t,this.genome=e,this.bamPath=t.url,this.isDataUri=fa(t.url)&&t.url.startsWith("data:"),aa.setReaderDefaults(this,t)}async readAlignments(t,e,i){const n=this.genome;if(this.alignmentCache){const n=this.header,r=n.chrAliasTable.hasOwnProperty(t)?n.chrAliasTable[t]:t,s=this.alignmentCache.queryFeatures(r,e,i),o=new Vo(t,e,i,this.samplingWindowSize,this.samplingDepth,this.pairsSupported,this.alleleFreqThreshold);for(let t of s)o.push(t);return o.finish(),o}if(this.isDataUri){const n=Qi(function(t){const e=t.split(","),i=e[0].split(":")[1];let n=e[1];n=i.indexOf("base64")>=0?atob(n):decodeURI(n);const r=new Uint8Array(n.length);for(var s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.bamPath).buffer);return r.call(this,n),s.call(this,t,e,i)}{const n=Qi(await un.loadArrayBuffer(this.bamPath,sn(this.config)));return r.call(this,n),s.call(this,t,e,i)}function r(t){const e=[];this.header=aa.decodeBamHeader(t),aa.decodeBamRecords(t,this.header.size,e,this.header.chrNames),this.alignmentCache=new fs(e,n)}function s(t,e,i){var n,r,s,o;r=(n=this.header).chrAliasTable.hasOwnProperty(t)?n.chrAliasTable[t]:t,s=this.alignmentCache.queryFeatures(r,e,i),o=new Vo(t,e,i,this.samplingWindowSize,this.samplingDepth,this.pairsSupported);for(let t of s)o.push(t);return o.finish(),o}}}class pa{constructor(t,e){this.config=t,this.genome=e,this.bamPath=t.url,this.baiPath=t.indexURL,this.baiPath||!1===t.indexed||this.bamPath instanceof File||(this.baiPath=function(t,e){var i;if(t instanceof File)throw new Error("Cannot infer an index path for a local File.  Please select explicitly");return t.includes("?")?(i=t.indexOf("?"),t.substring(0,i)+"."+e+t.substring(i)):t+"."+e}(this.bamPath,"bai"),console.error(`Warning: no indexURL specified for ${this.config.url}.  Guessing ${this.baiPath}`)),aa.setReaderDefaults(this,t)}async readAlignments(t,e,i){const n=(await this.getChrIndex())[this.chrAliasTable.hasOwnProperty(t)?this.chrAliasTable[t]:t],r=new Vo(t,e,i,this.config.samplingWindowSize,this.config.samplingDepth,this.config.pairsSupported,this.config.alleleFreqThreshold);if(void 0===n)return r;{const t=(await this.getIndex()).blocksForRange(n,e,i);if(!t||0===t.length)return r;for(let o of t){let t;if(0===o.maxv.offset)t=0;else{const e=sn(this.config,{range:{start:o.maxv.block,size:26}});t=Ji(await un.loadArrayBuffer(this.bamPath,e))}const a=o.minv.block,h={start:a,size:o.maxv.block+t-a+1};var s=Qi(await un.loadArrayBuffer(this.bamPath,sn(this.config,{range:h})));if(aa.decodeBamRecords(s,o.minv.offset,r,this.indexToChr,n,e,i,this.filter))break}return r.finish(),r}}async getHeader(){if(!this.header){const t=this.genome,e=await this.getIndex();let i;if(e.firstAlignmentBlock){const t=sn(this.config,{range:{start:e.firstAlignmentBlock,size:26}}),n=Ji(await un.loadArrayBuffer(this.bamPath,t));i=e.firstAlignmentBlock+n}else i=64e3;const n=sn(this.config,{range:{start:0,size:i}});this.header=await aa.readHeader(this.bamPath,n,t)}return this.header}async getIndex(){const t=this.genome;return this.index||(this.index=await hs(this.baiPath,this.config,t)),this.index}async getChrIndex(){if(this.chrToIndex)return this.chrToIndex;{const t=await this.getHeader();return this.chrToIndex=t.chrToIndex,this.indexToChr=t.chrNames,this.chrAliasTable=t.chrAliasTable,this.chrToIndex}}}class ga{constructor(t,e){this.config=t,this.genome=e;const i={},n={};t.sources.sequences.forEach((function(t){if(i[t]=null,e){const i=e.getChromosomeName(t);n[i]=t}})),this.chrAliasTable=n,this.bamReaders=i,aa.setReaderDefaults(this,t)}async readAlignments(t,e,i){this.genome;const n=this,r=n.chrAliasTable.hasOwnProperty(t)?n.chrAliasTable[t]:t;if(this.bamReaders.hasOwnProperty(r)&&"none"!==this.bamReaders[r]){let s,o=n.bamReaders[r];if(!o){s={url:n.config.sources.url.replace("$CHR",r)},n.config.sources.indexURL&&(s.indexURL=n.config.sources.indexURL.replace("$CHR",r));const t=Object.assign(n.config,s);o=new pa(t),n.bamReaders[r]=o}return o.readAlignments(r,e,i).catch((function(o){console.error(o);const a=`Error reading BAM or index file for: ${s?s.url:""}`;return v.presentAlert(new Error(a)),n.bamReaders[r]="none",new Vo(t,e,i)}))}return Promise.resolve(new Vo(t,e,i))}}const ma=function(t,e){this.config=t,this.genome=e,aa.setReaderDefaults(this,t)};function ba(){const t=this,e=this.genome;if(this.header)return Promise.resolve(this.header);{const i=this.config.url+"?file="+this.config.alignmentFile+"&options=-b,-H",n=sn(this.config);return aa.readHeader(i,n,e).then((function(e){return t.header=e,e}))}}ma.prototype.readAlignments=function(t,e,i){var n=this;return ba.call(n).then((function(r){var s,o;return s=r.chrAliasTable.hasOwnProperty(t)?r.chrAliasTable[t]:t,o=n.config.url+"?reference="+n.config.referenceFile+"&file="+n.config.alignmentFile+"&region="+s+":"+e+"-"+i,un.loadString(o,sn(n.config)).then((function(o){var a;return r.chrToIndex[s],a=new Vo(t,e,i,n.samplingWindowSize,n.samplingDepth,n.pairsSupported,n.alleleFreqThreshold),aa.decodeSamRecords(o,a,s,e,i,n.filter),a}))}))};class wa{constructor(t,e){this.config=t,this.genome=e,aa.setReaderDefaults(this,t)}async readAlignments(t,e,i,n){if(this.config.format&&"BAM"!==this.config.format.toUpperCase())throw Error(`htsget format ${this.config.format} is not supported`);const r=this.genome;let s,o;s=this.header&&this.header.chrAliasTable.hasOwnProperty(t)?this.header.chrAliasTable[t]:t,o=this.config.url?this.config.url+this.config.endpoint:this.config.endpoint+"/reads/";const a=o+this.config.id+"?format=BAM&referenceName="+s+"&start="+e+"&end="+i,h=await un.loadJson(a,this.config),l=Qi(function(t){let e=0;t.forEach((function(t){e+=t.length}));let i=0;const n=new Uint8Array(e);return t.forEach((function(t){n.set(t,i),i+=t.length})),n}(await async function(t){const e=[];return t.forEach((function(t){if(t.url.startsWith("data:"))e.push(Promise.resolve(function(t){const e=t.split(","),i=e[0].split(":")[1];let n=e[1];n=i.indexOf("base64")>=0?atob(n):decodeURI(n);const r=new Uint8Array(n.length);for(var s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(t.url)));else{const i={};t.headers&&(i.headers=t.headers,i.headers.hasOwnProperty("referer")&&delete i.headers.referer),e.push(new Promise((function(e,n){un.loadArrayBuffer(t.url,i).then((function(t){e(new Uint8Array(t))}))})))}})),Promise.all(e)}(h.htsget.urls)).buffer);this.header=aa.decodeBamHeader(l,r);const c=this.header.chrToIndex[t],u=new Vo(t,e,i,this.samplingWindowSize,this.samplingDepth,this.pairsSupported,this.alleleFreqThreshold);return aa.decodeBamRecords(l,this.header.size,u,this.header.chrNames,c,e,i),u.finish(),0===u.alignments.length&&void 0===c&&this.header.chrAliasTable.hasOwnProperty(t)&&!n?(s=this.header.chrAliasTable[t],this.readAlignments(s,e,i,1)):u}}var va=eval,ya=function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=35)}([function(t,e){class i extends Error{}class n extends i{}t.exports={CramBufferOverrunError:class extends n{},CramMalformedError:n,CramUnimplementedError:class extends Error{},CramSizeLimitError:class extends i{},CramArgumentError:class extends i{}}},function(t,e,i){(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var n=i(37),r=i(38),s=i(19);function o(){return h.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){if(o()<e)throw new RangeError("Invalid typed array length");return h.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=h.prototype:(null===t&&(t=new h(e)),t.length=e),t}function h(t,e,i){if(!(h.TYPED_ARRAY_SUPPORT||this instanceof h))return new h(t,e,i);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return u(this,t)}return l(this,t,e,i)}function l(t,e,i,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,i,n){if(e.byteLength,i<0||e.byteLength<i)throw new RangeError("'offset' is out of bounds");if(e.byteLength<i+(n||0))throw new RangeError("'length' is out of bounds");return e=void 0===i&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,i):new Uint8Array(e,i,n),h.TYPED_ARRAY_SUPPORT?(t=e).__proto__=h.prototype:t=f(t,e),t}(t,e,i,n):"string"==typeof e?function(t,e,i){if("string"==typeof i&&""!==i||(i="utf8"),!h.isEncoding(i))throw new TypeError('"encoding" must be a valid string encoding');var n=0|p(e,i),r=(t=a(t,n)).write(e,i);return r!==n&&(t=t.slice(0,r)),t}(t,e,i):function(t,e){if(h.isBuffer(e)){var i=0|d(e.length);return 0===(t=a(t,i)).length||e.copy(t,0,0,i),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(n=e.length)!=n?a(t,0):f(t,e);if("Buffer"===e.type&&s(e.data))return f(t,e.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function c(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function u(t,e){if(c(e),t=a(t,e<0?0:0|d(e)),!h.TYPED_ARRAY_SUPPORT)for(var i=0;i<e;++i)t[i]=0;return t}function f(t,e){var i=e.length<0?0:0|d(e.length);t=a(t,i);for(var n=0;n<i;n+=1)t[n]=255&e[n];return t}function d(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function p(t,e){if(h.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var i=t.length;if(0===i)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":case void 0:return H(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return U(t).length;default:if(n)return H(t).length;e=(""+e).toLowerCase(),n=!0}}function g(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function m(t,e,i,n,r){if(0===t.length)return-1;if("string"==typeof i?(n=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),i=+i,isNaN(i)&&(i=r?0:t.length-1),i<0&&(i=t.length+i),i>=t.length){if(r)return-1;i=t.length-1}else if(i<0){if(!r)return-1;i=0}if("string"==typeof e&&(e=h.from(e,n)),h.isBuffer(e))return 0===e.length?-1:b(t,e,i,n,r);if("number"==typeof e)return e&=255,h.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(t,e,i):Uint8Array.prototype.lastIndexOf.call(t,e,i):b(t,[e],i,n,r);throw new TypeError("val must be string, number or Buffer")}function b(t,e,i,n,r){var s,o=1,a=t.length,h=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;o=2,a/=2,h/=2,i/=2}function l(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(r){var c=-1;for(s=i;s<a;s++)if(l(t,s)===l(e,-1===c?0:s-c)){if(-1===c&&(c=s),s-c+1===h)return c*o}else-1!==c&&(s-=s-c),c=-1}else for(i+h>a&&(i=a-h),s=i;s>=0;s--){for(var u=!0,f=0;f<h;f++)if(l(t,s+f)!==l(e,f)){u=!1;break}if(u)return s}return-1}function w(t,e,i,n){i=Number(i)||0;var r=t.length-i;n?(n=Number(n))>r&&(n=r):n=r;var s=e.length;if(s%2!=0)throw new TypeError("Invalid hex string");n>s/2&&(n=s/2);for(var o=0;o<n;++o){var a=parseInt(e.substr(2*o,2),16);if(isNaN(a))return o;t[i+o]=a}return o}function v(t,e,i,n){return $(H(e,t.length-i),t,i,n)}function y(t,e,i,n){return $(function(t){for(var e=[],i=0;i<t.length;++i)e.push(255&t.charCodeAt(i));return e}(e),t,i,n)}function x(t,e,i,n){return y(t,e,i,n)}function k(t,e,i,n){return $(U(e),t,i,n)}function S(t,e,i,n){return $(function(t,e){for(var i,n,r,s=[],o=0;o<t.length&&!((e-=2)<0);++o)n=(i=t.charCodeAt(o))>>8,r=i%256,s.push(r),s.push(n);return s}(e,t.length-i),t,i,n)}function _(t,e,i){return 0===e&&i===t.length?n.fromByteArray(t):n.fromByteArray(t.slice(e,i))}function C(t,e,i){i=Math.min(t.length,i);for(var n=[],r=e;r<i;){var s,o,a,h,l=t[r],c=null,u=l>239?4:l>223?3:l>191?2:1;if(r+u<=i)switch(u){case 1:l<128&&(c=l);break;case 2:128==(192&(s=t[r+1]))&&(h=(31&l)<<6|63&s)>127&&(c=h);break;case 3:s=t[r+1],o=t[r+2],128==(192&s)&&128==(192&o)&&(h=(15&l)<<12|(63&s)<<6|63&o)>2047&&(h<55296||h>57343)&&(c=h);break;case 4:s=t[r+1],o=t[r+2],a=t[r+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&(h=(15&l)<<18|(63&s)<<12|(63&o)<<6|63&a)>65535&&h<1114112&&(c=h)}null===c?(c=65533,u=1):c>65535&&(c-=65536,n.push(c>>>10&1023|55296),c=56320|1023&c),n.push(c),r+=u}return function(t){var e=t.length;if(e<=E)return String.fromCharCode.apply(String,t);for(var i="",n=0;n<e;)i+=String.fromCharCode.apply(String,t.slice(n,n+=E));return i}(n)}e.Buffer=h,e.SlowBuffer=function(t){return+t!=t&&(t=0),h.alloc(+t)},e.INSPECT_MAX_BYTES=50,h.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=o(),h.poolSize=8192,h._augment=function(t){return t.__proto__=h.prototype,t},h.from=function(t,e,i){return l(null,t,e,i)},h.TYPED_ARRAY_SUPPORT&&(h.prototype.__proto__=Uint8Array.prototype,h.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&h[Symbol.species]===h&&Object.defineProperty(h,Symbol.species,{value:null,configurable:!0})),h.alloc=function(t,e,i){return function(t,e,i,n){return c(e),e<=0?a(t,e):void 0!==i?"string"==typeof n?a(t,e).fill(i,n):a(t,e).fill(i):a(t,e)}(null,t,e,i)},h.allocUnsafe=function(t){return u(null,t)},h.allocUnsafeSlow=function(t){return u(null,t)},h.isBuffer=function(t){return!(null==t||!t._isBuffer)},h.compare=function(t,e){if(!h.isBuffer(t)||!h.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var i=t.length,n=e.length,r=0,s=Math.min(i,n);r<s;++r)if(t[r]!==e[r]){i=t[r],n=e[r];break}return i<n?-1:n<i?1:0},h.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},h.concat=function(t,e){if(!s(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return h.alloc(0);var i;if(void 0===e)for(e=0,i=0;i<t.length;++i)e+=t[i].length;var n=h.allocUnsafe(e),r=0;for(i=0;i<t.length;++i){var o=t[i];if(!h.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,r),r+=o.length}return n},h.byteLength=p,h.prototype._isBuffer=!0,h.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)g(this,e,e+1);return this},h.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},h.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},h.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?C(this,0,t):function(t,e,i){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return R(this,e,i);case"utf8":case"utf-8":return C(this,e,i);case"ascii":return T(this,e,i);case"latin1":case"binary":return A(this,e,i);case"base64":return _(this,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,e,i);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}.apply(this,arguments)},h.prototype.equals=function(t){if(!h.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===h.compare(this,t)},h.prototype.inspect=function(){var t="",i=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,i).match(/.{2}/g).join(" "),this.length>i&&(t+=" ... ")),"<Buffer "+t+">"},h.prototype.compare=function(t,e,i,n,r){if(!h.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===i&&(i=t?t.length:0),void 0===n&&(n=0),void 0===r&&(r=this.length),e<0||i>t.length||n<0||r>this.length)throw new RangeError("out of range index");if(n>=r&&e>=i)return 0;if(n>=r)return-1;if(e>=i)return 1;if(this===t)return 0;for(var s=(r>>>=0)-(n>>>=0),o=(i>>>=0)-(e>>>=0),a=Math.min(s,o),l=this.slice(n,r),c=t.slice(e,i),u=0;u<a;++u)if(l[u]!==c[u]){s=l[u],o=c[u];break}return s<o?-1:o<s?1:0},h.prototype.includes=function(t,e,i){return-1!==this.indexOf(t,e,i)},h.prototype.indexOf=function(t,e,i){return m(this,t,e,i,!0)},h.prototype.lastIndexOf=function(t,e,i){return m(this,t,e,i,!1)},h.prototype.write=function(t,e,i,n){if(void 0===e)n="utf8",i=this.length,e=0;else if(void 0===i&&"string"==typeof e)n=e,i=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(i)?(i|=0,void 0===n&&(n="utf8")):(n=i,i=void 0)}var r=this.length-e;if((void 0===i||i>r)&&(i=r),t.length>0&&(i<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var s=!1;;)switch(n){case"hex":return w(this,t,e,i);case"utf8":case"utf-8":return v(this,t,e,i);case"ascii":return y(this,t,e,i);case"latin1":case"binary":return x(this,t,e,i);case"base64":return k(this,t,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,t,e,i);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}},h.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var E=4096;function T(t,e,i){var n="";i=Math.min(t.length,i);for(var r=e;r<i;++r)n+=String.fromCharCode(127&t[r]);return n}function A(t,e,i){var n="";i=Math.min(t.length,i);for(var r=e;r<i;++r)n+=String.fromCharCode(t[r]);return n}function R(t,e,i){var n=t.length;(!e||e<0)&&(e=0),(!i||i<0||i>n)&&(i=n);for(var r="",s=e;s<i;++s)r+=z(t[s]);return r}function I(t,e,i){for(var n=t.slice(e,i),r="",s=0;s<n.length;s+=2)r+=String.fromCharCode(n[s]+256*n[s+1]);return r}function L(t,e,i){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>i)throw new RangeError("Trying to access beyond buffer length")}function M(t,e,i,n,r,s){if(!h.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>r||e<s)throw new RangeError('"value" argument is out of bounds');if(i+n>t.length)throw new RangeError("Index out of range")}function F(t,e,i,n){e<0&&(e=65535+e+1);for(var r=0,s=Math.min(t.length-i,2);r<s;++r)t[i+r]=(e&255<<8*(n?r:1-r))>>>8*(n?r:1-r)}function D(t,e,i,n){e<0&&(e=4294967295+e+1);for(var r=0,s=Math.min(t.length-i,4);r<s;++r)t[i+r]=e>>>8*(n?r:3-r)&255}function B(t,e,i,n,r,s){if(i+n>t.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function N(t,e,i,n,s){return s||B(t,0,i,4),r.write(t,e,i,n,23,4),i+4}function P(t,e,i,n,s){return s||B(t,0,i,8),r.write(t,e,i,n,52,8),i+8}h.prototype.slice=function(t,e){var i,n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t),h.TYPED_ARRAY_SUPPORT)(i=this.subarray(t,e)).__proto__=h.prototype;else{var r=e-t;i=new h(r,void 0);for(var s=0;s<r;++s)i[s]=this[s+t]}return i},h.prototype.readUIntLE=function(t,e,i){t|=0,e|=0,i||L(t,e,this.length);for(var n=this[t],r=1,s=0;++s<e&&(r*=256);)n+=this[t+s]*r;return n},h.prototype.readUIntBE=function(t,e,i){t|=0,e|=0,i||L(t,e,this.length);for(var n=this[t+--e],r=1;e>0&&(r*=256);)n+=this[t+--e]*r;return n},h.prototype.readUInt8=function(t,e){return e||L(t,1,this.length),this[t]},h.prototype.readUInt16LE=function(t,e){return e||L(t,2,this.length),this[t]|this[t+1]<<8},h.prototype.readUInt16BE=function(t,e){return e||L(t,2,this.length),this[t]<<8|this[t+1]},h.prototype.readUInt32LE=function(t,e){return e||L(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},h.prototype.readUInt32BE=function(t,e){return e||L(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},h.prototype.readIntLE=function(t,e,i){t|=0,e|=0,i||L(t,e,this.length);for(var n=this[t],r=1,s=0;++s<e&&(r*=256);)n+=this[t+s]*r;return n>=(r*=128)&&(n-=Math.pow(2,8*e)),n},h.prototype.readIntBE=function(t,e,i){t|=0,e|=0,i||L(t,e,this.length);for(var n=e,r=1,s=this[t+--n];n>0&&(r*=256);)s+=this[t+--n]*r;return s>=(r*=128)&&(s-=Math.pow(2,8*e)),s},h.prototype.readInt8=function(t,e){return e||L(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},h.prototype.readInt16LE=function(t,e){e||L(t,2,this.length);var i=this[t]|this[t+1]<<8;return 32768&i?4294901760|i:i},h.prototype.readInt16BE=function(t,e){e||L(t,2,this.length);var i=this[t+1]|this[t]<<8;return 32768&i?4294901760|i:i},h.prototype.readInt32LE=function(t,e){return e||L(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},h.prototype.readInt32BE=function(t,e){return e||L(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},h.prototype.readFloatLE=function(t,e){return e||L(t,4,this.length),r.read(this,t,!0,23,4)},h.prototype.readFloatBE=function(t,e){return e||L(t,4,this.length),r.read(this,t,!1,23,4)},h.prototype.readDoubleLE=function(t,e){return e||L(t,8,this.length),r.read(this,t,!0,52,8)},h.prototype.readDoubleBE=function(t,e){return e||L(t,8,this.length),r.read(this,t,!1,52,8)},h.prototype.writeUIntLE=function(t,e,i,n){t=+t,e|=0,i|=0,n||M(this,t,e,i,Math.pow(2,8*i)-1,0);var r=1,s=0;for(this[e]=255&t;++s<i&&(r*=256);)this[e+s]=t/r&255;return e+i},h.prototype.writeUIntBE=function(t,e,i,n){t=+t,e|=0,i|=0,n||M(this,t,e,i,Math.pow(2,8*i)-1,0);var r=i-1,s=1;for(this[e+r]=255&t;--r>=0&&(s*=256);)this[e+r]=t/s&255;return e+i},h.prototype.writeUInt8=function(t,e,i){return t=+t,e|=0,i||M(this,t,e,1,255,0),h.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},h.prototype.writeUInt16LE=function(t,e,i){return t=+t,e|=0,i||M(this,t,e,2,65535,0),h.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):F(this,t,e,!0),e+2},h.prototype.writeUInt16BE=function(t,e,i){return t=+t,e|=0,i||M(this,t,e,2,65535,0),h.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):F(this,t,e,!1),e+2},h.prototype.writeUInt32LE=function(t,e,i){return t=+t,e|=0,i||M(this,t,e,4,4294967295,0),h.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):D(this,t,e,!0),e+4},h.prototype.writeUInt32BE=function(t,e,i){return t=+t,e|=0,i||M(this,t,e,4,4294967295,0),h.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):D(this,t,e,!1),e+4},h.prototype.writeIntLE=function(t,e,i,n){if(t=+t,e|=0,!n){var r=Math.pow(2,8*i-1);M(this,t,e,i,r-1,-r)}var s=0,o=1,a=0;for(this[e]=255&t;++s<i&&(o*=256);)t<0&&0===a&&0!==this[e+s-1]&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+i},h.prototype.writeIntBE=function(t,e,i,n){if(t=+t,e|=0,!n){var r=Math.pow(2,8*i-1);M(this,t,e,i,r-1,-r)}var s=i-1,o=1,a=0;for(this[e+s]=255&t;--s>=0&&(o*=256);)t<0&&0===a&&0!==this[e+s+1]&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+i},h.prototype.writeInt8=function(t,e,i){return t=+t,e|=0,i||M(this,t,e,1,127,-128),h.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},h.prototype.writeInt16LE=function(t,e,i){return t=+t,e|=0,i||M(this,t,e,2,32767,-32768),h.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):F(this,t,e,!0),e+2},h.prototype.writeInt16BE=function(t,e,i){return t=+t,e|=0,i||M(this,t,e,2,32767,-32768),h.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):F(this,t,e,!1),e+2},h.prototype.writeInt32LE=function(t,e,i){return t=+t,e|=0,i||M(this,t,e,4,2147483647,-2147483648),h.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):D(this,t,e,!0),e+4},h.prototype.writeInt32BE=function(t,e,i){return t=+t,e|=0,i||M(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),h.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):D(this,t,e,!1),e+4},h.prototype.writeFloatLE=function(t,e,i){return N(this,t,e,!0,i)},h.prototype.writeFloatBE=function(t,e,i){return N(this,t,e,!1,i)},h.prototype.writeDoubleLE=function(t,e,i){return P(this,t,e,!0,i)},h.prototype.writeDoubleBE=function(t,e,i){return P(this,t,e,!1,i)},h.prototype.copy=function(t,e,i,n){if(i||(i=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<i&&(n=i),n===i)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-i&&(n=t.length-e+i);var r,s=n-i;if(this===t&&i<e&&e<n)for(r=s-1;r>=0;--r)t[r+e]=this[r+i];else if(s<1e3||!h.TYPED_ARRAY_SUPPORT)for(r=0;r<s;++r)t[r+e]=this[r+i];else Uint8Array.prototype.set.call(t,this.subarray(i,i+s),e);return s},h.prototype.fill=function(t,e,i,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,i=this.length):"string"==typeof i&&(n=i,i=this.length),1===t.length){var r=t.charCodeAt(0);r<256&&(t=r)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!h.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<i)throw new RangeError("Out of range index");if(i<=e)return this;var s;if(e>>>=0,i=void 0===i?this.length:i>>>0,t||(t=0),"number"==typeof t)for(s=e;s<i;++s)this[s]=t;else{var o=h.isBuffer(t)?t:H(new h(t,n).toString()),a=o.length;for(s=0;s<i-e;++s)this[s+e]=o[s%a]}return this};var O=/[^+\/0-9A-Za-z-_]/g;function z(t){return t<16?"0"+t.toString(16):t.toString(16)}function H(t,e){var i;e=e||1/0;for(var n=t.length,r=null,s=[],o=0;o<n;++o){if((i=t.charCodeAt(o))>55295&&i<57344){if(!r){if(i>56319){(e-=3)>-1&&s.push(239,191,189);continue}if(o+1===n){(e-=3)>-1&&s.push(239,191,189);continue}r=i;continue}if(i<56320){(e-=3)>-1&&s.push(239,191,189),r=i;continue}i=65536+(r-55296<<10|i-56320)}else r&&(e-=3)>-1&&s.push(239,191,189);if(r=null,i<128){if((e-=1)<0)break;s.push(i)}else if(i<2048){if((e-=2)<0)break;s.push(i>>6|192,63&i|128)}else if(i<65536){if((e-=3)<0)break;s.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;s.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return s}function U(t){return n.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(O,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function $(t,e,i,n){for(var r=0;r<n&&!(r+i>=e.length||r>=t.length);++r)e[r+i]=t[r];return r}}).call(this,i(2))},function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e){var i,n,r=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(t){if(i===setTimeout)return setTimeout(t,0);if((i===s||!i)&&setTimeout)return i=setTimeout,setTimeout(t,0);try{return i(t,0)}catch(e){try{return i.call(null,t,0)}catch(e){return i.call(this,t,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:s}catch(t){i=s}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(t){n=o}}();var h,l=[],c=!1,u=-1;function f(){c&&h&&(c=!1,h.length?l=h.concat(l):u=-1,l.length&&d())}function d(){if(!c){var t=a(f);c=!0;for(var e=l.length;e;){for(h=l,l=[];++u<e;)h&&h[u].run();u=-1,e=l.length}h=null,c=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function g(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];l.push(new p(t,e)),1!==l.length||c||a(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=g,r.addListener=g,r.once=g,r.off=g,r.removeListener=g,r.removeAllListeners=g,r.emit=g,r.prependListener=g,r.prependOnceListener=g,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}},function(t,e,i){var n=i(9),r=Object.keys||function(t){var e=[];for(var i in t)e.push(i);return e};t.exports=u;var s=i(7);s.inherits=i(4);var o=i(21),a=i(16);s.inherits(u,o);for(var h=r(a.prototype),l=0;l<h.length;l++){var c=h[l];u.prototype[c]||(u.prototype[c]=a.prototype[c])}function u(t){if(!(this instanceof u))return new u(t);o.call(this,t),a.call(this,t),t&&!1===t.readable&&(this.readable=!1),t&&!1===t.writable&&(this.writable=!1),this.allowHalfOpen=!0,t&&!1===t.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",f)}function f(){this.allowHalfOpen||this._writableState.ended||n.nextTick(d,this)}function d(t){t.end()}Object.defineProperty(u.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(u.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}}),u.prototype._destroy=function(t,e){this.push(null),this.end(),n.nextTick(e,t)}},function(t,e,i){const{CramBufferOverrunError:n}=i(0),r={int:!0,byte:!0,long:!0,byteArray:!0,byteArrayBlock:!0};t.exports=class{constructor(t={},e){if(this.parameters=t,this.dataType=e,!e)throw new TypeError("must provide a data type to codec constructor");if(!r[e])throw new TypeError(`invalid data type ${e}`)}_getBits(t,e,i){let r=0;if(e.bytePosition+(7-e.bitPosition+i)/8>t.length)throw new n("read error during decoding. the file seems to be truncated.");for(let n=i;n;n-=1)r<<=1,r|=t[e.bytePosition]>>e.bitPosition&1,e.bitPosition-=1,e.bitPosition<0&&(e.bytePosition+=1),e.bitPosition&=7;return r}}},function(t,e,i){(function(t){function i(t){return Object.prototype.toString.call(t)}e.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===i(t)},e.isBoolean=function(t){return"boolean"==typeof t},e.isNull=function(t){return null===t},e.isNullOrUndefined=function(t){return null==t},e.isNumber=function(t){return"number"==typeof t},e.isString=function(t){return"string"==typeof t},e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=function(t){return void 0===t},e.isRegExp=function(t){return"[object RegExp]"===i(t)},e.isObject=function(t){return"object"==typeof t&&null!==t},e.isDate=function(t){return"[object Date]"===i(t)},e.isError=function(t){return"[object Error]"===i(t)||t instanceof Error},e.isFunction=function(t){return"function"==typeof t},e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=t.isBuffer}).call(this,i(1).Buffer)},function(t,e,i){const n=i(72),{CramBufferOverrunError:r}=i(0);t.exports={itf8Size:t=>-128&t?-16384&t?-2097152&t?-268435456&t?5:4:3:2:1,parseItf8(t,e){let i=e;const n=t[i];let s;if(n<128?(s=n,i+=1):n<192?(s=16383&(n<<8|t[i+1]),i+=2):n<224?(s=2097151&(n<<16|t[i+1]<<8|t[i+2]),i+=3):n<240?(s=268435455&(n<<24|t[i+1]<<16|t[i+2]<<8|t[i+3]),i+=4):(s=(15&n)<<28|t[i+1]<<20|t[i+2]<<12|t[i+3]<<4|15&t[i+4],i+=5),i>t.length)throw new r("Attempted to read beyond end of buffer; this file seems truncated.");return[s,i-e]},parseItem(t,e,i=0,n=0){const{offset:r,result:s}=e.parse(t);return s._endPosition=r+n,s._size=r-i,s},tinyMemoize(t,e){const i=t.prototype[e],n=`_memo_${e}`;t.prototype[e]=function(){return n in this||(this[n]=i.call(this)),this[n]}},sequenceMD5:t=>n(t.toUpperCase().replace(/[^\x21-\x7e]/g,""))}},function(t,e,i){(function(e){!e.version||0===e.version.indexOf("v0.")||0===e.version.indexOf("v1.")&&0!==e.version.indexOf("v1.8.")?t.exports={nextTick:function(t,i,n,r){if("function"!=typeof t)throw new TypeError('"callback" argument must be a function');var s,o,a=arguments.length;switch(a){case 0:case 1:return e.nextTick(t);case 2:return e.nextTick((function(){t.call(null,i)}));case 3:return e.nextTick((function(){t.call(null,i,n)}));case 4:return e.nextTick((function(){t.call(null,i,n,r)}));default:for(s=new Array(a-1),o=0;o<s.length;)s[o++]=arguments[o];return e.nextTick((function(){t.apply(null,s)}))}}}:t.exports=e}).call(this,i(3))},function(t,e,i){var n=i(1),r=n.Buffer;function s(t,e){for(var i in t)e[i]=t[i]}function o(t,e,i){return r(t,e,i)}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?t.exports=n:(s(n,e),e.Buffer=o),s(r,o),o.from=function(t,e,i){if("number"==typeof t)throw new TypeError("Argument must not be a number");return r(t,e,i)},o.alloc=function(t,e,i){if("number"!=typeof t)throw new TypeError("Argument must be a number");var n=r(t);return void 0!==e?"string"==typeof i?n.fill(e,i):n.fill(e):n.fill(0),n},o.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return r(t)},o.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return n.SlowBuffer(t)}},function(t,e,i){var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var i=e.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(var n in i)r(i,n)&&(t[n]=i[n])}}return t},e.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var s={arraySet:function(t,e,i,n,r){if(e.subarray&&t.subarray)t.set(e.subarray(i,i+n),r);else for(var s=0;s<n;s++)t[r+s]=e[i+s]},flattenChunks:function(t){var e,i,n,r,s,o;for(n=0,e=0,i=t.length;e<i;e++)n+=t[e].length;for(o=new Uint8Array(n),r=0,e=0,i=t.length;e<i;e++)s=t[e],o.set(s,r),r+=s.length;return o}},o={arraySet:function(t,e,i,n,r){for(var s=0;s<n;s++)t[r+s]=e[i+s]},flattenChunks:function(t){return[].concat.apply([],t)}};e.setTyped=function(t){t?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,s)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,o))},e.setTyped(n)},function(t,e,i){const{CramMalformedError:n}=i(0),r=i(13);class s{constructor(){this.F=void 0,this.C=void 0}}function o(t,e,i,n){return i*(t>>n)+(t&(1<<n)-1)-e}const a={FC:s,AriDecoder:class{constructor(){this.fc=new Array(256);for(let t=0;t<this.fc.length;t+=1)this.fc[t]=new s;this.R=null}},Symbol:class{constructor(){this.start=void 0,this.freq=void 0}},symbolInit:function(t,e,i){if(!(e<=65536))throw new n("assertion failed: start <= 1<<16");if(!(i<=65536-e))throw new n("assertion failed: freq <= 1<<16");t.start=e,t.freq=i},advanceStep:o,advanceSymbolStep:function(t,e,i){return o(t,e.start,e.freq,i)},get:function(t,e){return t&(1<<e)-1},advanceSymbol:function(t,e,i,n){return function(t,e,i,n,s){if((t=n*(t>>s)+(t&(1<<s)-1)-i)<r.RANS_BYTE_L)do{t=t<<8|255&e.get()}while(t<r.RANS_BYTE_L);return t}(t,e,i.start,i.freq,n)},renormalize:function(t,e){if(t<r.RANS_BYTE_L)do{t=t<<8|255&e.get()}while(t<r.RANS_BYTE_L);return t}};t.exports=a},function(t,e){t.exports={TF_SHIFT:12,TOTFREQ:4096,RANS_BYTE_L:1<<23}},function(t,e){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(t){return"function"==typeof t}function r(t){return"object"==typeof t&&null!==t}function s(t){return void 0===t}t.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},i.prototype.emit=function(t){var e,i,o,a,h,l;if(this._events||(this._events={}),"error"===t&&(!this._events.error||r(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var c=new Error('Uncaught, unspecified "error" event. ('+e+")");throw c.context=e,c}if(s(i=this._events[t]))return!1;if(n(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),i.apply(this,a)}else if(r(i))for(a=Array.prototype.slice.call(arguments,1),o=(l=i.slice()).length,h=0;h<o;h++)l[h].apply(this,a);return!0},i.prototype.addListener=function(t,e){var o;if(!n(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,n(e.listener)?e.listener:e),this._events[t]?r(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,r(this._events[t])&&!this._events[t].warned&&(o=s(this._maxListeners)?i.defaultMaxListeners:this._maxListeners)&&o>0&&this._events[t].length>o&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(t,e){if(!n(e))throw TypeError("listener must be a function");var i=!1;function r(){this.removeListener(t,r),i||(i=!0,e.apply(this,arguments))}return r.listener=e,this.on(t,r),this},i.prototype.removeListener=function(t,e){var i,s,o,a;if(!n(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(o=(i=this._events[t]).length,s=-1,i===e||n(i.listener)&&i.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(r(i)){for(a=o;a-- >0;)if(i[a]===e||i[a].listener&&i[a].listener===e){s=a;break}if(s<0)return this;1===i.length?(i.length=0,delete this._events[t]):i.splice(s,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},i.prototype.removeAllListeners=function(t){var e,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n(i=this._events[t]))this.removeListener(t,i);else if(i)for(;i.length;)this.removeListener(t,i[i.length-1]);return delete this._events[t],this},i.prototype.listeners=function(t){return this._events&&this._events[t]?n(this._events[t])?[this._events[t]]:this._events[t].slice():[]},i.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(n(e))return 1;if(e)return e.length}return 0},i.listenerCount=function(t,e){return t.listenerCount(e)}},function(t,e,i){(e=t.exports=i(21)).Stream=e,e.Readable=e,e.Writable=i(16),e.Duplex=i(5),e.Transform=i(25),e.PassThrough=i(46)},function(t,e,i){(function(e,n,r){var s=i(9);function o(t){var e=this;this.next=null,this.entry=null,this.finish=function(){!function(t,e,i){var n=t.entry;for(t.entry=null;n;){var r=n.callback;e.pendingcb--,r(undefined),n=n.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}(e,t)}}t.exports=w;var a,h=!e.browser&&["v0.10","v0.9."].indexOf(e.version.slice(0,5))>-1?n:s.nextTick;w.WritableState=b;var l=i(7);l.inherits=i(4);var c,u={deprecate:i(45)},f=i(22),d=i(10).Buffer,p=r.Uint8Array||function(){},g=i(23);function m(){}function b(t,e){a=a||i(5),t=t||{};var n=e instanceof a;this.objectMode=!!t.objectMode,n&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var r=t.highWaterMark,l=t.writableHighWaterMark,c=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n&&(l||0===l)?l:c,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var u=!1===t.decodeStrings;this.decodeStrings=!u,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,e){var i=t._writableState,n=i.sync,r=i.writecb;if(function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(i),e)!function(t,e,i,n,r){--e.pendingcb,i?(s.nextTick(r,n),s.nextTick(_,t,e),t._writableState.errorEmitted=!0,t.emit("error",n)):(r(n),t._writableState.errorEmitted=!0,t.emit("error",n),_(t,e))}(t,i,n,e,r);else{var o=k(i);o||i.corked||i.bufferProcessing||!i.bufferedRequest||x(t,i),n?h(y,t,i,o,r):y(t,i,o,r)}}(e,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new o(this)}function w(t){if(a=a||i(5),!(c.call(w,this)||this instanceof a))return new w(t);this._writableState=new b(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),f.call(this)}function v(t,e,i,n,r,s,o){e.writelen=n,e.writecb=o,e.writing=!0,e.sync=!0,i?t._writev(r,e.onwrite):t._write(r,s,e.onwrite),e.sync=!1}function y(t,e,i,n){i||function(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}(t,e),e.pendingcb--,n(),_(t,e)}function x(t,e){e.bufferProcessing=!0;var i=e.bufferedRequest;if(t._writev&&i&&i.next){var n=e.bufferedRequestCount,r=new Array(n),s=e.corkedRequestsFree;s.entry=i;for(var a=0,h=!0;i;)r[a]=i,i.isBuf||(h=!1),i=i.next,a+=1;r.allBuffers=h,v(t,e,!0,e.length,r,"",s.finish),e.pendingcb++,e.lastBufferedRequest=null,s.next?(e.corkedRequestsFree=s.next,s.next=null):e.corkedRequestsFree=new o(e),e.bufferedRequestCount=0}else{for(;i;){var l=i.chunk,c=i.encoding,u=i.callback;if(v(t,e,!1,e.objectMode?1:l.length,l,c,u),i=i.next,e.bufferedRequestCount--,e.writing)break}null===i&&(e.lastBufferedRequest=null)}e.bufferedRequest=i,e.bufferProcessing=!1}function k(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function S(t,e){t._final((function(i){e.pendingcb--,i&&t.emit("error",i),e.prefinished=!0,t.emit("prefinish"),_(t,e)}))}function _(t,e){var i=k(e);return i&&(function(t,e){e.prefinished||e.finalCalled||("function"==typeof t._final?(e.pendingcb++,e.finalCalled=!0,s.nextTick(S,t,e)):(e.prefinished=!0,t.emit("prefinish")))}(t,e),0===e.pendingcb&&(e.finished=!0,t.emit("finish"))),i}l.inherits(w,f),b.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(b.prototype,"buffer",{get:u.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(c=Function.prototype[Symbol.hasInstance],Object.defineProperty(w,Symbol.hasInstance,{value:function(t){return!!c.call(this,t)||this===w&&t&&t._writableState instanceof b}})):c=function(t){return t instanceof this},w.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},w.prototype.write=function(t,e,i){var n,r=this._writableState,o=!1,a=!r.objectMode&&(n=t,d.isBuffer(n)||n instanceof p);return a&&!d.isBuffer(t)&&(t=function(t){return d.from(t)}(t)),"function"==typeof e&&(i=e,e=null),a?e="buffer":e||(e=r.defaultEncoding),"function"!=typeof i&&(i=m),r.ended?function(t,e){var i=new Error("write after end");t.emit("error",i),s.nextTick(e,i)}(this,i):(a||function(t,e,i,n){var r=!0,o=!1;return null===i?o=new TypeError("May not write null values to stream"):"string"==typeof i||void 0===i||e.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o&&(t.emit("error",o),s.nextTick(n,o),r=!1),r}(this,r,t,i))&&(r.pendingcb++,o=function(t,e,i,n,r,s){if(!i){var o=function(t,e,i){return t.objectMode||!1===t.decodeStrings||"string"!=typeof e||(e=d.from(e,i)),e}(e,n,r);n!==o&&(i=!0,r="buffer",n=o)}var a=e.objectMode?1:n.length;e.length+=a;var h=e.length<e.highWaterMark;if(h||(e.needDrain=!0),e.writing||e.corked){var l=e.lastBufferedRequest;e.lastBufferedRequest={chunk:n,encoding:r,isBuf:i,callback:s,next:null},l?l.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else v(t,e,!1,a,n,r,s);return h}(this,r,a,t,e,i)),o},w.prototype.cork=function(){this._writableState.corked++},w.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.bufferedRequest||x(this,t))},w.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(w.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),w.prototype._write=function(t,e,i){i(new Error("_write() is not implemented"))},w.prototype._writev=null,w.prototype.end=function(t,e,i){var n=this._writableState;"function"==typeof t?(i=t,t=null,e=null):"function"==typeof e&&(i=e,e=null),null!=t&&this.write(t,e),n.corked&&(n.corked=1,this.uncork()),n.ending||n.finished||function(t,e,i){e.ending=!0,_(t,e),i&&(e.finished?s.nextTick(i):t.once("finish",i)),e.ended=!0,t.writable=!1}(this,n,i)},Object.defineProperty(w.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),w.prototype.destroy=g.destroy,w.prototype._undestroy=g.undestroy,w.prototype._destroy=function(t,e){this.end(),e(t)}}).call(this,i(3),i(43).setImmediate,i(2))},function(t,e){t.exports={CRAM_FLAG_PRESERVE_QUAL_SCORES:1,CRAM_FLAG_DETACHED:2,CRAM_FLAG_MATE_DOWNSTREAM:4,CRAM_FLAG_NO_SEQ:8,CRAM_FLAG_MASK:15,CRAM_M_REVERSE:1,CRAM_M_UNMAP:2,BAM_FPAIRED:1,BAM_FPROPER_PAIR:2,BAM_FUNMAP:4,BAM_FMUNMAP:8,BAM_FREVERSE:16,BAM_FMREVERSE:32,BAM_FREAD1:64,BAM_FREAD2:128,BAM_FSECONDARY:256,BAM_FQCFAIL:512,BAM_FDUP:1024,BAM_FSUPPLEMENTARY:2048,BAM_CMATCH:0,BAM_CINS:1,BAM_CDEL:2,BAM_CREF_SKIP:3,BAM_CSOFT_CLIP:4,BAM_CHARD_CLIP:5,BAM_CPAD:6,BAM_CEQUAL:7,BAM_CDIFF:8,BAM_CBACK:9,BAM_CIGAR_STR:"MIDNSHP:XB",BAM_CIGAR_SHIFT:4,BAM_CIGAR_MASK:15,BAM_CIGAR_TYPE:246183}},function(t,e,i){const n=i(36);t.exports=n},function(t,e){var i={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==i.call(t)}},function(t,e,i){(function(t){var n=i(1).Buffer,r=i(39).Transform,s=i(51),o=i(27),a=i(26).ok,h=i(1).kMaxLength,l="Cannot create final Buffer. It would be larger than 0x"+h.toString(16)+" bytes";s.Z_MIN_WINDOWBITS=8,s.Z_MAX_WINDOWBITS=15,s.Z_DEFAULT_WINDOWBITS=15,s.Z_MIN_CHUNK=64,s.Z_MAX_CHUNK=1/0,s.Z_DEFAULT_CHUNK=16384,s.Z_MIN_MEMLEVEL=1,s.Z_MAX_MEMLEVEL=9,s.Z_DEFAULT_MEMLEVEL=8,s.Z_MIN_LEVEL=-1,s.Z_MAX_LEVEL=9,s.Z_DEFAULT_LEVEL=s.Z_DEFAULT_COMPRESSION;for(var c=Object.keys(s),u=0;u<c.length;u++){var f=c[u];f.match(/^Z/)&&Object.defineProperty(e,f,{enumerable:!0,value:s[f],writable:!1})}for(var d={Z_OK:s.Z_OK,Z_STREAM_END:s.Z_STREAM_END,Z_NEED_DICT:s.Z_NEED_DICT,Z_ERRNO:s.Z_ERRNO,Z_STREAM_ERROR:s.Z_STREAM_ERROR,Z_DATA_ERROR:s.Z_DATA_ERROR,Z_MEM_ERROR:s.Z_MEM_ERROR,Z_BUF_ERROR:s.Z_BUF_ERROR,Z_VERSION_ERROR:s.Z_VERSION_ERROR},p=Object.keys(d),g=0;g<p.length;g++){var m=p[g];d[d[m]]=m}function b(t,e,i){var r=[],s=0;function o(){for(var e;null!==(e=t.read());)r.push(e),s+=e.length;t.once("readable",o)}function a(){var e,o=null;s>=h?o=new RangeError(l):e=n.concat(r,s),r=[],t.close(),i(o,e)}t.on("error",(function(e){t.removeListener("end",a),t.removeListener("readable",o),i(e)})),t.on("end",a),t.end(e),o()}function w(t,e){if("string"==typeof e&&(e=n.from(e)),!n.isBuffer(e))throw new TypeError("Not a string or buffer");var i=t._finishFlushFlag;return t._processChunk(e,i)}function v(t){if(!(this instanceof v))return new v(t);T.call(this,t,s.DEFLATE)}function y(t){if(!(this instanceof y))return new y(t);T.call(this,t,s.INFLATE)}function x(t){if(!(this instanceof x))return new x(t);T.call(this,t,s.GZIP)}function k(t){if(!(this instanceof k))return new k(t);T.call(this,t,s.GUNZIP)}function S(t){if(!(this instanceof S))return new S(t);T.call(this,t,s.DEFLATERAW)}function _(t){if(!(this instanceof _))return new _(t);T.call(this,t,s.INFLATERAW)}function C(t){if(!(this instanceof C))return new C(t);T.call(this,t,s.UNZIP)}function E(t){return t===s.Z_NO_FLUSH||t===s.Z_PARTIAL_FLUSH||t===s.Z_SYNC_FLUSH||t===s.Z_FULL_FLUSH||t===s.Z_FINISH||t===s.Z_BLOCK}function T(t,i){var o=this;if(this._opts=t=t||{},this._chunkSize=t.chunkSize||e.Z_DEFAULT_CHUNK,r.call(this,t),t.flush&&!E(t.flush))throw new Error("Invalid flush flag: "+t.flush);if(t.finishFlush&&!E(t.finishFlush))throw new Error("Invalid flush flag: "+t.finishFlush);if(this._flushFlag=t.flush||s.Z_NO_FLUSH,this._finishFlushFlag=void 0!==t.finishFlush?t.finishFlush:s.Z_FINISH,t.chunkSize&&(t.chunkSize<e.Z_MIN_CHUNK||t.chunkSize>e.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+t.chunkSize);if(t.windowBits&&(t.windowBits<e.Z_MIN_WINDOWBITS||t.windowBits>e.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+t.windowBits);if(t.level&&(t.level<e.Z_MIN_LEVEL||t.level>e.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+t.level);if(t.memLevel&&(t.memLevel<e.Z_MIN_MEMLEVEL||t.memLevel>e.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+t.memLevel);if(t.strategy&&t.strategy!=e.Z_FILTERED&&t.strategy!=e.Z_HUFFMAN_ONLY&&t.strategy!=e.Z_RLE&&t.strategy!=e.Z_FIXED&&t.strategy!=e.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+t.strategy);if(t.dictionary&&!n.isBuffer(t.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._handle=new s.Zlib(i);var a=this;this._hadError=!1,this._handle.onerror=function(t,i){A(a),a._hadError=!0;var n=new Error(t);n.errno=i,n.code=e.codes[i],a.emit("error",n)};var h=e.Z_DEFAULT_COMPRESSION;"number"==typeof t.level&&(h=t.level);var l=e.Z_DEFAULT_STRATEGY;"number"==typeof t.strategy&&(l=t.strategy),this._handle.init(t.windowBits||e.Z_DEFAULT_WINDOWBITS,h,t.memLevel||e.Z_DEFAULT_MEMLEVEL,l,t.dictionary),this._buffer=n.allocUnsafe(this._chunkSize),this._offset=0,this._level=h,this._strategy=l,this.once("end",this.close),Object.defineProperty(this,"_closed",{get:function(){return!o._handle},configurable:!0,enumerable:!0})}function A(e,i){i&&t.nextTick(i),e._handle&&(e._handle.close(),e._handle=null)}function R(t){t.emit("close")}Object.defineProperty(e,"codes",{enumerable:!0,value:Object.freeze(d),writable:!1}),e.Deflate=v,e.Inflate=y,e.Gzip=x,e.Gunzip=k,e.DeflateRaw=S,e.InflateRaw=_,e.Unzip=C,e.createDeflate=function(t){return new v(t)},e.createInflate=function(t){return new y(t)},e.createDeflateRaw=function(t){return new S(t)},e.createInflateRaw=function(t){return new _(t)},e.createGzip=function(t){return new x(t)},e.createGunzip=function(t){return new k(t)},e.createUnzip=function(t){return new C(t)},e.deflate=function(t,e,i){return"function"==typeof e&&(i=e,e={}),b(new v(e),t,i)},e.deflateSync=function(t,e){return w(new v(e),t)},e.gzip=function(t,e,i){return"function"==typeof e&&(i=e,e={}),b(new x(e),t,i)},e.gzipSync=function(t,e){return w(new x(e),t)},e.deflateRaw=function(t,e,i){return"function"==typeof e&&(i=e,e={}),b(new S(e),t,i)},e.deflateRawSync=function(t,e){return w(new S(e),t)},e.unzip=function(t,e,i){return"function"==typeof e&&(i=e,e={}),b(new C(e),t,i)},e.unzipSync=function(t,e){return w(new C(e),t)},e.inflate=function(t,e,i){return"function"==typeof e&&(i=e,e={}),b(new y(e),t,i)},e.inflateSync=function(t,e){return w(new y(e),t)},e.gunzip=function(t,e,i){return"function"==typeof e&&(i=e,e={}),b(new k(e),t,i)},e.gunzipSync=function(t,e){return w(new k(e),t)},e.inflateRaw=function(t,e,i){return"function"==typeof e&&(i=e,e={}),b(new _(e),t,i)},e.inflateRawSync=function(t,e){return w(new _(e),t)},o.inherits(T,r),T.prototype.params=function(i,n,r){if(i<e.Z_MIN_LEVEL||i>e.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+i);if(n!=e.Z_FILTERED&&n!=e.Z_HUFFMAN_ONLY&&n!=e.Z_RLE&&n!=e.Z_FIXED&&n!=e.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+n);if(this._level!==i||this._strategy!==n){var o=this;this.flush(s.Z_SYNC_FLUSH,(function(){a(o._handle,"zlib binding closed"),o._handle.params(i,n),o._hadError||(o._level=i,o._strategy=n,r&&r())}))}else t.nextTick(r)},T.prototype.reset=function(){return a(this._handle,"zlib binding closed"),this._handle.reset()},T.prototype._flush=function(t){this._transform(n.alloc(0),"",t)},T.prototype.flush=function(e,i){var r=this,o=this._writableState;("function"==typeof e||void 0===e&&!i)&&(i=e,e=s.Z_FULL_FLUSH),o.ended?i&&t.nextTick(i):o.ending?i&&this.once("end",i):o.needDrain?i&&this.once("drain",(function(){return r.flush(e,i)})):(this._flushFlag=e,this.write(n.alloc(0),"",i))},T.prototype.close=function(e){A(this,e),t.nextTick(R,this)},T.prototype._transform=function(t,e,i){var r,o=this._writableState,a=(o.ending||o.ended)&&(!t||o.length===t.length);return null===t||n.isBuffer(t)?this._handle?(a?r=this._finishFlushFlag:(r=this._flushFlag,t.length>=o.length&&(this._flushFlag=this._opts.flush||s.Z_NO_FLUSH)),void this._processChunk(t,r,i)):i(new Error("zlib binding closed")):i(new Error("invalid input"))},T.prototype._processChunk=function(t,e,i){var r=t&&t.length,s=this._chunkSize-this._offset,o=0,c=this,u="function"==typeof i;if(!u){var f,d=[],p=0;this.on("error",(function(t){f=t})),a(this._handle,"zlib binding closed");do{var g=this._handle.writeSync(e,t,o,r,this._buffer,this._offset,s)}while(!this._hadError&&w(g[0],g[1]));if(this._hadError)throw f;if(p>=h)throw A(this),new RangeError(l);var m=n.concat(d,p);return A(this),m}a(this._handle,"zlib binding closed");var b=this._handle.write(e,t,o,r,this._buffer,this._offset,s);function w(h,l){if(this&&(this.buffer=null,this.callback=null),!c._hadError){var f=s-l;if(a(f>=0,"have should not go down"),f>0){var g=c._buffer.slice(c._offset,c._offset+f);c._offset+=f,u?c.push(g):(d.push(g),p+=g.length)}if((0===l||c._offset>=c._chunkSize)&&(s=c._chunkSize,c._offset=0,c._buffer=n.allocUnsafe(c._chunkSize)),0===l){if(o+=r-h,r=h,!u)return!0;var m=c._handle.write(e,t,o,r,c._buffer,c._offset,c._chunkSize);return m.callback=w,void(m.buffer=t)}if(!u)return!1;i()}}b.buffer=t,b.callback=w},o.inherits(v,T),o.inherits(y,T),o.inherits(x,T),o.inherits(k,T),o.inherits(S,T),o.inherits(_,T),o.inherits(C,T)}).call(this,i(3))},function(t,e,i){(function(e,n){var r=i(9);t.exports=v;var s,o=i(19);v.ReadableState=w,i(14).EventEmitter;var a=function(t,e){return t.listeners(e).length},h=i(22),l=i(10).Buffer,c=e.Uint8Array||function(){},u=i(7);u.inherits=i(4);var f=i(40),d=void 0;d=f&&f.debuglog?f.debuglog("stream"):function(){};var p,g=i(41),m=i(23);u.inherits(v,h);var b=["error","close","destroy","pause","resume"];function w(t,e){t=t||{};var n=e instanceof(s=s||i(5));this.objectMode=!!t.objectMode,n&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var r=t.highWaterMark,o=t.readableHighWaterMark,a=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n&&(o||0===o)?o:a,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new g,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(p||(p=i(24).StringDecoder),this.decoder=new p(t.encoding),this.encoding=t.encoding)}function v(t){if(s=s||i(5),!(this instanceof v))return new v(t);this._readableState=new w(t,this),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),h.call(this)}function y(t,e,i,n,r){var s,o=t._readableState;return null===e?(o.reading=!1,function(t,e){if(!e.ended){if(e.decoder){var i=e.decoder.end();i&&i.length&&(e.buffer.push(i),e.length+=e.objectMode?1:i.length)}e.ended=!0,_(t)}}(t,o)):(r||(s=function(t,e){var i,n;return n=e,l.isBuffer(n)||n instanceof c||"string"==typeof e||void 0===e||t.objectMode||(i=new TypeError("Invalid non-string/buffer chunk")),i}(o,e)),s?t.emit("error",s):o.objectMode||e&&e.length>0?("string"==typeof e||o.objectMode||Object.getPrototypeOf(e)===l.prototype||(e=function(t){return l.from(t)}(e)),n?o.endEmitted?t.emit("error",new Error("stream.unshift() after end event")):x(t,o,e,!0):o.ended?t.emit("error",new Error("stream.push() after EOF")):(o.reading=!1,o.decoder&&!i?(e=o.decoder.write(e),o.objectMode||0!==e.length?x(t,o,e,!1):E(t,o)):x(t,o,e,!1))):n||(o.reading=!1)),function(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}(o)}function x(t,e,i,n){e.flowing&&0===e.length&&!e.sync?(t.emit("data",i),t.read(0)):(e.length+=e.objectMode?1:i.length,n?e.buffer.unshift(i):e.buffer.push(i),e.needReadable&&_(t)),E(t,e)}Object.defineProperty(v.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),v.prototype.destroy=m.destroy,v.prototype._undestroy=m.undestroy,v.prototype._destroy=function(t,e){this.push(null),e(t)},v.prototype.push=function(t,e){var i,n=this._readableState;return n.objectMode?i=!0:"string"==typeof t&&((e=e||n.defaultEncoding)!==n.encoding&&(t=l.from(t,e),e=""),i=!0),y(this,t,e,!1,i)},v.prototype.unshift=function(t){return y(this,t,null,!0,!1)},v.prototype.isPaused=function(){return!1===this._readableState.flowing},v.prototype.setEncoding=function(t){return p||(p=i(24).StringDecoder),this._readableState.decoder=new p(t),this._readableState.encoding=t,this};var k=8388608;function S(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!=t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=function(t){return t>=k?t=k:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function _(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(d("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?r.nextTick(C,t):C(t))}function C(t){d("emit readable"),t.emit("readable"),I(t)}function E(t,e){e.readingMore||(e.readingMore=!0,r.nextTick(T,t,e))}function T(t,e){for(var i=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(d("maybeReadMore read 0"),t.read(0),i!==e.length);)i=e.length;e.readingMore=!1}function A(t){d("readable nexttick read 0"),t.read(0)}function R(t,e){e.reading||(d("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),I(t),e.flowing&&!e.reading&&t.read(0)}function I(t){var e=t._readableState;for(d("flow",e.flowing);e.flowing&&null!==t.read(););}function L(t,e){return 0===e.length?null:(e.objectMode?i=e.buffer.shift():!t||t>=e.length?(i=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.head.data:e.buffer.concat(e.length),e.buffer.clear()):i=function(t,e,i){var n;return t<e.head.data.length?(n=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):n=t===e.head.data.length?e.shift():i?function(t,e){var i=e.head,n=1,r=i.data;for(t-=r.length;i=i.next;){var s=i.data,o=t>s.length?s.length:t;if(o===s.length?r+=s:r+=s.slice(0,t),0==(t-=o)){o===s.length?(++n,i.next?e.head=i.next:e.head=e.tail=null):(e.head=i,i.data=s.slice(o));break}++n}return e.length-=n,r}(t,e):function(t,e){var i=l.allocUnsafe(t),n=e.head,r=1;for(n.data.copy(i),t-=n.data.length;n=n.next;){var s=n.data,o=t>s.length?s.length:t;if(s.copy(i,i.length-t,0,o),0==(t-=o)){o===s.length?(++r,n.next?e.head=n.next:e.head=e.tail=null):(e.head=n,n.data=s.slice(o));break}++r}return e.length-=r,i}(t,e),n}(t,e.buffer,e.decoder),i);var i}function M(t){var e=t._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,r.nextTick(F,e,t))}function F(t,e){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function D(t,e){for(var i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1}v.prototype.read=function(t){d("read",t),t=parseInt(t,10);var e=this._readableState,i=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return d("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?M(this):_(this),null;if(0===(t=S(t,e))&&e.ended)return 0===e.length&&M(this),null;var n,r=e.needReadable;return d("need readable",r),(0===e.length||e.length-t<e.highWaterMark)&&d("length less than watermark",r=!0),e.ended||e.reading?d("reading or ended",r=!1):r&&(d("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=S(i,e))),null===(n=t>0?L(t,e):null)?(e.needReadable=!0,t=0):e.length-=t,0===e.length&&(e.ended||(e.needReadable=!0),i!==t&&e.ended&&M(this)),null!==n&&this.emit("data",n),n},v.prototype._read=function(t){this.emit("error",new Error("_read() is not implemented"))},v.prototype.pipe=function(t,e){var i=this,s=this._readableState;switch(s.pipesCount){case 0:s.pipes=t;break;case 1:s.pipes=[s.pipes,t];break;default:s.pipes.push(t)}s.pipesCount+=1,d("pipe count=%d opts=%j",s.pipesCount,e);var h=e&&!1===e.end||t===n.stdout||t===n.stderr?w:l;function l(){d("onend"),t.end()}s.endEmitted?r.nextTick(h):i.once("end",h),t.on("unpipe",(function e(n,r){d("onunpipe"),n===i&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,d("cleanup"),t.removeListener("close",m),t.removeListener("finish",b),t.removeListener("drain",c),t.removeListener("error",g),t.removeListener("unpipe",e),i.removeListener("end",l),i.removeListener("end",w),i.removeListener("data",p),u=!0,!s.awaitDrain||t._writableState&&!t._writableState.needDrain||c())}));var c=function(t){return function(){var e=t._readableState;d("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&a(t,"data")&&(e.flowing=!0,I(t))}}(i);t.on("drain",c);var u=!1,f=!1;function p(e){d("ondata"),f=!1,!1!==t.write(e)||f||((1===s.pipesCount&&s.pipes===t||s.pipesCount>1&&-1!==D(s.pipes,t))&&!u&&(d("false write response, pause",i._readableState.awaitDrain),i._readableState.awaitDrain++,f=!0),i.pause())}function g(e){d("onerror",e),w(),t.removeListener("error",g),0===a(t,"error")&&t.emit("error",e)}function m(){t.removeListener("finish",b),w()}function b(){d("onfinish"),t.removeListener("close",m),w()}function w(){d("unpipe"),i.unpipe(t)}return i.on("data",p),function(t,e,i){if("function"==typeof t.prependListener)return t.prependListener(e,i);t._events&&t._events[e]?o(t._events[e])?t._events[e].unshift(i):t._events[e]=[i,t._events[e]]:t.on(e,i)}(t,"error",g),t.once("close",m),t.once("finish",b),t.emit("pipe",i),s.flowing||(d("pipe resume"),i.resume()),t},v.prototype.unpipe=function(t){var e=this._readableState,i={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes||(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,i)),this;if(!t){var n=e.pipes,r=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var s=0;s<r;s++)n[s].emit("unpipe",this,i);return this}var o=D(e.pipes,t);return-1===o||(e.pipes.splice(o,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,i)),this},v.prototype.on=function(t,e){var i=h.prototype.on.call(this,t,e);if("data"===t)!1!==this._readableState.flowing&&this.resume();else if("readable"===t){var n=this._readableState;n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&_(this):r.nextTick(A,this))}return i},v.prototype.addListener=v.prototype.on,v.prototype.resume=function(){var t=this._readableState;return t.flowing||(d("resume"),t.flowing=!0,function(t,e){e.resumeScheduled||(e.resumeScheduled=!0,r.nextTick(R,t,e))}(this,t)),this},v.prototype.pause=function(){return d("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(d("pause"),this._readableState.flowing=!1,this.emit("pause")),this},v.prototype.wrap=function(t){var e=this,i=this._readableState,n=!1;for(var r in t.on("end",(function(){if(d("wrapped end"),i.decoder&&!i.ended){var t=i.decoder.end();t&&t.length&&e.push(t)}e.push(null)})),t.on("data",(function(r){d("wrapped data"),i.decoder&&(r=i.decoder.write(r)),i.objectMode&&null==r||(i.objectMode||r&&r.length)&&(e.push(r)||(n=!0,t.pause()))})),t)void 0===this[r]&&"function"==typeof t[r]&&(this[r]=function(e){return function(){return t[e].apply(t,arguments)}}(r));for(var s=0;s<b.length;s++)t.on(b[s],this.emit.bind(this,b[s]));return this._read=function(e){d("wrapped _read",e),n&&(n=!1,t.resume())},this},Object.defineProperty(v.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),v._fromList=L}).call(this,i(2),i(3))},function(t,e,i){t.exports=i(14).EventEmitter},function(t,e,i){var n=i(9);function r(t,e){t.emit("error",e)}t.exports={destroy:function(t,e){var i=this,s=this._readableState&&this._readableState.destroyed,o=this._writableState&&this._writableState.destroyed;return s||o?(e?e(t):!t||this._writableState&&this._writableState.errorEmitted||n.nextTick(r,this,t),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,(function(t){!e&&t?(n.nextTick(r,i,t),i._writableState&&(i._writableState.errorEmitted=!0)):e&&e(t)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(t,e,i){var n=i(10).Buffer,r=n.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function s(t){var e;switch(this.encoding=function(t){var e=function(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}(t);if("string"!=typeof e&&(n.isEncoding===r||!r(t)))throw new Error("Unknown encoding: "+t);return e||t}(t),this.encoding){case"utf16le":this.text=h,this.end=l,e=4;break;case"utf8":this.fillLast=a,e=4;break;case"base64":this.text=c,this.end=u,e=3;break;default:return this.write=f,void(this.end=d)}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(e)}function o(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function a(t){var e=this.lastTotal-this.lastNeed,i=function(t,e,i){if(128!=(192&e[0]))return t.lastNeed=0,"";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,""}}(this,t);return void 0!==i?i:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function h(t,e){if((t.length-e)%2==0){var i=t.toString("utf16le",e);if(i){var n=i.charCodeAt(i.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],i.slice(0,-1)}return i}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function l(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var i=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,i)}return e}function c(t,e){var i=(t.length-e)%3;return 0===i?t.toString("base64",e):(this.lastNeed=3-i,this.lastTotal=3,1===i?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-i))}function u(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function f(t){return t.toString(this.encoding)}function d(t){return t&&t.length?this.write(t):""}e.StringDecoder=s,s.prototype.write=function(t){if(0===t.length)return"";var e,i;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";i=this.lastNeed,this.lastNeed=0}else i=0;return i<t.length?e?e+this.text(t,i):this.text(t,i):e||""},s.prototype.end=function(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"":e},s.prototype.text=function(t,e){var i=function(t,e,i){var n=e.length-1;if(n<i)return 0;var r=o(e[n]);return r>=0?(r>0&&(t.lastNeed=r-1),r):--n<i||-2===r?0:(r=o(e[n]))>=0?(r>0&&(t.lastNeed=r-2),r):--n<i||-2===r?0:(r=o(e[n]))>=0?(r>0&&(2===r?r=0:t.lastNeed=r-3),r):0}(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=i;var n=t.length-(i-this.lastNeed);return t.copy(this.lastChar,0,n),t.toString("utf8",e,n)},s.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}},function(t,e,i){t.exports=o;var n=i(5),r=i(7);function s(t,e){var i=this._transformState;i.transforming=!1;var n=i.writecb;if(!n)return this.emit("error",new Error("write callback called multiple times"));i.writechunk=null,i.writecb=null,null!=e&&this.push(e),n(t);var r=this._readableState;r.reading=!1,(r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}function o(t){if(!(this instanceof o))return new o(t);n.call(this,t),this._transformState={afterTransform:s.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",a)}function a(){var t=this;"function"==typeof this._flush?this._flush((function(e,i){h(t,e,i)})):h(this,null,null)}function h(t,e,i){if(e)return t.emit("error",e);if(null!=i&&t.push(i),t._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(t._transformState.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}r.inherits=i(4),r.inherits(o,n),o.prototype.push=function(t,e){return this._transformState.needTransform=!1,n.prototype.push.call(this,t,e)},o.prototype._transform=function(t,e,i){throw new Error("_transform() is not implemented")},o.prototype._write=function(t,e,i){var n=this._transformState;if(n.writecb=i,n.writechunk=t,n.writeencoding=e,!n.transforming){var r=this._readableState;(n.needTransform||r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}},o.prototype._read=function(t){var e=this._transformState;null!==e.writechunk&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0},o.prototype._destroy=function(t,e){var i=this;n.prototype._destroy.call(this,t,(function(t){e(t),i.emit("close")}))}},function(t,e,i){(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
function n(t,e){if(t===e)return 0;for(var i=t.length,n=e.length,r=0,s=Math.min(i,n);r<s;++r)if(t[r]!==e[r]){i=t[r],n=e[r];break}return i<n?-1:n<i?1:0}function r(t){return e.Buffer&&"function"==typeof e.Buffer.isBuffer?e.Buffer.isBuffer(t):!(null==t||!t._isBuffer)}var s=i(27),o=Object.prototype.hasOwnProperty,a=Array.prototype.slice,h="foo"===function(){}.name;function l(t){return Object.prototype.toString.call(t)}function c(t){return!r(t)&&"function"==typeof e.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):!!t&&(t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer)))}var u=t.exports=b,f=/\s*function\s+([^\(\s]*)\s*/;function d(t){if(s.isFunction(t)){if(h)return t.name;var e=t.toString().match(f);return e&&e[1]}}function p(t,e){return"string"==typeof t?t.length<e?t:t.slice(0,e):t}function g(t){if(h||!s.isFunction(t))return s.inspect(t);var e=d(t);return"[Function"+(e?": "+e:"")+"]"}function m(t,e,i,n,r){throw new u.AssertionError({message:i,actual:t,expected:e,operator:n,stackStartFunction:r})}function b(t,e){t||m(t,!0,e,"==",u.ok)}function w(t,e,i,o){if(t===e)return!0;if(r(t)&&r(e))return 0===n(t,e);if(s.isDate(t)&&s.isDate(e))return t.getTime()===e.getTime();if(s.isRegExp(t)&&s.isRegExp(e))return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(null!==t&&"object"==typeof t||null!==e&&"object"==typeof e){if(c(t)&&c(e)&&l(t)===l(e)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===n(new Uint8Array(t.buffer),new Uint8Array(e.buffer));if(r(t)!==r(e))return!1;var h=(o=o||{actual:[],expected:[]}).actual.indexOf(t);return-1!==h&&h===o.expected.indexOf(e)||(o.actual.push(t),o.expected.push(e),function(t,e,i,n){if(null==t||null==e)return!1;if(s.isPrimitive(t)||s.isPrimitive(e))return t===e;if(i&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;var r=v(t),o=v(e);if(r&&!o||!r&&o)return!1;if(r)return w(t=a.call(t),e=a.call(e),i);var h,l,c=k(t),u=k(e);if(c.length!==u.length)return!1;for(c.sort(),u.sort(),l=c.length-1;l>=0;l--)if(c[l]!==u[l])return!1;for(l=c.length-1;l>=0;l--)if(!w(t[h=c[l]],e[h],i,n))return!1;return!0}(t,e,i,o))}return i?t===e:t==e}function v(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function y(t,e){if(!t||!e)return!1;if("[object RegExp]"==Object.prototype.toString.call(e))return e.test(t);try{if(t instanceof e)return!0}catch(t){}return!Error.isPrototypeOf(e)&&!0===e.call({},t)}function x(t,e,i,n){var r;if("function"!=typeof e)throw new TypeError('"block" argument must be a function');"string"==typeof i&&(n=i,i=null),r=function(t){var e;try{t()}catch(t){e=t}return e}(e),n=(i&&i.name?" ("+i.name+").":".")+(n?" "+n:"."),t&&!r&&m(r,i,"Missing expected exception"+n);var o="string"==typeof n,a=!t&&r&&!i;if((!t&&s.isError(r)&&o&&y(r,i)||a)&&m(r,i,"Got unwanted exception"+n),t&&r&&i&&!y(r,i)||!t&&r)throw r}u.AssertionError=function(t){this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=p(g(this.actual),128)+" "+this.operator+" "+p(g(this.expected),128),this.generatedMessage=!0);var e=t.stackStartFunction||m;if(Error.captureStackTrace)Error.captureStackTrace(this,e);else{var i=new Error;if(i.stack){var n=i.stack,r=d(e),s=n.indexOf("\n"+r);if(s>=0){var o=n.indexOf("\n",s+1);n=n.substring(o+1)}this.stack=n}}},s.inherits(u.AssertionError,Error),u.fail=m,u.ok=b,u.equal=function(t,e,i){t!=e&&m(t,e,i,"==",u.equal)},u.notEqual=function(t,e,i){t==e&&m(t,e,i,"!=",u.notEqual)},u.deepEqual=function(t,e,i){w(t,e,!1)||m(t,e,i,"deepEqual",u.deepEqual)},u.deepStrictEqual=function(t,e,i){w(t,e,!0)||m(t,e,i,"deepStrictEqual",u.deepStrictEqual)},u.notDeepEqual=function(t,e,i){w(t,e,!1)&&m(t,e,i,"notDeepEqual",u.notDeepEqual)},u.notDeepStrictEqual=function t(e,i,n){w(e,i,!0)&&m(e,i,n,"notDeepStrictEqual",t)},u.strictEqual=function(t,e,i){t!==e&&m(t,e,i,"===",u.strictEqual)},u.notStrictEqual=function(t,e,i){t===e&&m(t,e,i,"!==",u.notStrictEqual)},u.throws=function(t,e,i){x(!0,t,e,i)},u.doesNotThrow=function(t,e,i){x(!1,t,e,i)},u.ifError=function(t){if(t)throw t};var k=Object.keys||function(t){var e=[];for(var i in t)o.call(t,i)&&e.push(i);return e}}).call(this,i(2))},function(t,e,i){(function(t,n){var r=/%[sdj%]/g;e.format=function(t){if(!b(t)){for(var e=[],i=0;i<arguments.length;i++)e.push(a(arguments[i]));return e.join(" ")}i=1;for(var n=arguments,s=n.length,o=String(t).replace(r,(function(t){if("%%"===t)return"%";if(i>=s)return t;switch(t){case"%s":return String(n[i++]);case"%d":return Number(n[i++]);case"%j":try{return JSON.stringify(n[i++])}catch(t){return"[Circular]"}default:return t}})),h=n[i];i<s;h=n[++i])g(h)||!y(h)?o+=" "+h:o+=" "+a(h);return o},e.deprecate=function(i,r){if(w(t.process))return function(){return e.deprecate(i,r).apply(this,arguments)};if(!0===n.noDeprecation)return i;var s=!1;return function(){if(!s){if(n.throwDeprecation)throw new Error(r);n.traceDeprecation?console.trace(r):console.error(r),s=!0}return i.apply(this,arguments)}};var s,o={};function a(t,i){var n={seen:[],stylize:l};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),p(i)?n.showHidden=i:i&&e._extend(n,i),w(n.showHidden)&&(n.showHidden=!1),w(n.depth)&&(n.depth=2),w(n.colors)&&(n.colors=!1),w(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=h),c(n,t,n.depth)}function h(t,e){var i=a.styles[e];return i?"["+a.colors[i][0]+"m"+t+"["+a.colors[i][1]+"m":t}function l(t,e){return t}function c(t,i,n){if(t.customInspect&&i&&S(i.inspect)&&i.inspect!==e.inspect&&(!i.constructor||i.constructor.prototype!==i)){var r=i.inspect(n,t);return b(r)||(r=c(t,r,n)),r}var s=function(t,e){if(w(e))return t.stylize("undefined","undefined");if(b(e)){var i="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(i,"string")}return m(e)?t.stylize(""+e,"number"):p(e)?t.stylize(""+e,"boolean"):g(e)?t.stylize("null","null"):void 0}(t,i);if(s)return s;var o=Object.keys(i),a=function(t){var e={};return t.forEach((function(t,i){e[t]=!0})),e}(o);if(t.showHidden&&(o=Object.getOwnPropertyNames(i)),k(i)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return u(i);if(0===o.length){if(S(i)){var h=i.name?": "+i.name:"";return t.stylize("[Function"+h+"]","special")}if(v(i))return t.stylize(RegExp.prototype.toString.call(i),"regexp");if(x(i))return t.stylize(Date.prototype.toString.call(i),"date");if(k(i))return u(i)}var l,y="",_=!1,E=["{","}"];return d(i)&&(_=!0,E=["[","]"]),S(i)&&(y=" [Function"+(i.name?": "+i.name:"")+"]"),v(i)&&(y=" "+RegExp.prototype.toString.call(i)),x(i)&&(y=" "+Date.prototype.toUTCString.call(i)),k(i)&&(y=" "+u(i)),0!==o.length||_&&0!=i.length?n<0?v(i)?t.stylize(RegExp.prototype.toString.call(i),"regexp"):t.stylize("[Object]","special"):(t.seen.push(i),l=_?function(t,e,i,n,r){for(var s=[],o=0,a=e.length;o<a;++o)C(e,String(o))?s.push(f(t,e,i,n,String(o),!0)):s.push("");return r.forEach((function(r){r.match(/^\d+$/)||s.push(f(t,e,i,n,r,!0))})),s}(t,i,n,a,o):o.map((function(e){return f(t,i,n,a,e,_)})),t.seen.pop(),function(t,e,i){return t.reduce((function(t,e){return e.indexOf("\n"),t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?i[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+i[1]:i[0]+e+" "+t.join(", ")+" "+i[1]}(l,y,E)):E[0]+y+E[1]}function u(t){return"["+Error.prototype.toString.call(t)+"]"}function f(t,e,i,n,r,s){var o,a,h;if((h=Object.getOwnPropertyDescriptor(e,r)||{value:e[r]}).get?a=h.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):h.set&&(a=t.stylize("[Setter]","special")),C(n,r)||(o="["+r+"]"),a||(t.seen.indexOf(h.value)<0?(a=g(i)?c(t,h.value,null):c(t,h.value,i-1)).indexOf("\n")>-1&&(a=s?a.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+a.split("\n").map((function(t){return"   "+t})).join("\n")):a=t.stylize("[Circular]","special")),w(o)){if(s&&r.match(/^\d+$/))return a;(o=JSON.stringify(""+r)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=t.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=t.stylize(o,"string"))}return o+": "+a}function d(t){return Array.isArray(t)}function p(t){return"boolean"==typeof t}function g(t){return null===t}function m(t){return"number"==typeof t}function b(t){return"string"==typeof t}function w(t){return void 0===t}function v(t){return y(t)&&"[object RegExp]"===_(t)}function y(t){return"object"==typeof t&&null!==t}function x(t){return y(t)&&"[object Date]"===_(t)}function k(t){return y(t)&&("[object Error]"===_(t)||t instanceof Error)}function S(t){return"function"==typeof t}function _(t){return Object.prototype.toString.call(t)}function C(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.debuglog=function(t){if(w(s)&&(s=n.env.NODE_DEBUG||""),t=t.toUpperCase(),!o[t])if(new RegExp("\\b"+t+"\\b","i").test(s)){var i=n.pid;o[t]=function(){var n=e.format.apply(e,arguments);console.error("%s %d: %s",t,i,n)}}else o[t]=function(){};return o[t]},e.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=d,e.isBoolean=p,e.isNull=g,e.isNullOrUndefined=function(t){return null==t},e.isNumber=m,e.isString=b,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=w,e.isRegExp=v,e.isObject=y,e.isDate=x,e.isError=k,e.isFunction=S,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=i(52),e.log=function(){},e.inherits=i(4),e._extend=function(t,e){if(!e||!y(e))return t;for(var i=Object.keys(e),n=i.length;n--;)t[i[n]]=e[i[n]];return t}}).call(this,i(2),i(3))},function(t,e,i){t.exports=function(t,e,i,n){for(var r=65535&t|0,s=t>>>16&65535|0,o=0;0!==i;){i-=o=i>2e3?2e3:i;do{s=s+(r=r+e[n++]|0)|0}while(--o);r%=65521,s%=65521}return r|s<<16|0}},function(t,e,i){var n=function(){for(var t,e=[],i=0;i<256;i++){t=i;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[i]=t}return e}();t.exports=function(t,e,i,r){var s=n,o=r+i;t^=-1;for(var a=r;a<o;a++)t=t>>>8^s[255&(t^e[a])];return-1^t}},function(t,e,i){t.exports=class{constructor(t={}){if(!(t.maxSize&&t.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");this.maxSize=t.maxSize,this.cache=new Map,this.oldCache=new Map,this._size=0}_set(t,e){this.cache.set(t,e),this._size++,this._size>=this.maxSize&&(this._size=0,this.oldCache=this.cache,this.cache=new Map)}get(t){if(this.cache.has(t))return this.cache.get(t);if(this.oldCache.has(t)){const e=this.oldCache.get(t);return this._set(t,e),e}}set(t,e){return this.cache.has(t)?this.cache.set(t,e):this._set(t,e),this}has(t){return this.cache.has(t)||this.oldCache.has(t)}peek(t){return this.cache.has(t)?this.cache.get(t):this.oldCache.has(t)?this.oldCache.get(t):void 0}delete(t){const e=this.cache.delete(t);return e&&this._size--,this.oldCache.delete(t)||e}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}*keys(){for(const[t]of this)yield t}*values(){for(const[,t]of this)yield t}*[Symbol.iterator](){for(const t of this.cache)yield t;for(const t of this.oldCache){const[e]=t;this.cache.has(e)||(yield t)}}get size(){let t=0;for(const e of this.oldCache.keys())this.cache.has(e)||t++;return this._size+t}}},function(t,e){t.exports=n;var i=null;try{i=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(t){}function n(t,e,i){this.low=0|t,this.high=0|e,this.unsigned=!!i}function r(t){return!0===(t&&t.__isLong__)}n.prototype.__isLong__,Object.defineProperty(n.prototype,"__isLong__",{value:!0}),n.isLong=r;var s={},o={};function a(t,e){var i,n,r;return e?(r=0<=(t>>>=0)&&t<256)&&(n=o[t])?n:(i=l(t,(0|t)<0?-1:0,!0),r&&(o[t]=i),i):(r=-128<=(t|=0)&&t<128)&&(n=s[t])?n:(i=l(t,t<0?-1:0,!1),r&&(s[t]=i),i)}function h(t,e){if(isNaN(t))return e?w:b;if(e){if(t<0)return w;if(t>=p)return S}else{if(t<=-g)return _;if(t+1>=g)return k}return t<0?h(-t,e).neg():l(t%d|0,t/d|0,e)}function l(t,e,i){return new n(t,e,i)}n.fromInt=a,n.fromNumber=h,n.fromBits=l;var c=Math.pow;function u(t,e,i){if(0===t.length)throw Error("empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return b;if("number"==typeof e?(i=e,e=!1):e=!!e,(i=i||10)<2||36<i)throw RangeError("radix");var n;if((n=t.indexOf("-"))>0)throw Error("interior hyphen");if(0===n)return u(t.substring(1),e,i).neg();for(var r=h(c(i,8)),s=b,o=0;o<t.length;o+=8){var a=Math.min(8,t.length-o),l=parseInt(t.substring(o,o+a),i);if(a<8){var f=h(c(i,a));s=s.mul(f).add(h(l))}else s=(s=s.mul(r)).add(h(l))}return s.unsigned=e,s}function f(t,e){return"number"==typeof t?h(t,e):"string"==typeof t?u(t,e):l(t.low,t.high,"boolean"==typeof e?e:t.unsigned)}n.fromString=u,n.fromValue=f;var d=4294967296,p=d*d,g=p/2,m=a(1<<24),b=a(0);n.ZERO=b;var w=a(0,!0);n.UZERO=w;var v=a(1);n.ONE=v;var y=a(1,!0);n.UONE=y;var x=a(-1);n.NEG_ONE=x;var k=l(-1,2147483647,!1);n.MAX_VALUE=k;var S=l(-1,-1,!0);n.MAX_UNSIGNED_VALUE=S;var _=l(0,-2147483648,!1);n.MIN_VALUE=_;var C=n.prototype;C.toInt=function(){return this.unsigned?this.low>>>0:this.low},C.toNumber=function(){return this.unsigned?(this.high>>>0)*d+(this.low>>>0):this.high*d+(this.low>>>0)},C.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(_)){var e=h(t),i=this.div(e),n=i.mul(e).sub(this);return i.toString(t)+n.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var r=h(c(t,6),this.unsigned),s=this,o="";;){var a=s.div(r),l=(s.sub(a.mul(r)).toInt()>>>0).toString(t);if((s=a).isZero())return l+o;for(;l.length<6;)l="0"+l;o=""+l+o}},C.getHighBits=function(){return this.high},C.getHighBitsUnsigned=function(){return this.high>>>0},C.getLowBits=function(){return this.low},C.getLowBitsUnsigned=function(){return this.low>>>0},C.getNumBitsAbs=function(){if(this.isNegative())return this.eq(_)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,e=31;e>0&&0==(t&1<<e);e--);return 0!=this.high?e+33:e+1},C.isZero=function(){return 0===this.high&&0===this.low},C.eqz=C.isZero,C.isNegative=function(){return!this.unsigned&&this.high<0},C.isPositive=function(){return this.unsigned||this.high>=0},C.isOdd=function(){return 1==(1&this.low)},C.isEven=function(){return 0==(1&this.low)},C.equals=function(t){return r(t)||(t=f(t)),(this.unsigned===t.unsigned||this.high>>>31!=1||t.high>>>31!=1)&&this.high===t.high&&this.low===t.low},C.eq=C.equals,C.notEquals=function(t){return!this.eq(t)},C.neq=C.notEquals,C.ne=C.notEquals,C.lessThan=function(t){return this.comp(t)<0},C.lt=C.lessThan,C.lessThanOrEqual=function(t){return this.comp(t)<=0},C.lte=C.lessThanOrEqual,C.le=C.lessThanOrEqual,C.greaterThan=function(t){return this.comp(t)>0},C.gt=C.greaterThan,C.greaterThanOrEqual=function(t){return this.comp(t)>=0},C.gte=C.greaterThanOrEqual,C.ge=C.greaterThanOrEqual,C.compare=function(t){if(r(t)||(t=f(t)),this.eq(t))return 0;var e=this.isNegative(),i=t.isNegative();return e&&!i?-1:!e&&i?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},C.comp=C.compare,C.negate=function(){return!this.unsigned&&this.eq(_)?_:this.not().add(v)},C.neg=C.negate,C.add=function(t){r(t)||(t=f(t));var e=this.high>>>16,i=65535&this.high,n=this.low>>>16,s=65535&this.low,o=t.high>>>16,a=65535&t.high,h=t.low>>>16,c=0,u=0,d=0,p=0;return d+=(p+=s+(65535&t.low))>>>16,u+=(d+=n+h)>>>16,c+=(u+=i+a)>>>16,c+=e+o,l((d&=65535)<<16|(p&=65535),(c&=65535)<<16|(u&=65535),this.unsigned)},C.subtract=function(t){return r(t)||(t=f(t)),this.add(t.neg())},C.sub=C.subtract,C.multiply=function(t){if(this.isZero())return b;if(r(t)||(t=f(t)),i)return l(i.mul(this.low,this.high,t.low,t.high),i.get_high(),this.unsigned);if(t.isZero())return b;if(this.eq(_))return t.isOdd()?_:b;if(t.eq(_))return this.isOdd()?_:b;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(m)&&t.lt(m))return h(this.toNumber()*t.toNumber(),this.unsigned);var e=this.high>>>16,n=65535&this.high,s=this.low>>>16,o=65535&this.low,a=t.high>>>16,c=65535&t.high,u=t.low>>>16,d=65535&t.low,p=0,g=0,w=0,v=0;return w+=(v+=o*d)>>>16,g+=(w+=s*d)>>>16,w&=65535,g+=(w+=o*u)>>>16,p+=(g+=n*d)>>>16,g&=65535,p+=(g+=s*u)>>>16,g&=65535,p+=(g+=o*c)>>>16,p+=e*d+n*u+s*c+o*a,l((w&=65535)<<16|(v&=65535),(p&=65535)<<16|(g&=65535),this.unsigned)},C.mul=C.multiply,C.divide=function(t){if(r(t)||(t=f(t)),t.isZero())throw Error("division by zero");var e,n,s;if(i)return this.unsigned||-2147483648!==this.high||-1!==t.low||-1!==t.high?l((this.unsigned?i.div_u:i.div_s)(this.low,this.high,t.low,t.high),i.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?w:b;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return w;if(t.gt(this.shru(1)))return y;s=w}else{if(this.eq(_))return t.eq(v)||t.eq(x)?_:t.eq(_)?v:(e=this.shr(1).div(t).shl(1)).eq(b)?t.isNegative()?v:x:(n=this.sub(t.mul(e)),s=e.add(n.div(t)));if(t.eq(_))return this.unsigned?w:b;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();s=b}for(n=this;n.gte(t);){e=Math.max(1,Math.floor(n.toNumber()/t.toNumber()));for(var o=Math.ceil(Math.log(e)/Math.LN2),a=o<=48?1:c(2,o-48),u=h(e),d=u.mul(t);d.isNegative()||d.gt(n);)d=(u=h(e-=a,this.unsigned)).mul(t);u.isZero()&&(u=v),s=s.add(u),n=n.sub(d)}return s},C.div=C.divide,C.modulo=function(t){return r(t)||(t=f(t)),i?l((this.unsigned?i.rem_u:i.rem_s)(this.low,this.high,t.low,t.high),i.get_high(),this.unsigned):this.sub(this.div(t).mul(t))},C.mod=C.modulo,C.rem=C.modulo,C.not=function(){return l(~this.low,~this.high,this.unsigned)},C.and=function(t){return r(t)||(t=f(t)),l(this.low&t.low,this.high&t.high,this.unsigned)},C.or=function(t){return r(t)||(t=f(t)),l(this.low|t.low,this.high|t.high,this.unsigned)},C.xor=function(t){return r(t)||(t=f(t)),l(this.low^t.low,this.high^t.high,this.unsigned)},C.shiftLeft=function(t){return r(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?l(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):l(0,this.low<<t-32,this.unsigned)},C.shl=C.shiftLeft,C.shiftRight=function(t){return r(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?l(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):l(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},C.shr=C.shiftRight,C.shiftRightUnsigned=function(t){if(r(t)&&(t=t.toInt()),0==(t&=63))return this;var e=this.high;return t<32?l(this.low>>>t|e<<32-t,e>>>t,this.unsigned):l(32===t?e:e>>>t-32,0,this.unsigned)},C.shru=C.shiftRightUnsigned,C.shr_u=C.shiftRightUnsigned,C.toSigned=function(){return this.unsigned?l(this.low,this.high,!1):this},C.toUnsigned=function(){return this.unsigned?this:l(this.low,this.high,!0)},C.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},C.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24,255&t,t>>>8&255,t>>>16&255,t>>>24]},C.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,255&t,e>>>24,e>>>16&255,e>>>8&255,255&e]},n.fromBytes=function(t,e,i){return i?n.fromBytesLE(t,e):n.fromBytesBE(t,e)},n.fromBytesLE=function(t,e){return new n(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)},n.fromBytesBE=function(t,e){return new n(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)}},function(t,e){var i={utf8:{stringToBytes:function(t){return i.bin.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){return decodeURIComponent(escape(i.bin.bytesToString(t)))}},bin:{stringToBytes:function(t){for(var e=[],i=0;i<t.length;i++)e.push(255&t.charCodeAt(i));return e},bytesToString:function(t){for(var e=[],i=0;i<t.length;i++)e.push(String.fromCharCode(t[i]));return e.join("")}}};t.exports=i},function(t,e,i){const n=i(87),r=i(94),s=i(97);function o(t){const{protocol:e,pathname:i}=n.parse(t);return"file:"===e?new s(unescape(i)):new r(t)}t.exports={LocalFile:s,RemoteFile:r,fromUrl:o,open(t,e,i){if(i)return i;if(t)return o(t);if(e)return new s(e);throw new Error("no url, path, or filehandle provided, cannot open")}}},function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var n="__ES6-PROMISIFY--CUSTOM-ARGUMENTS__";function r(t){if("function"!=typeof t)throw new TypeError("Argument to promisify must be a function");var e=t[n],i=r.Promise||Promise;if("function"!=typeof i)throw new Error("No Promise implementation found; do you need a polyfill?");return function(){for(var n=this,r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return new i((function(i,r){s.push((function(t){if(t)return r(t);for(var n=arguments.length,s=Array(n>1?n-1:0),o=1;o<n;o++)s[o-1]=arguments[o];if(1===s.length||!e)return i(s[0]);var a={};s.forEach((function(t,i){var n=e[i];n&&(a[n]=t)})),i(a)})),t.call.apply(t,[n].concat(s))}))}}r.argumentNames=n,r.Promise=void 0,e.promisify=r},function(t,e,i){const n=i(18),r=i(99),s=i(100);t.exports={CramFile:n,IndexedCramFile:r,CraiIndex:s}},function(t,e,i){(function(e){const n=i(20),r=i(61),s=i(30),{CramUnimplementedError:o,CramMalformedError:a}=i(0),h=i(62),{cramFileDefinition:l,getSectionParsers:c}=i(66),u=i(71),{open:f}=i(33),{parseItem:d,tinyMemoize:p}=i(8),{parseHeaderText:g}=i(98);class m{constructor(t){this.file=f(t.url,t.path,t.filehandle),this.validateChecksums=!0,this.fetchReferenceSequenceCallback=t.seqFetch,this.options={checkSequenceMD5:!1!==t.checkSequenceMD5,cacheSize:void 0!==t.cacheSize?t.cacheSize:2e4},this.featureCache=new s({maxSize:this.options.cacheSize})}toString(){return this.file.filename?this.file.filename:this.file.url?this.file.url:"(cram file)"}read(t,e,i,n){return this.file.read(t,e,i,n)}stat(){return this.file.stat()}async getDefinition(){const t=e.allocUnsafe(l.maxLength);await this.file.read(t,0,l.maxLength,0);const i=l.parser.parse(t).result;if(2!==i.majorVersion&&3!==i.majorVersion)throw new o(`CRAM version ${i.majorVersion} not supported`);return i}async getSamHeader(){const t=await this.getContainerById(0);if(!t)throw new a("file contains no containers");const{content:e}=await t.getFirstBlock(),i=e.readInt32LE(0),n=e.toString("utf8",4,4+i);return g(n)}async getSectionParsers(){const{majorVersion:t}=await this.getDefinition();return c(t)}async getContainerById(t){const e=await this.getSectionParsers();let i=e.cramFileDefinition.maxLength;const{size:n}=await this.file.stat(),{cramContainerHeader1:r}=e;let s;for(let e=0;e<=t;e+=1){if(i+r.maxLength+8>=n)return;s=this.getContainerAtPosition(i);const o=await s.getHeader();if(!o)throw new a(`container ${t} not found in file`);if(0===e){i=o._endPosition;for(let t=0;t<o.numBlocks;t+=1)i=(await this.readBlock(i))._endPosition}else i+=o._size+o.length}return s}async checkCrc32(t,i,n,s){const o=e.allocUnsafe(i);await this.file.read(o,0,i,t);const h=r.unsigned(o);if(h!==n)throw new a(`crc mismatch in ${s}: recorded CRC32 = ${n}, but calculated CRC32 = ${h}`)}async containerCount(){const t=await this.getSectionParsers(),{size:e}=await this.file.stat(),{cramContainerHeader1:i}=t;let n=0,r=t.cramFileDefinition.maxLength;for(;r+i.maxLength+8<e;){const t=await this.getContainerAtPosition(r).getHeader();if(!t)break;if(0===n){r=t._endPosition;for(let e=0;e<t.numBlocks;e+=1)r=(await this.readBlock(r))._endPosition}else r+=t._size+t.length;n+=1}return n}getContainerAtPosition(t){return new u(this,t)}async readBlockHeader(t){const i=await this.getSectionParsers(),{cramBlockHeader:n}=i,{size:r}=await this.file.stat();if(t+n.maxLength>=r)return;const s=e.allocUnsafe(n.maxLength);return await this.file.read(s,0,n.maxLength,t),d(s,n.parser,0,t)}async _parseSection(t,i,n=t.maxLength,r){let s;if(r)s=r;else{const{size:t}=await this.file.stat();if(i+n>=t)return;s=e.allocUnsafe(n),await this.file.read(s,0,n,i)}const o=d(s,t.parser,0,i);if(o._size!==n)throw new a(`section read error: requested size ${n} does not equal parsed size ${o._size}`);return o}_uncompress(t,e,i){if("gzip"===t)n.gunzipSync(e).copy(i);else{if("rans"!==t)throw new o(`${t} decompression not yet implemented`);h.uncompress(e,i)}}async readBlock(t){const{majorVersion:i}=await this.getDefinition(),n=await this.getSectionParsers(),r=await this.readBlockHeader(t),s=r._endPosition;r.contentPosition=r._endPosition;const o=e.allocUnsafe(r.uncompressedSize);if("raw"!==r.compressionMethod){const t=e.allocUnsafe(r.compressedSize);await this.read(t,0,r.compressedSize,s),this._uncompress(r.compressionMethod,t,o)}else await this.read(o,0,r.uncompressedSize,s);if(r.content=o,i>=3){const e=await this._parseSection(n.cramBlockCrc32,s+r.compressedSize);r.crc32=e.crc32,this.validateChecksums&&await this.checkCrc32(t,r._size+r.compressedSize,r.crc32,"block data"),r._endPosition=e._endPosition,r._size=r.compressedSize+n.cramBlockCrc32.maxLength}else r._endPosition=s+r.compressedSize,r._size=r.compressedSize;return r}}"getDefinition getSectionParsers getSamHeader".split(" ").forEach((t=>p(m,t))),t.exports=m}).call(this,i(1).Buffer)},function(t,e,i){e.byteLength=function(t){var e=l(t),i=e[0],n=e[1];return 3*(i+n)/4-n},e.toByteArray=function(t){for(var e,i=l(t),n=i[0],o=i[1],a=new s(function(t,e,i){return 3*(e+i)/4-i}(0,n,o)),h=0,c=o>0?n-4:n,u=0;u<c;u+=4)e=r[t.charCodeAt(u)]<<18|r[t.charCodeAt(u+1)]<<12|r[t.charCodeAt(u+2)]<<6|r[t.charCodeAt(u+3)],a[h++]=e>>16&255,a[h++]=e>>8&255,a[h++]=255&e;return 2===o&&(e=r[t.charCodeAt(u)]<<2|r[t.charCodeAt(u+1)]>>4,a[h++]=255&e),1===o&&(e=r[t.charCodeAt(u)]<<10|r[t.charCodeAt(u+1)]<<4|r[t.charCodeAt(u+2)]>>2,a[h++]=e>>8&255,a[h++]=255&e),a},e.fromByteArray=function(t){for(var e,i=t.length,r=i%3,s=[],o=0,a=i-r;o<a;o+=16383)s.push(c(t,o,o+16383>a?a:o+16383));return 1===r?(e=t[i-1],s.push(n[e>>2]+n[e<<4&63]+"==")):2===r&&(e=(t[i-2]<<8)+t[i-1],s.push(n[e>>10]+n[e>>4&63]+n[e<<2&63]+"=")),s.join("")};for(var n=[],r=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,h=o.length;a<h;++a)n[a]=o[a],r[o.charCodeAt(a)]=a;function l(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=t.indexOf("=");return-1===i&&(i=e),[i,i===e?0:4-i%4]}function c(t,e,i){for(var r,s,o=[],a=e;a<i;a+=3)r=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),o.push(n[(s=r)>>18&63]+n[s>>12&63]+n[s>>6&63]+n[63&s]);return o.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,i,n,r){var s,o,a=8*r-n-1,h=(1<<a)-1,l=h>>1,c=-7,u=i?r-1:0,f=i?-1:1,d=t[e+u];for(u+=f,s=d&(1<<-c)-1,d>>=-c,c+=a;c>0;s=256*s+t[e+u],u+=f,c-=8);for(o=s&(1<<-c)-1,s>>=-c,c+=n;c>0;o=256*o+t[e+u],u+=f,c-=8);if(0===s)s=1-l;else{if(s===h)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,n),s-=l}return(d?-1:1)*o*Math.pow(2,s-n)},e.write=function(t,e,i,n,r,s){var o,a,h,l=8*s-r-1,c=(1<<l)-1,u=c>>1,f=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:s-1,p=n?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=c):(o=Math.floor(Math.log(e)/Math.LN2),e*(h=Math.pow(2,-o))<1&&(o--,h*=2),(e+=o+u>=1?f/h:f*Math.pow(2,1-u))*h>=2&&(o++,h/=2),o+u>=c?(a=0,o=c):o+u>=1?(a=(e*h-1)*Math.pow(2,r),o+=u):(a=e*Math.pow(2,u-1)*Math.pow(2,r),o=0));r>=8;t[i+d]=255&a,d+=p,a/=256,r-=8);for(o=o<<r|a,l+=r;l>0;t[i+d]=255&o,d+=p,o/=256,l-=8);t[i+d-p]|=128*g}},function(t,e,i){t.exports=r;var n=i(14).EventEmitter;function r(){n.call(this)}i(4)(r,n),r.Readable=i(15),r.Writable=i(47),r.Duplex=i(48),r.Transform=i(49),r.PassThrough=i(50),r.Stream=r,r.prototype.pipe=function(t,e){var i=this;function r(e){t.writable&&!1===t.write(e)&&i.pause&&i.pause()}function s(){i.readable&&i.resume&&i.resume()}i.on("data",r),t.on("drain",s),t._isStdio||e&&!1===e.end||(i.on("end",a),i.on("close",h));var o=!1;function a(){o||(o=!0,t.end())}function h(){o||(o=!0,"function"==typeof t.destroy&&t.destroy())}function l(t){if(c(),0===n.listenerCount(this,"error"))throw t}function c(){i.removeListener("data",r),t.removeListener("drain",s),i.removeListener("end",a),i.removeListener("close",h),i.removeListener("error",l),t.removeListener("error",l),i.removeListener("end",c),i.removeListener("close",c),t.removeListener("close",c)}return i.on("error",l),t.on("error",l),i.on("end",c),i.on("close",c),t.on("close",c),t.emit("pipe",i),t}},function(t,e){},function(t,e,i){var n=i(10).Buffer,r=i(42);t.exports=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length},t.prototype.unshift=function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length},t.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},t.prototype.clear=function(){this.head=this.tail=null,this.length=0},t.prototype.join=function(t){if(0===this.length)return"";for(var e=this.head,i=""+e.data;e=e.next;)i+=t+e.data;return i},t.prototype.concat=function(t){if(0===this.length)return n.alloc(0);if(1===this.length)return this.head.data;for(var e,i,r=n.allocUnsafe(t>>>0),s=this.head,o=0;s;)e=r,i=o,s.data.copy(e,i),o+=s.data.length,s=s.next;return r},t}(),r&&r.inspect&&r.inspect.custom&&(t.exports.prototype[r.inspect.custom]=function(){var t=r.inspect({length:this.length});return this.constructor.name+" "+t})},function(t,e){},function(t,e,i){(function(t){var n=void 0!==t&&t||"undefined"!=typeof self&&self||window,r=Function.prototype.apply;function s(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new s(r.call(setTimeout,n,arguments),clearTimeout)},e.setInterval=function(){return new s(r.call(setInterval,n,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(n,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},i(44),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,i(2))},function(t,e,i){(function(t,e){!function(t,i){if(!t.setImmediate){var n,r,s,o,a,h=1,l={},c=!1,u=t.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(t);f=f&&f.setTimeout?f:t,"[object process]"==={}.toString.call(t.process)?n=function(t){e.nextTick((function(){p(t)}))}:function(){if(t.postMessage&&!t.importScripts){var e=!0,i=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=i,e}}()?(o="setImmediate$"+Math.random()+"$",a=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(o)&&p(+e.data.slice(o.length))},t.addEventListener?t.addEventListener("message",a,!1):t.attachEvent("onmessage",a),n=function(e){t.postMessage(o+e,"*")}):t.MessageChannel?((s=new MessageChannel).port1.onmessage=function(t){p(t.data)},n=function(t){s.port2.postMessage(t)}):u&&"onreadystatechange"in u.createElement("script")?(r=u.documentElement,n=function(t){var e=u.createElement("script");e.onreadystatechange=function(){p(t),e.onreadystatechange=null,r.removeChild(e),e=null},r.appendChild(e)}):n=function(t){setTimeout(p,0,t)},f.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),i=0;i<e.length;i++)e[i]=arguments[i+1];var r={callback:t,args:e};return l[h]=r,n(h),h++},f.clearImmediate=d}function d(t){delete l[t]}function p(t){if(c)setTimeout(p,0,t);else{var e=l[t];if(e){c=!0;try{!function(t){var e=t.callback,i=t.args;switch(i.length){case 0:e();break;case 1:e(i[0]);break;case 2:e(i[0],i[1]);break;case 3:e(i[0],i[1],i[2]);break;default:e.apply(undefined,i)}}(e)}finally{d(t),c=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,i(2),i(3))},function(t,e,i){(function(e){function i(t){try{if(!e.localStorage)return!1}catch(t){return!1}var i=e.localStorage[t];return null!=i&&"true"===String(i).toLowerCase()}t.exports=function(t,e){if(i("noDeprecation"))return t;var n=!1;return function(){if(!n){if(i("throwDeprecation"))throw new Error(e);i("traceDeprecation")?console.trace(e):console.warn(e),n=!0}return t.apply(this,arguments)}}}).call(this,i(2))},function(t,e,i){t.exports=s;var n=i(25),r=i(7);function s(t){if(!(this instanceof s))return new s(t);n.call(this,t)}r.inherits=i(4),r.inherits(s,n),s.prototype._transform=function(t,e,i){i(null,t)}},function(t,e,i){t.exports=i(16)},function(t,e,i){t.exports=i(5)},function(t,e,i){t.exports=i(15).Transform},function(t,e,i){t.exports=i(15).PassThrough},function(t,e,i){(function(t,n){var r=i(26),s=i(53),o=i(54),a=i(57),h=i(60);for(var l in h)e[l]=h[l];function c(t){if("number"!=typeof t||t<e.DEFLATE||t>e.UNZIP)throw new TypeError("Bad argument");this.dictionary=null,this.err=0,this.flush=0,this.init_done=!1,this.level=0,this.memLevel=0,this.mode=t,this.strategy=0,this.windowBits=0,this.write_in_progress=!1,this.pending_close=!1,this.gzip_id_bytes_read=0}e.NONE=0,e.DEFLATE=1,e.INFLATE=2,e.GZIP=3,e.GUNZIP=4,e.DEFLATERAW=5,e.INFLATERAW=6,e.UNZIP=7,c.prototype.close=function(){this.write_in_progress?this.pending_close=!0:(this.pending_close=!1,r(this.init_done,"close before init"),r(this.mode<=e.UNZIP),this.mode===e.DEFLATE||this.mode===e.GZIP||this.mode===e.DEFLATERAW?o.deflateEnd(this.strm):this.mode!==e.INFLATE&&this.mode!==e.GUNZIP&&this.mode!==e.INFLATERAW&&this.mode!==e.UNZIP||a.inflateEnd(this.strm),this.mode=e.NONE,this.dictionary=null)},c.prototype.write=function(t,e,i,n,r,s,o){return this._write(!0,t,e,i,n,r,s,o)},c.prototype.writeSync=function(t,e,i,n,r,s,o){return this._write(!1,t,e,i,n,r,s,o)},c.prototype._write=function(i,s,o,a,h,l,c,u){if(r.equal(arguments.length,8),r(this.init_done,"write before init"),r(this.mode!==e.NONE,"already finalized"),r.equal(!1,this.write_in_progress,"write already in progress"),r.equal(!1,this.pending_close,"close is pending"),this.write_in_progress=!0,r.equal(!1,void 0===s,"must provide flush value"),this.write_in_progress=!0,s!==e.Z_NO_FLUSH&&s!==e.Z_PARTIAL_FLUSH&&s!==e.Z_SYNC_FLUSH&&s!==e.Z_FULL_FLUSH&&s!==e.Z_FINISH&&s!==e.Z_BLOCK)throw new Error("Invalid flush value");if(null==o&&(o=t.alloc(0),h=0,a=0),this.strm.avail_in=h,this.strm.input=o,this.strm.next_in=a,this.strm.avail_out=u,this.strm.output=l,this.strm.next_out=c,this.flush=s,!i)return this._process(),this._checkError()?this._afterSync():void 0;var f=this;return n.nextTick((function(){f._process(),f._after()})),this},c.prototype._afterSync=function(){var t=this.strm.avail_out,e=this.strm.avail_in;return this.write_in_progress=!1,[e,t]},c.prototype._process=function(){var t=null;switch(this.mode){case e.DEFLATE:case e.GZIP:case e.DEFLATERAW:this.err=o.deflate(this.strm,this.flush);break;case e.UNZIP:switch(this.strm.avail_in>0&&(t=this.strm.next_in),this.gzip_id_bytes_read){case 0:if(null===t)break;if(31!==this.strm.input[t]){this.mode=e.INFLATE;break}if(this.gzip_id_bytes_read=1,t++,1===this.strm.avail_in)break;case 1:if(null===t)break;139===this.strm.input[t]?(this.gzip_id_bytes_read=2,this.mode=e.GUNZIP):this.mode=e.INFLATE;break;default:throw new Error("invalid number of gzip magic number bytes read")}case e.INFLATE:case e.GUNZIP:case e.INFLATERAW:for(this.err=a.inflate(this.strm,this.flush),this.err===e.Z_NEED_DICT&&this.dictionary&&(this.err=a.inflateSetDictionary(this.strm,this.dictionary),this.err===e.Z_OK?this.err=a.inflate(this.strm,this.flush):this.err===e.Z_DATA_ERROR&&(this.err=e.Z_NEED_DICT));this.strm.avail_in>0&&this.mode===e.GUNZIP&&this.err===e.Z_STREAM_END&&0!==this.strm.next_in[0];)this.reset(),this.err=a.inflate(this.strm,this.flush);break;default:throw new Error("Unknown mode "+this.mode)}},c.prototype._checkError=function(){switch(this.err){case e.Z_OK:case e.Z_BUF_ERROR:if(0!==this.strm.avail_out&&this.flush===e.Z_FINISH)return this._error("unexpected end of file"),!1;break;case e.Z_STREAM_END:break;case e.Z_NEED_DICT:return null==this.dictionary?this._error("Missing dictionary"):this._error("Bad dictionary"),!1;default:return this._error("Zlib error"),!1}return!0},c.prototype._after=function(){if(this._checkError()){var t=this.strm.avail_out,e=this.strm.avail_in;this.write_in_progress=!1,this.callback(e,t),this.pending_close&&this.close()}},c.prototype._error=function(t){this.strm.msg&&(t=this.strm.msg),this.onerror(t,this.err),this.write_in_progress=!1,this.pending_close&&this.close()},c.prototype.init=function(t,i,n,s,o){r(4===arguments.length||5===arguments.length,"init(windowBits, level, memLevel, strategy, [dictionary])"),r(t>=8&&t<=15,"invalid windowBits"),r(i>=-1&&i<=9,"invalid compression level"),r(n>=1&&n<=9,"invalid memlevel"),r(s===e.Z_FILTERED||s===e.Z_HUFFMAN_ONLY||s===e.Z_RLE||s===e.Z_FIXED||s===e.Z_DEFAULT_STRATEGY,"invalid strategy"),this._init(i,t,n,s,o),this._setDictionary()},c.prototype.params=function(){throw new Error("deflateParams Not supported")},c.prototype.reset=function(){this._reset(),this._setDictionary()},c.prototype._init=function(t,i,n,r,h){switch(this.level=t,this.windowBits=i,this.memLevel=n,this.strategy=r,this.flush=e.Z_NO_FLUSH,this.err=e.Z_OK,this.mode!==e.GZIP&&this.mode!==e.GUNZIP||(this.windowBits+=16),this.mode===e.UNZIP&&(this.windowBits+=32),this.mode!==e.DEFLATERAW&&this.mode!==e.INFLATERAW||(this.windowBits=-1*this.windowBits),this.strm=new s,this.mode){case e.DEFLATE:case e.GZIP:case e.DEFLATERAW:this.err=o.deflateInit2(this.strm,this.level,e.Z_DEFLATED,this.windowBits,this.memLevel,this.strategy);break;case e.INFLATE:case e.GUNZIP:case e.INFLATERAW:case e.UNZIP:this.err=a.inflateInit2(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}this.err!==e.Z_OK&&this._error("Init error"),this.dictionary=h,this.write_in_progress=!1,this.init_done=!0},c.prototype._setDictionary=function(){if(null!=this.dictionary){switch(this.err=e.Z_OK,this.mode){case e.DEFLATE:case e.DEFLATERAW:this.err=o.deflateSetDictionary(this.strm,this.dictionary)}this.err!==e.Z_OK&&this._error("Failed to set dictionary")}},c.prototype._reset=function(){switch(this.err=e.Z_OK,this.mode){case e.DEFLATE:case e.DEFLATERAW:case e.GZIP:this.err=o.deflateReset(this.strm);break;case e.INFLATE:case e.INFLATERAW:case e.GUNZIP:this.err=a.inflateReset(this.strm)}this.err!==e.Z_OK&&this._error("Failed to reset stream")},e.Zlib=c}).call(this,i(1).Buffer,i(3))},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e,i){t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},function(t,e,i){var n,r=i(11),s=i(55),o=i(28),a=i(29),h=i(56),l=-2,c=258,u=262,f=103,d=113,p=666;function g(t,e){return t.msg=h[e],e}function m(t){return(t<<1)-(t>4?9:0)}function b(t){for(var e=t.length;--e>=0;)t[e]=0}function w(t){var e=t.state,i=e.pending;i>t.avail_out&&(i=t.avail_out),0!==i&&(r.arraySet(t.output,e.pending_buf,e.pending_out,i,t.next_out),t.next_out+=i,e.pending_out+=i,t.total_out+=i,t.avail_out-=i,e.pending-=i,0===e.pending&&(e.pending_out=0))}function v(t,e){s._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,w(t.strm)}function y(t,e){t.pending_buf[t.pending++]=e}function x(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function k(t,e){var i,n,r=t.max_chain_length,s=t.strstart,o=t.prev_length,a=t.nice_match,h=t.strstart>t.w_size-u?t.strstart-(t.w_size-u):0,l=t.window,f=t.w_mask,d=t.prev,p=t.strstart+c,g=l[s+o-1],m=l[s+o];t.prev_length>=t.good_match&&(r>>=2),a>t.lookahead&&(a=t.lookahead);do{if(l[(i=e)+o]===m&&l[i+o-1]===g&&l[i]===l[s]&&l[++i]===l[s+1]){s+=2,i++;do{}while(l[++s]===l[++i]&&l[++s]===l[++i]&&l[++s]===l[++i]&&l[++s]===l[++i]&&l[++s]===l[++i]&&l[++s]===l[++i]&&l[++s]===l[++i]&&l[++s]===l[++i]&&s<p);if(n=c-(p-s),s=p-c,n>o){if(t.match_start=e,o=n,n>=a)break;g=l[s+o-1],m=l[s+o]}}}while((e=d[e&f])>h&&0!=--r);return o<=t.lookahead?o:t.lookahead}function S(t){var e,i,n,s,h,l,c,f,d,p,g=t.w_size;do{if(s=t.window_size-t.lookahead-t.strstart,t.strstart>=g+(g-u)){r.arraySet(t.window,t.window,g,g,0),t.match_start-=g,t.strstart-=g,t.block_start-=g,e=i=t.hash_size;do{n=t.head[--e],t.head[e]=n>=g?n-g:0}while(--i);e=i=g;do{n=t.prev[--e],t.prev[e]=n>=g?n-g:0}while(--i);s+=g}if(0===t.strm.avail_in)break;if(l=t.strm,c=t.window,f=t.strstart+t.lookahead,d=s,p=void 0,(p=l.avail_in)>d&&(p=d),i=0===p?0:(l.avail_in-=p,r.arraySet(c,l.input,l.next_in,p,f),1===l.state.wrap?l.adler=o(l.adler,c,p,f):2===l.state.wrap&&(l.adler=a(l.adler,c,p,f)),l.next_in+=p,l.total_in+=p,p),t.lookahead+=i,t.lookahead+t.insert>=3)for(h=t.strstart-t.insert,t.ins_h=t.window[h],t.ins_h=(t.ins_h<<t.hash_shift^t.window[h+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[h+3-1])&t.hash_mask,t.prev[h&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=h,h++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<u&&0!==t.strm.avail_in)}function _(t,e){for(var i,n;;){if(t.lookahead<u){if(S(t),t.lookahead<u&&0===e)return 1;if(0===t.lookahead)break}if(i=0,t.lookahead>=3&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==i&&t.strstart-i<=t.w_size-u&&(t.match_length=k(t,i)),t.match_length>=3)if(n=s._tr_tally(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else n=s._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(v(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,4===e?(v(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(v(t,!1),0===t.strm.avail_out)?1:2}function C(t,e){for(var i,n,r;;){if(t.lookahead<u){if(S(t),t.lookahead<u&&0===e)return 1;if(0===t.lookahead)break}if(i=0,t.lookahead>=3&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==i&&t.prev_length<t.max_lazy_match&&t.strstart-i<=t.w_size-u&&(t.match_length=k(t,i),t.match_length<=5&&(1===t.strategy||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-3,n=s._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=r&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,n&&(v(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if((n=s._tr_tally(t,0,t.window[t.strstart-1]))&&v(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=s._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,4===e?(v(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(v(t,!1),0===t.strm.avail_out)?1:2}function E(t,e,i,n,r){this.good_length=t,this.max_lazy=e,this.nice_length=i,this.max_chain=n,this.func=r}function T(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(1146),this.dyn_dtree=new r.Buf16(122),this.bl_tree=new r.Buf16(78),b(this.dyn_ltree),b(this.dyn_dtree),b(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(16),this.heap=new r.Buf16(573),b(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(573),b(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function A(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=2,(e=t.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?42:d,t.adler=2===e.wrap?0:1,e.last_flush=0,s._tr_init(e),0):g(t,l)}function R(t){var e,i=A(t);return 0===i&&((e=t.state).window_size=2*e.w_size,b(e.head),e.max_lazy_match=n[e.level].max_lazy,e.good_match=n[e.level].good_length,e.nice_match=n[e.level].nice_length,e.max_chain_length=n[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0),i}function I(t,e,i,n,s,o){if(!t)return l;var a=1;if(-1===e&&(e=6),n<0?(a=0,n=-n):n>15&&(a=2,n-=16),s<1||s>9||8!==i||n<8||n>15||e<0||e>9||o<0||o>4)return g(t,l);8===n&&(n=9);var h=new T;return t.state=h,h.strm=t,h.wrap=a,h.gzhead=null,h.w_bits=n,h.w_size=1<<h.w_bits,h.w_mask=h.w_size-1,h.hash_bits=s+7,h.hash_size=1<<h.hash_bits,h.hash_mask=h.hash_size-1,h.hash_shift=~~((h.hash_bits+3-1)/3),h.window=new r.Buf8(2*h.w_size),h.head=new r.Buf16(h.hash_size),h.prev=new r.Buf16(h.w_size),h.lit_bufsize=1<<s+6,h.pending_buf_size=4*h.lit_bufsize,h.pending_buf=new r.Buf8(h.pending_buf_size),h.d_buf=1*h.lit_bufsize,h.l_buf=3*h.lit_bufsize,h.level=e,h.strategy=o,h.method=i,R(t)}n=[new E(0,0,0,0,(function(t,e){var i=65535;for(i>t.pending_buf_size-5&&(i=t.pending_buf_size-5);;){if(t.lookahead<=1){if(S(t),0===t.lookahead&&0===e)return 1;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var n=t.block_start+i;if((0===t.strstart||t.strstart>=n)&&(t.lookahead=t.strstart-n,t.strstart=n,v(t,!1),0===t.strm.avail_out))return 1;if(t.strstart-t.block_start>=t.w_size-u&&(v(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(v(t,!0),0===t.strm.avail_out?3:4):(t.strstart>t.block_start&&(v(t,!1),t.strm.avail_out),1)})),new E(4,4,8,4,_),new E(4,5,16,8,_),new E(4,6,32,32,_),new E(4,4,16,16,C),new E(8,16,32,32,C),new E(8,16,128,128,C),new E(8,32,128,256,C),new E(32,128,258,1024,C),new E(32,258,258,4096,C)],e.deflateInit=function(t,e){return I(t,e,8,15,8,0)},e.deflateInit2=I,e.deflateReset=R,e.deflateResetKeep=A,e.deflateSetHeader=function(t,e){return t&&t.state?2!==t.state.wrap?l:(t.state.gzhead=e,0):l},e.deflate=function(t,e){var i,r,o,h;if(!t||!t.state||e>5||e<0)return t?g(t,l):l;if(r=t.state,!t.output||!t.input&&0!==t.avail_in||r.status===p&&4!==e)return g(t,0===t.avail_out?-5:l);if(r.strm=t,i=r.last_flush,r.last_flush=e,42===r.status)if(2===r.wrap)t.adler=0,y(r,31),y(r,139),y(r,8),r.gzhead?(y(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),y(r,255&r.gzhead.time),y(r,r.gzhead.time>>8&255),y(r,r.gzhead.time>>16&255),y(r,r.gzhead.time>>24&255),y(r,9===r.level?2:r.strategy>=2||r.level<2?4:0),y(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(y(r,255&r.gzhead.extra.length),y(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(t.adler=a(t.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(y(r,0),y(r,0),y(r,0),y(r,0),y(r,0),y(r,9===r.level?2:r.strategy>=2||r.level<2?4:0),y(r,3),r.status=d);else{var u=8+(r.w_bits-8<<4)<<8;u|=(r.strategy>=2||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(u|=32),u+=31-u%31,r.status=d,x(r,u),0!==r.strstart&&(x(r,t.adler>>>16),x(r,65535&t.adler)),t.adler=1}if(69===r.status)if(r.gzhead.extra){for(o=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>o&&(t.adler=a(t.adler,r.pending_buf,r.pending-o,o)),w(t),o=r.pending,r.pending!==r.pending_buf_size));)y(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>o&&(t.adler=a(t.adler,r.pending_buf,r.pending-o,o)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(73===r.status)if(r.gzhead.name){o=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>o&&(t.adler=a(t.adler,r.pending_buf,r.pending-o,o)),w(t),o=r.pending,r.pending===r.pending_buf_size)){h=1;break}h=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,y(r,h)}while(0!==h);r.gzhead.hcrc&&r.pending>o&&(t.adler=a(t.adler,r.pending_buf,r.pending-o,o)),0===h&&(r.gzindex=0,r.status=91)}else r.status=91;if(91===r.status)if(r.gzhead.comment){o=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>o&&(t.adler=a(t.adler,r.pending_buf,r.pending-o,o)),w(t),o=r.pending,r.pending===r.pending_buf_size)){h=1;break}h=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,y(r,h)}while(0!==h);r.gzhead.hcrc&&r.pending>o&&(t.adler=a(t.adler,r.pending_buf,r.pending-o,o)),0===h&&(r.status=f)}else r.status=f;if(r.status===f&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&w(t),r.pending+2<=r.pending_buf_size&&(y(r,255&t.adler),y(r,t.adler>>8&255),t.adler=0,r.status=d)):r.status=d),0!==r.pending){if(w(t),0===t.avail_out)return r.last_flush=-1,0}else if(0===t.avail_in&&m(e)<=m(i)&&4!==e)return g(t,-5);if(r.status===p&&0!==t.avail_in)return g(t,-5);if(0!==t.avail_in||0!==r.lookahead||0!==e&&r.status!==p){var k=2===r.strategy?function(t,e){for(var i;;){if(0===t.lookahead&&(S(t),0===t.lookahead)){if(0===e)return 1;break}if(t.match_length=0,i=s._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,i&&(v(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(v(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(v(t,!1),0===t.strm.avail_out)?1:2}(r,e):3===r.strategy?function(t,e){for(var i,n,r,o,a=t.window;;){if(t.lookahead<=c){if(S(t),t.lookahead<=c&&0===e)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(n=a[r=t.strstart-1])===a[++r]&&n===a[++r]&&n===a[++r]){o=t.strstart+c;do{}while(n===a[++r]&&n===a[++r]&&n===a[++r]&&n===a[++r]&&n===a[++r]&&n===a[++r]&&n===a[++r]&&n===a[++r]&&r<o);t.match_length=c-(o-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(i=s._tr_tally(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(i=s._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),i&&(v(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(v(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(v(t,!1),0===t.strm.avail_out)?1:2}(r,e):n[r.level].func(r,e);if(3!==k&&4!==k||(r.status=p),1===k||3===k)return 0===t.avail_out&&(r.last_flush=-1),0;if(2===k&&(1===e?s._tr_align(r):5!==e&&(s._tr_stored_block(r,0,0,!1),3===e&&(b(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),w(t),0===t.avail_out))return r.last_flush=-1,0}return 4!==e?0:r.wrap<=0?1:(2===r.wrap?(y(r,255&t.adler),y(r,t.adler>>8&255),y(r,t.adler>>16&255),y(r,t.adler>>24&255),y(r,255&t.total_in),y(r,t.total_in>>8&255),y(r,t.total_in>>16&255),y(r,t.total_in>>24&255)):(x(r,t.adler>>>16),x(r,65535&t.adler)),w(t),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?0:1)},e.deflateEnd=function(t){var e;return t&&t.state?42!==(e=t.state.status)&&69!==e&&73!==e&&91!==e&&e!==f&&e!==d&&e!==p?g(t,l):(t.state=null,e===d?g(t,-3):0):l},e.deflateSetDictionary=function(t,e){var i,n,s,a,h,c,u,f,d=e.length;if(!t||!t.state)return l;if(2===(a=(i=t.state).wrap)||1===a&&42!==i.status||i.lookahead)return l;for(1===a&&(t.adler=o(t.adler,e,d,0)),i.wrap=0,d>=i.w_size&&(0===a&&(b(i.head),i.strstart=0,i.block_start=0,i.insert=0),f=new r.Buf8(i.w_size),r.arraySet(f,e,d-i.w_size,i.w_size,0),e=f,d=i.w_size),h=t.avail_in,c=t.next_in,u=t.input,t.avail_in=d,t.next_in=0,t.input=e,S(i);i.lookahead>=3;){n=i.strstart,s=i.lookahead-2;do{i.ins_h=(i.ins_h<<i.hash_shift^i.window[n+3-1])&i.hash_mask,i.prev[n&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=n,n++}while(--s);i.strstart=n,i.lookahead=2,S(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,t.next_in=c,t.input=u,t.avail_in=h,i.wrap=a,0},e.deflateInfo="pako deflate (from Nodeca project)"},function(t,e,i){var n=i(11);function r(t){for(var e=t.length;--e>=0;)t[e]=0}var s=256,o=286,a=30,h=15,l=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],c=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],u=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],f=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],d=new Array(576);r(d);var p=new Array(60);r(p);var g=new Array(512);r(g);var m=new Array(256);r(m);var b=new Array(29);r(b);var w,v,y,x=new Array(a);function k(t,e,i,n,r){this.static_tree=t,this.extra_bits=e,this.extra_base=i,this.elems=n,this.max_length=r,this.has_stree=t&&t.length}function S(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function _(t){return t<256?g[t]:g[256+(t>>>7)]}function C(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function E(t,e,i){t.bi_valid>16-i?(t.bi_buf|=e<<t.bi_valid&65535,C(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=i-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=i)}function T(t,e,i){E(t,i[2*e],i[2*e+1])}function A(t,e){var i=0;do{i|=1&t,t>>>=1,i<<=1}while(--e>0);return i>>>1}function R(t,e,i){var n,r,s=new Array(16),o=0;for(n=1;n<=h;n++)s[n]=o=o+i[n-1]<<1;for(r=0;r<=e;r++){var a=t[2*r+1];0!==a&&(t[2*r]=A(s[a]++,a))}}function I(t){var e;for(e=0;e<o;e++)t.dyn_ltree[2*e]=0;for(e=0;e<a;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function L(t){t.bi_valid>8?C(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function M(t,e,i,n){var r=2*e,s=2*i;return t[r]<t[s]||t[r]===t[s]&&n[e]<=n[i]}function F(t,e,i){for(var n=t.heap[i],r=i<<1;r<=t.heap_len&&(r<t.heap_len&&M(e,t.heap[r+1],t.heap[r],t.depth)&&r++,!M(e,n,t.heap[r],t.depth));)t.heap[i]=t.heap[r],i=r,r<<=1;t.heap[i]=n}function D(t,e,i){var n,r,o,a,h=0;if(0!==t.last_lit)do{n=t.pending_buf[t.d_buf+2*h]<<8|t.pending_buf[t.d_buf+2*h+1],r=t.pending_buf[t.l_buf+h],h++,0===n?T(t,r,e):(T(t,(o=m[r])+s+1,e),0!==(a=l[o])&&E(t,r-=b[o],a),T(t,o=_(--n),i),0!==(a=c[o])&&E(t,n-=x[o],a))}while(h<t.last_lit);T(t,256,e)}function B(t,e){var i,n,r,s=e.dyn_tree,o=e.stat_desc.static_tree,a=e.stat_desc.has_stree,l=e.stat_desc.elems,c=-1;for(t.heap_len=0,t.heap_max=573,i=0;i<l;i++)0!==s[2*i]?(t.heap[++t.heap_len]=c=i,t.depth[i]=0):s[2*i+1]=0;for(;t.heap_len<2;)s[2*(r=t.heap[++t.heap_len]=c<2?++c:0)]=1,t.depth[r]=0,t.opt_len--,a&&(t.static_len-=o[2*r+1]);for(e.max_code=c,i=t.heap_len>>1;i>=1;i--)F(t,s,i);r=l;do{i=t.heap[1],t.heap[1]=t.heap[t.heap_len--],F(t,s,1),n=t.heap[1],t.heap[--t.heap_max]=i,t.heap[--t.heap_max]=n,s[2*r]=s[2*i]+s[2*n],t.depth[r]=(t.depth[i]>=t.depth[n]?t.depth[i]:t.depth[n])+1,s[2*i+1]=s[2*n+1]=r,t.heap[1]=r++,F(t,s,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],function(t,e){var i,n,r,s,o,a,l=e.dyn_tree,c=e.max_code,u=e.stat_desc.static_tree,f=e.stat_desc.has_stree,d=e.stat_desc.extra_bits,p=e.stat_desc.extra_base,g=e.stat_desc.max_length,m=0;for(s=0;s<=h;s++)t.bl_count[s]=0;for(l[2*t.heap[t.heap_max]+1]=0,i=t.heap_max+1;i<573;i++)(s=l[2*l[2*(n=t.heap[i])+1]+1]+1)>g&&(s=g,m++),l[2*n+1]=s,n>c||(t.bl_count[s]++,o=0,n>=p&&(o=d[n-p]),a=l[2*n],t.opt_len+=a*(s+o),f&&(t.static_len+=a*(u[2*n+1]+o)));if(0!==m){do{for(s=g-1;0===t.bl_count[s];)s--;t.bl_count[s]--,t.bl_count[s+1]+=2,t.bl_count[g]--,m-=2}while(m>0);for(s=g;0!==s;s--)for(n=t.bl_count[s];0!==n;)(r=t.heap[--i])>c||(l[2*r+1]!==s&&(t.opt_len+=(s-l[2*r+1])*l[2*r],l[2*r+1]=s),n--)}}(t,e),R(s,c,t.bl_count)}function N(t,e,i){var n,r,s=-1,o=e[1],a=0,h=7,l=4;for(0===o&&(h=138,l=3),e[2*(i+1)+1]=65535,n=0;n<=i;n++)r=o,o=e[2*(n+1)+1],++a<h&&r===o||(a<l?t.bl_tree[2*r]+=a:0!==r?(r!==s&&t.bl_tree[2*r]++,t.bl_tree[32]++):a<=10?t.bl_tree[34]++:t.bl_tree[36]++,a=0,s=r,0===o?(h=138,l=3):r===o?(h=6,l=3):(h=7,l=4))}function P(t,e,i){var n,r,s=-1,o=e[1],a=0,h=7,l=4;for(0===o&&(h=138,l=3),n=0;n<=i;n++)if(r=o,o=e[2*(n+1)+1],!(++a<h&&r===o)){if(a<l)do{T(t,r,t.bl_tree)}while(0!=--a);else 0!==r?(r!==s&&(T(t,r,t.bl_tree),a--),T(t,16,t.bl_tree),E(t,a-3,2)):a<=10?(T(t,17,t.bl_tree),E(t,a-3,3)):(T(t,18,t.bl_tree),E(t,a-11,7));a=0,s=r,0===o?(h=138,l=3):r===o?(h=6,l=3):(h=7,l=4)}}r(x);var O=!1;function z(t,e,i,r){E(t,0+(r?1:0),3),function(t,e,i,r){L(t),C(t,i),C(t,~i),n.arraySet(t.pending_buf,t.window,e,i,t.pending),t.pending+=i}(t,e,i)}e._tr_init=function(t){O||(function(){var t,e,i,n,r,s=new Array(16);for(i=0,n=0;n<28;n++)for(b[n]=i,t=0;t<1<<l[n];t++)m[i++]=n;for(m[i-1]=n,r=0,n=0;n<16;n++)for(x[n]=r,t=0;t<1<<c[n];t++)g[r++]=n;for(r>>=7;n<a;n++)for(x[n]=r<<7,t=0;t<1<<c[n]-7;t++)g[256+r++]=n;for(e=0;e<=h;e++)s[e]=0;for(t=0;t<=143;)d[2*t+1]=8,t++,s[8]++;for(;t<=255;)d[2*t+1]=9,t++,s[9]++;for(;t<=279;)d[2*t+1]=7,t++,s[7]++;for(;t<=287;)d[2*t+1]=8,t++,s[8]++;for(R(d,287,s),t=0;t<a;t++)p[2*t+1]=5,p[2*t]=A(t,5);w=new k(d,l,257,o,h),v=new k(p,c,0,a,h),y=new k(new Array(0),u,0,19,7)}(),O=!0),t.l_desc=new S(t.dyn_ltree,w),t.d_desc=new S(t.dyn_dtree,v),t.bl_desc=new S(t.bl_tree,y),t.bi_buf=0,t.bi_valid=0,I(t)},e._tr_stored_block=z,e._tr_flush_block=function(t,e,i,n){var r,o,a=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=function(t){var e,i=4093624447;for(e=0;e<=31;e++,i>>>=1)if(1&i&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<s;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0}(t)),B(t,t.l_desc),B(t,t.d_desc),a=function(t){var e;for(N(t,t.dyn_ltree,t.l_desc.max_code),N(t,t.dyn_dtree,t.d_desc.max_code),B(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*f[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),r=t.opt_len+3+7>>>3,(o=t.static_len+3+7>>>3)<=r&&(r=o)):r=o=i+5,i+4<=r&&-1!==e?z(t,e,i,n):4===t.strategy||o===r?(E(t,2+(n?1:0),3),D(t,d,p)):(E(t,4+(n?1:0),3),function(t,e,i,n){var r;for(E(t,e-257,5),E(t,i-1,5),E(t,n-4,4),r=0;r<n;r++)E(t,t.bl_tree[2*f[r]+1],3);P(t,t.dyn_ltree,e-1),P(t,t.dyn_dtree,i-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,a+1),D(t,t.dyn_ltree,t.dyn_dtree)),I(t),n&&L(t)},e._tr_tally=function(t,e,i){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&i,t.last_lit++,0===e?t.dyn_ltree[2*i]++:(t.matches++,e--,t.dyn_ltree[2*(m[i]+s+1)]++,t.dyn_dtree[2*_(e)]++),t.last_lit===t.lit_bufsize-1},e._tr_align=function(t){E(t,2,3),T(t,256,d),function(t){16===t.bi_valid?(C(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)}},function(t,e,i){t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(t,e,i){var n=i(11),r=i(28),s=i(29),o=i(58),a=i(59),h=-2,l=12,c=30;function u(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function f(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function d(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=1,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new n.Buf32(852),e.distcode=e.distdyn=new n.Buf32(592),e.sane=1,e.back=-1,0):h}function p(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,d(t)):h}function g(t,e){var i,n;return t&&t.state?(n=t.state,e<0?(i=0,e=-e):(i=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?h:(null!==n.window&&n.wbits!==e&&(n.window=null),n.wrap=i,n.wbits=e,p(t))):h}function m(t,e){var i,n;return t?(n=new f,t.state=n,n.window=null,0!==(i=g(t,e))&&(t.state=null),i):h}var b,w,v=!0;function y(t){if(v){var e;for(b=new n.Buf32(512),w=new n.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(a(1,t.lens,0,288,b,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;a(2,t.lens,0,32,w,0,t.work,{bits:5}),v=!1}t.lencode=b,t.lenbits=9,t.distcode=w,t.distbits=5}function x(t,e,i,r){var s,o=t.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new n.Buf8(o.wsize)),r>=o.wsize?(n.arraySet(o.window,e,i-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):((s=o.wsize-o.wnext)>r&&(s=r),n.arraySet(o.window,e,i-r,s,o.wnext),(r-=s)?(n.arraySet(o.window,e,i-r,r,0),o.wnext=r,o.whave=o.wsize):(o.wnext+=s,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=s))),0}e.inflateReset=p,e.inflateReset2=g,e.inflateResetKeep=d,e.inflateInit=function(t){return m(t,15)},e.inflateInit2=m,e.inflate=function(t,e){var i,f,d,p,g,m,b,w,v,k,S,_,C,E,T,A,R,I,L,M,F,D,B,N,P=0,O=new n.Buf8(4),z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return h;(i=t.state).mode===l&&(i.mode=13),g=t.next_out,d=t.output,b=t.avail_out,p=t.next_in,f=t.input,m=t.avail_in,w=i.hold,v=i.bits,k=m,S=b,D=0;t:for(;;)switch(i.mode){case 1:if(0===i.wrap){i.mode=13;break}for(;v<16;){if(0===m)break t;m--,w+=f[p++]<<v,v+=8}if(2&i.wrap&&35615===w){i.check=0,O[0]=255&w,O[1]=w>>>8&255,i.check=s(i.check,O,2,0),w=0,v=0,i.mode=2;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&w)<<8)+(w>>8))%31){t.msg="incorrect header check",i.mode=c;break}if(8!=(15&w)){t.msg="unknown compression method",i.mode=c;break}if(v-=4,F=8+(15&(w>>>=4)),0===i.wbits)i.wbits=F;else if(F>i.wbits){t.msg="invalid window size",i.mode=c;break}i.dmax=1<<F,t.adler=i.check=1,i.mode=512&w?10:l,w=0,v=0;break;case 2:for(;v<16;){if(0===m)break t;m--,w+=f[p++]<<v,v+=8}if(i.flags=w,8!=(255&i.flags)){t.msg="unknown compression method",i.mode=c;break}if(57344&i.flags){t.msg="unknown header flags set",i.mode=c;break}i.head&&(i.head.text=w>>8&1),512&i.flags&&(O[0]=255&w,O[1]=w>>>8&255,i.check=s(i.check,O,2,0)),w=0,v=0,i.mode=3;case 3:for(;v<32;){if(0===m)break t;m--,w+=f[p++]<<v,v+=8}i.head&&(i.head.time=w),512&i.flags&&(O[0]=255&w,O[1]=w>>>8&255,O[2]=w>>>16&255,O[3]=w>>>24&255,i.check=s(i.check,O,4,0)),w=0,v=0,i.mode=4;case 4:for(;v<16;){if(0===m)break t;m--,w+=f[p++]<<v,v+=8}i.head&&(i.head.xflags=255&w,i.head.os=w>>8),512&i.flags&&(O[0]=255&w,O[1]=w>>>8&255,i.check=s(i.check,O,2,0)),w=0,v=0,i.mode=5;case 5:if(1024&i.flags){for(;v<16;){if(0===m)break t;m--,w+=f[p++]<<v,v+=8}i.length=w,i.head&&(i.head.extra_len=w),512&i.flags&&(O[0]=255&w,O[1]=w>>>8&255,i.check=s(i.check,O,2,0)),w=0,v=0}else i.head&&(i.head.extra=null);i.mode=6;case 6:if(1024&i.flags&&((_=i.length)>m&&(_=m),_&&(i.head&&(F=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Array(i.head.extra_len)),n.arraySet(i.head.extra,f,p,_,F)),512&i.flags&&(i.check=s(i.check,f,_,p)),m-=_,p+=_,i.length-=_),i.length))break t;i.length=0,i.mode=7;case 7:if(2048&i.flags){if(0===m)break t;_=0;do{F=f[p+_++],i.head&&F&&i.length<65536&&(i.head.name+=String.fromCharCode(F))}while(F&&_<m);if(512&i.flags&&(i.check=s(i.check,f,_,p)),m-=_,p+=_,F)break t}else i.head&&(i.head.name=null);i.length=0,i.mode=8;case 8:if(4096&i.flags){if(0===m)break t;_=0;do{F=f[p+_++],i.head&&F&&i.length<65536&&(i.head.comment+=String.fromCharCode(F))}while(F&&_<m);if(512&i.flags&&(i.check=s(i.check,f,_,p)),m-=_,p+=_,F)break t}else i.head&&(i.head.comment=null);i.mode=9;case 9:if(512&i.flags){for(;v<16;){if(0===m)break t;m--,w+=f[p++]<<v,v+=8}if(w!==(65535&i.check)){t.msg="header crc mismatch",i.mode=c;break}w=0,v=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),t.adler=i.check=0,i.mode=l;break;case 10:for(;v<32;){if(0===m)break t;m--,w+=f[p++]<<v,v+=8}t.adler=i.check=u(w),w=0,v=0,i.mode=11;case 11:if(0===i.havedict)return t.next_out=g,t.avail_out=b,t.next_in=p,t.avail_in=m,i.hold=w,i.bits=v,2;t.adler=i.check=1,i.mode=l;case l:if(5===e||6===e)break t;case 13:if(i.last){w>>>=7&v,v-=7&v,i.mode=27;break}for(;v<3;){if(0===m)break t;m--,w+=f[p++]<<v,v+=8}switch(i.last=1&w,v-=1,3&(w>>>=1)){case 0:i.mode=14;break;case 1:if(y(i),i.mode=20,6===e){w>>>=2,v-=2;break t}break;case 2:i.mode=17;break;case 3:t.msg="invalid block type",i.mode=c}w>>>=2,v-=2;break;case 14:for(w>>>=7&v,v-=7&v;v<32;){if(0===m)break t;m--,w+=f[p++]<<v,v+=8}if((65535&w)!=(w>>>16^65535)){t.msg="invalid stored block lengths",i.mode=c;break}if(i.length=65535&w,w=0,v=0,i.mode=15,6===e)break t;case 15:i.mode=16;case 16:if(_=i.length){if(_>m&&(_=m),_>b&&(_=b),0===_)break t;n.arraySet(d,f,p,_,g),m-=_,p+=_,b-=_,g+=_,i.length-=_;break}i.mode=l;break;case 17:for(;v<14;){if(0===m)break t;m--,w+=f[p++]<<v,v+=8}if(i.nlen=257+(31&w),w>>>=5,v-=5,i.ndist=1+(31&w),w>>>=5,v-=5,i.ncode=4+(15&w),w>>>=4,v-=4,i.nlen>286||i.ndist>30){t.msg="too many length or distance symbols",i.mode=c;break}i.have=0,i.mode=18;case 18:for(;i.have<i.ncode;){for(;v<3;){if(0===m)break t;m--,w+=f[p++]<<v,v+=8}i.lens[z[i.have++]]=7&w,w>>>=3,v-=3}for(;i.have<19;)i.lens[z[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,B={bits:i.lenbits},D=a(0,i.lens,0,19,i.lencode,0,i.work,B),i.lenbits=B.bits,D){t.msg="invalid code lengths set",i.mode=c;break}i.have=0,i.mode=19;case 19:for(;i.have<i.nlen+i.ndist;){for(;A=(P=i.lencode[w&(1<<i.lenbits)-1])>>>16&255,R=65535&P,!((T=P>>>24)<=v);){if(0===m)break t;m--,w+=f[p++]<<v,v+=8}if(R<16)w>>>=T,v-=T,i.lens[i.have++]=R;else{if(16===R){for(N=T+2;v<N;){if(0===m)break t;m--,w+=f[p++]<<v,v+=8}if(w>>>=T,v-=T,0===i.have){t.msg="invalid bit length repeat",i.mode=c;break}F=i.lens[i.have-1],_=3+(3&w),w>>>=2,v-=2}else if(17===R){for(N=T+3;v<N;){if(0===m)break t;m--,w+=f[p++]<<v,v+=8}v-=T,F=0,_=3+(7&(w>>>=T)),w>>>=3,v-=3}else{for(N=T+7;v<N;){if(0===m)break t;m--,w+=f[p++]<<v,v+=8}v-=T,F=0,_=11+(127&(w>>>=T)),w>>>=7,v-=7}if(i.have+_>i.nlen+i.ndist){t.msg="invalid bit length repeat",i.mode=c;break}for(;_--;)i.lens[i.have++]=F}}if(i.mode===c)break;if(0===i.lens[256]){t.msg="invalid code -- missing end-of-block",i.mode=c;break}if(i.lenbits=9,B={bits:i.lenbits},D=a(1,i.lens,0,i.nlen,i.lencode,0,i.work,B),i.lenbits=B.bits,D){t.msg="invalid literal/lengths set",i.mode=c;break}if(i.distbits=6,i.distcode=i.distdyn,B={bits:i.distbits},D=a(2,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,B),i.distbits=B.bits,D){t.msg="invalid distances set",i.mode=c;break}if(i.mode=20,6===e)break t;case 20:i.mode=21;case 21:if(m>=6&&b>=258){t.next_out=g,t.avail_out=b,t.next_in=p,t.avail_in=m,i.hold=w,i.bits=v,o(t,S),g=t.next_out,d=t.output,b=t.avail_out,p=t.next_in,f=t.input,m=t.avail_in,w=i.hold,v=i.bits,i.mode===l&&(i.back=-1);break}for(i.back=0;A=(P=i.lencode[w&(1<<i.lenbits)-1])>>>16&255,R=65535&P,!((T=P>>>24)<=v);){if(0===m)break t;m--,w+=f[p++]<<v,v+=8}if(A&&0==(240&A)){for(I=T,L=A,M=R;A=(P=i.lencode[M+((w&(1<<I+L)-1)>>I)])>>>16&255,R=65535&P,!(I+(T=P>>>24)<=v);){if(0===m)break t;m--,w+=f[p++]<<v,v+=8}w>>>=I,v-=I,i.back+=I}if(w>>>=T,v-=T,i.back+=T,i.length=R,0===A){i.mode=26;break}if(32&A){i.back=-1,i.mode=l;break}if(64&A){t.msg="invalid literal/length code",i.mode=c;break}i.extra=15&A,i.mode=22;case 22:if(i.extra){for(N=i.extra;v<N;){if(0===m)break t;m--,w+=f[p++]<<v,v+=8}i.length+=w&(1<<i.extra)-1,w>>>=i.extra,v-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=23;case 23:for(;A=(P=i.distcode[w&(1<<i.distbits)-1])>>>16&255,R=65535&P,!((T=P>>>24)<=v);){if(0===m)break t;m--,w+=f[p++]<<v,v+=8}if(0==(240&A)){for(I=T,L=A,M=R;A=(P=i.distcode[M+((w&(1<<I+L)-1)>>I)])>>>16&255,R=65535&P,!(I+(T=P>>>24)<=v);){if(0===m)break t;m--,w+=f[p++]<<v,v+=8}w>>>=I,v-=I,i.back+=I}if(w>>>=T,v-=T,i.back+=T,64&A){t.msg="invalid distance code",i.mode=c;break}i.offset=R,i.extra=15&A,i.mode=24;case 24:if(i.extra){for(N=i.extra;v<N;){if(0===m)break t;m--,w+=f[p++]<<v,v+=8}i.offset+=w&(1<<i.extra)-1,w>>>=i.extra,v-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){t.msg="invalid distance too far back",i.mode=c;break}i.mode=25;case 25:if(0===b)break t;if(_=S-b,i.offset>_){if((_=i.offset-_)>i.whave&&i.sane){t.msg="invalid distance too far back",i.mode=c;break}_>i.wnext?(_-=i.wnext,C=i.wsize-_):C=i.wnext-_,_>i.length&&(_=i.length),E=i.window}else E=d,C=g-i.offset,_=i.length;_>b&&(_=b),b-=_,i.length-=_;do{d[g++]=E[C++]}while(--_);0===i.length&&(i.mode=21);break;case 26:if(0===b)break t;d[g++]=i.length,b--,i.mode=21;break;case 27:if(i.wrap){for(;v<32;){if(0===m)break t;m--,w|=f[p++]<<v,v+=8}if(S-=b,t.total_out+=S,i.total+=S,S&&(t.adler=i.check=i.flags?s(i.check,d,S,g-S):r(i.check,d,S,g-S)),S=b,(i.flags?w:u(w))!==i.check){t.msg="incorrect data check",i.mode=c;break}w=0,v=0}i.mode=28;case 28:if(i.wrap&&i.flags){for(;v<32;){if(0===m)break t;m--,w+=f[p++]<<v,v+=8}if(w!==(4294967295&i.total)){t.msg="incorrect length check",i.mode=c;break}w=0,v=0}i.mode=29;case 29:D=1;break t;case c:D=-3;break t;case 31:return-4;case 32:default:return h}return t.next_out=g,t.avail_out=b,t.next_in=p,t.avail_in=m,i.hold=w,i.bits=v,(i.wsize||S!==t.avail_out&&i.mode<c&&(i.mode<27||4!==e))&&x(t,t.output,t.next_out,S-t.avail_out)?(i.mode=31,-4):(k-=t.avail_in,S-=t.avail_out,t.total_in+=k,t.total_out+=S,i.total+=S,i.wrap&&S&&(t.adler=i.check=i.flags?s(i.check,d,S,t.next_out-S):r(i.check,d,S,t.next_out-S)),t.data_type=i.bits+(i.last?64:0)+(i.mode===l?128:0)+(20===i.mode||15===i.mode?256:0),(0===k&&0===S||4===e)&&0===D&&(D=-5),D)},e.inflateEnd=function(t){if(!t||!t.state)return h;var e=t.state;return e.window&&(e.window=null),t.state=null,0},e.inflateGetHeader=function(t,e){var i;return t&&t.state?0==(2&(i=t.state).wrap)?h:(i.head=e,e.done=!1,0):h},e.inflateSetDictionary=function(t,e){var i,n=e.length;return t&&t.state?0!==(i=t.state).wrap&&11!==i.mode?h:11===i.mode&&r(1,e,n,0)!==i.check?-3:x(t,e,n,n)?(i.mode=31,-4):(i.havedict=1,0):h},e.inflateInfo="pako inflate (from Nodeca project)"},function(t,e,i){t.exports=function(t,e){var i,n,r,s,o,a,h,l,c,u,f,d,p,g,m,b,w,v,y,x,k,S,_,C,E;i=t.state,n=t.next_in,C=t.input,r=n+(t.avail_in-5),s=t.next_out,E=t.output,o=s-(e-t.avail_out),a=s+(t.avail_out-257),h=i.dmax,l=i.wsize,c=i.whave,u=i.wnext,f=i.window,d=i.hold,p=i.bits,g=i.lencode,m=i.distcode,b=(1<<i.lenbits)-1,w=(1<<i.distbits)-1;t:do{p<15&&(d+=C[n++]<<p,p+=8,d+=C[n++]<<p,p+=8),v=g[d&b];e:for(;;){if(d>>>=y=v>>>24,p-=y,0==(y=v>>>16&255))E[s++]=65535&v;else{if(!(16&y)){if(0==(64&y)){v=g[(65535&v)+(d&(1<<y)-1)];continue e}if(32&y){i.mode=12;break t}t.msg="invalid literal/length code",i.mode=30;break t}x=65535&v,(y&=15)&&(p<y&&(d+=C[n++]<<p,p+=8),x+=d&(1<<y)-1,d>>>=y,p-=y),p<15&&(d+=C[n++]<<p,p+=8,d+=C[n++]<<p,p+=8),v=m[d&w];i:for(;;){if(d>>>=y=v>>>24,p-=y,!(16&(y=v>>>16&255))){if(0==(64&y)){v=m[(65535&v)+(d&(1<<y)-1)];continue i}t.msg="invalid distance code",i.mode=30;break t}if(k=65535&v,p<(y&=15)&&(d+=C[n++]<<p,(p+=8)<y&&(d+=C[n++]<<p,p+=8)),(k+=d&(1<<y)-1)>h){t.msg="invalid distance too far back",i.mode=30;break t}if(d>>>=y,p-=y,k>(y=s-o)){if((y=k-y)>c&&i.sane){t.msg="invalid distance too far back",i.mode=30;break t}if(S=0,_=f,0===u){if(S+=l-y,y<x){x-=y;do{E[s++]=f[S++]}while(--y);S=s-k,_=E}}else if(u<y){if(S+=l+u-y,(y-=u)<x){x-=y;do{E[s++]=f[S++]}while(--y);if(S=0,u<x){x-=y=u;do{E[s++]=f[S++]}while(--y);S=s-k,_=E}}}else if(S+=u-y,y<x){x-=y;do{E[s++]=f[S++]}while(--y);S=s-k,_=E}for(;x>2;)E[s++]=_[S++],E[s++]=_[S++],E[s++]=_[S++],x-=3;x&&(E[s++]=_[S++],x>1&&(E[s++]=_[S++]))}else{S=s-k;do{E[s++]=E[S++],E[s++]=E[S++],E[s++]=E[S++],x-=3}while(x>2);x&&(E[s++]=E[S++],x>1&&(E[s++]=E[S++]))}break}}break}}while(n<r&&s<a);n-=x=p>>3,d&=(1<<(p-=x<<3))-1,t.next_in=n,t.next_out=s,t.avail_in=n<r?r-n+5:5-(n-r),t.avail_out=s<a?a-s+257:257-(s-a),i.hold=d,i.bits=p}},function(t,e,i){var n=i(11),r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],a=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(t,e,i,h,l,c,u,f){var d,p,g,m,b,w,v,y,x,k=f.bits,S=0,_=0,C=0,E=0,T=0,A=0,R=0,I=0,L=0,M=0,F=null,D=0,B=new n.Buf16(16),N=new n.Buf16(16),P=null,O=0;for(S=0;S<=15;S++)B[S]=0;for(_=0;_<h;_++)B[e[i+_]]++;for(T=k,E=15;E>=1&&0===B[E];E--);if(T>E&&(T=E),0===E)return l[c++]=20971520,l[c++]=20971520,f.bits=1,0;for(C=1;C<E&&0===B[C];C++);for(T<C&&(T=C),I=1,S=1;S<=15;S++)if(I<<=1,(I-=B[S])<0)return-1;if(I>0&&(0===t||1!==E))return-1;for(N[1]=0,S=1;S<15;S++)N[S+1]=N[S]+B[S];for(_=0;_<h;_++)0!==e[i+_]&&(u[N[e[i+_]]++]=_);if(0===t?(F=P=u,w=19):1===t?(F=r,D-=257,P=s,O-=257,w=256):(F=o,P=a,w=-1),M=0,_=0,S=C,b=c,A=T,R=0,g=-1,m=(L=1<<T)-1,1===t&&L>852||2===t&&L>592)return 1;for(;;){v=S-R,u[_]<w?(y=0,x=u[_]):u[_]>w?(y=P[O+u[_]],x=F[D+u[_]]):(y=96,x=0),d=1<<S-R,C=p=1<<A;do{l[b+(M>>R)+(p-=d)]=v<<24|y<<16|x|0}while(0!==p);for(d=1<<S-1;M&d;)d>>=1;if(0!==d?(M&=d-1,M+=d):M=0,_++,0==--B[S]){if(S===E)break;S=e[i+u[_]]}if(S>T&&(M&m)!==g){for(0===R&&(R=T),b+=C,I=1<<(A=S-R);A+R<E&&!((I-=B[A+R])<=0);)A++,I<<=1;if(L+=1<<A,1===t&&L>852||2===t&&L>592)return 1;l[g=M&m]=T<<24|A<<16|b-c|0}}return 0!==M&&(l[b+M]=S-R<<24|64<<16|0),f.bits=T,0}},function(t,e,i){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(t,e,i){var n=i(1).Buffer,r=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];function s(t){if(n.isBuffer(t))return t;var e="function"==typeof n.alloc&&"function"==typeof n.from;if("number"==typeof t)return e?n.alloc(t):new n(t);if("string"==typeof t)return e?n.from(t):new n(t);throw new Error("input must be buffer, number, or string, received "+typeof t)}function o(t,e){t=s(t),n.isBuffer(e)&&(e=e.readUInt32BE(0));for(var i=-1^~~e,o=0;o<t.length;o++)i=r[255&(i^t[o])]^i>>>8;return-1^i}function a(){return t=o.apply(null,arguments),(e=s(4)).writeInt32BE(t,0),e;var t,e}"undefined"!=typeof Int32Array&&(r=new Int32Array(r)),a.signed=function(){return o.apply(null,arguments)},a.unsigned=function(){return o.apply(null,arguments)>>>0},t.exports=a},function(t,e,i){(function(e){const{CramMalformedError:n}=i(0),r=i(12),s=i(63),o=i(64),a=i(65);class h{constructor(t,e=0){this._buffer=t,this._position=e,this.length=t.length}get(){const t=this._buffer[this._position];return this._position+=1,t}getByte(){return this.get()}getByteAt(t){return this._buffer[t]}position(){return this._position}put(t){return this._buffer[this._position]=t,this._position+=1,t}putAt(t,e){return this._buffer[t]=e,e}setPosition(t){return this._position=t,t}getInt(){const t=this._buffer.readInt32LE(this._position);return this._position+=4,t}remaining(){return this._buffer.length-this._position}}t.exports={uncompress:function(t,i,l=0){if(0===t.length)return i.fill(0),i;const c=new h(t,l),u=c.get();if(0!==u&&1!==u)throw new n(`Invalid rANS order ${u}`);if(c.getInt()!==c.remaining()-4)throw new n("Incorrect input length.");const f=c.getInt(),d=new h(i||e.allocUnsafe(f));if(d.length<f)throw new n(`Output buffer too small to fit ${f} bytes.`);switch(u){case 0:return function(t,e){const i=new r.AriDecoder,n=new Array(256);for(let t=0;t<n.length;t+=1)n[t]=new r.Symbol;return s.readStatsO0(t,i,n),o.uncompress(t,i,n,e),e}(c,d);case 1:return function(t,e){const i=new Array(256);for(let t=0;t<i.length;t+=1)i[t]=new r.AriDecoder;const n=new Array(256);for(let t=0;t<n.length;t+=1){n[t]=new Array(256);for(let e=0;e<n[t].length;e+=1)n[t][e]=new r.Symbol}return s.readStatsO1(t,i,n),a.uncompress(t,e,i,n),e}(c,d);default:throw new n(`Invalid rANS order: ${u}`)}}}}).call(this,i(1).Buffer)},function(t,e,i){const{CramMalformedError:n}=i(0),r=i(13),s=i(12);function o(t){if(!t)throw new n("assertion failed")}t.exports={readStatsO0:function(t,e,i){let n=0,a=0,h=255&t.get();do{null==e.fc[h]&&(e.fc[h]=new s.FC),e.fc[h].F=255&t.get(),e.fc[h].F>=128&&(e.fc[h].F&=-129,e.fc[h].F=(127&e.fc[h].F)<<8|255&t.get()),e.fc[h].C=a,s.symbolInit(i[h],e.fc[h].C,e.fc[h].F),e.R||(e.R=new Array(r.TOTFREQ)),e.R.fill(h,a,a+e.fc[h].F),a+=e.fc[h].F,0===n&&h+1===(255&t.getByteAt(t.position()))?(h=255&t.get(),n=255&t.get()):0!==n?(n-=1,h+=1):h=255&t.get()}while(0!==h);o(a<r.TOTFREQ)},readStatsO1:function(t,e,i){let n=0,a=255&t.get();do{let h=0,l=0,c=255&t.get();null==e[a]&&(e[a]=new s.AriDecoder);do{null==e[a].fc[c]&&(e[a].fc[c]=new s.FC),e[a].fc[c].F=255&t.get(),e[a].fc[c].F>=128&&(e[a].fc[c].F&=-129,e[a].fc[c].F=(127&e[a].fc[c].F)<<8|255&t.get()),e[a].fc[c].C=l,0===e[a].fc[c].F&&(e[a].fc[c].F=r.TOTFREQ),null==i[a][c]&&(i[a][c]=new s.RansDecSymbol),s.symbolInit(i[a][c],e[a].fc[c].C,e[a].fc[c].F),null==e[a].R&&(e[a].R=new Array(r.TOTFREQ)),e[a].R.fill(c,l,l+e[a].fc[c].F),o((l+=e[a].fc[c].F)<=r.TOTFREQ),0===h&&c+1===(255&t.getByteAt(t.position()))?(c=255&t.get(),h=255&t.get()):0!==h?(h-=1,c+=1):c=255&t.get()}while(0!==c);0===n&&a+1===(255&t.getByteAt(t.position()))?(a=255&t.get(),n=255&t.get()):0!==n?(n-=1,a+=1):a=255&t.get()}while(0!==a)}}},function(t,e,i){const{CramMalformedError:n}=i(0),r=i(13),s=i(12);t.exports={uncompress:function(t,e,i,o){let a=t.getInt(),h=t.getInt(),l=t.getInt(),c=t.getInt();const u=o.remaining(),f=-4&u;for(let n=0;n<f;n+=4){const u=e.R[s.get(a,r.TF_SHIFT)],f=e.R[s.get(h,r.TF_SHIFT)],d=e.R[s.get(l,r.TF_SHIFT)],p=e.R[s.get(c,r.TF_SHIFT)];o.putAt(n,u),o.putAt(n+1,f),o.putAt(n+2,d),o.putAt(n+3,p),a=s.advanceSymbolStep(a,i[255&u],r.TF_SHIFT),h=s.advanceSymbolStep(h,i[255&f],r.TF_SHIFT),l=s.advanceSymbolStep(l,i[255&d],r.TF_SHIFT),c=s.advanceSymbolStep(c,i[255&p],r.TF_SHIFT),a=s.renormalize(a,t),h=s.renormalize(h,t),l=s.renormalize(l,t),c=s.renormalize(c,t)}let d;switch(o.setPosition(f),3&u){case 0:break;case 1:d=e.R[s.get(a,r.TF_SHIFT)],s.advanceSymbol(a,t,i[255&d],r.TF_SHIFT),o.put(d);break;case 2:d=e.R[s.get(a,r.TF_SHIFT)],s.advanceSymbol(a,t,i[255&d],r.TF_SHIFT),o.put(d),d=e.R[s.get(h,r.TF_SHIFT)],s.advanceSymbol(h,t,i[255&d],r.TF_SHIFT),o.put(d);break;case 3:d=e.R[s.get(a,r.TF_SHIFT)],s.advanceSymbol(a,t,i[255&d],r.TF_SHIFT),o.put(d),d=e.R[s.get(h,r.TF_SHIFT)],s.advanceSymbol(h,t,i[255&d],r.TF_SHIFT),o.put(d),d=e.R[s.get(l,r.TF_SHIFT)],s.advanceSymbol(l,t,i[255&d],r.TF_SHIFT),o.put(d);break;default:throw new n("invalid output size encountered during rANS decoding")}o.setPosition(0)}}},function(t,e,i){const n=i(13),r=i(12);t.exports={uncompress:function(t,e,i,s){const o=e.remaining();let a=t.getInt(),h=t.getInt(),l=t.getInt(),c=t.getInt();const u=o>>2;let f=0,d=u,p=2*u,g=3*u,m=0,b=0,w=0,v=0;for(;f<u;f+=1,d+=1,p+=1,g+=1){const o=255&i[m].R[r.get(a,n.TF_SHIFT)],u=255&i[b].R[r.get(h,n.TF_SHIFT)],y=255&i[w].R[r.get(l,n.TF_SHIFT)],x=255&i[v].R[r.get(c,n.TF_SHIFT)];e.putAt(f,o),e.putAt(d,u),e.putAt(p,y),e.putAt(g,x),a=r.advanceSymbolStep(a,s[m][o],n.TF_SHIFT),h=r.advanceSymbolStep(h,s[b][u],n.TF_SHIFT),l=r.advanceSymbolStep(l,s[w][y],n.TF_SHIFT),c=r.advanceSymbolStep(c,s[v][x],n.TF_SHIFT),a=r.renormalize(a,t),h=r.renormalize(h,t),l=r.renormalize(l,t),c=r.renormalize(c,t),m=o,b=u,w=y,v=x}for(;g<o;g+=1){const o=255&i[v].R[r.get(c,n.TF_SHIFT)];e.putAt(g,o),c=r.advanceSymbol(c,t,s[v][o],n.TF_SHIFT),v=o}}}},function(t,e,i){const{Parser:n}=i(67),r=(new n).itf8(),s={parser:(new n).string("magic",{length:4}).uint8("majorVersion").uint8("minorVersion").string("fileId",{length:20,stripNull:!0}),maxLength:26},o={parser:(new n).uint8("compressionMethod",{formatter:t=>{const e=["raw","gzip","bzip2","lzma","rans"][t];if(!e)throw new Error(`compression method number ${t} not implemented`);return e}}).uint8("contentType",{formatter:t=>{const e=["FILE_HEADER","COMPRESSION_HEADER","MAPPED_SLICE_HEADER","UNMAPPED_SLICE_HEADER","EXTERNAL_DATA","CORE_DATA"][t];if(!e)throw new Error(`invalid block content type id ${t}`);return e}}).itf8("contentId").itf8("compressedSize").itf8("uncompressedSize"),maxLength:17},a={parser:(new n).uint32("crc32"),maxLength:4},h=(new n).itf8("size").buffer("entries",{length:"size",formatter:t=>{function e(e,i){const n=t.toString("utf8",e,i),r=[];for(let t=0;t<n.length;t+=3)r.push(n.substr(t,3));return r}var i,n=[],r=0;for(i=0;i<t.length;i+=1)t[i]||(n.push(e(r,i)),r=i+1);return i>r&&n.push(e(r,i)),n}}),l=(new n).uint8(null,{formatter:t=>!!t}),c=(new n).itf8("mapSize").itf8("mapCount").array("entries",{length:"mapCount",type:(new n).string("key",{length:2,stripNull:!1}).choice("value",{tag:"key",choices:{MI:l,UI:l,PI:l,RN:l,AP:l,RR:l,SM:(new n).array(null,{type:"uint8",length:5}),TD:(new n).nest(null,{type:h,formatter:t=>t.entries})}})});function u(t){const e={};return t.entries.forEach((({key:t,value:i})=>{e[t]&&console.warn(`duplicate key ${t} in map`),e[t]=i})),e}const f={cramFileDefinition:s,cramBlockHeader:o,cramBlockCrc32:a},d={cramUnmappedSliceHeader(t){let e=0,i=(new n).itf8("numRecords");return e+=5,t>=3?(i=i.ltf8("recordCounter"),e+=9):2===t&&(i=i.itf8("recordCounter"),e+=5),i=i.itf8("numBlocks").itf8("numContentIds").array("contentIds",{type:r,length:"numContentIds"}),e+=10,t>=2&&(i=i.array("md5",{type:"uint8",length:16}),e+=16),{parser:i,maxLength:t=>e+5*t}},cramMappedSliceHeader(t){let e=(new n).itf8("refSeqId").itf8("refSeqStart").itf8("refSeqSpan").itf8("numRecords"),i=20;return t>=3?(e=e.ltf8("recordCounter"),i+=9):2===t&&(e=e.itf8("recordCounter"),i+=5),e=e.itf8("numBlocks").itf8("numContentIds").array("contentIds",{type:r,length:"numContentIds"}).itf8("refBaseBlockId"),i+=15,t>=2&&(e=e.array("md5",{type:"uint8",length:16}),i+=16),{parser:e,maxLength:t=>i+5*t}},cramEncoding:t=>({parser:(new n).namely("cramEncoding").itf8("codecId").itf8("parametersBytes").choice("parameters",{tag:"codecId",choices:{0:new n,1:(new n).itf8("blockContentId"),2:(new n).itf8("offset").itf8("M"),3:n.start().itf8("numCodes").array("symbols",{length:"numCodes",type:r}).itf8("numLengths").array("bitLengths",{length:"numLengths",type:r}),4:n.start().nest("lengthsEncoding",{type:"cramEncoding"}).nest("valuesEncoding",{type:"cramEncoding"}),5:(new n).uint8("stopByte")[t>1?"itf8":"int"]("blockContentId"),6:(new n).itf8("offset").itf8("length"),7:(new n).itf8("offset").itf8("K"),8:(new n).itf8("offset").itf8("log2m"),9:(new n).itf8("offset")}})}),cramDataSeriesEncodingMap(t){return(new n).itf8("mapSize").itf8("mapCount").array("entries",{length:"mapCount",type:(new n).string("key",{length:2,stripNull:!1}).nest("value",{type:this.cramEncoding(t).parser})})},cramTagEncodingMap(t){return(new n).itf8("mapSize").itf8("mapCount").array("entries",{length:"mapCount",type:(new n).itf8("key",{formatter:t=>String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(255&t)}).nest("value",{type:this.cramEncoding(t).parser})})},cramCompressionHeader(t){let e=new n;return{parser:e=e.nest("preservation",{type:c,formatter:u}).nest("dataSeriesEncoding",{type:this.cramDataSeriesEncodingMap(t),formatter:u}).nest("tagEncoding",{type:this.cramTagEncodingMap(t),formatter:u})}},cramContainerHeader1(t){let e=(new n).int32("length").itf8("refSeqId").itf8("refSeqStart").itf8("alignmentSpan").itf8("numRecords"),i=24;return t>=3?(e=e.ltf8("recordCounter"),i+=9):2===t&&(e=e.itf8("recordCounter"),i+=5),t>1&&(e=e.ltf8("numBases"),i+=9),{parser:e=e.itf8("numBlocks").itf8("numLandmarks"),maxLength:i+=10}},cramContainerHeader2(t){let e=(new n).itf8("numLandmarks").array("landmarks",{type:(new n).itf8(),length:"numLandmarks"}),i=0;return t>=3&&(e=e.uint32("crc32"),i=4),{parser:e,maxLength:t=>5+5*t+i}}};t.exports={cramFileDefinition:s,getSectionParsers:function(t){const e=Object.assign({},f);return Object.keys(d).forEach((i=>{e[i]=d[i](t)})),e}}},function(t,e,i){(function(t){var n=i(68),r=i(70).Context,s=i(31);"undefined"!=typeof window&&(window.Buffer=t);var o={UInt8:1,UInt16LE:2,UInt16BE:2,UInt32LE:4,UInt32BE:4,Int8:1,Int16LE:2,Int16BE:2,Int32LE:4,Int32BE:4,FloatLE:4,FloatBE:4,DoubleLE:8,DoubleBE:8},a={},h=[];!function(){var t;for(t=1;t<=32;t++)h.push(t)}();var l={};Object.keys(o).concat(Object.keys({String:null,Buffer:null,Array:null,Skip:null,Choice:null,Nest:null,Bit:null,Itf8:null,Ltf8:null})).forEach((function(t){l[t.toLowerCase()]=t}));var c=function(){this.varName="",this.type="",this.options={},this.next=null,this.head=null,this.compiled=null,this.endian="le",this.constructorFn=null,this.alias=null};c.start=function(){return new c},Object.keys(o).forEach((function(t){c.prototype[t.toLowerCase()]=function(e,i){return this.setNextParser(t.toLowerCase(),e,i)};var e=t.replace(/BE|LE/,"").toLowerCase();e in c.prototype||(c.prototype[e]=function(t,i){return this[e+this.endian](t,i)})})),h.forEach((function(t){c.prototype["bit"+t.toString()]=function(e,i){return i||(i={}),i.length=t,this.setNextParser("bit",e,i)}})),c.prototype.namely=function(t){return a[t]=this,this.alias=t,this},c.prototype.skip=function(t,e){if(e&&e.assert)throw new Error("assert option on skip is not allowed.");return this.setNextParser("skip","",{length:t})},c.prototype.string=function(t,e){if(!e.zeroTerminated&&!e.length&&!e.greedy)throw new Error("Neither length, zeroTerminated, nor greedy is defined for string.");if((e.zeroTerminated||e.length)&&e.greedy)throw new Error("greedy is mutually exclusive with length and zeroTerminated for string.");if(e.stripNull&&!e.length&&!e.greedy)throw new Error("Length or greedy must be defined if stripNull is defined.");return e.encoding=e.encoding||"utf8",this.setNextParser("string",t,e)},c.prototype.buffer=function(t,e){if(!e.length&&!e.readUntil)throw new Error("Length nor readUntil is defined in buffer parser");return this.setNextParser("buffer",t,e)},c.prototype.array=function(t,e){if(!e.readUntil&&!e.length&&!e.lengthInBytes)throw new Error("Length option of array is not defined.");if(!e.type)throw new Error("Type option of array is not defined.");if("string"==typeof e.type&&!a[e.type]&&Object.keys(o).indexOf(l[e.type])<0)throw new Error('Specified primitive type "'+e.type+'" is not supported.');return this.setNextParser("array",t,e)},c.prototype.choice=function(t,e){if(1==arguments.length&&"object"==typeof t&&(e=t,t=null),!e.tag)throw new Error("Tag option of array is not defined.");if(!e.choices)throw new Error("Choices option of array is not defined.");return Object.keys(e.choices).forEach((function(i){if(!e.choices[i])throw new Error("Choice Case "+i+" of "+t+" is not valid.");if("string"==typeof e.choices[i]&&!a[e.choices[i]]&&Object.keys(o).indexOf(l[e.choices[i]])<0)throw new Error('Specified primitive type "'+e.choices[i]+'" is not supported.')}),this),this.setNextParser("choice",t,e)},c.prototype.nest=function(t,e){if(1==arguments.length&&"object"==typeof t&&(e=t,t=null),!e.type)throw new Error("Type option of nest is not defined.");if(!(e.type instanceof c||a[e.type]))throw new Error("Type option of nest must be a Parser object.");if(!(e.type instanceof c||t))throw new Error("options.type must be a object if variable name is omitted.");return this.setNextParser("nest",t,e)},c.prototype.endianess=function(t){switch(t.toLowerCase()){case"little":this.endian="le";break;case"big":this.endian="be";break;default:throw new Error("Invalid endianess: "+t)}return this},c.prototype.create=function(t){if(!(t instanceof Function))throw new Error("Constructor must be a Function object.");return this.constructorFn=t,this},c.prototype.getCode=function(){var t=new r;return t.pushCode("if (!Buffer.isBuffer(buffer)) {"),t.generateError('"argument buffer is not a Buffer object"'),t.pushCode("}"),this.alias?this.addAliasedCode(t):this.addRawCode(t),this.alias?t.pushCode("return {0}(0)","___parser_"+this.alias):t.pushCode("return { offset: offset, result: vars };"),t.code},c.prototype.addRawCode=function(t){t.pushCode("var offset = 0;"),this.constructorFn?t.pushCode("var vars = new constructorFn();"):t.pushCode("var vars = {};"),this.generate(t),this.resolveReferences(t),t.pushCode("return { offset: offset, result: vars };")},c.prototype.addAliasedCode=function(t){return t.pushCode("function {0}(offset) {","___parser_"+this.alias),this.constructorFn?t.pushCode("var vars = new constructorFn();"):t.pushCode("var vars = {};"),this.generate(t),t.markResolved(this.alias),this.resolveReferences(t),t.pushCode("return { offset: offset, result: vars };"),t.pushCode("}"),t},c.prototype.resolveReferences=function(t){var e=t.getUnresolvedReferences();t.markRequested(e),e.forEach((function(e){a[e].addAliasedCode(t)}))},c.prototype.compile=function(){var t="(function(buffer, constructorFn, Long) { "+this.getCode()+" })";this.compiled=n.runInThisContext(t)},c.prototype.sizeOf=function(){var t=NaN;if(Object.keys(o).indexOf(this.type)>=0)t=o[this.type];else if("String"===this.type&&"number"==typeof this.options.length)t=this.options.length;else if("Buffer"===this.type&&"number"==typeof this.options.length)t=this.options.length;else if("Array"===this.type&&"number"==typeof this.options.length){var e=NaN;"string"==typeof this.options.type?e=o[l[this.options.type]]:this.options.type instanceof c&&(e=this.options.type.sizeOf()),t=this.options.length*e}else"Skip"===this.type?t=this.options.length:"Nest"===this.type?t=this.options.type.sizeOf():this.type||(t=0);return this.next&&(t+=this.next.sizeOf()),t},c.prototype.parse=function(t){return this.compiled||this.compile(),this.compiled(t,this.constructorFn,s)},c.prototype.setNextParser=function(t,e,i){var n=new c;return n.type=l[t],n.varName=e,n.options=i||n.options,n.endian=this.endian,this.head?this.head.next=n:this.next=n,this.head=n,this},c.prototype.generate=function(t){this.type&&(this["generate"+this.type](t),this.generateAssert(t));var e=t.generateVariable(this.varName);return this.options.formatter&&this.generateFormatter(t,e,this.options.formatter),this.generateNext(t)},c.prototype.generateAssert=function(t){if(this.options.assert){var e=t.generateVariable(this.varName);switch(typeof this.options.assert){case"function":t.pushCode("if (!({0}).call(vars, {1})) {",this.options.assert,e);break;case"number":t.pushCode("if ({0} !== {1}) {",this.options.assert,e);break;case"string":t.pushCode('if ("{0}" !== {1}) {',this.options.assert,e);break;default:throw new Error("Assert option supports only strings, numbers and assert functions.")}t.generateError('"Assert error: {0} is " + {0}',e),t.pushCode("}")}},c.prototype.generateNext=function(t){return this.next&&(t=this.next.generate(t)),t},Object.keys(o).forEach((function(t){c.prototype["generate"+t]=function(e){e.pushCode("{0} = buffer.read{1}(offset);",e.generateVariable(this.varName),t),e.pushCode("offset += {0};",o[t])}})),c.prototype.generateBit=function(t){var e=JSON.parse(JSON.stringify(this));if(e.varName=t.generateVariable(e.varName),t.bitFields.push(e),!this.next||this.next&&["Bit","Nest"].indexOf(this.next.type)<0){var i=0;t.bitFields.forEach((function(t){i+=t.options.length}));var n=t.generateTmpVariable();if(i<=8)t.pushCode("var {0} = buffer.readUInt8(offset);",n),i=8;else if(i<=16)t.pushCode("var {0} = buffer.readUInt16BE(offset);",n),i=16;else if(i<=24){var r=t.generateTmpVariable(),s=t.generateTmpVariable();t.pushCode("var {0} = buffer.readUInt16BE(offset);",r),t.pushCode("var {0} = buffer.readUInt8(offset + 2);",s),t.pushCode("var {2} = ({0} << 8) | {1};",r,s,n),i=24}else{if(!(i<=32))throw new Error("Currently, bit field sequence longer than 4-bytes is not supported.");t.pushCode("var {0} = buffer.readUInt32BE(offset);",n),i=32}t.pushCode("offset += {0};",i/8);var o=0,a="be"===this.endian;t.bitFields.forEach((function(e){t.pushCode("{0} = {1} >> {2} & {3};",e.varName,n,a?i-o-e.options.length:o,(1<<e.options.length)-1),o+=e.options.length})),t.bitFields=[]}},c.prototype.generateSkip=function(t){var e=t.generateOption(this.options.length);t.pushCode("offset += {0};",e)},c.prototype.generateString=function(t){var e=t.generateVariable(this.varName),i=t.generateTmpVariable();this.options.length&&this.options.zeroTerminated?(t.pushCode("var {0} = offset;",i),t.pushCode("while(buffer.readUInt8(offset++) !== 0 && offset - {0}  < {1});",i,this.options.length),t.pushCode("{0} = buffer.toString('{1}', {2}, offset - {2} < {3} ? offset - 1 : offset);",e,this.options.encoding,i,this.options.length)):this.options.length?(t.pushCode("{0} = buffer.toString('{1}', offset, offset + {2});",e,this.options.encoding,t.generateOption(this.options.length)),t.pushCode("offset += {0};",t.generateOption(this.options.length))):this.options.zeroTerminated?(t.pushCode("var {0} = offset;",i),t.pushCode("while(buffer.readUInt8(offset++) !== 0);"),t.pushCode("{0} = buffer.toString('{1}', {2}, offset - 1);",e,this.options.encoding,i)):this.options.greedy&&(t.pushCode("var {0} = offset;",i),t.pushCode("while(buffer.length > offset++);"),t.pushCode("{0} = buffer.toString('{1}', {2}, offset);",e,this.options.encoding,i)),this.options.stripNull&&t.pushCode("{0} = {0}.replace(/\\x00+$/g, '')",e)},c.prototype.generateBuffer=function(t){"eof"===this.options.readUntil?t.pushCode("{0} = buffer.slice(offset);",t.generateVariable(this.varName)):(t.pushCode("{0} = buffer.slice(offset, offset + {1});",t.generateVariable(this.varName),t.generateOption(this.options.length)),t.pushCode("offset += {0};",t.generateOption(this.options.length))),this.options.clone&&t.pushCode("{0} = Buffer.from({0});",t.generateVariable(this.varName))},c.prototype.generateArray=function(t){var e=t.generateOption(this.options.length),i=t.generateOption(this.options.lengthInBytes),n=this.options.type,r=t.generateTmpVariable(),s=t.generateVariable(this.varName),h=t.generateTmpVariable(),u=this.options.key,f="string"==typeof u;if(f?t.pushCode("{0} = {};",s):t.pushCode("{0} = [];",s),"function"==typeof this.options.readUntil?t.pushCode("do {"):"eof"===this.options.readUntil?t.pushCode("for (var {0} = 0; offset < buffer.length; {0}++) {",r):void 0!==i?t.pushCode("for (var {0} = offset; offset - {0} < {1}; ) {",r,i):t.pushCode("for (var {0} = 0; {0} < {1}; {0}++) {",r,e),"string"==typeof n)if(a[n]){var d=t.generateTmpVariable();t.pushCode("var {0} = {1}(offset);",d,"___parser_"+n),t.pushCode("var {0} = {1}.result; offset = {1}.offset;",h,d),n!==this.alias&&t.addReference(n)}else t.pushCode("var {0} = buffer.read{1}(offset);",h,l[n]),t.pushCode("offset += {0};",o[l[n]]);else n instanceof c&&(t.pushCode("var {0} = {};",h),t.pushScope(h),n.generate(t),t.popScope());f?t.pushCode("{0}[{2}.{1}] = {2};",s,u,h):t.pushCode("{0}.push({1});",s,h),t.pushCode("}"),"function"==typeof this.options.readUntil&&t.pushCode(" while (!({0}).call(this, {1}, buffer.slice(offset)));",this.options.readUntil,h)},c.prototype.generateChoiceCase=function(t,e,i){if("string"==typeof i)if(a[i]){var n=t.generateTmpVariable();t.pushCode("var {0} = {1}(offset);",n,"___parser_"+i),t.pushCode("{0} = {1}.result; offset = {1}.offset;",t.generateVariable(this.varName),n),i!==this.alias&&t.addReference(i)}else t.pushCode("{0} = buffer.read{1}(offset);",t.generateVariable(this.varName),l[i]),t.pushCode("offset += {0};",o[l[i]]);else i instanceof c&&(t.pushPath(e),i.generate(t),t.popPath(e))},c.prototype.generateChoice=function(t){var e=t.generateOption(this.options.tag);this.varName&&t.pushCode("{0} = {};",t.generateVariable(this.varName)),t.pushCode("switch({0}) {",e),Object.keys(this.options.choices).forEach((function(e){var i=this.options.choices[e];isNaN(parseInt(e,10))?t.pushCode("case '{0}':",e):t.pushCode("case {0}:",e),this.generateChoiceCase(t,this.varName,i),t.pushCode("break;")}),this),t.pushCode("default:"),this.options.defaultChoice?this.generateChoiceCase(t,this.varName,this.options.defaultChoice):t.generateError('"Met undefined tag value " + {0} + " at choice"',e),t.pushCode("}")},c.prototype.generateNest=function(t){var e=t.generateVariable(this.varName);if(this.options.type instanceof c)this.varName&&t.pushCode("{0} = {};",e),t.pushPath(this.varName),this.options.type.generate(t),t.popPath(this.varName);else if(a[this.options.type]){var i=t.generateTmpVariable();t.pushCode("var {0} = {1}(offset);",i,"___parser_"+this.options.type),t.pushCode("{0} = {1}.result; offset = {1}.offset;",e,i),this.options.type!==this.alias&&t.addReference(this.options.type)}},c.prototype.generateFormatter=function(t,e,i){"function"==typeof i&&t.pushCode("{0} = ({1}).call(this, {0});",e,i)},c.prototype.isInteger=function(){return!!this.type.match(/U?Int[8|16|32][BE|LE]?|Bit\d+/)},c.prototype.itf8=function(t,e){return this.setNextParser("itf8",t,e)},c.prototype.generateItf8=function(t){const e=t.generateVariable(this.varName),i=t.generateTmpVariable();t.pushCode(`\n    var ${i} = buffer[offset];\n    if (${i} < 0x80) {\n      ${e} = ${i};\n      offset += 1;\n    } else if (${i} < 0xc0) {\n      ${e} = ((${i}<<8) | buffer[offset+1]) & 0x3fff;\n      offset += 2;\n    } else if (${i} < 0xe0) {\n      ${e} = ((${i}<<16) | (buffer[offset+1]<< 8) |  buffer[offset+2]) & 0x1fffff;\n      offset += 3;\n    } else if (${i} < 0xf0) {\n      ${e} = ((${i}<<24) | (buffer[offset+1]<<16) | (buffer[offset+2]<<8) | buffer[offset+3]) & 0x0fffffff;\n      offset += 4\n    } else {\n      ${e} = ((${i} & 0x0f)<<28) | (buffer[offset+1]<<20) | (buffer[offset+2]<<12) | (buffer[offset+3]<<4) | (buffer[offset+4] & 0x0f);\n      // x=((0xff & 0x0f)<<28) | (0xff<<20) | (0xff<<12) | (0xff<<4) | (0x0f & 0x0f);\n      // TODO *val_p = uv < 0x80000000UL ? uv : -((int32_t) (0xffffffffUL - uv)) - 1;\n      offset += 5\n    }\n  `)},c.prototype.ltf8=function(t,e){return this.setNextParser("ltf8",t,e)},c.prototype.generateLtf8=function(t){const e=t.generateVariable(this.varName),i=t.generateTmpVariable();t.pushCode(`\n  var ${i} = buffer[offset];\n  if (${i} < 0x80) {\n    ${e} = ${i};\n    offset += 1;\n  } else if (${i} < 0xc0) {\n    ${e} = ((buffer[offset]<<8) | buffer[offset+1]) & 0x3fff;\n    offset += 2;\n  } else if (${i} < 0xe0) {\n    ${e} = ((buffer[offset]<<16) | (buffer[offset+1]<<8) | buffer[offset+2]) & 0x1fffff;\n    ${e} = (((${i} & 63) << 16) | buffer.readUInt16LE(offset + 1));\n    offset += 3;\n  } else if (${i} < 0xf0) {\n    ${e} = ((buffer[offset]<<24) | (buffer[offset+1]<<16) | (buffer[offset+2]<<8) | buffer[offset+3]) & 0x0fffffff;\n    offset += 4;\n  } else if (${i} < 0xf8) {\n    ${e} = (((buffer[offset] & 15) * Math.pow(2,32))) +\n      (buffer[offset+1]<<24) | (buffer[offset+2]<<16 | buffer[offset+3]<<8 | buffer[offset+4])\n    // TODO *val_p = uv < 0x80000000UL ? uv : -((int32_t) (0xffffffffUL - uv)) - 1;\n    offset += 5;\n  } else if (${i} < 0xfc) {\n    ${e} = ((((buffer[offset] & 7) << 8) | buffer[offset+1] )) * Math.pow(2,32) +\n      (buffer[offset+2]<<24) | (buffer[offset+3]<<16 | buffer[offset+4]<<8 | buffer[offset+5])\n    offset += 6;\n  } else if (${i} < 0xfe) {\n    ${e} = ((((buffer[offset] & 3) << 16) | buffer[offset+1]<<8 | buffer[offset+2])) * Math.pow(2,32) +\n      (buffer[offset+3]<<24) | (buffer[offset+4]<<16 | buffer[offset+5]<<8 | buffer[offset+6])\n    offset += 7;\n  } else if (${i} < 0xff) {\n    ${e} = Long.fromBytesBE(buffer.slice(offset+1,offset+8));\n    if (${e}.greaterThan(Number.MAX_SAFE_INTEGER) || ${e}.lessThan(Number.MIN_SAFE_INTEGER))\n      throw new Error('integer overflow')\n    ${e} = ${e}.toNumber()\n    offset += 8;\n  } else {\n    ${e} = Long.fromBytesBE(buffer.slice(offset+1,offset+9));\n    if (${e}.greaterThan(Number.MAX_SAFE_INTEGER) || ${e}.lessThan(Number.MIN_SAFE_INTEGER))\n      throw new Error('integer overflow')\n    ${e} = ${e}.toNumber()\n    offset += 9;\n  }\n  `)},e.Parser=c}).call(this,i(1).Buffer)},function(t,e,i){var n=i(69),r=function(t){if(Object.keys)return Object.keys(t);var e=[];for(var i in t)e.push(i);return e},s=function(t,e){if(t.forEach)return t.forEach(e);for(var i=0;i<t.length;i++)e(t[i],i,t)},o=function(){try{return Object.defineProperty({},"_",{}),function(t,e,i){Object.defineProperty(t,e,{writable:!0,enumerable:!1,configurable:!0,value:i})}}catch(t){return function(t,e,i){t[e]=i}}}(),a=["Array","Boolean","Date","Error","EvalError","Function","Infinity","JSON","Math","NaN","Number","Object","RangeError","ReferenceError","RegExp","String","SyntaxError","TypeError","URIError","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","eval2","isFinite","isNaN","parseFloat","parseInt","undefined","unescape"];function h(){}h.prototype={};var l=e.Script=function(t){if(!(this instanceof l))return new l(t);this.code=t};l.prototype.runInContext=function(t){if(!(t instanceof h))throw new TypeError("needs a 'context' argument.");var e=document.createElement("iframe");e.style||(e.style={}),e.style.display="none",document.body.appendChild(e);var i=e.contentWindow,l=i.eval2,c=i.execScript;!l&&c&&(c.call(i,"null"),l=i.eval2),s(r(t),(function(e){i[e]=t[e]})),s(a,(function(e){t[e]&&(i[e]=t[e])}));var u=r(i),f=l.call(i,this.code);return s(r(i),(function(e){(e in t||-1===n(u,e))&&(t[e]=i[e])})),s(a,(function(e){e in t||o(t,e,i[e])})),document.body.removeChild(e),f},l.prototype.runInThisContext=function(){return va(this.code)},l.prototype.runInNewContext=function(t){var e=l.createContext(t),i=this.runInContext(e);return s(r(e),(function(i){t[i]=e[i]})),i},s(r(l.prototype),(function(t){e[t]=l[t]=function(e){var i=l(e);return i[t].apply(i,[].slice.call(arguments,1))}})),e.createScript=function(t){return e.Script(t)},e.createContext=l.createContext=function(t){var e=new h;return"object"==typeof t&&s(r(t),(function(i){e[i]=t[i]})),e}},function(t,e){var i=[].indexOf;t.exports=function(t,e){if(i)return t.indexOf(e);for(var n=0;n<t.length;++n)if(t[n]===e)return n;return-1}},function(t,e){var i=function(){this.code="",this.scopes=[["vars"]],this.isAsync=!1,this.bitFields=[],this.tmpVariableCount=0,this.references={}};i.prototype.generateVariable=function(t){var e=[];for(Array.prototype.push.apply(e,this.scopes[this.scopes.length-1]);/^\$parent\./.test(t);)e.pop(),t=t.replace(/^\$parent\./,"");return t&&e.push(t),e.join(".")},i.prototype.generateOption=function(t){switch(typeof t){case"number":return t.toString();case"string":return this.generateVariable(t);case"function":return"("+t+").call("+this.generateVariable()+", vars)"}},i.prototype.generateError=function(){var t=Array.prototype.slice.call(arguments),e=i.interpolate.apply(this,t);this.isAsync?this.pushCode("return process.nextTick(function() { callback(new Error("+e+"), vars); });"):this.pushCode("throw new Error("+e+");")},i.prototype.generateTmpVariable=function(){return"$tmp"+this.tmpVariableCount++},i.prototype.pushCode=function(){var t=Array.prototype.slice.call(arguments);this.code+=i.interpolate.apply(this,t)+"\n"},i.prototype.pushPath=function(t){t&&this.scopes[this.scopes.length-1].push(t)},i.prototype.popPath=function(t){t&&this.scopes[this.scopes.length-1].pop()},i.prototype.pushScope=function(t){this.scopes.push([t])},i.prototype.popScope=function(){this.scopes.pop()},i.prototype.addReference=function(t){this.references[t]||(this.references[t]={resolved:!1,requested:!1})},i.prototype.markResolved=function(t){this.references[t].resolved=!0},i.prototype.markRequested=function(t){t.forEach(function(t){this.references[t].requested=!0}.bind(this))},i.prototype.getUnresolvedReferences=function(){var t=this.references;return Object.keys(this.references).filter((function(e){return!t[e].resolved&&!t[e].requested}))},i.interpolate=function(t){var e=t.match(/{\d+}/g),i=Array.prototype.slice.call(arguments,1);return e&&e.forEach((function(e){var n=parseInt(e.substr(1,e.length-2),10);t=t.replace(e,i[n].toString())})),t},e.Context=i},function(t,e,i){(function(e){const{CramMalformedError:n}=i(0),{itf8Size:r,parseItem:s,tinyMemoize:o}=i(8),a=i(75),h=i(78);class l{constructor(t,e){this.file=t,this.filePosition=e}getHeader(){return this._readContainerHeader(this.filePosition)}async getCompressionHeaderBlock(){if(!(await this.getHeader()).numRecords)return null;const t=await this.file.getSectionParsers(),e=await this.getFirstBlock();if("COMPRESSION_HEADER"!==e.contentType)throw new n(`invalid content type ${e.contentType} in what is supposed to be the compression header block`);const i=s(e.content,t.cramCompressionHeader.parser,0,e.contentPosition);return e.content=i,e}async getFirstBlock(){const t=await this.getHeader();return this.file.readBlock(t._endPosition)}async getCompressionScheme(){const t=await this.getCompressionHeaderBlock();if(t)return new h(t.content)}getSlice(t,e){return new a(this,t,e)}async _readContainerHeader(t){const i=await this.file.getSectionParsers(),{cramContainerHeader1:n,cramContainerHeader2:o}=i,{size:a}=await this.file.stat();if(t>=a)return;const h=e.allocUnsafe(n.maxLength);await this.file.read(h,0,n.maxLength,t);const l=s(h,n.parser),c=r(l.numLandmarks);if(t+l.length>=a)return void console.warn(`${this.file}: container header at ${t} indicates that the container has length ${l.length}, which extends beyond the length of the file. Skipping this container.`);const u=e.allocUnsafe(o.maxLength(l.numLandmarks));await this.file.read(u,0,o.maxLength(l.numLandmarks),t+l._size-c);const f=s(u,o.parser);return this.file.validateChecksums&&void 0!==f.crc32&&await this.file.checkCrc32(t,l._size+f._size-c-4,f.crc32,`container header beginning at position ${t}`),Object.assign(l,f,{_size:l._size+f._size-c,_endPosition:l._size+f._size-c+t})}}"getHeader getCompressionHeaderBlock getCompressionScheme".split(" ").forEach((t=>o(l,t))),t.exports=l}).call(this,i(1).Buffer)},function(t,e,i){var n,r,s,o,a;n=i(73),r=i(32).utf8,s=i(74),o=i(32).bin,(a=function(t,e){t.constructor==String?t=e&&"binary"===e.encoding?o.stringToBytes(t):r.stringToBytes(t):s(t)?t=Array.prototype.slice.call(t,0):Array.isArray(t)||(t=t.toString());for(var i=n.bytesToWords(t),h=8*t.length,l=1732584193,c=-271733879,u=-1732584194,f=271733878,d=0;d<i.length;d++)i[d]=16711935&(i[d]<<8|i[d]>>>24)|4278255360&(i[d]<<24|i[d]>>>8);i[h>>>5]|=128<<h%32,i[14+(h+64>>>9<<4)]=h;var p=a._ff,g=a._gg,m=a._hh,b=a._ii;for(d=0;d<i.length;d+=16){var w=l,v=c,y=u,x=f;l=p(l,c,u,f,i[d+0],7,-680876936),f=p(f,l,c,u,i[d+1],12,-389564586),u=p(u,f,l,c,i[d+2],17,606105819),c=p(c,u,f,l,i[d+3],22,-1044525330),l=p(l,c,u,f,i[d+4],7,-176418897),f=p(f,l,c,u,i[d+5],12,1200080426),u=p(u,f,l,c,i[d+6],17,-1473231341),c=p(c,u,f,l,i[d+7],22,-45705983),l=p(l,c,u,f,i[d+8],7,1770035416),f=p(f,l,c,u,i[d+9],12,-1958414417),u=p(u,f,l,c,i[d+10],17,-42063),c=p(c,u,f,l,i[d+11],22,-1990404162),l=p(l,c,u,f,i[d+12],7,1804603682),f=p(f,l,c,u,i[d+13],12,-40341101),u=p(u,f,l,c,i[d+14],17,-1502002290),l=g(l,c=p(c,u,f,l,i[d+15],22,1236535329),u,f,i[d+1],5,-165796510),f=g(f,l,c,u,i[d+6],9,-1069501632),u=g(u,f,l,c,i[d+11],14,643717713),c=g(c,u,f,l,i[d+0],20,-373897302),l=g(l,c,u,f,i[d+5],5,-701558691),f=g(f,l,c,u,i[d+10],9,38016083),u=g(u,f,l,c,i[d+15],14,-660478335),c=g(c,u,f,l,i[d+4],20,-405537848),l=g(l,c,u,f,i[d+9],5,568446438),f=g(f,l,c,u,i[d+14],9,-1019803690),u=g(u,f,l,c,i[d+3],14,-187363961),c=g(c,u,f,l,i[d+8],20,1163531501),l=g(l,c,u,f,i[d+13],5,-1444681467),f=g(f,l,c,u,i[d+2],9,-51403784),u=g(u,f,l,c,i[d+7],14,1735328473),l=m(l,c=g(c,u,f,l,i[d+12],20,-1926607734),u,f,i[d+5],4,-378558),f=m(f,l,c,u,i[d+8],11,-2022574463),u=m(u,f,l,c,i[d+11],16,1839030562),c=m(c,u,f,l,i[d+14],23,-35309556),l=m(l,c,u,f,i[d+1],4,-1530992060),f=m(f,l,c,u,i[d+4],11,1272893353),u=m(u,f,l,c,i[d+7],16,-155497632),c=m(c,u,f,l,i[d+10],23,-1094730640),l=m(l,c,u,f,i[d+13],4,681279174),f=m(f,l,c,u,i[d+0],11,-358537222),u=m(u,f,l,c,i[d+3],16,-722521979),c=m(c,u,f,l,i[d+6],23,76029189),l=m(l,c,u,f,i[d+9],4,-640364487),f=m(f,l,c,u,i[d+12],11,-421815835),u=m(u,f,l,c,i[d+15],16,530742520),l=b(l,c=m(c,u,f,l,i[d+2],23,-995338651),u,f,i[d+0],6,-198630844),f=b(f,l,c,u,i[d+7],10,1126891415),u=b(u,f,l,c,i[d+14],15,-1416354905),c=b(c,u,f,l,i[d+5],21,-57434055),l=b(l,c,u,f,i[d+12],6,1700485571),f=b(f,l,c,u,i[d+3],10,-1894986606),u=b(u,f,l,c,i[d+10],15,-1051523),c=b(c,u,f,l,i[d+1],21,-2054922799),l=b(l,c,u,f,i[d+8],6,1873313359),f=b(f,l,c,u,i[d+15],10,-30611744),u=b(u,f,l,c,i[d+6],15,-1560198380),c=b(c,u,f,l,i[d+13],21,1309151649),l=b(l,c,u,f,i[d+4],6,-145523070),f=b(f,l,c,u,i[d+11],10,-1120210379),u=b(u,f,l,c,i[d+2],15,718787259),c=b(c,u,f,l,i[d+9],21,-343485551),l=l+w>>>0,c=c+v>>>0,u=u+y>>>0,f=f+x>>>0}return n.endian([l,c,u,f])})._ff=function(t,e,i,n,r,s,o){var a=t+(e&i|~e&n)+(r>>>0)+o;return(a<<s|a>>>32-s)+e},a._gg=function(t,e,i,n,r,s,o){var a=t+(e&n|i&~n)+(r>>>0)+o;return(a<<s|a>>>32-s)+e},a._hh=function(t,e,i,n,r,s,o){var a=t+(e^i^n)+(r>>>0)+o;return(a<<s|a>>>32-s)+e},a._ii=function(t,e,i,n,r,s,o){var a=t+(i^(e|~n))+(r>>>0)+o;return(a<<s|a>>>32-s)+e},a._blocksize=16,a._digestsize=16,t.exports=function(t,e){if(null==t)throw new Error("Illegal argument "+t);var i=n.wordsToBytes(a(t,e));return e&&e.asBytes?i:e&&e.asString?o.bytesToString(i):n.bytesToHex(i)}},function(t,e){var i,n;i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n={rotl:function(t,e){return t<<e|t>>>32-e},rotr:function(t,e){return t<<32-e|t>>>e},endian:function(t){if(t.constructor==Number)return 16711935&n.rotl(t,8)|4278255360&n.rotl(t,24);for(var e=0;e<t.length;e++)t[e]=n.endian(t[e]);return t},randomBytes:function(t){for(var e=[];t>0;t--)e.push(Math.floor(256*Math.random()));return e},bytesToWords:function(t){for(var e=[],i=0,n=0;i<t.length;i++,n+=8)e[n>>>5]|=t[i]<<24-n%32;return e},wordsToBytes:function(t){for(var e=[],i=0;i<32*t.length;i+=8)e.push(t[i>>>5]>>>24-i%32&255);return e},bytesToHex:function(t){for(var e=[],i=0;i<t.length;i++)e.push((t[i]>>>4).toString(16)),e.push((15&t[i]).toString(16));return e.join("")},hexToBytes:function(t){for(var e=[],i=0;i<t.length;i+=2)e.push(parseInt(t.substr(i,2),16));return e},bytesToBase64:function(t){for(var e=[],n=0;n<t.length;n+=3)for(var r=t[n]<<16|t[n+1]<<8|t[n+2],s=0;s<4;s++)8*n+6*s<=8*t.length?e.push(i.charAt(r>>>6*(3-s)&63)):e.push("=");return e.join("")},base64ToBytes:function(t){t=t.replace(/[^A-Z0-9+\/]/gi,"");for(var e=[],n=0,r=0;n<t.length;r=++n%4)0!=r&&e.push((i.indexOf(t.charAt(n-1))&Math.pow(2,-2*r+8)-1)<<2*r|i.indexOf(t.charAt(n))>>>6-2*r);return e}},t.exports=n},function(t,e){function i(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */t.exports=function(t){return null!=t&&(i(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&i(t.slice(0,0))}(t)||!!t._isBuffer)}},function(t,e,i){const{CramMalformedError:n,CramBufferOverrunError:r,CramArgumentError:s}=i(0),{parseItem:o,tinyMemoize:a,sequenceMD5:h}=i(8),l=i(17),c=i(76);function u(t,e,i,r){if(!r)throw new n("could not resolve intra-slice mate pairs, file seems truncated or malformed");const s=!!(r.mate||void 0!==r.mateRecordNumber&&r.mateRecordNumber!==e);i.readName||(i.readName=String(i.uniqueId),r.readName=i.readName),i.mate={sequenceId:r.sequenceId,alignmentStart:r.alignmentStart,uniqueId:r.uniqueId},r.readName&&(i.mate.readName=r.readName),r.mate||void 0!==r.mateRecordNumber||(r.mate={sequenceId:i.sequenceId,alignmentStart:i.alignmentStart,uniqueId:i.uniqueId},i.readName&&(r.mate.readName=i.readName)),i.flags|=l.BAM_FPAIRED,r.flags&l.BAM_FUNMAP&&(i.flags|=l.BAM_FMUNMAP),i.flags&l.BAM_FUNMAP&&(r.flags|=l.BAM_FMUNMAP),r.flags&l.BAM_FREVERSE&&(i.flags|=l.BAM_FMREVERSE),i.flags&l.BAM_FREVERSE&&(r.flags|=l.BAM_FMREVERSE),void 0===i.templateLength&&(s?function(t,e,i){const r=function e(i){const r=[i];if(i.mateRecordNumber>=0){const s=t[i.mateRecordNumber];if(!s)throw new n("intra-slice mate record not found, this file seems malformed");r.push(...e(s))}return r}(i),s=r.map((t=>t.alignmentStart)),o=r.map((t=>t.alignmentStart+t.readLength-1)),a=Math.max(...o)-Math.min(...s)+1;a>=0&&r.forEach((t=>{if(void 0!==t.templateLength)throw new n("mate pair group has some members that have template lengths already, this file seems malformed");t.templateLength=a}))}(t,0,i):function(t,e){const i=Math.min(t.alignmentStart,e.alignmentStart),n=Math.max(t.alignmentStart+t.readLength-1,e.alignmentStart+e.readLength-1)-i+1;t.templateLength=n,e.templateLength=n}(i,r)),delete i.mateRecordNumber}class f{constructor(t,e){this.container=t,this.file=t.file,this.containerPosition=e}async getHeader(){const t=await this.file.getSectionParsers(),e=await this.container.getHeader(),i=await this.file.readBlock(e._endPosition+this.containerPosition);if("MAPPED_SLICE_HEADER"===i.contentType)i.content=o(i.content,t.cramMappedSliceHeader.parser,0,e._endPosition);else{if("UNMAPPED_SLICE_HEADER"!==i.contentType)throw new n(`error reading slice header block, invalid content type ${i._contentType}`);i.content=o(i.content,t.cramUnmappedSliceHeader.parser,0,e._endPosition)}return i}async getBlocks(){const t=await this.getHeader();let e=t._endPosition;const i=new Array(t.content.numBlocks);for(let t=0;t<i.length;t+=1)i[t]=await this.file.readBlock(e),e=i[t]._endPosition;return i}async getCoreDataBlock(){return(await this.getBlocks())[0]}async _getBlocksContentIdIndex(){const t=await this.getBlocks(),e={};return t.forEach((t=>{"EXTERNAL_DATA"===t.contentType&&(e[t.contentId]=t)})),e}async getBlockByContentId(t){return(await this._getBlocksContentIdIndex())[t]}async getReferenceRegion(){const t=(await this.getHeader()).content;if(t.refSeqId<0)return;const e=await this.container.getCompressionScheme();if(t.refBaseBlockId>=0){const e=this.getBlockByContentId(t.refBaseBlockId);if(!e)throw new n("embedded reference specified, but reference block does not exist");if(t.span>e.uncompressedSize)throw new n("Embedded reference is too small");return{seq:e.data.toString("utf8"),start:t.refSeqStart,end:t.refSeqStart+t.refSeqSpan-1,span:t.refSeqSpan}}if(e.referenceRequired||this.file.fetchReferenceSequenceCallback){if(!this.file.fetchReferenceSequenceCallback)throw new Error("reference sequence not embedded, and seqFetch callback not provided, cannot fetch reference sequence");const e=await this.file.fetchReferenceSequenceCallback(t.refSeqId,t.refSeqStart,t.refSeqStart+t.refSeqSpan-1);if(e.length!==t.refSeqSpan)throw new s("seqFetch callback returned a reference sequence of the wrong length");return{seq:e,start:t.refSeqStart,end:t.refSeqStart+t.refSeqSpan-1,span:t.refSeqSpan}}}getAllRecords(){return this.getRecords((()=>!0))}async _fetchRecords(){const{majorVersion:t}=await this.file.getDefinition(),e=await this.container.getCompressionScheme(),i=await this.getHeader(),s=await this._getBlocksContentIdIndex();if(t>1&&this.file.options.checkSequenceMD5&&i.content.refSeqId>=0&&"0000000000000000"!==i.content.md5.join("")){const t=await this.getReferenceRegion();if(t){const{seq:e,start:r,end:s}=t,o=h(e),a=i.content.md5.map((t=>(t<16?"0":"")+t.toString(16))).join("");if(o!==a)throw new n(`MD5 checksum reference mismatch for ref ${i.content.refSeqId} pos ${r}..${s}. recorded MD5: ${a}, calculated MD5: ${o}`)}}const o=await this.getCoreDataBlock(),a={lastAlignmentStart:i.content.refSeqStart||0,coreBlock:{bitPosition:7,bytePosition:0},externalBlocks:{getCursor(t){return this[t]||(this[t]={bitPosition:7,bytePosition:0}),this[t]}}},l=t=>{const i=e.getCodecForDataSeries(t);if(!i)throw new n(`no codec defined for ${t} data series`);return i.decode(this,o,s,a)};let f=new Array(i.content.numRecords);for(let n=0;n<f.length;n+=1)try{f[n]=c(this,l,e,i,o,s,a,t,n),f[n].uniqueId=i.contentPosition+i.content.recordCounter+n+1}catch(t){if(t instanceof r){console.warn("read attempted beyond end of buffer, file seems truncated."),f=f.filter((t=>!!t));break}throw t}for(let t=0;t<f.length;t+=1){const{mateRecordNumber:e}=f[t];e>=0&&u(f,t,f[t],f[e])}return f}async getRecords(t){const e=this.container.filePosition+this.containerPosition;let i=this.file.featureCache.get(e);i||(i=this._fetchRecords(),this.file.featureCache.set(e,i));const n=(await i).filter(t);if(n.length&&this.file.fetchReferenceSequenceCallback){const t=await this.getHeader();if(t.content.refSeqId>=0||-2===t.content.refSeqId){const e=t.content.refSeqId>=0?t.content.refSeqId:void 0,i=await this.container.getCompressionScheme(),r={};for(let t=0;t<n.length;t+=1){const i=void 0!==e?e:n[t].sequenceId;let s=r[i];s||(s={id:i,start:n[t].alignmentStart,end:-1/0},r[i]=s);const o=n[t].alignmentStart+(n[t].lengthOnRef||n[t].readLength)-1;o>s.end&&(s.end=o),n[t].alignmentStart<s.start&&(s.start=n[t].alignmentStart)}await Promise.all(Object.values(r).map((async t=>{-1!==t.id&&t.start<=t.end&&(t.seq=await this.file.fetchReferenceSequenceCallback(t.id,t.start,t.end))})));for(let t=0;t<n.length;t+=1){const s=r[void 0!==e?e:n[t].sequenceId];s&&s.seq&&n[t].addReferenceSequence(s,i)}}}return n}}"getHeader getBlocks _getBlocksContentIdIndex".split(" ").forEach((t=>a(f,t))),t.exports=f},function(t,e,i){(function(e){const{CramMalformedError:n,CramUnimplementedError:r}=i(0),s=i(31),o=i(77),a=i(17);function h(t){const e=t.indexOf(0);return-1===e?t.toString("utf8"):t.toString("utf8",0,e)}function l(t,i){if(i.readInt32LE||(i=e.from(i)),"Z"===t)return h(i);if("A"===t)return String.fromCharCode(i[0]);if("I"===t){const t=s.fromBytesLE(i);if(t.greaterThan(Number.MAX_SAFE_INTEGER)||t.lessThan(Number.MIN_SAFE_INTEGER))throw new r("integer overflow");return t.toNumber()}if("i"===t)return i.readInt32LE(0);if("s"===t)return i.readInt16LE(0);if("S"===t)return i.readUInt16LE(0);if("c"===t)return i.readInt8(0);if("C"===t)return i.readUInt8(0);if("f"===t)return i.readFloatLE(0);if("H"===t){const t=h(i);return Number.parseInt(t.replace(/^0x/,""),16)}if("B"===t)return function(t){const e=String.fromCharCode(t[0]),i=t.readInt32LE(1),r={c:["readInt8",1],C:["readUInt8",1],s:["readInt16LE",2],S:["readUInt16LE",2],i:["readInt32LE",4],I:["readUInt32LE",4],f:["readFloatLE",4]}[e];if(!r)throw new n(`invalid tag value array type '${e}'`);const[s,o]=r,a=new Array(i);let h=5;for(let e=0;e<i;e+=1)a[e]=t[s](h),h+=o;return a}(i);throw new n(`Unrecognized tag type ${t}`)}function c(t){if(t instanceof e)return h(t);if(t.length&&t.indexOf){if(!t[t.length-1]){const e=t.indexOf(0);return String.fromCharCode(...t.slice(0,e))}return String.fromCharCode(...t)}return String(t)}t.exports=function(t,e,i,r,s,h,u,f,d){const p=new o;if(p.flags=e("BF"),p.cramFlags=e("CF"),f>1&&-2===r.content.refSeqId?p.sequenceId=e("RI"):p.sequenceId=r.content.refSeqId,p.readLength=e("RL"),p.alignmentStart=e("AP"),i.APdelta&&(p.alignmentStart+=u.lastAlignmentStart),u.lastAlignmentStart=p.alignmentStart,p.readGroupId=e("RG"),i.readNamesIncluded&&(p.readName=c(e("RN"))),p.isDetached()){const t={};t.flags=e("MF"),i.readNamesIncluded||(t.readName=c(e("RN")),p.readName=t.readName),t.sequenceId=e("NS"),t.alignmentStart=e("NP"),(t.flags||t.sequenceId>-1)&&(p.mate=t),p.templateSize=e("TS"),t.flags&a.CRAM_M_UNMAP&&(p.flags|=a.BAM_FMUNMAP),t.flags&a.CRAM_M_REVERSE&&(p.flags|=a.BAM_FMREVERSE)}else p.hasMateDownStream()&&(p.mateRecordNumber=e("NF")+d+1);const g=e("TL");if(g<0)throw new n("invalid TL index");const m=i.getTagNames(g),b=m.length;for(let e=0;e<b;e+=1){const r=m[e],o=r.substr(0,2),a=r.substr(2,1),c=i.getCodecForTag(r);if(!c)throw new n(`no codec defined for auxiliary tag ${r}`);const f=c.decode(t,s,h,u);p.tags[o]=l(a,f)}if(p.isSegmentUnmapped())if(p.isUnknownBases())p.readBases=null,p.qualityScores=null;else{const t=new Array(p.readLength);for(let i=0;i<t.length;i+=1)t[i]=e("BA");if(p.readBases=String.fromCharCode(...t),p.isPreservingQualityScores()){for(let i=0;i<t.length;i+=1)t[i]=e("QS");p.qualityScores=t}}else{const t=e("FN");t&&(p.readFeatures=function(t,e,i,r,s){let o=0,a=t.alignmentStart-1;const h=new Array(e);function l([t,e]){const n=i(e);return"character"===t?String.fromCharCode(n):"string"===t?n.toString("utf8"):"numArray"===t?n.toArray():n}for(let t=0;t<e;t+=1){const e=String.fromCharCode(i("FC")),r=i("FP"),c={code:e},u={B:["character","BA"],S:["string",s>1?"SC":"IN"],X:["number","BS"],D:["number","DL"],I:["string","IN"],i:["character","BA"],b:["string","BB"],q:["numArray","QQ"],Q:["number","QS"],H:["number","HC"],P:["number","PD"],N:["number","RS"]}[e];if(!u)throw new n(`invalid read feature code "${e}"`);c.data=l(u);const f={B:["number","QS"]}[e];f&&(c.data=[c.data,l(f)]),o+=r,c.pos=o,a+=r,c.refPos=a,"D"===e||"N"===e?a+=c.data:"H"===e?a-=c.data:"I"===e||"S"===e?a-=c.data.length:"i"===e&&(a-=1),h[t]=c}return h}(p,t,e,0,f));let i=p.readLength;if(p.readFeatures&&p.readFeatures.forEach((({code:t,data:e})=>{"D"===t||"N"===t?i+=e:"I"===t||"S"===t?i-=e.length:"i"===t&&(i-=1)})),Number.isNaN(i)&&(console.warn(`${p.readName||`${p.sequenceId}:${p.alignmentStart}`} record has invalid read features`),i=p.readLength),p.lengthOnRef=i,p.mappingQuality=e("MQ"),p.isPreservingQualityScores()){const t=new Array(p.readLength);for(let i=0;i<t.length;i+=1)t[i]=e("QS");p.qualityScores=t}}return p}}).call(this,i(1).Buffer)},function(t,e,i){const n=i(17),r={a:0,A:0,c:1,C:1,g:2,G:2,t:3,T:3,n:4,N:4};t.exports=class{constructor(){this.tags={}}isPaired(){return!!(this.flags&n.BAM_FPAIRED)}isProperlyPaired(){return!!(this.flags&n.BAM_FPROPER_PAIR)}isSegmentUnmapped(){return!!(this.flags&n.BAM_FUNMAP)}isMateUnmapped(){return!!(this.flags&n.BAM_FMUNMAP)}isReverseComplemented(){return!!(this.flags&n.BAM_FREVERSE)}isMateReverseComplemented(){return!!(this.flags&n.BAM_FMREVERSE)}isRead1(){return!!(this.flags&n.BAM_FREAD1)}isRead2(){return!!(this.flags&n.BAM_FREAD2)}isSecondary(){return!!(this.flags&n.BAM_FSECONDARY)}isFailedQc(){return!!(this.flags&n.BAM_FQCFAIL)}isDuplicate(){return!!(this.flags&n.BAM_FDUP)}isSupplementary(){return!!(this.flags&n.BAM_FSUPPLEMENTARY)}isDetached(){return!!(this.cramFlags&n.CRAM_FLAG_DETACHED)}hasMateDownStream(){return!!(this.cramFlags&n.CRAM_FLAG_MATE_DOWNSTREAM)}isPreservingQualityScores(){return!!(this.cramFlags&n.CRAM_FLAG_PRESERVE_QUAL_SCORES)}isUnknownBases(){return!!(this.cramFlags&n.CRAM_FLAG_NO_SEQ)}getReadBases(){return!this.readBases&&this._refRegion&&(this.readBases=function(t,e){if(!t.lengthOnRef&&!t.readLength)return;if(t.isUnknownBases())return;const i=t.alignmentStart-e.start;if(!t.readFeatures)return e.seq.substr(i,t.lengthOnRef).toUpperCase();let n="",r=i,s=0;for(;n.length<t.readLength;)if(s<t.readFeatures.length&&t.readFeatures[s].pos===n.length+1){const e=t.readFeatures[s];s+=1,"b"===e.code?(n+=e.data,r+=1):"B"===e.code?(n+=e.data[0],r+=1):"X"===e.code?(n+=e.sub,r+=1):"I"===e.code?n+=e.data:"D"===e.code?r+=e.data:"i"===e.code?n+=e.data:"N"===e.code?r+=e.data:"S"===e.code?n+=e.data:"P"===e.code||e.code}else if(s<t.readFeatures.length){const i=e.seq.substr(r,t.readFeatures[s].pos-n.length-1);n+=i,r+=i.length}else{const i=e.seq.substr(r,t.readLength-n.length);n+=i,r+=i.length}return n.toUpperCase()}(this,this._refRegion)),this.readBases}getPairOrientation(){if(!this.isSegmentUnmapped()&&this.isPaired()&&!this.isMateUnmapped()&&this.sequenceId===this.mate.sequenceId){const t=this.isReverseComplemented()?"R":"F",e=this.isMateReverseComplemented()?"R":"F";let i=" ",n=" ";this.isRead1()?(i="1",n="2"):this.isRead2()&&(i="2",n="1");const r=[];let s=this.templateLength||this.templateSize;return this.alignmentStart>this.mate.alignmentStart&&s>0&&(s=-s),s>0?(r[0]=t,r[1]=i,r[2]=e,r[3]=n):(r[2]=t,r[3]=i,r[0]=e,r[1]=n),r.join("")}return null}addReferenceSequence(t,e){this.readFeatures&&this.readFeatures.forEach((i=>{"X"===i.code&&function(t,e,i,n){if(!e)return;const s=n.refPos-e.start,o=e.seq.charAt(s);o&&(n.ref=o);let a=r[o];void 0===a&&(a=4);const h=i.substitutionMatrix[a][n.data];h&&(n.sub=h)}(0,t,e,i)})),!this.readBases&&t.start<=this.alignmentStart&&t.end>=this.alignmentStart+(this.lengthOnRef||this.readLength)-1&&(this._refRegion=t)}toJSON(){const t={};return Object.keys(this).forEach((e=>{"_"!==e.charAt(0)&&(t[e]=this[e])})),t.readBases=this.getReadBases(),t}}},function(t,e,i){const{CramMalformedError:n}=i(0),{instantiateCodec:r}=i(79),s={BF:"int",CF:"int",RI:"int",RL:"int",AP:"int",RG:"int",MF:"int",NS:"int",NP:"int",TS:"int",NF:"int",TC:"byte",TN:"int",FN:"int",FC:"byte",FP:"int",BS:"byte",IN:"byteArray",SC:"byteArray",DL:"int",BA:"byte",BB:"byteArray",RS:"int",PD:"int",HC:"int",MQ:"int",RN:"byteArray",QS:"byte",QQ:"byteArray",TL:"int",TM:"ignore",TV:"ignore"};t.exports=class{constructor(t){Object.assign(this,t),this.readNamesIncluded=t.preservation.RN,this.APdelta=t.preservation.AP,this.referenceRequired=!!t.preservation.RR,this.tagIdsDictionary=t.preservation.TD,this.substitutionMatrix=function(t){const e=new Array(5);for(let t=0;t<5;t+=1)e[t]=new Array(4);return e[0][t[0]>>6&3]="C",e[0][t[0]>>4&3]="G",e[0][t[0]>>2&3]="T",e[0][t[0]>>0&3]="N",e[1][t[1]>>6&3]="A",e[1][t[1]>>4&3]="G",e[1][t[1]>>2&3]="T",e[1][t[1]>>0&3]="N",e[2][t[2]>>6&3]="A",e[2][t[2]>>4&3]="C",e[2][t[2]>>2&3]="T",e[2][t[2]>>0&3]="N",e[3][t[3]>>6&3]="A",e[3][t[3]>>4&3]="C",e[3][t[3]>>2&3]="G",e[3][t[3]>>0&3]="N",e[4][t[4]>>6&3]="A",e[4][t[4]>>4&3]="C",e[4][t[4]>>2&3]="G",e[4][t[4]>>0&3]="T",e}(t.preservation.SM),this.dataSeriesCodecCache={},this.tagCodecCache={}}getCodecForTag(t){if(!this.tagCodecCache[t]){const e=this.tagEncoding[t];e&&(this.tagCodecCache[t]=r(e,"byteArray"))}return this.tagCodecCache[t]}getTagNames(t){return this.tagIdsDictionary[t]}getCodecForDataSeries(t){if(!this.dataSeriesCodecCache[t]){const e=this.dataSeriesEncoding[t];if(e){const i=s[t];if(!i)throw new n(`data series name ${t} not defined in file compression header`);this.dataSeriesCodecCache[t]=r(e,i)}}return this.dataSeriesCodecCache[t]}toJSON(){const t={};return Object.keys(this).forEach((e=>{/Cache$/.test(e)||(t[e]=this[e])})),t}}},function(t,e,i){const{CramUnimplementedError:n}=i(0),r=i(80),s=i(81),o=i(82),a=i(83),h=i(84),l=i(85),c={1:s,3:r,4:a,5:o,6:h,7:i(86),9:l};function u(t){return c[t]}t.exports={getCodecClassWithId:u,instantiateCodec:function t(e,i){const r=u("ignore"===i?0:e.codecId);if(!r)throw new n(`no codec implemented for codec ID ${e.codecId}`);return new r(e.parameters,i,t)}}},function(t,e,i){const{CramMalformedError:n}=i(0),r=i(6);t.exports=class extends r{constructor(t={},e){if(super(t,e),!["byte","int"].includes(this.dataType))throw new TypeError(`${this.dataType} decoding not yet implemented by HUFFMAN_INT codec`);this.buildCodeBook(),this.buildCodes(),this.buildCaches(),0===this.sortedCodes[0].bitLength&&(this._decode=this._decodeZeroLengthCode)}buildCodeBook(){let t=new Array(this.parameters.numCodes);for(let e=0;e<this.parameters.numCodes;e+=1)t[e]={symbol:this.parameters.symbols[e],bitLength:this.parameters.bitLengths[e]};t=t.sort(((t,e)=>t.bitLength-e.bitLength||t.symbol-e.symbol)),this.codeBook={},t.forEach((t=>{this.codeBook[t.bitLength]||(this.codeBook[t.bitLength]=[]),this.codeBook[t.bitLength].push(t.symbol)}))}buildCodes(){this.codes={};let t=0,e=-1;Object.entries(this.codeBook).forEach((([i,r])=>{i=parseInt(i,10),r.forEach((r=>{const s={bitLength:i,value:r};e+=1;const o=i-t;if(e<<=o,s.bitCode=e,t+=o,function(t){let e=t-(t>>1)&1431655765;return 16843009*((e=(858993459&e)+(e>>2&858993459))+(e>>4)&252645135)>>24}(e)>i)throw new n("Symbol out of range");this.codes[r]=s}))}))}buildCaches(){this.sortedCodes=Object.values(this.codes).sort(((t,e)=>t.bitLength-e.bitLength||t.bitCode-e.bitCode)),this.sortedByValue=Object.values(this.codes).sort(((t,e)=>t.value-e.value)),this.sortedValuesByBitCode=this.sortedCodes.map((t=>t.value)),this.sortedBitCodes=this.sortedCodes.map((t=>t.bitCode)),this.sortedBitLengthsByBitCode=this.sortedCodes.map((t=>t.bitLength));const t=Math.max(...this.sortedBitCodes);this.bitCodeToValue=new Array(t+1).fill(-1);for(let t=0;t<this.sortedBitCodes.length;t+=1)this.bitCodeToValue[this.sortedCodes[t].bitCode]=t}decode(t,e,i,n){return this._decode(t,e,n.coreBlock)}_decodeZeroLengthCode(){return this.sortedCodes[0].value}_decode(t,e,i){const r=e.content;let s=0,o=0;for(let t=0;t<this.sortedCodes.length;t+=1){const e=this.sortedCodes[t].bitLength;o<<=e-s,o|=this._getBits(r,i,e-s),s=e;{const i=this.bitCodeToValue[o];if(i>-1&&this.sortedBitLengthsByBitCode[i]===e)return this.sortedValuesByBitCode[i];for(let i=t;this.sortedCodes[i+1].bitLength===e&&i<this.sortedCodes.length;i+=1)t+=1}}throw new n("Huffman symbol not found.")}}},function(t,e,i){const{CramUnimplementedError:n,CramMalformedError:r,CramBufferOverrunError:s}=i(0),o=i(6),{parseItf8:a}=i(8);t.exports=class extends o{constructor(t={},e){if(super(t,e),"int"===this.dataType)this._decodeData=this._decodeInt;else{if("byte"!==this.dataType)throw new n(`${this.dataType} decoding not yet implemented by EXTERNAL codec`);this._decodeData=this._decodeByte}}decode(t,e,i,n){const{blockContentId:s}=this.parameters,o=i[s];if(!o)throw new r(`no block found with content ID ${s}`);const a=n.externalBlocks.getCursor(s);return this._decodeData(o,a)}_decodeInt(t,e){const[i,n]=a(t.content,e.bytePosition);return e.bytePosition+=n,i}_decodeByte(t,e){if(e.bytePosition>=t.content.length)throw new s("attempted to read beyond end of block. this file seems truncated.");const i=t.content[e.bytePosition];return e.bytePosition+=1,i}}},function(t,e,i){const{CramBufferOverrunError:n,CramMalformedError:r}=i(0),s=i(6);t.exports=class extends s{constructor(t={},e){if(super(t,e),"byteArray"!==e)throw new TypeError(`byteArrayStop codec does not support data type ${e}`);this._decode=this._decodeByteArray}decode(t,e,i,n){const{blockContentId:s}=this.parameters,o=i[s];if(!o)throw new r(`no block found with content ID ${s}`);const a=n.externalBlocks.getCursor(s);return this._decode(o,a)}_decodeByteArray(t,e){const i=t.content,{stopByte:r}=this.parameters,s=e.bytePosition;let o=e.bytePosition;for(;i[o]!==r&&o<i.length;){if(o===i.length)throw new n("byteArrayStop reading beyond length of data buffer?");o+=1}return e.bytePosition=o+1,i.slice(s,o)}}},function(t,e,i){const{tinyMemoize:n}=i(8),r=i(6);class s extends r{constructor(t={},e,i){if(super(t,e),this.instantiateCodec=i,"byteArray"!==e)throw new TypeError(`byteArrayLength does not support data type ${e}`)}decode(t,e,i,n){const r=this._getLengthCodec().decode(t,e,i,n),s=this._getDataCodec(),o=new Array(r);for(let a=0;a<r;a+=1)o[a]=s.decode(t,e,i,n);return o}_getLengthCodec(){const t=this.parameters.lengthsEncoding;return this.instantiateCodec(t,"int")}_getDataCodec(){const t=this.parameters.valuesEncoding;return this.instantiateCodec(t,"byte")}}"_getLengthCodec _getDataCodec".split(" ").forEach((t=>n(s,t))),t.exports=s},function(t,e,i){const{CramUnimplementedError:n}=i(0),r=i(6);t.exports=class extends r{constructor(t={},e){if(super(t,e),"int"!==this.dataType)throw new n(`${this.dataType} decoding not yet implemented by BETA codec`)}decode(t,e,i,n){return this._getBits(e.content,n.coreBlock,this.parameters.length)-this.parameters.offset}}},function(t,e,i){const{CramUnimplementedError:n}=i(0),r=i(6);t.exports=class extends r{constructor(t={},e){if(super(t,e),"int"!==this.dataType)throw new n(`${this.dataType} decoding not yet implemented by GAMMA codec`)}decode(t,e,i,n){let r=1;for(;0===this._getBits(e.content,n.coreBlock,1);)r+=1;return(this._getBits(e.content,n.coreBlock,r-1)|1<<r-1)-this.parameters.offset}}},function(t,e,i){const{CramUnimplementedError:n}=i(0),r=i(6);t.exports=class extends r{constructor(t={},e){if(super(t,e),"int"!==this.dataType)throw new n(`${this.dataType} decoding not yet implemented by SUBEXP codec`)}decode(t,e,i,n){let r,s,o=0;for(;this._getBits(e.content,n.coreBlock,1);)o+=1;return 0===o?(r=this.parameters.K,s=this._getBits(e.content,n.coreBlock,r)):s=1<<(r=o+this.parameters.K-1)|this._getBits(e.content,n.coreBlock,r),s-this.parameters.offset}}},function(t,e,i){var n=i(88),r=i(90);function s(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}e.parse=v,e.resolve=function(t,e){return v(t,!1,!0).resolve(e)},e.resolveObject=function(t,e){return t?v(t,!1,!0).resolveObject(e):e},e.format=function(t){return r.isString(t)&&(t=v(t)),t instanceof s?t.format():s.prototype.format.call(t)},e.Url=s;var o=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,h=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,l=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),c=["'"].concat(l),u=["%","/","?",";","#"].concat(c),f=["/","?","#"],d=/^[+a-z0-9A-Z_-]{0,63}$/,p=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,g={javascript:!0,"javascript:":!0},m={javascript:!0,"javascript:":!0},b={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},w=i(91);function v(t,e,i){if(t&&r.isObject(t)&&t instanceof s)return t;var n=new s;return n.parse(t,e,i),n}s.prototype.parse=function(t,e,i){if(!r.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var s=t.indexOf("?"),a=-1!==s&&s<t.indexOf("#")?"?":"#",l=t.split(a);l[0]=l[0].replace(/\\/g,"/");var v=t=l.join(a);if(v=v.trim(),!i&&1===t.split("#").length){var y=h.exec(v);if(y)return this.path=v,this.href=v,this.pathname=y[1],y[2]?(this.search=y[2],this.query=e?w.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var x=o.exec(v);if(x){var k=(x=x[0]).toLowerCase();this.protocol=k,v=v.substr(x.length)}if(i||x||v.match(/^\/\/[^@\/]+@[^@\/]+/)){var S="//"===v.substr(0,2);!S||x&&m[x]||(v=v.substr(2),this.slashes=!0)}if(!m[x]&&(S||x&&!b[x])){for(var _,C,E=-1,T=0;T<f.length;T++)-1!==(A=v.indexOf(f[T]))&&(-1===E||A<E)&&(E=A);for(-1!==(C=-1===E?v.lastIndexOf("@"):v.lastIndexOf("@",E))&&(_=v.slice(0,C),v=v.slice(C+1),this.auth=decodeURIComponent(_)),E=-1,T=0;T<u.length;T++){var A;-1!==(A=v.indexOf(u[T]))&&(-1===E||A<E)&&(E=A)}-1===E&&(E=v.length),this.host=v.slice(0,E),v=v.slice(E),this.parseHost(),this.hostname=this.hostname||"";var R="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!R)for(var I=this.hostname.split(/\./),L=(T=0,I.length);T<L;T++){var M=I[T];if(M&&!M.match(d)){for(var F="",D=0,B=M.length;D<B;D++)M.charCodeAt(D)>127?F+="x":F+=M[D];if(!F.match(d)){var N=I.slice(0,T),P=I.slice(T+1),O=M.match(p);O&&(N.push(O[1]),P.unshift(O[2])),P.length&&(v="/"+P.join(".")+v),this.hostname=N.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),R||(this.hostname=n.toASCII(this.hostname));var z=this.port?":"+this.port:"",H=this.hostname||"";this.host=H+z,this.href+=this.host,R&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==v[0]&&(v="/"+v))}if(!g[k])for(T=0,L=c.length;T<L;T++){var U=c[T];if(-1!==v.indexOf(U)){var $=encodeURIComponent(U);$===U&&($=escape(U)),v=v.split(U).join($)}}var q=v.indexOf("#");-1!==q&&(this.hash=v.substr(q),v=v.slice(0,q));var V=v.indexOf("?");if(-1!==V?(this.search=v.substr(V),this.query=v.substr(V+1),e&&(this.query=w.parse(this.query)),v=v.slice(0,V)):e&&(this.search="",this.query={}),v&&(this.pathname=v),b[k]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){z=this.pathname||"";var j=this.search||"";this.path=z+j}return this.href=this.format(),this},s.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",i=this.pathname||"",n=this.hash||"",s=!1,o="";this.host?s=t+this.host:this.hostname&&(s=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(s+=":"+this.port)),this.query&&r.isObject(this.query)&&Object.keys(this.query).length&&(o=w.stringify(this.query));var a=this.search||o&&"?"+o||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||b[e])&&!1!==s?(s="//"+(s||""),i&&"/"!==i.charAt(0)&&(i="/"+i)):s||(s=""),n&&"#"!==n.charAt(0)&&(n="#"+n),a&&"?"!==a.charAt(0)&&(a="?"+a),e+s+(i=i.replace(/[?#]/g,(function(t){return encodeURIComponent(t)})))+(a=a.replace("#","%23"))+n},s.prototype.resolve=function(t){return this.resolveObject(v(t,!1,!0)).format()},s.prototype.resolveObject=function(t){if(r.isString(t)){var e=new s;e.parse(t,!1,!0),t=e}for(var i=new s,n=Object.keys(this),o=0;o<n.length;o++){var a=n[o];i[a]=this[a]}if(i.hash=t.hash,""===t.href)return i.href=i.format(),i;if(t.slashes&&!t.protocol){for(var h=Object.keys(t),l=0;l<h.length;l++){var c=h[l];"protocol"!==c&&(i[c]=t[c])}return b[i.protocol]&&i.hostname&&!i.pathname&&(i.path=i.pathname="/"),i.href=i.format(),i}if(t.protocol&&t.protocol!==i.protocol){if(!b[t.protocol]){for(var u=Object.keys(t),f=0;f<u.length;f++){var d=u[f];i[d]=t[d]}return i.href=i.format(),i}if(i.protocol=t.protocol,t.host||m[t.protocol])i.pathname=t.pathname;else{for(var p=(t.pathname||"").split("/");p.length&&!(t.host=p.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==p[0]&&p.unshift(""),p.length<2&&p.unshift(""),i.pathname=p.join("/")}if(i.search=t.search,i.query=t.query,i.host=t.host||"",i.auth=t.auth,i.hostname=t.hostname||t.host,i.port=t.port,i.pathname||i.search){var g=i.pathname||"",w=i.search||"";i.path=g+w}return i.slashes=i.slashes||t.slashes,i.href=i.format(),i}var v=i.pathname&&"/"===i.pathname.charAt(0),y=t.host||t.pathname&&"/"===t.pathname.charAt(0),x=y||v||i.host&&t.pathname,k=x,S=i.pathname&&i.pathname.split("/")||[],_=(p=t.pathname&&t.pathname.split("/")||[],i.protocol&&!b[i.protocol]);if(_&&(i.hostname="",i.port=null,i.host&&(""===S[0]?S[0]=i.host:S.unshift(i.host)),i.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===p[0]?p[0]=t.host:p.unshift(t.host)),t.host=null),x=x&&(""===p[0]||""===S[0])),y)i.host=t.host||""===t.host?t.host:i.host,i.hostname=t.hostname||""===t.hostname?t.hostname:i.hostname,i.search=t.search,i.query=t.query,S=p;else if(p.length)S||(S=[]),S.pop(),S=S.concat(p),i.search=t.search,i.query=t.query;else if(!r.isNullOrUndefined(t.search))return _&&(i.hostname=i.host=S.shift(),(R=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@"))&&(i.auth=R.shift(),i.host=i.hostname=R.shift())),i.search=t.search,i.query=t.query,r.isNull(i.pathname)&&r.isNull(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.href=i.format(),i;if(!S.length)return i.pathname=null,i.search?i.path="/"+i.search:i.path=null,i.href=i.format(),i;for(var C=S.slice(-1)[0],E=(i.host||t.host||S.length>1)&&("."===C||".."===C)||""===C,T=0,A=S.length;A>=0;A--)"."===(C=S[A])?S.splice(A,1):".."===C?(S.splice(A,1),T++):T&&(S.splice(A,1),T--);if(!x&&!k)for(;T--;T)S.unshift("..");!x||""===S[0]||S[0]&&"/"===S[0].charAt(0)||S.unshift(""),E&&"/"!==S.join("/").substr(-1)&&S.push("");var R,I=""===S[0]||S[0]&&"/"===S[0].charAt(0);return _&&(i.hostname=i.host=I?"":S.length?S.shift():"",(R=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@"))&&(i.auth=R.shift(),i.host=i.hostname=R.shift())),(x=x||i.host&&S.length)&&!I&&S.unshift(""),S.length?i.pathname=S.join("/"):(i.pathname=null,i.path=null),r.isNull(i.pathname)&&r.isNull(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.auth=t.auth||i.auth,i.slashes=i.slashes||t.slashes,i.href=i.format(),i},s.prototype.parseHost=function(){var t=this.host,e=a.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},function(t,e,i){(function(t,n){var r;/*! https://mths.be/punycode v1.4.1 by @mathias */!function(s){e&&e.nodeType,t&&t.nodeType;var o="object"==typeof n&&n;o.global!==o&&o.window!==o&&o.self;var a,h=2147483647,l=36,c=/^xn--/,u=/[^\x20-\x7E]/,f=/[\x2E\u3002\uFF0E\uFF61]/g,d={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},p=Math.floor,g=String.fromCharCode;function m(t){throw new RangeError(d[t])}function b(t,e){for(var i=t.length,n=[];i--;)n[i]=e(t[i]);return n}function w(t,e){var i=t.split("@"),n="";return i.length>1&&(n=i[0]+"@",t=i[1]),n+b((t=t.replace(f,".")).split("."),e).join(".")}function v(t){for(var e,i,n=[],r=0,s=t.length;r<s;)(e=t.charCodeAt(r++))>=55296&&e<=56319&&r<s?56320==(64512&(i=t.charCodeAt(r++)))?n.push(((1023&e)<<10)+(1023&i)+65536):(n.push(e),r--):n.push(e);return n}function y(t){return b(t,(function(t){var e="";return t>65535&&(e+=g((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+g(t)})).join("")}function x(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function k(t,e,i){var n=0;for(t=i?p(t/700):t>>1,t+=p(t/e);t>455;n+=l)t=p(t/35);return p(n+36*t/(t+38))}function S(t){var e,i,n,r,s,o,a,c,u,f,d,g=[],b=t.length,w=0,v=128,x=72;for((i=t.lastIndexOf("-"))<0&&(i=0),n=0;n<i;++n)t.charCodeAt(n)>=128&&m("not-basic"),g.push(t.charCodeAt(n));for(r=i>0?i+1:0;r<b;){for(s=w,o=1,a=l;r>=b&&m("invalid-input"),((c=(d=t.charCodeAt(r++))-48<10?d-22:d-65<26?d-65:d-97<26?d-97:l)>=l||c>p((h-w)/o))&&m("overflow"),w+=c*o,!(c<(u=a<=x?1:a>=x+26?26:a-x));a+=l)o>p(h/(f=l-u))&&m("overflow"),o*=f;x=k(w-s,e=g.length+1,0==s),p(w/e)>h-v&&m("overflow"),v+=p(w/e),w%=e,g.splice(w++,0,v)}return y(g)}function _(t){var e,i,n,r,s,o,a,c,u,f,d,b,w,y,S,_=[];for(b=(t=v(t)).length,e=128,i=0,s=72,o=0;o<b;++o)(d=t[o])<128&&_.push(g(d));for(n=r=_.length,r&&_.push("-");n<b;){for(a=h,o=0;o<b;++o)(d=t[o])>=e&&d<a&&(a=d);for(a-e>p((h-i)/(w=n+1))&&m("overflow"),i+=(a-e)*w,e=a,o=0;o<b;++o)if((d=t[o])<e&&++i>h&&m("overflow"),d==e){for(c=i,u=l;!(c<(f=u<=s?1:u>=s+26?26:u-s));u+=l)S=c-f,y=l-f,_.push(g(x(f+S%y,0))),c=p(S/y);_.push(g(x(c,0))),s=k(i,w,n==r),i=0,++n}++i,++e}return _.join("")}a={version:"1.4.1",ucs2:{decode:v,encode:y},decode:S,encode:_,toASCII:function(t){return w(t,(function(t){return u.test(t)?"xn--"+_(t):t}))},toUnicode:function(t){return w(t,(function(t){return c.test(t)?S(t.slice(4).toLowerCase()):t}))}},void 0===(r=function(){return a}.call(e,i,e,t))||(t.exports=r)}()}).call(this,i(89)(t),i(2))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,i){t.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},function(t,e,i){e.decode=e.parse=i(92),e.encode=e.stringify=i(93)},function(t,e,i){function n(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,i,s){e=e||"&",i=i||"=";var o={};if("string"!=typeof t||0===t.length)return o;var a=/\+/g;t=t.split(e);var h=1e3;s&&"number"==typeof s.maxKeys&&(h=s.maxKeys);var l=t.length;h>0&&l>h&&(l=h);for(var c=0;c<l;++c){var u,f,d,p,g=t[c].replace(a,"%20"),m=g.indexOf(i);m>=0?(u=g.substr(0,m),f=g.substr(m+1)):(u=g,f=""),d=decodeURIComponent(u),p=decodeURIComponent(f),n(o,d)?r(o[d])?o[d].push(p):o[d]=[o[d],p]:o[d]=p}return o};var r=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},function(t,e,i){var n=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,i,a){return e=e||"&",i=i||"=",null===t&&(t=void 0),"object"==typeof t?s(o(t),(function(o){var a=encodeURIComponent(n(o))+i;return r(t[o])?s(t[o],(function(t){return a+encodeURIComponent(n(t))})).join(e):a+encodeURIComponent(n(t[o]))})).join(e):a?encodeURIComponent(n(a))+i+encodeURIComponent(n(t)):""};var r=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function s(t,e){if(t.map)return t.map(e);for(var i=[],n=0;n<t.length;n++)i.push(e(t[n],n));return i}var o=Object.keys||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.push(i);return e}},function(t,e,i){(function(e){const n=i(95),r=i(96);t.exports=class{constructor(t){this.position=0,this.url=t,this.cache=new r({fetch:(t,e)=>this._fetch(t,e)})}async _fetch(t,i){const r={};i<1/0?r.range=`bytes=${t}-${t+i}`:i===1/0&&0!==t&&(r.range=`bytes=${t}-`);const s=await n(this.url,{method:"GET",headers:r,redirect:"follow",mode:"cors"});if(200===s.status&&0===t||206===s.status){const t=e.from(await s.arrayBuffer()),i=/\/(\d+)$/.exec(s.headers.get("content-range"));return i&&i[1]?this._stat={size:parseInt(i[1],10)}:this._stat={size:void 0},t}throw new Error(`HTTP ${s.status} fetching ${this.url}`)}read(t,e=0,i=1/0,n=0){let r=n;return null===n&&(r=this.position,this.position+=i),this.cache.get(t,e,i,n)}async readFile(){const t=await n(this.url,{method:"GET",redirect:"follow",mode:"cors"});return e.from(await t.arrayBuffer())}async stat(){if(!this._stat){const t=e.allocUnsafe(10);if(await this.read(t,0,10,0),!this._stat)throw new Error(`unable to determine size of file at ${this.url}`)}return this._stat}}}).call(this,i(1).Buffer)},function(t,e){var i=function(t){function e(){this.fetch=!1}return e.prototype=t,new e}("undefined"!=typeof self?self:this);!function(t){!function(e){var i="URLSearchParams"in t,n="Symbol"in t&&"iterator"in Symbol,r="FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),s="FormData"in t,o="ArrayBuffer"in t;if(o)var a=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],h=ArrayBuffer.isView||function(t){return t&&a.indexOf(Object.prototype.toString.call(t))>-1};function l(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function c(t){return"string"!=typeof t&&(t=String(t)),t}function u(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return n&&(e[Symbol.iterator]=function(){return e}),e}function f(t){this.map={},t instanceof f?t.forEach((function(t,e){this.append(e,t)}),this):Array.isArray(t)?t.forEach((function(t){this.append(t[0],t[1])}),this):t&&Object.getOwnPropertyNames(t).forEach((function(e){this.append(e,t[e])}),this)}function d(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function p(t){return new Promise((function(e,i){t.onload=function(){e(t.result)},t.onerror=function(){i(t.error)}}))}function g(t){var e=new FileReader,i=p(e);return e.readAsArrayBuffer(t),i}function m(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function b(){return this.bodyUsed=!1,this._initBody=function(t){var e;this._bodyInit=t,t?"string"==typeof t?this._bodyText=t:r&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:s&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:i&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():o&&r&&(e=t)&&DataView.prototype.isPrototypeOf(e)?(this._bodyArrayBuffer=m(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):o&&(ArrayBuffer.prototype.isPrototypeOf(t)||h(t))?this._bodyArrayBuffer=m(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):i&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},r&&(this.blob=function(){var t=d(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?d(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(g)}),this.text=function(){var t,e,i,n=d(this);if(n)return n;if(this._bodyBlob)return t=this._bodyBlob,i=p(e=new FileReader),e.readAsText(t),i;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),i=new Array(e.length),n=0;n<e.length;n++)i[n]=String.fromCharCode(e[n]);return i.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},s&&(this.formData=function(){return this.text().then(y)}),this.json=function(){return this.text().then(JSON.parse)},this}f.prototype.append=function(t,e){t=l(t),e=c(e);var i=this.map[t];this.map[t]=i?i+", "+e:e},f.prototype.delete=function(t){delete this.map[l(t)]},f.prototype.get=function(t){return t=l(t),this.has(t)?this.map[t]:null},f.prototype.has=function(t){return this.map.hasOwnProperty(l(t))},f.prototype.set=function(t,e){this.map[l(t)]=c(e)},f.prototype.forEach=function(t,e){for(var i in this.map)this.map.hasOwnProperty(i)&&t.call(e,this.map[i],i,this)},f.prototype.keys=function(){var t=[];return this.forEach((function(e,i){t.push(i)})),u(t)},f.prototype.values=function(){var t=[];return this.forEach((function(e){t.push(e)})),u(t)},f.prototype.entries=function(){var t=[];return this.forEach((function(e,i){t.push([i,e])})),u(t)},n&&(f.prototype[Symbol.iterator]=f.prototype.entries);var w=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function v(t,e){var i,n,r=(e=e||{}).body;if(t instanceof v){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new f(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,r||null==t._bodyInit||(r=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new f(e.headers)),this.method=(n=(i=e.method||this.method||"GET").toUpperCase(),w.indexOf(n)>-1?n:i),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function y(t){var e=new FormData;return t.trim().split("&").forEach((function(t){if(t){var i=t.split("="),n=i.shift().replace(/\+/g," "),r=i.join("=").replace(/\+/g," ");e.append(decodeURIComponent(n),decodeURIComponent(r))}})),e}function x(t,e){e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new f(e.headers),this.url=e.url||"",this._initBody(t)}v.prototype.clone=function(){return new v(this,{body:this._bodyInit})},b.call(v.prototype),b.call(x.prototype),x.prototype.clone=function(){return new x(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},x.error=function(){var t=new x(null,{status:0,statusText:""});return t.type="error",t};var k=[301,302,303,307,308];x.redirect=function(t,e){if(-1===k.indexOf(e))throw new RangeError("Invalid status code");return new x(null,{status:e,headers:{location:t}})},e.DOMException=t.DOMException;try{new e.DOMException}catch(t){e.DOMException=function(t,e){this.message=t,this.name=e;var i=Error(t);this.stack=i.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function S(t,i){return new Promise((function(n,s){var o=new v(t,i);if(o.signal&&o.signal.aborted)return s(new e.DOMException("Aborted","AbortError"));var a=new XMLHttpRequest;function h(){a.abort()}a.onload=function(){var t,e,i={status:a.status,statusText:a.statusText,headers:(t=a.getAllResponseHeaders()||"",e=new f,t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(t){var i=t.split(":"),n=i.shift().trim();if(n){var r=i.join(":").trim();e.append(n,r)}})),e)};i.url="responseURL"in a?a.responseURL:i.headers.get("X-Request-URL");var r="response"in a?a.response:a.responseText;n(new x(r,i))},a.onerror=function(){s(new TypeError("Network request failed"))},a.ontimeout=function(){s(new TypeError("Network request failed"))},a.onabort=function(){s(new e.DOMException("Aborted","AbortError"))},a.open(o.method,o.url,!0),"include"===o.credentials?a.withCredentials=!0:"omit"===o.credentials&&(a.withCredentials=!1),"responseType"in a&&r&&(a.responseType="blob"),o.headers.forEach((function(t,e){a.setRequestHeader(e,t)})),o.signal&&(o.signal.addEventListener("abort",h),a.onreadystatechange=function(){4===a.readyState&&o.signal.removeEventListener("abort",h)}),a.send(void 0===o._bodyInit?null:o._bodyInit)}))}S.polyfill=!0,t.fetch||(t.fetch=S,t.Headers=f,t.Request=v,t.Response=x),e.Headers=f,e.Request=v,e.Response=x,e.fetch=S}({})}(i),delete i.fetch.polyfill,t.exports=e=i.fetch,e.fetch=i.fetch,e.Headers=i.Headers,e.Request=i.Request,e.Response=i.Response,e.default=i.fetch},function(t,e,i){const n=i(30);t.exports=class{constructor({fetch:t,size:e=1e7,chunkSize:i=32768}){if(!t)throw new Error("fetch function required");this.fetch=t,this.chunkSize=i,this.lruCache=new n({maxSize:Math.floor(e/i)})}async get(t,e,i,n){if(t.length<e+i)throw new Error("output buffer not big enough for request");const r=Math.floor(n/this.chunkSize),s=Math.floor((n+i)/this.chunkSize),o=new Array(s-r+1);for(let t=r;t<=s;t+=1)o[t-r]=this._getChunk(t).then((e=>({data:e,chunkNumber:t})));const a=await Promise.all(o),h=n-a[0].chunkNumber*this.chunkSize;a.forEach((({data:o,chunkNumber:a})=>{const l=a*this.chunkSize;let c=0,u=this.chunkSize,f=e+(a-r)*this.chunkSize-h;a===r&&(f=e,c=h),a===s&&(u=n+i-l),o.copy(t,f,c,u)}))}_getChunk(t){const e=this.lruCache.get(t);if(e)return e;const i=this.fetch(t*this.chunkSize,this.chunkSize);return this.lruCache.set(t,i),i}}},function(t,e,i){const{promisify:n}=i(34),r=null,s=r,o=r,a=r,h=r;t.exports=class{constructor(t){this.position=0,this.filename=t,this.fd=s(this.filename,"r")}async read(t,e=0,i,n){let r=n;return null===n&&(r=this.position,this.position+=i),o(await this.fd,t,e,i,n)}async readFile(){return h(await this.fd)}async stat(){return this._stat||(this._stat=await a(await this.fd)),this._stat}}},function(t,e){t.exports={parseHeaderText:function(t){const e=t.split(/\r?\n/),i=[];return e.forEach((t=>{const[e,...n]=t.split(/\t/),r=n.map((t=>{const[e,i]=t.split(":",2);return{tag:e,value:i}}));e&&i.push({tag:e.substr(1),data:r})})),i}}},function(t,e,i){const{CramUnimplementedError:n,CramSizeLimitError:r}=i(0),s=i(18);t.exports=class{constructor(t){if(t.cram?this.cram=t.cram:this.cram=new s({url:t.cramUrl,path:t.cramPath,filehandle:t.cramFilehandle,seqFetch:t.seqFetch,checkSequenceMD5:t.checkSequenceMD5,cacheSize:t.cacheSize}),!(this.cram instanceof s))throw new Error("invalid arguments: no cramfile");if(this.index=t.index,!this.index.getEntriesForRange)throw new Error("invalid arguments: not an index");this.fetchSizeLimit=t.fetchSizeLimit||3e6}async getRecordsForRange(t,e,i,s={}){if(s.viewAsPairs=s.viewAsPairs||!1,s.pairAcrossChr=s.pairAcrossChr||!1,s.maxInsertSize=s.maxInsertSize||2e5,"string"==typeof t)throw new n("string sequence names not yet supported");const o=t,a=await this.index.getEntriesForRange(o,e,i),h=a.map((t=>t.sliceBytes)).reduce(((t,e)=>t+e),0);if(h>this.fetchSizeLimit)throw new r(`data size of ${h.toLocaleString()} bytes exceeded fetch size limit of ${this.fetchSizeLimit.toLocaleString()} bytes`);const l=n=>n.sequenceId===t&&n.alignmentStart<=i&&n.alignmentStart+n.lengthOnRef>=e,c=await Promise.all(a.map((t=>this.getRecordsInSlice(t,l))));let u=Array.prototype.concat(...c);if(s.viewAsPairs){const t={},e={};for(let i=0;i<u.length;i+=1){const n=u[i].readName,r=u[i].uniqueId;t[n]||(t[n]=0),t[n]+=1,e[r]=1}const i={};Object.entries(t).forEach((([t,e])=>{1===e&&(i[t]=!0)}));const n=[];for(let t=0;t<u.length;t+=1){const e=u[t].readName;if(i[e]&&u[t].mate&&(u[t].mate.sequenceId===o||s.pairAcrossChr)&&Math.abs(u[t].alignmentStart-u[t].mate.alignmentStart)<s.maxInsertSize){const e=this.index.getEntriesForRange(u[t].mate.sequenceId,u[t].mate.alignmentStart,u[t].mate.alignmentStart+1);n.push(e)}}const r=await Promise.all(n);let a=[];for(let t=0;t<r.length;t+=1)a.push(...r[t]);a=a.sort(((t,e)=>t.toString().localeCompare(e.toString()))).filter(((t,e,i)=>!e||t.toString()!==i[e-1].toString()));const h=[],l=[],c=a.map((t=>t.sliceBytes)).reduce(((t,e)=>t+e),0);if(c>this.fetchSizeLimit)throw new Error(`mate data size of ${c.toLocaleString()} bytes exceeded fetch size limit of ${this.fetchSizeLimit.toLocaleString()} bytes`);a.forEach((t=>{let n=this.cram.featureCache.get(t.toString());n||(n=this.getRecordsInSlice(t,(()=>!0)),this.cram.featureCache.set(t.toString(),n)),h.push(n);const r=n.then((t=>{const n=[];for(let r=0;r<t.length;r+=1){const s=t[r];i[s.readName]&&!e[s.uniqueId]&&n.push(s)}return n}));l.push(r)}));const f=await Promise.all(l);if(f.length){const t=f.reduce(((t,e)=>t.concat(e)));u=u.concat(t)}}return u}getRecordsInSlice({containerStart:t,sliceStart:e,sliceBytes:i},n){return this.cram.getContainerAtPosition(t).getSlice(e,i).getRecords(n)}hasDataForReferenceSequence(t){return this.index.hasDataForReferenceSequence(t)}}},function(t,e,i){const{promisify:n}=i(34),r=n(i(20).gunzip),{open:s}=i(33),{CramMalformedError:o}=i(0);class a{constructor(t){Object.assign(this,t)}toString(){return`${this.start}:${this.span}:${this.containerStart}:${this.sliceStart}:${this.sliceBytes}`}}function h(t,e){if(e.some((t=>void 0===t)))throw new o("invalid .crai index file");const[i,n,r,s,h,l]=e;t[i]||(t[i]=[]),t[i].push(new a({start:n,span:r,containerStart:s,sliceStart:h,sliceBytes:l}))}t.exports=class{constructor(t){const e=s(t.url,t.path,t.filehandle);this.readFile=e.readFile.bind(e),this.index=this.parseIndex()}parseIndex(){const t={};return this.readFile().then((t=>31===t[0]&&139===t[1]?r(t):t)).then((e=>{let i=[],n="";for(let r=0;r<e.length;r+=1){const s=e[r];if(s>=48&&s<=57||!n&&45===s)n+=String.fromCharCode(s);else if(9===s)i.push(Number.parseInt(n,10)),n="";else if(10===s)i.push(Number.parseInt(n,10)),n="",h(t,i),i=[];else if(13!==s&&32!==s)throw new o("invalid .crai index file")}return n&&i.push(Number.parseInt(n,10)),6===i.length&&h(t,i),Object.entries(t).forEach((([e,i])=>{t[e]=i.sort(((t,e)=>t.start-e.start||t.span-e.span))})),t}))}getIndex(){return this.index}async hasDataForReferenceSequence(t){return!!(await this.index)[t]}async getEntriesForRange(t,e,i){const n=(await this.index)[t];if(!n)return[];const r=n.length,s=t=>{const n=t.start,r=t.start+t.span;return n>=i?-1:r<=e?1:0};let o,a=0,h=r-1;for(;a<=h;){const t=s(n[o=Math.round((h+a)/2)]);if(t>0)a=o+1;else{if(!(t<0))break;h=o-1}}let l=o;for(;l&&!s(n[l-1]);)l-=1;let c=o;for(;c<r-1&&!s(n[c+1]);)c+=1;const u=n[l].start;return n[c].start+n[c].span>=e&&i>=u?n.slice(l,c+1):[]}}}]);class xa{constructor(t,e,i){this.config=t,this.browser=i,this.genome=e,this.cramFile=new ya.CramFile({filehandle:new ka(t.url,t),seqFetch:t.seqFetch||function(t,e,i){const n=this.genome.sequence,r=this.genome;return this.getHeader().then((function(s){const o=r.getChromosomeName(s.chrNames[t]);return n.getSequence(o,e-1,i)}))}.bind(this),checkSequenceMD5:void 0===t.checkSequenceMD5||t.checkSequenceMD5});const n=new ka(t.indexURL,t);this.indexedCramFile=new ya.IndexedCramFile({cram:this.cramFile,index:new ya.CraiIndex({filehandle:n}),fetchSizeLimit:3e7}),aa.setReaderDefaults(this,t)}async getHeader(){if(!this.header){const t=this.genome,e=await this.cramFile.getSamHeader(),i={},n=[],r={},s=[];for(let o of e)if("SQ"===o.tag){for(let e of o.data)if("SN"===e.tag){const s=e.value;if(i[s]=n.length,n.push(s),t){r[t.getChromosomeName(s)]=s}break}}else"RG"===o.tag&&s.push(o.data);this.header={chrNames:n,chrToIndex:i,chrAliasTable:r,readGroups:s}}return this.header}async readAlignments(t,e,i){this.browser;const n=await this.getHeader(),r=n.chrAliasTable.hasOwnProperty(t)?n.chrAliasTable[t]:t,s=n.chrToIndex[r],o=new Vo(t,e,i,this.samplingWindowSize,this.samplingDepth,this.pairsSupported,this.alleleFreqThreshold);if(void 0===s)return o;try{const t=await this.indexedCramFile.getRecordsForRange(s,e,i);for(let r of t){const t=r.sequenceId,h=r.alignmentStart,l=h+r.lengthOnRef;if(t<0)continue;if(t>s||h>i)return;if(t<s)continue;if(l<e)continue;const c=a(r,n.chrNames);o.push(c)}return o.finish(),o}catch(t){let e=t.message;throw e&&e.indexOf("MD5")>=0&&(e="Sequence mismatch. Is this the correct genome for the loaded CRAM?"),v.presentAlert(new Error(e)),t}function a(t,e){const i=new Ko;if(i.chr=e[t.sequenceId],i.start=t.alignmentStart-1,i.lengthOnRef=t.lengthOnRef,i.flags=t.flags,i.strand=!(16&t.flags),i.fragmentLength=t.templateLength||t.templateSize,i.mq=t.mappingQuality,i.end=t.alignmentStart+t.lengthOnRef,i.readGroupId=t.readGroupId,t.mate&&void 0!==t.mate.sequenceId){const n=void 0!==t.mate.flags?!(1&t.mate.flags):!(32&t.flags);i.mate={chr:e[t.mate.sequenceId],position:t.mate.alignmentStart,strand:n}}return i.seq=t.getReadBases(),i.qual=t.qualityScores,i.tagDict=t.tags,i.readName=t.readName,function(t,e){const i=[];let n,r,s=0,o="";if(e.scStart=e.start,e.scLengthOnRef=e.lengthOnRef,t.readFeatures)for(let a of t.readFeatures){const t=a.code,h=a.data,l=a.pos-1,c=a.refPos-1;switch(t){case"S":case"I":case"i":case"N":case"D":if(l>s){const t=l-s;i.push(new ia({start:c-t,seqOffset:s,len:t,type:"M"})),s+=t,o+=t+"M"}if("S"===t){let n=c;e.scLengthOnRef+=h.length,0===l&&(e.scStart-=h.length,n-=h.length);const r=h.length;i.push(new ia({start:n,seqOffset:s,len:r,type:"S"})),s+=r,o+=r+t}else if("I"===t||"i"===t){void 0===n&&(n=[]);const e="i"===t?1:h.length;n.push(new ia({start:c-1,len:e,seqOffset:s,type:"I"})),s+=e,o+=e+t}else"D"!==t&&"N"!==t||(r||(r=[]),r.push({start:c,len:h,type:t}),o+=h+t);break;case"H":case"P":o+=h+t}}const a=t.readLength-s;a>0&&(i.push(new ia({start:t.alignmentStart+t.lengthOnRef-a-1,seqOffset:s,len:a,type:"M"})),o+=a+"M");e.blocks=i,e.insertions=n,e.gaps=r,e.cigar=o}(t,i),i.mate&&i.start>i.mate.position&&i.fragmentLength>0&&(i.fragmentLength=-i.fragmentLength),aa.setPairOrientation(i),i}}}class ka{constructor(t,e){this.position=0,this.url=t,this.config=e,this.cache=new Sa({fetch:(t,e)=>this._fetch(t,e)})}async _fetch(t,e){const i={start:t,size:e};this._stat={size:void 0};const n=await un.loadArrayBuffer(this.url,sn(this.config,{range:i}));return Buffer.from(n)}async read(t,e=0,i=1/0,n=0){let r=n;return null===n&&(r=this.position,this.position+=i),this.cache.get(t,e,i,n)}async readFile(){const t=await un.loadArrayBuffer(this.url,sn(this.config));return Buffer.from(t)}async stat(){if(!this._stat){const t=Buffer.allocUnsafe(10);if(await this.read(t,0,10,0),!this._stat)throw new Error(`unable to determine size of file at ${this.url}`)}return this._stat}}class Sa{constructor({fetch:t,size:e=1e7,chunkSize:i=32768}){this.fetch=t,this.chunkSize=i,this.lruCache=new _a({maxSize:Math.floor(e/i)})}async get(t,e,i,n){if(t.length<e+i)throw new Error("output buffer not big enough for request");const r=Math.floor(n/this.chunkSize),s=Math.floor((n+i)/this.chunkSize),o=new Array(s-r+1);for(let t=r;t<=s;t+=1)o[t-r]=this._getChunk(t).then((e=>({data:e,chunkNumber:t})));const a=await Promise.all(o),h=n-a[0].chunkNumber*this.chunkSize;a.forEach((({data:o,chunkNumber:a})=>{const l=a*this.chunkSize;let c=0,u=this.chunkSize,f=e+(a-r)*this.chunkSize-h;a===r&&(f=e,c=h),a===s&&(u=n+i-l),o.copy(t,f,c,u)}))}_getChunk(t){const e=this.lruCache.get(t);if(e)return e;const i=this.fetch(t*this.chunkSize,this.chunkSize);return this.lruCache.set(t,i),i}}class _a{constructor(t={}){if(!(t.maxSize&&t.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");this.maxSize=t.maxSize,this.cache=new Map,this.oldCache=new Map,this._size=0}_set(t,e){this.cache.set(t,e),this._size++,this._size>=this.maxSize&&(this._size=0,this.oldCache=this.cache,this.cache=new Map)}get(t){if(this.cache.has(t))return this.cache.get(t);if(this.oldCache.has(t)){const e=this.oldCache.get(t);return this._set(t,e),e}}set(t,e){return this.cache.has(t)?this.cache.set(t,e):this._set(t,e),this}has(t){return this.cache.has(t)||this.oldCache.has(t)}peek(t){return this.cache.has(t)?this.cache.get(t):this.oldCache.has(t)?this.oldCache.get(t):void 0}delete(t){const e=this.cache.delete(t);return e&&this._size--,this.oldCache.delete(t)||e}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}*keys(){for(const[t]of this)yield t}*values(){for(const[,t]of this)yield t}*[Symbol.iterator](){for(const t of this.cache)yield t;for(const t of this.oldCache){const[e]=t;this.cache.has(e)||(yield t)}}get size(){let t=0;for(const e of this.oldCache.keys())this.cache.has(e)||t++;return this._size+t}}var Ca={ALIGNMENT_MATCH:"M",INSERT:"I",DELETE:"D",SKIP:"N",CLIP_SOFT:"S",CLIP_HARD:"H",PAD:"P",SEQUENCE_MATCH:"=",SEQUENCE_MISMATCH:"X"};const Ea=function(t,e){this.config=t,this.genome=e,this.url=t.url,this.filter=new na(t.filter),this.readGroupSetIds=t.readGroupSetIds,this.authKey=t.authKey,this.samplingWindowSize=void 0===t.samplingWindowSize?100:t.samplingWindowSize,this.samplingDepth=void 0===t.samplingDepth?1e3:t.samplingDepth,t.viewAsPairs?this.pairsSupported=!0:this.pairsSupported=void 0===t.pairsSupported||t.pairsSupported};Ea.prototype.readAlignments=function(t,e,i){const n=this.genome,r=this;return(r.chrAliasTable?Promise.resolve(r.chrAliasTable):r.readMetadata().then((function(t){if(r.chrAliasTable={},n&&t.readGroups&&t.readGroups.length>0){var e=t.readGroups[0].referenceSetId;return e?Is({url:r.url+"/references/search",body:{referenceSetId:e},decode:function(t){return t.references}}).then((function(t){return t.forEach((function(t){var e=t.name,i=n.getChromosomeName(e);r.chrAliasTable[i]=e})),r.chrAliasTable})):(function(t,e){var i;if("461916304629"===e||"337315832689"===e){for(i=1;i<23;i++)t["chr"+i]=i;t.chrX="X",t.chrY="Y",t.chrM="MT"}}(r.chrAliasTable,r.config.datasetId),r.chrAliasTable)}return r.chrAliasTable}))).then((function(n){var o=n.hasOwnProperty(t)?n[t]:t;return Is({url:r.url+"/reads/search",body:{readGroupSetIds:[r.readGroupSetIds],referenceName:o,start:e,end:i,pageSize:"10000"},decode:s,results:new Vo(t,e,i,r.samplingWindowSize,r.samplingDepth,r.pairsSupported,r.alleleFreqThreshold)})}));function s(t){var e,i,s,o,a,h=t.alignments,l=h.length,c=[];for(e=0;e<l;e++){let t=h[e];(i=new Ko).readName=t.fragmentName,i.properPlacement=t.properPlacement,i.duplicateFragment=t.duplicateFragment,i.numberReads=t.numberReads,i.fragmentLength=t.fragmentLength,i.readNumber=t.readNumber,i.failedVendorQualityChecks=t.failedVendorQualityChecks,i.secondaryAlignment=t.secondaryAlignment,i.supplementaryAlignment=t.supplementaryAlignment,i.seq=t.alignedSequence,i.qual=t.alignedQuality,i.matePos=t.nextMatePosition,i.tagDict=t.info,i.flags=0,t.alignment?(i.mapped=!0,i.chr=t.alignment.position.referenceName,n&&(i.chr=n.getChromosomeName(i.chr)),i.start=parseInt(t.alignment.position.position),i.strand=!t.alignment.position.reverseStrand,i.mq=t.alignment.mappingQuality,i.cigar=u(t.alignment.cigar),s=f(t.alignment.cigar),i.lengthOnRef=s.lengthOnRef,a=d(i,s.array),i.blocks=a.blocks,i.insertions=a.insertions):i.mapped=!1,(o=t.nextMatePosition)&&(i.mate={chr:o.referenceFrame,position:parseInt(o.position),strand:!o.reverseStrand}),r.filter.pass(i)&&c.push(i)}return c;function u(t){var e="";return t.forEach((function(t){var i=Ca[t.operation],n=t.operationLength;e+=n+i})),e}function f(t){var e,i,n,r,s=0,o=[];for(r=0;r<t.length;r++)e=t[r],n=Ca[e.operation],i=parseInt(e.operationLength),"M"!==n&&"EQ"!==n&&"X"!==n&&"D"!==n&&"N"!==n&&"="!==n||(s+=i),o.push({len:i,ltr:n});return{lengthOnRef:s,array:o}}function d(t,e){for(var i,n,r,s=[],o=0,a=t.start,h=e.length,l=0;l<h;l++){var c=e[l];switch(c.ltr){case"H":case"P":break;case"S":o+=c.len,r="S";break;case"N":case"D":void 0===i&&(i=[]),i.push({start:a,len:c.len,type:c.ltr}),a+=c.len;break;case"I":void 0===n&&(n=[]),n.push(new ia({start:a,len:c.len,seqOffset:o})),o+=c.len;break;case"M":case"EQ":case"=":case"X":s.push(new ia({start:a,len:c.len,seqOffset:o,gapType:r})),o+=c.len,a+=c.len}}return{blocks:s,insertions:n,gaps:i}}}},Ea.prototype.readMetadata=function(){return Rs({url:this.url,entity:"readgroupsets",entityId:this.readGroupSetIds})};const Ta=O;class Aa{constructor(t,e){const i=e.genome;if(this.config=t,this.genome=i,this.alignmentContainer=void 0,Ta(t.url)&&t.url.startsWith("data:")){if("cram"===t.format)throw"CRAM data uris are not supported";this.config.indexed=!1}"ga4gh"===t.sourceType?this.bamReader=new Ea(t,i):"pysam"===t.sourceType?this.bamReader=new ma(t,i):"htsget"===t.sourceType?this.bamReader=new wa(t,i):"shardedBam"===t.sourceType?this.bamReader=new ga(t,i):"cram"===t.format?this.bamReader=new xa(t,i,e):!1===this.config.indexed?this.bamReader=new da(t,i):this.bamReader=new pa(t,i),this.viewAsPairs=t.viewAsPairs,this.showSoftClips=t.showSoftClips}setViewAsPairs(t){this.viewAsPairs!==t&&(this.viewAsPairs=t)}setShowSoftClips(t){this.showSoftClips!==t&&(this.showSoftClips=t)}async getAlignments(t,e,i){const n=this.genome,r=this.showSoftClips;if(this.alignmentContainer&&this.alignmentContainer.contains(t,e,i))return this.alignmentContainer;{const s=await this.bamReader.readAlignments(t,e,i);let o=s.alignments;this.viewAsPairs||(o=$o([{alignments:o}]));const a=o.length>0;if(s.packedAlignmentRows=qo(o,s.start,s.end,r),s.alignments=void 0,this.alignmentContainer=s,a){const e=await n.sequence.getSequence(t,s.start,s.end);if(e)return s.coverageMap.refSeq=e,s.sequence=e,s;console.error("No sequence for: "+t+":"+s.start+"-"+s.end)}return s}}}class Ra extends Pr{constructor(t,e){super(t,e),this.type="alignment",void 0===t.alleleFreqThreshold&&(t.alleleFreqThreshold=.2),this.featureSource=new Aa(t,e),this.showCoverage=void 0===t.showCoverage||t.showCoverage,this.showAlignments=void 0===t.showAlignments||t.showAlignments,this.coverageTrack=new Ia(t,this),this.alignmentTrack=new La(t,this),this.alignmentTrack.setTop(this.coverageTrack,this.showCoverage),this.visibilityWindow=t.visibilityWindow||3e4,this.viewAsPairs=t.viewAsPairs,this.pairsSupported=!1!==t.pairsSupported,this.showSoftClips=t.showSoftClips,this.showAllBases=t.showAllBases,this.showMismatches=!1!==t.showMismatches,this.color=t.color||"rgb(185, 185, 185)",this.coverageColor=t.coverageColor||"rgb(150, 150, 150)",this.minFragmentLength=t.minFragmentLength,this.maxFragmentLength=t.maxFragmentLength,t.sort&&(Array.isArray(t.sort)?this.assignSort(t.sort[0]):this.assignSort(t.sort)),this.height=void 0!==t.height?t.height:300}set height(t){this._height=t,this.coverageTrack&&this.showAlignments&&(this.alignmentTrack.height=this.showCoverage?t-this.coverageTrack.height:t)}get height(){return this._height}sort(t){t=this.assignSort(t);for(let e of this.trackView.viewports)if(e.containsPosition(t.chr,t.position)){const i=e.getCachedFeatures();i&&(Ma(t,i),e.repaint())}}assignSort(t){if(t.locus){const e=function(t){const e=t.split(":"),i=e[1].split("-"),n={chr:e[0],start:Number.parseInt(i[0].replace(/,/g,""))-1};return i.length>1?n.end=Number.parseInt(i[1].replace(/,/g,"")):n.end=n.start+1,n}(t.locus);t.chr=e.chr,t.position=e.start}else t.position--;return t.direction="ASC"===t.direction||!0===t.direction,t.chr=this.browser.genome.getChromosomeName(t.chr),this.sortObject=t,this.sortObject}async getFeatures(t,e,i,n,r){const s=await this.featureSource.getAlignments(t,e,i);s.alignments&&s.alignments.length>99&&(void 0===this.minFragmentLength&&(this.minFragmentLength=s.pairedEndStats.lowerFragmentLength),void 0===this.maxFragmentLength&&(this.maxFragmentLength=s.pairedEndStats.upperFragmentLength));const o=this.sortObject;return o&&o.chr===t&&o.position>=e&&o.position<=i&&Ma(o,s),s}computePixelHeight(t){return(this.showCoverage?this.coverageTrack.height:0)+(this.showAlignments?this.alignmentTrack.computePixelHeight(t):0)+15}draw(t){Ii.fillRect(t.context,0,t.pixelTop,t.pixelWidth,t.pixelHeight,{fillStyle:"rgb(255, 255, 255)"}),!0===this.showCoverage&&this.coverageTrack.height>0?(this.trackView.controlCanvas.style.display="block",this.coverageTrack.draw(t)):this.trackView.controlCanvas.style.display="none",!0===this.showAlignments&&(this.alignmentTrack.setTop(this.coverageTrack,this.showCoverage),this.alignmentTrack.draw(t))}paintAxis(t,e,i){this.browser.isMultiLocusMode()?t.clearRect(0,0,e,i):this.coverageTrack.paintAxis(t,e,this.coverageTrack.height)}contextMenuItemList(t){return this.alignmentTrack.contextMenuItemList(t)}popupData(t){return!0===this.showCoverage&&t.y>=this.coverageTrack.top&&t.y<this.coverageTrack.height?this.coverageTrack.popupData(t):this.alignmentTrack.popupData(t)}menuItemList(){let t=["<hr/>"];t=t.concat(In.numericDataMenuItems(this.trackView));const e=Ri('<div class="igv-track-menu-category igv-track-menu-border-top">');e.text("Color by"),t.push({name:void 0,object:e,click:void 0,init:void 0});const i=[{key:"strand",label:"read strand"}];this.alignmentTrack.hasPairs&&(i.push({key:"firstOfPairStrand",label:"first-of-pair strand"}),i.push({key:"pairOrientation",label:"pair orientation"}),i.push({key:"fragmentLength",label:"insert size (TLEN)"}));const n="tag"+(this.alignmentTrack.colorByTag?" ("+this.alignmentTrack.colorByTag+")":"");i.push({key:"tag",label:n});for(let e of i){const i=this.alignmentTrack.colorBy===e.key;t.push(this.colorByCB(e,i))}const r=()=>{if(!this.autoHeight){const t=15+(this.showCoverage?this.coverageTrack.height:0)+(this.showAlignments?this.alignmentTrack.height:0);this.trackView.setTrackHeight(t)}};t.push({object:Ri('<div class="igv-track-menu-border-top">')}),t.push({object:En("Show Coverage",this.showCoverage),click:()=>{this.showCoverage=!this.showCoverage,r(),this.trackView.checkContentHeight(),this.trackView.repaintViews()}}),t.push({object:En("Show Alignments",this.showAlignments),click:()=>{this.showAlignments=!this.showAlignments,r(),this.trackView.checkContentHeight(),this.trackView.repaintViews()}}),t.push({object:Ri('<div class="igv-track-menu-border-top">')}),t.push({object:En("Show all bases",this.showAllBases),click:()=>{this.showAllBases=!this.showAllBases,this.config.showAllBases=this.showAllBases,this.trackView.repaintViews()}}),t.push({object:Ri('<div class="igv-track-menu-border-top">')}),this.pairsSupported&&this.alignmentTrack.hasPairs&&t.push({object:En("View as pairs",this.viewAsPairs),click:()=>{this.viewAsPairs=!this.viewAsPairs,this.config.viewAsPairs=this.viewAsPairs,this.featureSource.setViewAsPairs(this.viewAsPairs);const t=this.getCachedAlignmentContainers();for(let e of t)e.setViewAsPairs(this.viewAsPairs);this.trackView.repaintViews()}}),t.push({object:En("Show soft clips",this.showSoftClips),click:()=>{this.showSoftClips=!this.showSoftClips,this.config.showSoftClips=this.showSoftClips,this.featureSource.setShowSoftClips(this.showSoftClips);const t=this.getCachedAlignmentContainers();for(let e of t)e.setShowSoftClips(this.showSoftClips);this.trackView.repaintViews()}});const s=Ri('<div class="igv-track-menu-category igv-track-menu-border-top">');return s.text("Display mode"),t.push({name:void 0,object:s,click:void 0,init:void 0}),t.push({object:En("expand","EXPANDED"===this.alignmentTrack.displayMode),click:()=>{this.alignmentTrack.displayMode="EXPANDED",this.config.displayMode="EXPANDED",this.trackView.checkContentHeight(),this.trackView.repaintViews()}}),t.push({object:En("squish","SQUISHED"===this.alignmentTrack.displayMode),click:()=>{this.alignmentTrack.displayMode="SQUISHED",this.config.displayMode="SQUISHED",this.trackView.checkContentHeight(),this.trackView.repaintViews()}}),t}colorByCB(t,e){return{name:void 0,object:En(t.label,e),click:e=>{t.key===this.alignmentTrack.colorBy?(this.alignmentTrack.colorBy="none",this.config.colorBy="none",this.trackView.repaintViews()):"tag"===t.key?this.browser.inputDialog.present({label:"Tag Name",value:this.alignmentTrack.colorByTag?this.alignmentTrack.colorByTag:"",callback:t=>{this.alignmentTrack.colorBy="tag",this.config.colorBy="tag",t!==this.alignmentTrack.colorByTag&&(this.alignmentTrack.colorByTag=t,this.config.colorByTag=t,this.alignmentTrack.tagColors=new ao("Set1"),Ri("#color-by-tag").text(self.alignmentTrack.colorByTag)),this.trackView.repaintViews()}},e):(this.alignmentTrack.colorBy=t.key,this.config.colorBy=t.key,this.trackView.repaintViews())},init:void 0}}dispose(){this.trackView=void 0}getState(){const t=super.getState();return this.sortObject&&(t.sort={chr:this.sortObject.chr,position:this.sortObject.position+1,option:this.sortObject.option,direction:this.sortObject.direction?"ASC":"DESC"}),t}getCachedAlignmentContainers(){return this.trackView.viewports.map((t=>t.getCachedFeatures()))}get dataRange(){return this.coverageTrack.dataRange}set dataRange(t){this.coverageTrack.dataRange=t}get logScale(){return this.coverageTrack.logScale}set logScale(t){this.coverageTrack.logScale=t}get autoscale(){return this.coverageTrack.autoscale}set autoscale(t){this.coverageTrack.autoscale=t}}class Ia{constructor(t,e){this.parent=e,this.featureSource=e.featureSource,this.height=void 0!==t.coverageTrackHeight?t.coverageTrackHeight:50,this.paintAxis=Io,this.top=0,this.autoscale=t.autoscale||void 0===t.max,this.autoscale||(this.dataRange={min:t.min||0,max:t.max})}draw(t){const e=t.pixelTop,i=(t.pixelHeight,this.parent.browser.nucleotideColors);if(e>this.height)return;const n=t.context,r=t.features.coverageMap;let s;r.refSeq&&(s=r.refSeq.toUpperCase());const o=t.bpPerPixel,a=t.bpStart,h=a+t.pixelWidth*o+1;let l=this.parent.coverageColor;"rgb(185, 185, 185)"!==this.parent.color&&(l=ct.darkenLighten(this.parent.color,-35)),Ii.setProperties(n,{fillStyle:l,strokeStyle:l});const c=Math.max(1,Math.ceil(1/o));for(let t=0,e=r.coverage.length;t<e;t++){const e=r.bpStart+t;if(e<a)continue;if(e>h)break;const i=r.coverage[t];if(!i)continue;const s=Math.round(i.total/this.dataRange.max*this.height),l=this.height-s,u=Math.floor((e-a)/o);Ii.fillRect(n,u,l,c,s)}if(s)for(let t=0,e=r.coverage.length;t<e;t++){const e=r.bpStart+t;if(e<a)continue;if(e>h)break;const l=r.coverage[t];if(!l)continue;const u=l.total/this.dataRange.max*this.height;let f=this.height-u;const d=Math.floor((e-a)/o),p=s[t];if(l.isMismatch(p)){Ii.setProperties(n,{fillStyle:i[p]}),Ii.fillRect(n,d,f,c,u);let t=0;for(let e of["A","C","T","G"]){const r=(l["pos"+e]+l["neg"+e])/this.dataRange.max*this.height;f=this.height-r-t,t+=r,Ii.setProperties(n,{fillStyle:i[e]}),Ii.fillRect(n,d,f,c,r)}}}}popupData(t){let e=t.viewport.getCachedFeatures();if(!e||0===e.length)return;let i=Math.floor(t.genomicLocation),n=t.viewport.referenceFrame,r=e.coverageMap,s=[],o=Math.floor(i-r.bpStart),a=r.coverage[o];if(a){s.push(n.chr+":"+z(1+i)),s.push({name:"Total Count",value:a.total});let t=a.posA+a.negA;t>0&&(t=t.toString()+" ("+Math.round(t/a.total*100)+"%, "+a.posA+"+, "+a.negA+"- )"),s.push({name:"A",value:t}),t=a.posC+a.negC,t>0&&(t=t.toString()+" ("+Math.round(t/a.total*100)+"%, "+a.posC+"+, "+a.negC+"- )"),s.push({name:"C",value:t}),t=a.posG+a.negG,t>0&&(t=t.toString()+" ("+Math.round(t/a.total*100)+"%, "+a.posG+"+, "+a.negG+"- )"),s.push({name:"G",value:t}),t=a.posT+a.negT,t>0&&(t=t.toString()+" ("+Math.round(t/a.total*100)+"%, "+a.posT+"+, "+a.negT+"- )"),s.push({name:"T",value:t}),t=a.posN+a.negN,t>0&&(t=t.toString()+" ("+Math.round(t/a.total*100)+"%, "+a.posN+"+, "+a.negN+"- )"),s.push({name:"N",value:t}),s.push("<HR/>"),s.push({name:"DEL",value:a.del.toString()}),s.push({name:"INS",value:a.ins.toString()})}return s}}class La{constructor(t,e){this.parent=e,this.browser=e.browser,this.featureSource=e.featureSource,this.top=0===t.coverageTrackHeight?0:t.coverageTrackHeight+5,this.displayMode=t.displayMode||"EXPANDED",this.alignmentRowHeight=t.alignmentRowHeight||14,this.squishedRowHeight=t.squishedRowHeight||3,this.negStrandColor=t.negStrandColor||"rgba(150, 150, 230, 0.75)",this.posStrandColor=t.posStrandColor||"rgba(230, 150, 150, 0.75)",this.insertionColor=t.insertionColor||"rgb(138, 94, 161)",this.deletionColor=t.deletionColor||"black",this.skippedColor=t.skippedColor||"rgb(150, 170, 170)",this.pairConnectorColor=t.pairConnectorColor,this.smallFragmentLengthColor=t.smallFragmentLengthColor||"rgb(0, 0, 150)",this.largeFragmentLengthColor=t.largeFragmentLengthColor||"rgb(200, 0, 0)",this.pairOrientation=t.pairOrienation||"fr",this.pairColors={},this.pairColors.RL=t.rlColor||"rgb(0, 150, 0)",this.pairColors.RR=t.rrColor||"rgb(20, 50, 200)",this.pairColors.LL=t.llColor||"rgb(0, 150, 150)",this.colorBy=t.colorBy||"pairOrientation",this.colorByTag=t.colorByTag?t.colorByTag.toUpperCase():void 0,this.bamColorTag=void 0===t.bamColorTag?"YC":t.bamColorTag,this.hideSmallIndels=t.hideSmallIndels,this.indelSizeThreshold=t.indelSizeThreshold||1,this.hasPairs=!1}setTop(t,e){this.top=0===t.height||!1===e?0:5+t.height}computePixelHeight(t){if(t.packedAlignmentRows){return(t.hasDownsampledIntervals()?10:0)+("SQUISHED"===this.displayMode?this.squishedRowHeight:this.alignmentRowHeight)*t.packedAlignmentRows.length+5}return 0}draw(t){const e=t.features,i=t.context,n=t.bpPerPixel,r=t.bpStart,s=t.pixelWidth,o=r+s*n+1,a=e.packedAlignmentRows,h=this.parent.showSoftClips,l=this.parent.showAllBases,c=this.browser.nucleotideColors;let u=e.sequence;u&&(u=u.toUpperCase());let f=0,d=t.pixelTop;i.save(),this.top&&i.translate(0,this.top);const p=d+t.pixelHeight;e.hasDownsampledIntervals()?(f=10,e.downsampledIntervals.forEach((function(t){var e=(t.start-r)/n,s=(t.end-r)/n;s-e>5&&(e+=1,s-=1),Ii.fillRect(i,e,2,s-e,3,{fillStyle:"black"})}))):f=0,this.alignmentsYOffset=f;const g="SQUISHED"===this.displayMode?this.squishedRowHeight:this.alignmentRowHeight;if(a){const t=a.length;for(let e=0;e<t;e++){const t=a[e],i=f+g*e,n=g<=4?g:g-2;if(i>p)break;if(!(i+n<d))for(let e of t.alignments)if(this.hasPairs=this.hasPairs||e.isPaired(),!(e.start+e.lengthOnRef<r)){if(e.start>o)break;!0!==e.hidden&&(e instanceof Po?(m.call(this,e,i,n),b.call(this,e.firstAlignment,i,n),e.secondAlignment&&b.call(this,e.secondAlignment,i,n)):b.call(this,e,i,n))}}}function m(t,e,s){var a=this.getConnectorColor(t.firstAlignment),h=(t.connectingStart-r)/n,l=(t.connectingEnd-r)/n,c=e+s/2;t.connectingEnd<r||t.connectingStart>o||(t.mq<=0&&(a=ct.addAlpha(a,.15)),Ii.setProperties(i,{fillStyle:a,strokeStyle:a}),Ii.strokeLine(i,h,c,l,c))}function b(t,s,a){if(t.start+t.lengthOnRef<r||t.start>o)return;const f=h?t.blocks:t.blocks.filter((t=>"S"!==t.type));let d=this.getAlignmentColor(t);const p=d;t.mq<=0&&(d=ct.addAlpha(d,.15)),Ii.setProperties(i,{fillStyle:d,strokeStyle:p});for(let t=0;t<f.length;t++){const e=f[t];if(!(t!==f.length-1&&f[t+1].start<r)&&(m.call(this,e,t),e.start+e.len>o))break}if(t.insertions){let e=-1;for(let h of t.insertions){if(this.hideSmallIndels&&h.len<=this.indelSizeThreshold)continue;if(h.start<r)continue;if(h.start>o)break;const t=(h.start-r)/n-1;if(t-e>2){const n=3;Ii.fillRect(i,t,s-1,n,a+2,{fillStyle:this.insertionColor}),e=t}}}if(t.gaps){const e=s+a/2;for(let s of t.gaps){const t=(s.start-r)/n,o=(s.start+s.len-r)/n,a="D"===s.type?this.deletionColor:this.skippedColor;Ii.strokeLine(i,t,e,o,e,{strokeStyle:a})}}function m(o,h){const m=o.start-e.start,w=(o.start-r)/n,v=(o.start+o.len-r)/n,y=Math.max(1,v-w),x=g/2,k="S"===o.type,S=t.mq<=0||this.highlightedAlignmentReadNamed===t.readName||k;let _=p;this.highlightedAlignmentReadNamed===t.readName?_="red":k&&(_="rgb(50,50,50)");const C=!0===t.strand&&h===f.length-1,E=!1===t.strand&&0===h;if(C|E){let t,e;C?(t=[w,v,v+x,v,w,w],e=[s,s,s+a/2,s+a,s+a,s]):E&&(t=[v,w,w-x,w,v,v],e=[s,s,s+a/2,s+a,s+a,s]),Ii.fillPolygon(i,t,e,{fillStyle:d}),S&&Ii.strokePolygon(i,t,e,{strokeStyle:_})}else Ii.fillRect(i,w,s,y,a,{fillStyle:d}),S&&(i.save(),i.strokeStyle=_,i.strokeRect(w,s,y,a),i.restore());if(this.parent.showMismatches&&(k||l||u&&t.seq&&"*"!==t.seq)){const e=t.seq?t.seq.toUpperCase():void 0,h=t.qual,f=o.seqOffset;for(let t=0,d=o.len;t<d;t++){if(m+t<0)continue;let d=e?e.charAt(f+t):"";const p=u.charAt(m+t);if("="===d&&(d=p),"X"===d||p!==d||k||l){let e;if(!k&&void 0!==h&&h.length>f+t){e=Fa(h[f+t],c[d])}else e=c[d];if(e){const h=(o.start+t-r)/n,l=Math.max(1,1/n);b(i,n,{x:h,y:s,width:l,height:a},e,d)}}}}}function b(t,e,i,n,r){var s;if(.1,e<=.1&&i.height>=8){const e=Math.min(10,i.height);t.font=e+"px sans-serif",s=i.x+i.width/2,Ii.strokeText(t,r,s-t.measureText(r).width/2,e-1+i.y,{strokeStyle:n})}else Ii.fillRect(t,i.x,i.y,i.width,i.height,{fillStyle:n})}}i.restore()}popupData(t){const e=this.getClickedObject(t.viewport,t.y,t.genomicLocation);return e?e.popupData(t.genomicLocation):void 0}contextMenuItemList(t){const e=t.viewport,i=this.parent.showSoftClips,n=this.getClickedObject(e,t.y,t.genomicLocation),r=n&&"function"==typeof n.alignmentContaining?n.alignmentContaining(t.genomicLocation,i):n,s=(r&&n.isPaired,[]),o=i=>{const n=this.parent.sortObject,r=!n||n.position!==Math.floor(t.genomicLocation)||!n.direction,s={chr:e.referenceFrame.chr,position:Math.floor(t.genomicLocation),sortOption:i,direction:r};this.parent.sortObject=s,Ma(s,e.getCachedFeatures()),e.repaint()};return s.push("<b>Sort by...</b>"),s.push({label:"&nbsp; base",click:()=>o("BASE")}),s.push({label:"&nbsp; read strand",click:()=>o("STRAND")}),s.push({label:"&nbsp; insert size",click:()=>o("INSERT_SIZE")}),s.push({label:"&nbsp; gap size",click:()=>o("GAP_SIZE")}),s.push({label:"&nbsp; chromosome of mate",click:()=>o("MATE_CHR")}),s.push({label:"&nbsp; mapping quality",click:()=>o("MQ")}),s.push({label:"&nbsp; tag",click:()=>{const i=this.parent.sortObject,n=!i||i.position!==Math.floor(t.genomicLocation)||!i.direction,r={label:"Tag Name",value:this.sortByTag?this.sortByTag:"",callback:i=>{if(i){const r={chr:e.referenceFrame.chr,position:Math.floor(t.genomicLocation),sortOption:"TAG",tag:i,direction:n};this.sortByTag=i,this.parent.sortObject=r,Ma(r,e.getCachedFeatures()),e.repaint()}}};this.browser.inputDialog.present(r,t.event)}}),s.push("<hr/>"),r.isPaired()&&r.isMateMapped()&&s.push({label:"View mate in split screen",click:()=>{r.mate&&(this.highlightedAlignmentReadNamed=r.readName,this.browser.presentSplitScreenMultiLocusPanel(r,t.viewport.referenceFrame))},init:void 0}),s.push({label:"View read sequence",click:()=>{if(!r)return;const t=r.seq;t&&"*"!==t?v.presentAlert(t):v.presentAlert("Read sequence: *")}}),s.push("<hr/>"),s}getClickedObject(t,e,i){const n=this.parent.showSoftClips;let r=t.getCachedFeatures();if(!r||0===r.length)return;let s=r.packedAlignmentRows,o=r.downsampledIntervals;const a="SQUISHED"===this.displayMode?this.squishedRowHeight:this.alignmentRowHeight;let h=Math.floor((e-this.top-this.alignmentsYOffset)/a);if(h<0){for(let t=0;t<o.length;t++)if(o[t].start<=i&&o[t].end>=i)return o[t]}else if(h<s.length){const t=s[h].alignments.filter((t=>t.containsLocation(i,n)));if(t.length>0)return t[0]}}getConnectorColor(t){if(this.pairConnectorColor)return this.pairConnectorColor;switch(this.colorBy){case"strand":case"firstOfPairStrand":case"pairOrientation":case"tag":return this.parent.color||"rgb(200, 200, 200)";default:return this.getAlignmentColor(t)}}getAlignmentColor(t){let e=this.parent.color;switch(this.colorBy){case"strand":e=t.strand?this.posStrandColor:this.negStrandColor;break;case"firstOfPairStrand":t instanceof Po?e=t.firstOfPairStrand()?this.posStrandColor:this.negStrandColor:t.isPaired()&&(t.isFirstOfPair()?e=t.strand?this.posStrandColor:this.negStrandColor:t.isSecondOfPair()?e=t.strand?this.negStrandColor:this.posStrandColor:console.error("ERROR. Paired alignments are either first or second."));break;case"pairOrientation":if(t.mate&&t.isMateMapped()&&t.mate.chr!==t.chr)e=Ba(t.mate.chr);else if(this.pairOrientation&&t.pairOrientation){var i=Da[this.pairOrientation];if(i){var n=this.pairColors[i[t.pairOrientation]];n&&(e=n)}}break;case"fragmentLength":t.mate&&t.isMateMapped()&&t.mate.chr!==t.chr?e=Ba(t.mate.chr):this.parent.minFragmentLength&&Math.abs(t.fragmentLength)<this.parent.minFragmentLength?e=this.smallFragmentLengthColor:this.parent.maxFragmentLength&&Math.abs(t.fragmentLength)>this.parent.maxFragmentLength&&(e=this.largeFragmentLengthColor);break;case"tag":const r=t.tags()[this.colorByTag];void 0!==r&&(this.bamColorTag===this.colorByTag?e="rgb("+r+")":(this.tagColors||(this.tagColors=new ao("Set1")),e=this.tagColors.getColor(r)));break;default:e=this.parent.color}return e}}function Ma(t,e){const i=t.direction;for(let i of e.packedAlignmentRows)i.updateScore(t,e);e.packedAlignmentRows.sort((function(t,e){const n=t.score>e.score?1:t.score<e.score?-1:0;return!0===i?n:-n}))}function Fa(t,e){let i;return i=t<5?.1:Math.max(.1,Math.min(1,.1+.9*(t-5)/15)),i=Math.round(10*i)/10,i<1&&(e=ct.addAlpha(e,i)),e}const Da={fr:{F1R2:"LR",F2R1:"LR",F1F2:"LL",F2F1:"LL",R1R2:"RR",R2R1:"RR",R1F2:"RL",R2F1:"RL"},rf:{R1F2:"LR",R2F1:"LR",R1R2:"LL",R2R1:"LL",F1F2:"RR",F2F1:"RR",F1R2:"RL",F2R1:"RL"},ff:{F2F1:"LR",R1R2:"LR",F2R1:"LL",R1F2:"LL",R2F1:"RR",F1R2:"RR",R2R1:"RL",F1F2:"RL"}};function Ba(t){if(Na[t])return Na[t];if(Na["chr"+t]){const e=Na["chr"+t];return Na[t]=e,e}{const e=ct.randomRGB();return Na[t]=e,e}}const Na={chrX:"rgb(204, 153, 0)",chrY:"rgb(153, 204, 0",chrUn:"rgb(50, 50, 50)",chr1:"rgb(80, 80, 255)",chrI:"rgb(139, 155, 187)",chr2:"rgb(206, 61, 50)",chrII:"rgb(206, 61, 50)",chr2a:"rgb(216, 71, 60)",chr2b:"rgb(226, 81, 70)",chr3:"rgb(116, 155, 88)",chrIII:"rgb(116, 155, 88)",chr4:"rgb(240, 230, 133)",chrIV:"rgb(240, 230, 133)",chr5:"rgb(70, 105, 131)",chr6:"rgb(186, 99, 56)",chr7:"rgb(93, 177, 221)",chr8:"rgb(128, 34, 104)",chr9:"rgb(107, 215, 107)",chr10:"rgb(213, 149, 167)",chr11:"rgb(146, 72, 34)",chr12:"rgb(131, 123, 141)",chr13:"rgb(199, 81, 39)",chr14:"rgb(213, 143, 92)",chr15:"rgb(122, 101, 165)",chr16:"rgb(228, 175, 105)",chr17:"rgb(59, 27, 83)",chr18:"rgb(205, 222, 183)",chr19:"rgb(97, 42, 121)",chr20:"rgb(174, 31, 99)",chr21:"rgb(231, 199, 111)",chr22:"rgb(90, 101, 94)",chr23:"rgb(204, 153, 0)",chr24:"rgb(153, 204, 0)",chr25:"rgb(51, 204, 0)",chr26:"rgb(0, 204, 51)",chr27:"rgb(0, 204, 153)",chr28:"rgb(0, 153, 204)",chr29:"rgb(10, 71, 255)",chr30:"rgb(71, 117, 255)",chr31:"rgb(255, 194, 10)",chr32:"rgb(255, 209, 71)",chr33:"rgb(153, 0, 51)",chr34:"rgb(153, 26, 0)",chr35:"rgb(153, 102, 0)",chr36:"rgb(128, 153, 0)",chr37:"rgb(51, 153, 0)",chr38:"rgb(0, 153, 26)",chr39:"rgb(0, 153, 102)",chr40:"rgb(0, 128, 153)",chr41:"rgb(0, 51, 153)",chr42:"rgb(26, 0, 153)",chr43:"rgb(102, 0, 153)",chr44:"rgb(153, 0, 128)",chr45:"rgb(214, 0, 71)",chr46:"rgb(255, 20, 99)",chr47:"rgb(0, 214, 143)",chr48:"rgb(20, 255, 177)"};class Pa extends Pr{constructor(t,e){super(t,e),this.theta=t.theta||Math.PI/4,this.sinTheta=Math.sin(this.theta),this.cosTheta=Math.cos(this.theta),this.height=t.height||250,this.arcType=t.arcType||"nested",this.arcOrientation=void 0===t.arcOrientation||t.arcOrientation,this.showBlocks=void 0===t.showBlocks||t.showBlocks,this.blockHeight=t.blockHeight||3,this.thickness=t.thickness||1,this.color=t.color||"rgb(180,25,137)",this.alpha=t.alpha||.15,t.valueColumn?(this.valueColumn=t.valueColumn,this.hasValue=!0):t.useScore&&(this.hasValue=!0,this.valueColumn="score"),this.logScale=!1!==t.logScale,t.max?(this.dataRange={min:t.min||0,max:t.max},this.autoscale=!1):this.autoscale=!0,this.featureSource=so(t,e.genome),this.featureSource.getWGFeatures=$a}async postInit(){return"function"==typeof this.featureSource.getHeader&&(this.header=await this.featureSource.getHeader()),this.header&&this.setTrackProperties(this.header),void 0===this.visibilityWindow&&"function"==typeof this.featureSource.defaultVisibilityWindow&&(this.visibilityWindow=await this.featureSource.defaultVisibilityWindow(),this.featureSource.visibilityWindow=this.visibilityWindow),this}supportsWholeGenome(){return!0}async getFeatures(t,e,i){const n=this.visibilityWindow,r=await this.featureSource.getFeatures({chr:t,start:e,end:i,visibilityWindow:n});return void 0===this.hasValue&&r&&r.length>0&&(this.hasValue=void 0!==r[0].score),r}draw(t){"proportional"===this.arcType?this.drawProportional(t):this.drawNested(t)}drawNested(t){const e=t.context,i=t.pixelWidth,n=t.pixelHeight,r=t.viewportWidth,s=t.bpPerPixel,o=t.bpStart,a=s;Ii.fillRect(e,0,t.pixelTop,i,n,{fillStyle:"rgb(255, 255, 255)"});const h=t.features;if(h){(function(){let t=0;for(let e of h){let n=(e.start-o)/a,r=(e.end-o)/a;r>=0&&n<=i&&(t=Math.max(t,r-n))}let e=Math.min(r,t)/2;if(t>0){let t=(n-10)/e;this.theta=function(t){let e,i=[.01570925532366355,.15838444032453644,.3249196962329063,.5095254494944288,.7265425280053609,.9999999999999999],n=[.031415926535897934,.3141592653589793,.6283185307179586,.9424777960769379,1.2566370614359172,1.5707963267948966];for(e=0;e<i.length&&!(i[e]>t);e++);let r=0===e?0:i[e-1],s=e<i.length?i[e]:1,o=(t-r)/(s-r),a=0===e?0:n[e-1],h=e<n.length?n[e]:Math.PI/2;return a+o*(h-a)}(t),this.sinTheta=Math.sin(this.theta),this.cosTheta=Math.cos(this.theta)}}).call(this);const s=this.arcOrientation?t.pixelHeight:0,c=this.arcOrientation;e.font="8px",e.textAlign="center";for(let t of h){let n=t.color||this.color;if(n&&this.config.useScore&&(n=Ua(n,(l=t.score,Math.min(1,.11+l/779*.89).toString()))),e.lineWidth=t.thickness||this.thickness||1,t.chr1===t.chr2||"all"===t.chr){const{m1:h,m2:l}=Oa(t,this.browser.genome);let u=Math.round((h-o)/a),f=Math.round((l-o)/a);if(f<0||u>i)continue;let d=f-u;d<3&&(d=3,u--);const p=d/2,g=p/this.sinTheta,m=this.cosTheta*g,b=u+p;let w,v,y;if(c?(w=this.height+m,v=Math.PI+Math.PI/2-this.theta,y=Math.PI+Math.PI/2+this.theta):(w=-m,v=Math.PI/2-this.theta,y=Math.PI/2+this.theta),this.showBlocks&&"all"!==t.chr){const i=(t.start1-o)/a,n=(t.end1-o)/a,r=(t.start2-o)/a,h=(t.end2-o)/a,l=this.arcOrientation?-this.blockHeight:this.blockHeight;e.fillRect(i,s,n-i,l),e.fillRect(r,s,h-r,l)}n&&!this.config.useScore&&d>r&&(n=Ua(n,this.alpha)),e.strokeStyle=n,e.fillStyle=n,e.beginPath(),e.arc(b,w,g,v,y,!1),e.stroke(),t.drawState={xc:b,yc:w,r:g}}else{let r=Math.round((t.start-o)/a),s=Math.round((t.end-o)/a);if(s<0||r>i)continue;let h=s-r;h<3&&(h=3,r--);const l=t.chr===t.chr1?t.chr2:t.chr1;e.strokeStyle=n,e.fillStyle=n,c?(e.fillRect(r,this.height/2,h,this.height/2),e.fillText(l,r+h/2,this.height/2-5),t.drawState={x:r,y:this.height/2,w:h,h:this.height/2}):(e.fillRect(r,0,h,this.height/2),e.fillText(l,r+h/2,this.height/2+13),t.drawState={x:r,y:0,w:h,h:this.height/2})}}}var l}drawProportional(t){const e=t.context,i=t.pixelWidth,n=t.pixelHeight,r=t.bpPerPixel,s=t.bpStart,o=r;Ii.fillRect(e,0,t.pixelTop,i,n,{fillStyle:"rgb(255, 255, 255)"});const a=t.features;if(a&&a.length>0){const n=this.logScale?t.pixelHeight/Math.log10(this.dataRange.max+1):t.pixelHeight/(this.dataRange.max-this.dataRange.min),r=this.arcOrientation?t.pixelHeight:0;for(let t of a){e.save();const a=this.valueColumn?t[this.valueColumn]:t.score;if(void 0===a||Number.isNaN(a))continue;const h=this.logScale?Math.log10(a+1)*n:a*n;if(t.chr1===t.chr2||"all"===t.chr){const{m1:n,m2:l}=Oa(t,this.browser.genome);let c=(n-s)/o,u=(l-s)/o,f=u-c;if(f<3&&(f=3,c--),u<0||c>i||a<this.dataRange.min)continue;const d=f/2,p=c+f/2,g=!!this.arcOrientation,m=t.color||this.color;if(e.strokeStyle=m,e.lineWidth=t.thickness||this.thickness||1,e.beginPath(),e.ellipse(p,r,d,h,0,0,Math.PI,g),e.stroke(),this.showBlocks&&"all"!==t.chr){e.fillStyle=m;const i=(t.start1-s)/o,n=(t.end1-s)/o,a=(t.start2-s)/o,h=(t.end2-s)/o,l=this.arcOrientation?-this.blockHeight:this.blockHeight;e.fillRect(i,r,n-i,l),e.fillRect(a,r,h-a,l)}if(this.alpha){const t=Ua(m,this.alpha);e.fillStyle=t,e.fill()}e.restore(),t.drawState={xc:p,yc:r,radiusX:d,radiusY:h}}else{let n=Math.round((t.start-s)/o),r=Math.round((t.end-s)/o);if(r<0||n>i||a<this.dataRange.min)continue;const l=Math.min(h,this.height-13);let c=r-n;c<3&&(c=3,n--);const u=t.chr===t.chr1?t.chr2:t.chr1;if(e.font="8px",e.textAlign="center",this.arcOrientation){const i=this.height-l;e.fillRect(n,i,c,l),e.fillText(u,n+c/2,i-5),t.drawState={x:n,y:i,w:c,h:l}}else e.fillRect(n,0,c,l),e.fillText(u,n+c/2,l+13),t.drawState={x:n,y:0,w:c,h:l}}}}}menuItemList(){let t=[{name:"Set track color",click:()=>{this.trackView.presentColorPicker()}},"<HR/>"];if(this.hasValue){const e={nested:"Nested Arcs",proportional:"Proportional Arcs"};for(let i of["nested","proportional"])t.push({object:En(e[i],i===this.arcType),click:()=>{this.arcType=i,this.trackView.repaintViews()}})}return t.push({object:En("Show Blocks",this.showBlocks),click:()=>{this.showBlocks=!this.showBlocks,this.trackView.repaintViews()}}),t.push({name:"Toggle arc direction",click:()=>{this.arcOrientation=!this.arcOrientation,this.trackView.repaintViews()}}),"proportional"===this.arcType&&(t.push("<HR>"),t=t.concat(In.numericDataMenuItems(this.trackView))),t}doAutoscale(t){let e=0;if(t)for(let i of t){const t=this.valueColumn?i[this.valueColumn]:i.score;Number.isNaN(t)||(e=Math.max(e,t))}return{min:0,max:e}}popupData(t,e){e||(e=this.clickedFeatures(t));const i=[];for(let t of e){const e=t._||t;if(i.push({name:"Region 1",value:za(e.chr1,e.start1,e.end1,e.strand1)}),i.push({name:"Region 2",value:za(e.chr2,e.start2,e.end2,e.strand2)}),e.name&&i.push({name:"Name",value:e.name}),void 0!==e.value&&i.push({name:"Value",value:e.value}),void 0!==e.score&&i.push({name:"Score",value:e.score}),e.extras&&this.header&&this.header.columnNames){const t=this.header.columnNames;for(let n=10;n<t.length;n++)"info"===t[n]?qa(i,e.extras[n-10]):i.push({name:t[n],value:e.extras[n-10]})}break}return i}clickedFeatures(t){const e=t.viewport.getCachedFeatures(),i=[];if(e){const n="proportional"===this.arcType;for(let r of e)if(r.drawState)if(r.chr1===r.chr2||"all"===r.chr)if(n){const{xc:e,yc:n,radiusX:s,radiusY:o}=r.drawState,a=t.canvasX-e,h=t.canvasY-n,l=a/s*(a/s)+h/o*(h/o);l<=1&&i.push({score:1/l,feature:r})}else{const{xc:e,yc:n,r:s}=r.drawState,o=t.canvasX-e,a=t.canvasY-n,h=Math.abs(Math.sqrt(o*o+a*a)-s);h<5&&i.push({score:h,feature:r})}else{const{x:e,y:n,w:s,h:o}=r.drawState,a=5;if(t.canvasX>=e-a&&t.canvasX<=e+s+a&&t.canvasY>=n&&t.canvasY<=n+o){const n=-Math.abs(t.canvasX-(e+s/2));i.push({score:n,feature:r});break}}}return i.length>1&&i.sort(((t,e)=>t.score-e.score)),i.map((t=>t.feature))}}function Oa(t,e){let i=(t.start1+t.end1)/2,n=(t.start2+t.end2)/2;if("all"===t.chr&&(i=e.getGenomeCoordinate(t.chr1,i),n=e.getGenomeCoordinate(t.chr2,n)),i>n){const t=i;i=n,n=t}return{m1:i,m2:n}}function za(t,e,i,n){return n&&"."!==n?`${t}:${z(e+1)}-${z(i)} (${n})`:`${t}:${z(e+1)}-${z(i)}`}const Ha=new Map;function Ua(t,e){const i=`${t}_${e}`;let n=Ha.get(i);return n||(n=ct.addAlpha(t,e),Ha.set(i,n)),n}function $a(t){const e=this.genome,i=[];for(let n of e.wgChromosomeNames){const r=t[n];if(r)for(let t of r)if(!t.dup){const n=Object.assign({},t);n.chr="all",n.start=e.getGenomeCoordinate(t.chr1,t.start1),n.end=e.getGenomeCoordinate(t.chr2,t.end2),i.push(n)}}return i}function qa(t,e){const i=e.split(";");for(let e of i){const i=e.split("=");2===i.length&&t.push({name:i[0],value:i[1]})}}const Va=O;class ja extends Pr{constructor(t,e){super(t,e),this.visibilityWindow=t.visibilityWindow,this.displayMode=t.displayMode||"EXPANDED",this.labelDisplayMode=t.labelDisplayMode,this.variantHeight=t.variantHeight||10,this.squishedCallHeight=t.squishedCallHeight||1,this.expandedCallHeight=t.expandedCallHeight||10,this.expandedVGap=void 0!==t.expandedVGap?t.expandedVGap:2,this.squishedVGap=void 0!==t.squishedVGap?t.squishedVGap:1,this.expandedGroupGap=t.expandedGroupGap||10,this.squishedGroupGap=t.squishedGroupGap||5,this.featureHeight=t.featureHeight||14,this.visibilityWindow=t.visibilityWindow,this.featureSource=so(t,e.genome),this.noCallColor=t.noCallColor||"rgb(245, 245, 245)",this.nonRefColor=t.nonRefColor||"rgb(200, 200, 215)",this.mixedColor=t.mixedColor||"rgb(200, 220, 200)",this.homrefColor=t.homrefColor||"rgb(200, 200, 200)",this.homvarColor=t.homvarColor||"rgb(17,248,254)",this.hetvarColor=t.hetvarColor||"rgb(34,12,253)",this.sortDirection="ASC",this.type=t.type||"variant",this.nRows=1}async postInit(){await this.getHeader();if(void 0===this.visibilityWindow&&!1!==this.config.indexed){const t=this.config.url instanceof File?this.config.url.name:this.config.url;if(Va(t)&&t.toLowerCase().includes("gnomad"))this.visibilityWindow=1e3;else if(this.callSets){const t=this.callSets.length;this.visibilityWindow=Math.max(1e3,1e6-1e4*t)}else this.visibilityWindow=1e6}return this}supportsWholeGenome(){return!1===this.config.indexed&&!1!==this.config.supportsWholeGenome}async getHeader(){if(this.header)return this.header;if("function"==typeof this.featureSource.getHeader){const t=await this.featureSource.getHeader();return t&&(this.callSets=t.callSets||[]),this.header=t,t}this.callSets=[]}getCallsetsLength(){return this.callSets.length}async getFeatures(t,e,i,n){return void 0===this.header&&(this.header=await this.getHeader()),this.featureSource.getFeatures({chr:t,start:e,end:i,bpPerPixel:n,visibilityWindow:this.visibilityWindow})}computePixelHeight(t){if("COLLAPSED"===this.displayMode)return this.nRows=1,10+this.variantHeight;{var e=0;if(t)for(let i of t)i.row&&i.row>e&&(e=i.row);const i="EXPANDED"===this.displayMode?this.expandedVGap:this.squishedVGap;this.nRows=e+1;const n=10+this.nRows*(this.variantHeight+i);this.variantBandHeight=n;const r="EXPANDED"===this.displayMode?this.expandedCallHeight:this.squishedCallHeight;return n+i+(this.getCallsetsLength()*this.nRows+1)*(r+i)}}draw(t){const e=t.context,i=this.callSets,n=this.getCallsetsLength(),r=t.pixelWidth,s=t.pixelHeight,o="EXPANDED"===this.displayMode?this.expandedCallHeight:this.squishedCallHeight,a=t.bpPerPixel,h=t.bpStart,l=h+r*a+1;Ii.fillRect(e,0,t.pixelTop,r,s,{fillStyle:"rgb(255, 255, 255)"});const c="EXPANDED"===this.displayMode?this.expandedVGap:this.squishedVGap;i&&n>0&&"COLLAPSED"!==this.displayMode&&Ii.strokeLine(e,0,this.variantBandHeight,r,this.variantBandHeight,{strokeStyle:"rgb(224,224,224) "});const u=t.features;if(u)for(let t of u){if(t.end<h)continue;if(t.start>l)break;const r=10+("COLLAPSED"===this.displayMode?0:t.row*(this.variantHeight+c)),s=this.variantHeight;let u=Math.round((t.start-h)/a),f=Math.round((t.end-h)/a),d=Math.max(1,f-u);if(d<3?(d=3,u-=1):d>5&&(u+=1,d-=2),"NONVARIANT"===t.type?e.fillStyle=this.nonRefColor:"MIXED"===t.type?e.fillStyle=this.mixedColor:e.fillStyle=this.color||this.defaultColor,e.fillRect(u,r,d,s),n>0&&t.calls&&"COLLAPSED"!==this.displayMode){let n=0;for(let r of i){const i=t.calls[r.id];if(i){const r=this.variantBandHeight+c+(n+t.row)*(o+c);let s=!0,a=!0,h=!1;for(let t of i.genotype){if("."===t){h=!0;break}0!==t&&(a=!1),0===t&&(s=!1)}e.fillStyle=h?this.noCallColor:a?this.homrefColor:s?this.homvarColor:this.hetvarColor,e.fillRect(u,r,d,o)}n++}}}}popupData(t,e){e||(e=this.clickedFeatures(t));const i=t.genomicLocation,n=this.browser.genome.id,r=[],s=this.browser.sampleInformation;for(let a of e)if(r.length>0&&r.push("<HR>"),"COLLAPSED"===this.displayMode)Array.prototype.push.apply(r,a.popupData(i,this.type));else{const e=t.y,h="EXPANDED"===this.displayMode?this.expandedVGap:this.squishedVGap;if(e<=this.variantBandHeight){const t=Math.floor((e-10)/(this.variantHeight+h));a.row===t&&Array.prototype.push.apply(r,a.popupData(i,n),this.type)}else{const t=this.callSets;if(t&&a.calls){const i=this.nRows*("SQUISHED"===this.displayMode?this.squishedCallHeight:this.expandedCallHeight),l=Math.floor((e-this.variantBandHeight)/(i+h));if(l>=0&&l<t.length){const e=t[l],i=a.calls[e.id];Array.prototype.push.apply(r,o(i,a,n,s))}}}}return r;function o(t,e,i,n){let r="";const s=e.alternateBases.split(",");for(let i of t.genotype){if("."===i){r+="No Call";break}if(0===i)r+=e.referenceBases;else{r+=s[i-1].replace("<","&lt;")}}let o=[];if(void 0!==t.callSetName&&o.push({name:"Name",value:t.callSetName}),o.push({name:"Genotype",value:r}),void 0!==t.phaseset&&o.push({name:"Phase set",value:t.phaseset}),void 0!==t.genotypeLikelihood&&o.push({name:"genotypeLikelihood",value:t.genotypeLikelihood.toString()}),n){var a=n.getAttributes(t.callSetName);a&&Object.keys(a).forEach((function(t){var e=t.replace(/([A-Z])/g," $1");e=e.charAt(0).toUpperCase()+e.slice(1),o.push({name:e,value:a[t]})}))}var h=Object.keys(t.info);h.length&&o.push("<hr>"),h.forEach((function(e){o.push({name:e,value:t.info[e]})}));let l=[];return l.length>0&&(o.push("<HR/>"),o=o.concat(l)),o}}menuItemList(){var t=this,e=[];return e.push({object:Ri('<div class="igv-track-menu-border-top">')}),["COLLAPSED","SQUISHED","EXPANDED"].forEach((function(i){e.push({object:En({COLLAPSED:"Collapse",SQUISHED:"Squish",EXPANDED:"Expand"}[i],i===t.displayMode),click:function(){t.displayMode=i,t.trackView.checkContentHeight(),t.trackView.repaintViews()}})})),e}}class Wa extends Pr{constructor(t,e){super(t,e),this.config=t,this.url=t.url,this.name=t.name,this.pValueField=t.pValueField||"pValue",this.geneField=t.geneField||"geneSymbol",this.snpField=t.snpField||"snp";const i=t.minLogP||t.min,n=t.maxLogP||t.max;this.dataRange={min:i||3.5,max:n||25},this.autoscale=!n||t.autoscale,this.autoscalePercentile=void 0===t.autoscalePercentile?98:t.autoscalePercentile,this.background=t.background,this.divider=t.divider||"rgb(225,225,225)",this.dotSize=t.dotSize||2,this.height=t.height||100,this.autoHeight=!1,this.disableButtons=t.disableButtons,this.visibilityWindow=void 0===t.visibilityWindow?2e6:t.visibilityWindow>=0?Math.min(2e6,t.visibilityWindow):2e6,this.featureSource=so(t,e.genome),co.gtexLoaded=!0}paintAxis(t,e,i){const n=(this.dataRange.max-this.dataRange.min)/i,r={font:"normal 10px Arial",textAlign:"right",strokeStyle:"black"};Ii.fillRect(t,0,0,e,i,{fillStyle:"rgb(255, 255, 255)"});const s=Math.ceil(10*(this.dataRange.max-this.dataRange.min)/i);for(let o=4;o<=this.dataRange.max;o+=s){const s=.85*e,a=s-5,h=s,l=i-(o-this.dataRange.min)/n;Ii.strokeLine(t,a,l,h,l,r),l>8&&Ii.fillText(t,o,a-1,l+2,r)}r.textAlign="center",Ii.fillText(t,"-log10(pvalue)",e/4,i/2,r,{rotate:{angle:-90}})}async getFeatures(t,e,i){const n=this.pValueField,r=await this.featureSource.getFeatures({chr:t,start:e,end:i});return r.forEach((function(t){t.value=t[n]})),r}draw(t){const e=t.context,i=t.pixelWidth,n=t.pixelHeight;this.background&&Ii.fillRect(e,0,0,i,n,{fillStyle:this.background}),Ii.strokeLine(e,0,n-1,i,n-1,{strokeStyle:this.divider}),e.save();const r=r=>{const s=r?2*this.dotSize:this.dotSize,o=t.bpStart,a=(this.dataRange.max-this.dataRange.min)/n,h=t.referenceFrame.selection;for(let c of t.features){const u=(c.start-o+.5)/t.bpPerPixel;if(u<0)continue;if(u>i)break;const f=c.snp.toUpperCase(),d=c[this.geneField].toUpperCase(),p=h&&(h.snp===f||h.gene===d);if(!r||p){h&&h.snp===f&&h.addGene(d);var l=-Math.log(c[this.pValueField])/Math.LN10;if(l>=this.dataRange.min){let t;l>this.dataRange.max?(l=this.dataRange.max,t=!0):t=!1;const i=Math.max(0+s,n-Math.round((l-this.dataRange.min)/a));let o;c.px=u,c.py=i,c.radius=s,r&&h?(o=h.colorForGene(d),Ii.setProperties(e,{fillStyle:o,strokeStyle:"black"})):(o=t?"rgb(150, 150, 150)":"rgb(180, 180, 180)",Ii.setProperties(e,{fillStyle:o,strokeStyle:o})),Ii.fillCircle(e,u,i,s),Ii.strokeCircle(e,u,i,s)}}}};r(!1),r(!0),e.restore()}popupData(t){let e=t.viewport.getCachedFeatures();if(!e||0===e.length)return[];const i=this.name,n=[];for(let r of e)Math.abs(r.px-t.canvasX)<r.radius+3&&Math.abs(r.py-t.canvasY)<r.radius+3&&(n.length>0&&n.push("<hr>"),n.push({name:"snp id",value:r.snp},{name:"gene id",value:r.geneId},{name:"gene name",value:r.geneName},{name:"p value",value:r.pValue},{name:"tissue",value:i}));return n}menuItemList(){return In.numericDataMenuItems(this.trackView)}doAutoscale(t){if(t.length>0){var e=t.map((function(t){return-Math.log(t.value)/Math.LN10}));this.dataRange.max=ot(e,this.autoscalePercentile)}else{const t=this.config.maxLogP||this.config.max;this.dataRange.max=t||25}return this.dataRange}}const Ga={X:"rgb(204, 153, 0)",Y:"rgb(153, 204, 0)",Un:"darkGray)",1:"rgb(80, 80, 255)",I:"rgb(139, 155, 187)",2:"rgb(206, 61, 50)",II:"rgb(206, 61, 50)","2a":"rgb(210, 65, 55)","2b":"rgb(215, 70, 60)",3:"rgb(116, 155, 88)",III:"rgb(116, 155, 88)",4:"rgb(240, 230, 133)",IV:"rgb(240, 230, 133)",5:"rgb(70, 105, 131)",6:"rgb(186, 99, 56)",7:"rgb(93, 177, 221)",8:"rgb(128, 34, 104)",9:"rgb(107, 215, 107)",10:"rgb(213, 149, 167)",11:"rgb(146, 72, 34)",12:"rgb(131, 123, 141)",13:"rgb(199, 81, 39)",14:"rgb(213, 143, 92)",15:"rgb(122, 101, 165)",16:"rgb(228, 175, 105)",17:"rgb(59, 27, 83)",18:"rgb(205, 222, 183)",19:"rgb(97, 42, 121)",20:"rgb(174, 31, 99)",21:"rgb(231, 199, 111)",22:"rgb(90, 101, 94)",23:"rgb(204, 153, 0)",24:"rgb(153, 204, 0)",25:"rgb(51, 204, 0)",26:"rgb(0, 204, 51)",27:"rgb(0, 204, 153)",28:"rgb(0, 153, 204)",29:"rgb(10, 71, 255)",30:"rgb(71, 117, 255)",31:"rgb(255, 194, 10)",32:"rgb(255, 209, 71)",33:"rgb(153, 0, 51)",34:"rgb(153, 26, 0)",35:"rgb(153, 102, 0)",36:"rgb(128, 153, 0)",37:"rgb(51, 153, 0)",38:"rgb(0, 153, 26)",39:"rgb(0, 153, 102)",40:"rgb(0, 128, 153)",41:"rgb(0, 51, 153)",42:"rgb(26, 0, 153)",43:"rgb(102, 0, 153)",44:"rgb(153, 0, 128)",45:"rgb(214, 0, 71)",46:"rgb(255, 20, 99)",47:"rgb(0, 214, 143)",48:"rgb(20, 255, 177)"};for(let t of Object.keys(Ga)){Ga["chr"+t]=Ga[t]}class Za extends Pr{constructor(t,e){super(t,e),this.useChrColors=void 0===t.useChrColors||t.useChrColors,this.trait=t.trait,this.posteriorProbability=t.posteriorProbability,this.height=t.height||100,t.autoscale||(t.posteriorProbability?this.dataRange={min:void 0===t.min?0:t.min,max:void 0===t.max?1:t.max}:this.dataRange={min:void 0===t.min?0:t.min,max:void 0===t.max?25:t.max}),this.autoscale=t.autoscale,this.autoscalePercentile=void 0===t.autoscalePercentile?98:t.autoscalePercentile,this.background=t.background,this.divider=t.divider||"rgb(225,225,225)",this.dotSize=t.dotSize||3,this.popoverWindow=void 0===t.popoverWindow?1e8:t.popoverWindow,this.description=t.description,this.colorScales=t.color?new Do(t.color):{"*":new Mo(t.colorScale||{thresholds:[5e-8,5e-4,.5],colors:["rgb(255,50,50)","rgb(251,100,100)","rgb(251,170,170)","rgb(227,238,249)"]})},this.featureSource=so(t,e.genome)}supportsWholeGenome(){return!0}async getFeatures(t,e,i){return this.featureSource.getFeatures({chr:t,start:e,end:i})}draw(t){const e=t.features,i=t.context,n=t.pixelWidth,r=t.pixelHeight;if(this.background&&Ii.fillRect(i,0,0,n,r,{fillStyle:this.background}),Ii.strokeLine(i,0,r-1,n,r-1,{strokeStyle:this.divider}),e){const s=t.bpPerPixel,o=t.bpStart,a=o+n*s+1;for(let t of e){const e=t.start;if(e<o)continue;if(e>a)break;const n=this.getColorScale(t._f?t._f.chr:t.chr);let h,l;if(this.posteriorProbability)l=t.value,h=n.getColor(l);else{const e=t.value||t.score;if(!e)continue;l=-Math.log10(e),h=n.getColor(l)}const c=(this.dataRange.max-this.dataRange.min)/r,u=Math.round((e-o)/s),f=Math.max(this.dotSize,r-Math.round((l-this.dataRange.min)/c));h&&Ii.setProperties(i,{fillStyle:h,strokeStyle:"black"}),Ii.fillCircle(i,u,f,this.dotSize),t.px=u,t.py=f}}}getColorScale(t){if(this.useChrColors){let e=this.colorScales[t];if(!e){const i=Ga[t]||lo.get();e=new Do(i),this.colorScales[t]=e}return e}return this.colorScales("*")}paintAxis(t,e,i){Ii.fillRect(t,0,0,e,i,{fillStyle:"rgb(255, 255, 255)"});var n={font:"normal 10px Arial",textAlign:"right",strokeStyle:"black"};const r=(this.dataRange.max-this.dataRange.min)/i;if(this.posteriorProbability){const e=.1;for(let s=this.dataRange.min;s<this.dataRange.max;s+=e){const e=i-Math.round((s-this.dataRange.min)/r);Ii.strokeLine(t,45,e-2,50,e-2,n),Ii.fillText(t,s.toFixed(1),44,e+2,n)}}else{const e=Math.ceil(10*(this.dataRange.max-this.dataRange.min)/i);for(let s=this.dataRange.min;s<this.dataRange.max;s+=e){const e=i-Math.round((s-this.dataRange.min)/r);Ii.strokeLine(t,45,e,50,e,n),Ii.fillText(t,Math.floor(s),44,e+4,n)}}n.textAlign="center",this.posteriorProbability?Ii.fillText(t,"PPA",e/2,i/2,n,{rotate:{angle:-90}}):Ii.fillText(t,"-log10(pvalue)",e/2,i/2,n,{rotate:{angle:-90}})}popupData(t){let e=[];const i=t.viewport.trackView.track,n=t.viewport.getCachedFeatures();if(n){let r=0;for(let s of n){const n=Math.abs(t.canvasX-s.px),o=Math.abs(t.canvasY-s.py),a=s.value||s.score;if(n<this.dotSize&&o<this.dotSize){if(r>0&&e.push("<HR/>"),5==r){e.push("...");break}if("function"==typeof s.popupData)e=e.concat(s.popupData());else{const t=s.realChr||s.chr,n=(s.realStart||s.start)+1;e.push({name:"chromosome",value:t}),e.push({name:"position",value:n}),e.push({name:"name",value:s.name}),i.posteriorProbability?e.push({name:"posterior probability",value:a}):e.push({name:"pValue",value:a})}r++}}}return e}menuItemList(){return In.numericDataMenuItems(this.trackView)}doAutoscale(t){if(t.length>0){const e=this.posteriorProbability?t:t.map((function(t){const e=void 0!==t.value?t.value:t.score;return{value:-Math.log(e)/Math.LN10}})),i=on(e);this.dataRange.max=i.max,this.dataRange.min=i.min!==i.max?i.min:0}else this.posteriorProbability?(this.dataRange.min=this.config.min||0,this.dataRange.max=this.config.max||1):(this.dataRange.max=this.config.max||25,this.dataRange.min=this.config.min||0);return this.dataRange}}class Xa extends Pr{constructor(t,e){super(t,e),this.autoscale=t.autoscale||void 0===t.max,this.dataRange={min:t.min||0,max:t.max},this.windowFunction=t.windowFunction||"mean",this.paintAxis=Io,this.graphType=t.graphType||"bar",t._featureSource?(this.featureSource=t._featureSource,delete t._featureSource):this.featureSource=so(this.config,e.genome)}async postInit(){if("function"==typeof this.featureSource.getHeader&&(this.header=await this.featureSource.getHeader(),this.sampleNames=this.header.columnNames.slice(3),this.setTrackProperties(this.header),this.header.hasOwnProperty("highlight"))){this.config.highlightSamples={};let t=this.header.highlight;Array.isArray(t)||(t=[t]);for(let e of t){const t=e.split(";");2===t.length&&(this.config.highlightSamples[t[0]]=t[1])}}}menuItemList(){return In.numericDataMenuItems(this.trackView)}async getFeatures(t,e,i){const n=await this.featureSource.getFeatures({chr:t,start:0,end:Number.MAX_VALUE});let r,s;for(let t=1;t<n.length-1;t++)if(void 0===r&&n[t].end>e&&(r=t-1),void 0===s&&n[t].start>i){s=t+1;break}return void 0===r&&(r=0),void 0===s&&(s=n.length),n.slice(r,s)}draw(t){const{features:e,context:i,bpPerPixel:n,bpStart:r,pixelWidth:s,pixelHeight:o}=t,a=t=>(this.dataRange.max-t)/(this.dataRange.max-this.dataRange.min)*o,h=function(t){let e=Math.floor((t-r)/n);return isNaN(e)&&console.warn("isNaN(x). feature start "+z(t)+" bp start "+z(r)),e};if(e&&e.length>0&&(void 0===this.dataRange.min&&(this.dataRange.min=0),this.dataRange.max>this.dataRange.min)){const t=this.config.highlightSamples,n=this.config.onlyHandleClicksForHighlightedSamples;let r=-1,s={},o=[],l=[];this.clickDetectorCache={};for(let c of e){const e=h(c.start),u=h(c.end),f=r>=0?h(r):e;if(!isNaN(e)&&!isNaN(u)&&!(e-f<1&&u-e<1)){this.clickDetectorCache[e]=[],this.clickDetectorCache[u]=[];for(let r=0;r<c.values.length;r++){const h=this.sampleNames[r],d=c.values[r],p=a(d);if(e-f>=1){const r=s[h],l=a(r),c=t&&t[h];c?o.push([f,l,e,p,c]):Ii.strokeLine(i,f,l,e,p,{strokeStyle:"#D9D9D9"}),n&&!(h in t)||this.clickDetectorCache[e].push([f,l,e,p,h,c||"gray"])}if(u-e>=1){const r=t&&t[h];r?l.push([e,p,u,p,r]):Ii.strokeLine(i,e,p,u,p,{strokeStyle:"gray"}),n&&!(h in t)||this.clickDetectorCache[u].push([e,p,u,p,h,r||"gray"])}s[h]=d}r=c.end}}for(let t of o)Ii.strokeLine(i,t[0],t[1],t[2],t[3],{strokeStyle:t[4],lineWidth:1.3});for(let t of l)Ii.strokeLine(i,t[0],t[1],t[2],t[3],{strokeStyle:t[4],lineWidth:2})}(t=>{if(this.config.hasOwnProperty("guideLines"))for(let e of this.config.guideLines)if(e.hasOwnProperty("color")&&e.hasOwnProperty("y")&&e.hasOwnProperty("dotted")){let i=a(e.y),n={strokeStyle:e.color,strokeWidth:2};e.dotted?Ii.dashedLine(t.context,0,i,t.pixelWidth,i,5,n):Ii.strokeLine(t.context,0,i,t.pixelWidth,i,n)}})(t)}doAutoscale(t){let e,i;return t.length>0?(e=Number.MAX_VALUE,i=-Number.MAX_VALUE,t.forEach((function(t){e=Math.min(e,...t.values),i=Math.max(i,...t.values)})),e-=.01,i+=.01):(e=0,i=100),{min:e,max:i}}clickedFeatures(t){const e=t.canvasX,i=t.canvasY;let n=null;for(n of Object.keys(this.clickDetectorCache))if(n=parseInt(n),n>=e)break;if(n){let t=Number.MAX_VALUE,r=[];const s=this.clickDetectorCache[n];for(let n of s){const s=n[0],o=n[2];if(e<s||e>o)return[];const a=n[1],h=n[3];if(i<Math.min(a,h)-10||i>Math.max(a,h)+10)continue;const l=Ya(e,i,s,a,o,h);l<t&&(r=[{name:n[4],color:n[5]}],t=l)}if(t<5)return r}return[]}popupData(t,e){e||(e=this.clickedFeatures(t));const i=[];return e.forEach((function(t){for(let e of Object.keys(t))rn(t[e])&&i.push({name:e,value:t[e]})})),i}supportsWholeGenome(){return!1}}function Ya(t,e,i,n,r,s){const o=r-i,a=s-n,h=Math.abs(o*(n-e)-(i-t)*a),l=Math.sqrt(o*o+a*a);return l>0?h/l:0}class Ka extends Pr{constructor(t,e){super(t,e),t.height||(this.height=300),this.arcOrientation=!1,this.theta=Math.PI/2,t.format,this.featureSource=new Ja(t,e.genome)}async getFeatures(t,e,i){return this.featureSource.getFeatures(t,e,i)}draw(t){const e=this,i=Math.PI/2,n=t.context,r=t.pixelWidth,s=t.pixelHeight,o=(t.viewportWidth,t.bpPerPixel),a=t.bpStart,h=o,l=e.arcOrientation;Ii.fillRect(n,0,t.pixelTop,r,s,{fillStyle:"rgb(255, 255, 255)"});const c=t.features;c&&(Qa(c,1),c.forEach((function(t){if(t.startLeft){let r=Math.round((t.startLeft-a)/h),s=Math.round((t.startRight-a)/h),o=Math.round((t.endLeft-a)/h),c=Math.round((t.endRight-a)/h);n.fillStyle=t.color,n.strokeStyle=t.color,n.beginPath();let u=(r+c)/2,f=(c-r)/2,d=e.height,p=Math.PI+(Math.PI/2-i),g=2*Math.PI-(Math.PI/2-i);l?(d=0,n.arc(u,d,f,g,p),n.lineTo(c,d)):(n.arc(u,d,f,p,g),n.lineTo(o,d));const m=(s+o)/2,b=(o-s)/2,w=d;l?(n.arc(m,w,b,p,g,!0),n.lineTo(o,w)):(n.arc(m,w,b,g,p,!0),n.lineTo(r,w)),n.stroke(),n.fill(),t.drawState={x1:u,y1:d,r1:f,x2:m,y2:w,r2:b,sa:p,ea:g}}else{let r=Math.round((t.start-a)/h),s=Math.round((t.end-a)/h);n.strokeStyle=t.color,n.beginPath();let o=(r+s)/2,c=(s-r)/2,u=e.height,f=Math.PI+(Math.PI/2-i),d=2*Math.PI-(Math.PI/2-i);l?(u=0,n.arc(o,u,c,d,f)):n.arc(o,u,c,f,d),n.stroke(),t.drawState={x1:o,y1:u,r1:c,sa:f,ea:d}}})))}clickedFeatures(t){let e=super.clickedFeatures(t);const i=[];Qa(e,-1);for(let n of e){const e=n.drawState,r=t.canvasX-e.x1,s=t.canvasY-e.y1,o=Math.sqrt(r*r+s*s),a=e.r1+3;let h,l;if(void 0===e.x2)h=o,l=e.r1-3;else{const i=t.canvasX-e.x2,n=t.canvasY-e.y2;h=Math.sqrt(i*i+n*n),l=e.r2-3}if(o<a&&h>l){i.push(n);break}}return i}popupData(t,e){if(e||(e=this.clickedFeatures(t)),e&&e.length>0)return Pr.extractPopupData(e[0],this.getGenomeId())}menuItemList(){var t=this;return[{name:"Toggle arc direction",click:function(){t.arcOrientation=!t.arcOrientation,t.trackView.repaintViews()}}]}}function Qa(t,e){t.sort((function(t,i){const n=void 0===t.score?-Number.MAX_VALUE:t.score,r=void 0===i.score?-Number.MAX_VALUE:i.score;return(void 0===e?1:e)*(n-r)}))}class Ja{constructor(t,e){this.config=t,this.genome=e}async getFeatures(t,e,i){const n=this.genome;if(this.featureCache)return this.featureCache.queryFeatures(t,e,i);{const r=sn(this.config),s=await un.loadString(this.config.url,r);return this.featureCache=new fs(function(t){if(!t)return null;const e=Fr(t);let i,n=!0;const r=[],s=[],o=[];for(;void 0!==(i=e.nextLine());){const t=i.split("\t");if(n&&i.startsWith("color:")){const e="rgb("+t[1]+","+t[2]+","+t[3]+")";r.push(e),t.length>4&&s.push(t[4])}else{n=!1;const e=t[0],i=Number.parseInt(t[1])-1,h=Number.parseInt(t[2])-1,l=Number.parseInt(t[3]),c=Number.parseInt(t[4]);var a=Number.parseInt(t[5]);const u=r[a];let f;f=i<=c?{chr:e,startLeft:Math.min(i,h),startRight:Math.max(i,h),endLeft:Math.min(l,c),endRight:Math.max(l,c),color:u,score:a}:{chr:e,startLeft:Math.min(l,c),startRight:Math.max(l,c),endLeft:Math.min(i,h),endRight:Math.max(i,h),color:u,score:a},f.start=f.startLeft,f.end=f.endRight,s.length>a&&(f.description=s[a]),o.push(f)}}return o}(s),n),this.featureCache.queryFeatures(t,e,i)}}}class th{constructor(t){this.browser=t,this.type="ideogram",this.id=this.type,this.height=16,this.order=Number.MIN_SAFE_INTEGER,this.disableButtons=!0,this.ignoreTrackMenu=!0}async getFeatures(t,e,i){return[]}computePixelHeight(t){return this.height}draw(t){}computePixelHeight(){}dispose(){this.trackView=void 0}}var eh={tracks:{ideogram:(t,e)=>new th(t,e),sequence:(t,e)=>new Ro(t,e),feature:(t,e)=>new po(t,e),seg:(t,e)=>new Bo(t,e),wig:(t,e)=>new Lo(t,e),merged:(t,e)=>new No(t,e),alignment:(t,e)=>new Ra(t,e),interaction:(t,e)=>new Pa(t,e),interact:(t,e)=>new Pa(t,e),variant:(t,e)=>new ja(t,e),eqtl:(t,e)=>new Wa(t,e),gwas:(t,e)=>new Za(t,e),arc:(t,e)=>new Ka(t,e),gcnv:(t,e)=>new Xa(t,e)},addTrack:function(t,e){this.tracks[t]=e},getTrack:function(t){return this.tracks[t]}};class ih{constructor(t,e){this.config=t,this.name=t.name,this.roiSource=so(t,e),this.color=t.color||"rgba(68, 134, 247, 0.25)"}async getFeatures(t,e,i){return this.roiSource.getFeatures({chr:t,start:e,end:i})}draw(t){var e,i,n,r;if(r=t.features){e=t.bpStart+(t.pixelWidth*t.bpPerPixel+1);for(var s=0,o=r.length;s<o;s++)if(!((i=r[s]).end<t.bpStart)){if(i.start>e)break;n=nh(i,t.bpStart,t.bpPerPixel),Ii.fillRect(t.context,n.x,t.pixelTop,n.width,t.pixelHeight,{fillStyle:this.color})}}}}function nh(t,e,i){var n,r;return n=Math.round((t.start-e)/i),(r=Math.round((t.end-e)/i)-n)<3&&(r=3,n-=1),{x:n,width:r}}class rh{constructor(t,e){this.geneColors={},this.gene=null,this.snp=null,this.genesCount=0,t&&(this.gene=t.toUpperCase(),this.geneColors[this.gene]=sh[this.genesCount++]),e&&(this.snp=e.toUpperCase())}addGene(t){this.geneColors[t.toUpperCase()]||(this.geneColors[t.toUpperCase()]=sh[this.genesCount++])}colorForGene(t){return this.geneColors[t.toUpperCase()]}}var sh=new Array;sh.push("rgb(228,26,28)"),sh.push("rgb(55,126,184)"),sh.push("rgb(77,175,74)"),sh.push("rgb(166,86,40)"),sh.push("rgb(152,78,163)"),sh.push("rgb(255,127,0)"),sh.push("rgb(247,129,191)"),sh.push("rgb(153,153,153)"),sh.push("rgb(255,255,51)"),sh.push("rgb(102, 194, 165"),sh.push("rgb(252, 141, 98"),sh.push("rgb(141, 160, 203"),sh.push("rgb(231, 138, 195"),sh.push("rgb(166, 216, 84"),sh.push("rgb(255, 217, 47"),sh.push("rgb(229, 196, 148"),sh.push("rgb(179, 179, 179"),sh.push("rgb( 141, 211, 199"),sh.push("rgb(255, 255, 179"),sh.push("rgb(190, 186, 218"),sh.push("rgb(251, 128, 114"),sh.push("rgb(128, 177, 211"),sh.push("rgb(253, 180, 98"),sh.push("rgb(179, 222, 105"),sh.push("rgb(252, 205, 229"),sh.push("rgb(217, 217, 217"),sh.push("rgb(188, 128, 189"),sh.push("rgb(204, 235, 197"),sh.push("rgb(255, 237, 111");class oh{constructor(t,e){const i=(new DOMParser).parseFromString(t,"text/xml");this.processRootNode(i,e);const n=i.getElementsByTagName("Resource"),r=i.getElementsByTagName("Track"),s=r&&r.length>0,o=[];this.tracks=o;const a=new Map;Array.from(n).forEach((function(t,e){var i={url:t.getAttribute("path"),indexURL:t.getAttribute("index"),order:e};a.set(i.url,i),s||o.push(i)})),s&&Array.from(r).forEach((function(t){const e=t.getElementsByTagName("Track");if(e&&e.length>0){const i={type:"merged",tracks:[]};ah(t,i),o.push(i),Array.from(e).forEach((function(t){t.processed=!0;const e=t.getAttribute("id"),n=a.get(e);n&&(i.tracks.push(n),ah(t,n),n.autoscale=!1,i.height=n.height)}))}else if(!t.processed){const e=t.getAttribute("id"),i=a.get(e);i&&(o.push(i),ah(t,i))}}))}processRootNode(t,e){const i=t.getElementsByTagName("Session");!i||i.length;const n=i.item(0),r=n.getAttribute("genome"),s=n.getAttribute("locus"),o=n.getAttribute("ucscID");e&&e.hasOwnProperty(r)?this.genome=r:(this.reference={fastaURL:r},o&&(this.reference.id=o)),s&&(this.locus=s)}}function ah(t,e){e.name=t.getAttribute("name");const i=t.getAttribute("color");i&&(e.color="rgb("+i+")");const n=t.getAttribute("altColor");i&&(e.altColor="rgb("+n+")");const r=t.getAttribute("height");r&&(e.height=parseInt(r));const s=t.getAttribute("autoScale");s&&(e.autoscale="true"===s);const o=t.getAttribute("autoscaleGroup");o&&(e.autoscaleGroup=o);const a=t.getAttribute("windowFunction");a&&(e.windowFunction=a);const h=t.getAttribute("visibilityWindow")||t.getAttribute("featureVisibilityWindow");h&&(e.visibilityWindow=h);const l=t.getAttribute("indexed");l&&(e.indexed="true"===l);const c=t.getAttribute("normalize");c&&(e.normalize="true"===c);const u=t.getElementsByTagName("DataRange");if(u.length>0){const t=u.item(0);e.min=Number.parseFloat(t.getAttribute("minimum")),e.max=Number.parseFloat(t.getAttribute("maximum")),e.logScale="LOG"===t.getAttribute("type")}}const hh=H;class lh{constructor(){this.attributes={},this.plinkLoaded=!1}async loadPlinkFile(t,e){e||(e={});var i=sn(e);const n=await un.loadString(t,i);var r=hh(n);for(let t of r){var s=t.split(" ");this.attributes[s[1]]={familyId:s[0],fatherId:s[2],motherId:s[3],sex:s[4],phenotype:s[5]}}return this.plinkLoaded=!0,this}getAttributes(t){return this.attributes[t]}getAttributeNames(){return this.hasAttributes()?Object.keys(this.attributes[Object.keys(this.attributes)[0]]):[]}hasAttributes(){return Object.keys(this.attributes).length>0}}class ch{constructor(t,e,i,n,r){this.genome=t,this.chr=e,this.start=i,this.initialEnd=n,this.initialStart=i,this.bpPerPixel=r,this.id=I()}calculateEnd(t){return this.start+this.bpPerPixel*t}calculateBPP(t,e){return(t-this.start)/e}set(t){this.chr=t.chr,this.start=t.start,this.bpPerPixel=t.bpPerPixel}toPixels(t){return t/this.bpPerPixel}toBP(t){return this.bpPerPixel*t}shiftPixels(t,e){const i=this.start;return this.start+=t*this.bpPerPixel,this.clamp(e),i!==this.start}clamp(t){const e=this.genome.getChromosome(this.chr).bpStart||0;if(this.start=Math.max(e,this.start),t){var i=this.genome.getChromosome(this.chr).bpLength-t*this.bpPerPixel;this.start>i&&(this.start=i)}}getChromosome(){return this.genome.getChromosome(this.chr)}presentLocus(t){if("all"===this.chr)return this.chr;{const e=z(Math.floor(this.start)+1),i=z(Math.round(this.start+this.bpPerPixel*t));return`${this.chr}:${e}-${i}`}}}const uh={A:"rgb(  0, 200,   0)",C:"rgb(  0,0,200)",T:"rgb(255,0,0)",G:"rgb(209,113,  5)",N:"rgb(80,80,80)"};async function fh(t,e){if(void 0===e||""===e.trim())return;(e&&"all"===e.trim().toLowerCase()||"*"===e)&&(e="all");const i=e.split(" ");let n=t.searchConfig,r=[];const s=async e=>{let i=function(t,e){const i=e.split(":"),n=i[0];if("all"===n&&t.genome.getChromosome(n))return{chr:n,start:0,end:t.genome.getChromosome(n).bpLength};if(void 0===t.genome.getChromosome(n))return;{const e={chr:t.genome.getChromosomeName(n),start:0,end:t.genome.getChromosome(n).bpLength};if(i.length>1){const t=i[1].split("-");if(t.length>2)return;{let i;if(i=t[0].replace(/,/g,""),isNaN(i))return;if(e.start=parseInt(i,10)-1,e.end=e.start+1,1===t.length&&(e.start-=20,e.end+=20),2===t.length){if(i=t[1].replace(/,/g,""),isNaN(i))return;e.end=parseInt(i,10)}}}return e}}(t,e);return i||(i=t.genome.featureDB[e.toUpperCase()]),i||(i=await async function(t,e,i){let n=i.url.replace("$FEATURE$",e.toUpperCase());n.indexOf("$GENOME$")>-1&&(n=n.replace("$GENOME$",t.genome.id?t.genome.id:"hg19"));const r=await un.loadString(n),s=function(t,e,i){let n;n="plain"===i.type?function(t,e){const i=[],n=[];return H(e).forEach((function(t){""===t||i.push(t)})),i.forEach((function(e){var i,r,s,o,a=e.split("\t");a.length>=3&&(s=(r=a[1].split(":"))[1].split("-"),i=a[2].trim(),o={gene:a[0],chromosome:t.genome.getChromosomeName(r[0].trim()),start:parseInt(s[0].replace(/,/g,"")),end:parseInt(s[1].replace(/,/g,"")),type:"gtex"===i?"snp":"gene"},n.push(o))})),n}(t,e):JSON.parse(e);i.resultsField&&(n=n[i.resultsField]);if(n&&0!==n.length){const e=i.chromosomeField||"chromosome",r=i.startField||"start",s=i.endField||"end",o=i.coords||1;let a;a=Array.isArray(n)?n[0]:n,a.hasOwnProperty(e)&&a.hasOwnProperty(r)||console.error("Search service results must include chromosome and start fields: "+a);const h=a[e],l=t.genome.getChromosome(h);if(!l)return;const c=l.name;let u=a[r]-o,f=a[s];void 0===f&&(f=u+1);const d={chr:c,start:u,end:f},p=a.type?a.type:"gene";return i.geneField&&"gene"===p&&(d.gene=a[i.geneField]),i.snpField&&"snp"===p&&(d.snp=a[i.snpField]),d}return}(t,r,i);s&&(s.locusSearchString=e);return s}(t,e,n)),i};for(let t of i){const e=await s(t);e&&(e.locusSearchString=t,r.push(e))}if(0===r.length){const t=await s(e);t&&(t.locusSearchString=e,r.push(t))}return 0===r.length?void 0:r}class dh{constructor(t,e){this.config=t,this.guid=I(),this.namespace=".browser_"+this.guid,this.parent=e,this.$root=Ri("<div>",{class:"igv-root"}),Ri(e).append(this.$root);const i=Ri("<div>",{class:"igv-track-container"});this.$root.append(i),v.init(this.$root.get(0)),this.trackContainer=i.get(0),this.initialize(t),this.trackViews=[],this.trackLabelsVisible=!0,this.isCenterGuideVisible=!1,this.cursorGuideVisible=!1,this.constants={dragThreshold:3,scrollThreshold:5,defaultColor:"rgb(0,0,150)",doubleClickDelay:t.doubleClickDelay||500},this.eventHandlers={},this.$spinner=Ri("<div>",{class:"igv-track-container-spinner"}),i.append(this.$spinner),this.$spinner.append(Tn("spinner")),this.stopSpinner(),this.addMouseHandlers()}initialize(t){t.gtex&&(co.gtexLoaded=!0),this.flanking=t.flanking,this.crossDomainProxy=t.crossDomainProxy,this.formats=t.formats,this.trackDefaults=t.trackDefaults,this.nucleotideColors=t.nucleotideColors||uh;for(let t of Object.keys(this.nucleotideColors))this.nucleotideColors[t.toLowerCase()]=this.nucleotideColors[t];t.search?this.searchConfig={type:"json",url:t.search.url,coords:void 0===t.search.coords?1:t.search.coords,chromosomeField:t.search.chromosomeField||"chromosome",startField:t.search.startField||"start",endField:t.search.endField||"end",geneField:t.search.geneField||"gene",snpField:t.search.snpField||"snp",resultsField:t.search.resultsField}:(t.reference&&t.reference.id?t.reference.id:t.genome?t.genome:"hg19",this.searchConfig={type:"plain",url:"https://igv.org/genomes/locus.php?genome=$GENOME$&name=$FEATURE$",coords:0,chromosomeField:"chromosome",startField:"start",endField:"end",geneField:"gene",snpField:"snp"})}startSpinner(){const t=this.$spinner;t&&(t.addClass("igv-fa5-spin"),t.show())}stopSpinner(){const t=this.$spinner;t&&(t.hide(),t.removeClass("igv-fa5-spin"))}isMultiLocusMode(){return this.referenceFrameList&&this.referenceFrameList.length>1}addTrackToFactory(t,e){eh.addTrack(t,e)}isMultiLocusWholeGenomeView(){if(void 0===this.referenceFrameList||1===this.referenceFrameList.length)return!1;for(let t of this.referenceFrameList)if("all"===t.chr.toLowerCase())return!0;return!1}toSVG(){const{x:t,y:e,width:i,height:n}=this.trackContainer.getBoundingClientRect(),{x:r}=this.trackViews[0].$viewportContainer.get(0).getBoundingClientRect(),s=i+5*(this.referenceFrameList.length-1),o=n;let a=new $i({width:s,height:8e3,backdropColor:"white",multiLocusGap:5,viewbox:{x:0,y:0,width:s,height:8e3}});const h=r-t;for(let t of this.trackViews)t.renderSVGContext(a,{deltaX:h,deltaY:-e});return a.setHeight(o),a.getSerializedSvg(!0)}saveSVGtoFile(t){let e=this.toSVG();if(t.$container){const i=this.trackContainer.getBoundingClientRect();t.$container.empty(),t.$container.width(i.width),t.$container.append(e)}it(t.filename||"igv.svg",URL.createObjectURL(new Blob([e],{type:"application/octet-stream"})))}async loadSession(t){let e;return this.roi=[],e=t.url||t.file?await async function(t){const e=t.url||t.file;if(t.url&&(t.url.startsWith("blob:")||t.url.startsWith("data:"))){const e=dh.uncompressSession(t.url);return JSON.parse(e)}{let i=t.filename;if(i||(i=t.url?await ln(t.url):t.file.name),i.endsWith(".xml")){const t=_n.KNOWN_GENOMES,i=await un.loadString(e);return new oh(i,t)}return i.endsWith(".json")?un.loadJson(e):void 0}}(t):t,this.loadSessionObject(e)}async loadSessionObject(t){this.removeAllTracks();const e=await this.loadGenome(t.reference||t.genome,t.locus,!1);if(void 0===this.ideogram&&!1!==this.config.showIdeogram&&(this.ideogram=new th(this),this.addTrack(this.ideogram)),void 0===this.rulerTrack&&!1!==this.config.showRuler&&(this.rulerTrack=new Qn(this),this.addTrack(this.rulerTrack)),t.gtexSelections)for(let e of this.referenceFrameList)for(let i of Object.keys(t.gtexSelections)){const n=t.gtexSelections[i].gene,r=t.gtexSelections[i].snp;e.selection=new rh(n,r)}if(t.roi){this.roi=[];for(let i of t.roi)this.roi.push(new ih(i,e))}const i=t.tracks||[];0===i.filter((t=>"sequence"===t.type)).length&&!1!==this.config.showSequence&&i.push({type:"sequence",order:Eo}),await this.loadTrackList(i),this.ideogram&&this.ideogram.trackView.updateViews(),this.rulerTrack&&this.rulerTrack.trackView.updateViews(),this.updateLocusSearchWidget(this.referenceFrameList),this.windowSizePanel.updatePanel(this.referenceFrameList)}async loadGenome(t,e,i){if(O(t)&&t.startsWith("{"))try{t=JSON.parse(t)}catch(t){}const n=await async function(t){var e;O(t)?e=t:t.genome?e=t.genome:void 0!==t.id&&void 0===t.fastaURL&&(e=t.id);if(e){const t=_n.KNOWN_GENOMES[e];return t||v.presentAlert(new Error(`Unknown genome id: ${e}`),void 0),t}return t}.call(this,t),r=await _n.loadGenome(n),s=this.genome&&this.genome.id!==r.id;this.genome=r,this.$current_genome.text(r.id||""),this.$current_genome.attr("title",r.id||""),this.chromosomeSelectWidget.update(r),s&&this.removeAllTracks(),this.genome=r;try{this.referenceFrameList=await this.search(function(t,e){var i=[];i=t?Array.isArray(t)?t.join(" "):t:e.getHomeChromosomeName();return i}(e,r),!0)}catch(t){t.message(),v.presentAlert(new Error(`Unrecognized locus ${e}`),void 0),this.referenceFrameList=await this.search(this.genome.getHomeChromosomeName())}return n.tracks&&await this.loadTrackList(n.tracks),!1!==i&&this.updateViews(),this.genome}updateUIWithReferenceFrameListChange(t){const e=this.isMultiLocusWholeGenomeView()||_n.isWholeGenomeView(t[0].chr);e||this.isMultiLocusMode()?this.centerGuide.forcedHide():this.centerGuide.forcedShow(),this.navbarManager.navbarDidResize(this.$navigation.width(),e),ph(this.trackViews,this.trackLabelsVisible)}setTrackLabelName(t,e){t.viewports.forEach((t=>{t.setTrackLabel(e)}))}hideTrackLabels(){this.trackLabelsVisible=!1,ph(this.trackViews,this.trackLabelsVisible)}showTrackLabels(){this.trackLabelsVisible=!0,ph(this.trackViews,this.trackLabelsVisible)}hideCursorGuide(){this.cursorGuide.$guide.hide(),this.cursorGuideVisible=!1}showCursorGuide(){this.cursorGuide.$guide.show(),this.cursorGuideVisible=!0}setCustomCursorGuideMouseHandler(t){this.cursorGuide.customMouseHandler=t}hideCenterGuide(){this.centerGuide.$container.hide(),this.isCenterGuideVisible=!1}showCenterGuide(){this.centerGuide.$container.show(),this.centerGuide.resize(),this.isCenterGuideVisible=!0}async loadTrackList(t){try{this.startSpinner();const e=[];for(let i of t){const t=!0;e.push(this.loadTrack(i,t))}const i=await Promise.all(e),n=this.trackViews.filter((function(t){return t.track.autoscaleGroup}));return n.length>0&&this.updateViews(this.referenceFrameList[0],n),i}finally{this.stopSpinner()}}async loadROI(t){if(this.roi||(this.roi=[]),Array.isArray(t))for(let e of t)this.roi.push(new ih(e,this.genome));else this.roi.push(new ih(t,this.genome));await this.updateViews(void 0,void 0,!0)}removeROI(t){for(let e=0;e<this.roi.length;e++)if(this.roi[e].name===t.name){this.roi.splice(e,1);break}for(let t of this.trackViews)t.updateViews(void 0,void 0,!0)}clearROIs(){this.roi=[];for(let t of this.trackViews)t.updateViews(void 0,void 0,!0)}async loadTrack(t,e){O(t)&&(t=JSON.parse(t));try{e||this.startSpinner();const i=await this.createTrack(t);return void 0===i?(v.presentAlert(new Error(`Unknown file type: ${t.url||t}`),void 0),i):(void 0===i.order&&(i.order=this.trackViews.length),"function"==typeof i.postInit&&await i.postInit(),t.sync?await this.addTrack(i):this.addTrack(i),i)}catch(e){const i={401:"Access unauthorized",403:"Access forbidden",404:"Not found"};console.error(e);let n=e.message||e.error||e.toString();i.hasOwnProperty(n)&&(n=i[n]),n+=": "+t.url,v.presentAlert(new Error(n),void 0)}finally{e||this.stopSpinner()}}async createTrack(t){let e=await async function(t){return"function"==typeof t?t():t}(t.url);if(O(e)&&(e=e.trim()),e)if(t.format)t.format=t.format.toLowerCase();else{let i=t.filename;i||(i=await ln(e)),t.format=st(i)}let i,n=t.type;if(n&&"bedtype"!==n)n=n.toLowerCase();else if(n=hn(t),"bedtype"===n){const e=so(t,this.genome);t._featureSource=e;const i=await e.trackType();n=i||"annotation",t.type=n}if(this.trackDefaults&&n){const e=this.trackDefaults[n];if(e)for(let i in e)e.hasOwnProperty(i)&&void 0===t[i]&&(t[i]=e[i])}switch(n){case"annotation":case"genes":case"fusionjuncspan":case"junctions":case"splicejunctions":case"snp":i=eh.getTrack("feature")(t,this);break;default:i=eh.tracks.hasOwnProperty(n)?eh.getTrack(n)(t,this):void 0}if(t.roi&&i){i.roi=[];for(let e of t.roi)i.roi.push(new ih(e,this.genome))}return i}async addTrack(t){var e;if(e=new er(this,Ri(this.trackContainer),t),this.trackViews.push(e),ph(this.trackViews,this.trackLabelsVisible),this.reorderTracks(),!t.autoscaleGroup)return e.updateViews()}reorderTracks(){this.trackViews.sort((function(t,e){const i=t=>"ideogram"===t.track.id?1:"ruler"===t.track.id?2:3,n=i(t),r=i(e);if(n===r){return(t.track.order||0)-(e.track.order||0)}return n-r})),Ri(this.trackContainer).children("igv-track").detach();for(let t of this.trackViews)this.trackContainer.appendChild(t.trackDiv)}removeTrackByName(t){const e=this.trackViews.slice();for(let i of e)t===i.track.name&&this.removeTrack(i.track)}removeTrack(t){for(var e,i=0;i<this.trackViews.length;i++)if(t===this.trackViews[i].track){e=this.trackViews[i];break}e&&(this.trackViews.splice(i,1),Ri(e.trackDiv).remove(),this.fireEvent("trackremoved",[e.track]),e.dispose())}removeAllTracks(){const t=[];for(let e of this.trackViews){const i=e.track.id;"ruler"!==i&&"ideogram"!==i?(this.trackContainer.removeChild(e.trackDiv),this.fireEvent("trackremoved",[e.track]),e.dispose()):t.push(e)}this.trackViews=t}findTracks(t,e){let i="function"==typeof t?e=>t(e.track):i=>e===i.track[t];return this.trackViews.filter(i).map((t=>t.track))}setTrackHeight(t){this.trackHeight=t,this.trackViews.forEach((function(e){e.setTrackHeight(t)}))}async visibilityChange(){if(this.referenceFrameList.find((t=>t.bpPerPixel<0))){const t=this.calculateViewportWidth(this.referenceFrameList.length);for(let e of this.referenceFrameList)e.bpPerPixel=(e.initialEnd-e.start)/t}if(this.referenceFrameList){const t=this.isMultiLocusWholeGenomeView()||_n.isWholeGenomeView(this.referenceFrameList[0].chr);t||this.isMultiLocusMode()?this.centerGuide.forcedHide():this.centerGuide.forcedShow(),this.navbarManager.navbarDidResize(this.$navigation.width(),t)}await this.resize()}async resize(){const t=this.calculateViewportWidth(this.referenceFrameList.length);for(let e of this.referenceFrameList){const i=e.toBP(t),{bpLength:n}=e.genome.getChromosome(e.chr);i>n&&(e.bpPerPixel=n/t)}for(let e of this.trackViews)e.resize(t);this.centerGuide&&this.centerGuide.resize(),this.referenceFrameList&&this.referenceFrameList.length>0&&(this.updateLocusSearchWidget(this.referenceFrameList),this.windowSizePanel.updatePanel(this.referenceFrameList)),await this.updateViews();for(let{viewports:t,$viewportContainer:e}of this.trackViews)nr(t,e)}async updateViews(t,e,i){if(e||(e=this.trackViews),!t&&this.referenceFrameList&&1===this.referenceFrameList.length&&(t=this.referenceFrameList[0]),t&&(this.referenceFrameList.length>1?(this.updateLocusSearchWidget(this.referenceFrameList),this.windowSizePanel.updatePanel(this.referenceFrameList)):(this.updateLocusSearchWidget([t]),this.windowSizePanel.updatePanel([t]))),this.centerGuide&&this.centerGuide.repaint(),this.dragObject)for(let t of e)await t.updateViews(i);else{const t={},o=[];for(let i of e){const e=i.track.autoscaleGroup;if(e){var n=t[e];n||(n=[],t[e]=n),n.push(i)}else o.push(i)}const a=Object.keys(t);for(let e of a){const n=t[e],o=[];for(let t of n)o.push(t.getInViewFeatures());const a=await Promise.all(o);var r,s=[];for(let t of a)s=s.concat(t);r=on(s);for(let t of n)t.track.dataRange=r,t.track.autoscale=!1,await t.updateViews(i)}for(let t of o)await t.updateViews(i)}}loadInProgress(){var t;for(t=0;t<this.trackViews.length;t++)if(this.trackViews[t].isLoading())return!0;return!1}updateLocusSearchWidget(t){if(t.length>1)return this.$searchInput.val(""),void this.chromosomeSelectWidget.$select.val("");this.rulerTrack&&this.rulerTrack.updateLocusLabel();const e=t[0];if(e.locusSearchString&&"all"===e.locusSearchString.toLowerCase())this.$searchInput.val(e.locusSearchString),this.chromosomeSelectWidget.$select.val("all");else{let t,i,n;if(this.chromosomeSelectWidget.$select.val(e.chr),this.$searchInput){let r=e.start+e.bpPerPixel*this.viewportWidth();if(this.genome){const t=this.genome.getChromosome(e.chr);t&&(r=Math.min(r,t.bpLength))}t=z(Math.floor(e.start+1)),i=z(Math.floor(r)),n=e.chr+":"+t+"-"+i,this.$searchInput.val(n)}this.fireEvent("locuschange",[{chr:e.chr,start:t,end:i,label:n}])}}viewportContainerWidth(){let t;if(this.trackViews&&this.trackViews.length>0)t=this.trackViews[0].$viewportContainer.width();else{const{width:e}=this.trackContainer.getBoundingClientRect();t=e-112}return t}calculateViewportWidth(t){return 1===t?this.viewportContainerWidth():Math.floor((this.viewportContainerWidth()-5*(t-1))/t)}viewportWidth(){return this.trackViews[0].viewports[0].$viewport.width()}minimumBases(){return this.config.minimumBases}updateZoomSlider(t){const e=this.trackViews[0].viewports[0],i=e.referenceFrame,n=e.$viewport.width()*i.bpPerPixel,r=i.getChromosome().bpLength,s=(r-n)/(r-this.minimumBases()),o=Math.round(100*s);t.val(o)}zoom(t){this.zoomWithScaleFactor(t)}zoomIn(){this.zoomWithScaleFactor(.5)}zoomOut(){this.zoomWithScaleFactor(2)}zoomWithRangePercentage(t){if(this.loadInProgress())return;const e=this.trackViews[0].viewports;for(let s of e){const e=s.referenceFrame,o=e.start+e.toBP(s.$viewport.width()/2),a=e.getChromosome(),h=(i=(a.bpLength-a.bpStart)/s.$viewport.width(),n=this.minimumBases()/s.$viewport.width(),(1-(r=t))*i+r*n),l=h*s.$viewport.width();e.start=o-l/2,e.bpPerPixel=h,e.clamp(s.$viewport.width()),this.updateViews(s.referenceFrame)}var i,n,r}zoomWithScaleFactor(t,e,i){let n=i?[i]:this.trackViews[0].viewports;for(let i of n){const n=i.referenceFrame,r=n.getChromosome(),s=n.start,o=n.bpPerPixel,a=r.bpLength-r.bpStart,h=t<1?this.minimumBases()/i.$viewport.width():a/i.$viewport.width(),l=void 0===e?n.start+n.toBP(i.$viewport.width()/2):e;let c;c=t<1?Math.max(n.bpPerPixel*t,h):Math.min(n.bpPerPixel*t,h);const u=c*i.$viewport.width();n.start=l-u/2,n.bpPerPixel=c,n.clamp(i.$viewport.width());(s!==n.start||o!==n.bpPerPixel)&&this.updateViews(i.referenceFrame)}}presentSplitScreenMultiLocusPanel(t,e){const i=this.calculateViewportWidth(1+this.referenceFrameList.length);!function(t,e,i,n){const r=(i+(i+n))/2;t.start=r-t.bpPerPixel*(e/2),t.initialEnd=t.start+t.bpPerPixel*e,t.locusSearchString=t.presentLocus(e)}(e,i,t.start,t.lengthOnRef);const n=this.genome.getChromosomeName(t.mate.chr),r=function(t,e,i,n,r,s){const o=(r+(r+s))/2-i*(n/2),a=new ch(t,e,o,o+i*n,i);return a.locusSearchString=a.presentLocus(n),a}(this.genome,n,e.bpPerPixel,i,t.mate.position,t.lengthOnRef);this.addMultiLocusPanelWithReferenceFrameIndex(r,1+this.referenceFrameList.indexOf(e),i)}selectMultiLocusPanelWithReferenceFrame(t){this.referenceFrameList.filter((e=>t!==e)).forEach((t=>this.removeMultiLocusPanelWithReferenceFrame(t,!1))),this.resize()}removeMultiLocusPanelWithReferenceFrame(t,e){for(let e of this.trackViews)e.removeViewportForReferenceFrame(t);const i=this.referenceFrameList.indexOf(t);if(this.referenceFrameList.splice(i,1),this.updateUIWithReferenceFrameListChange(this.referenceFrameList),!0===e)this.resize();else for(let{viewports:t,$viewportContainer:e}of this.trackViews)nr(t,e)}addMultiLocusPanelWithReferenceFrameIndex(t,e,i){if(e===this.referenceFrameList.length){this.referenceFrameList.push(t);for(let t of this.trackViews){const n=Un(t,this.referenceFrameList,e,i);t.viewports.push(n)}}else{this.referenceFrameList.splice(e,0,t);for(let t of this.trackViews){const n=Un(t,this.referenceFrameList,e,i);t.viewports.splice(e,0,n);n.$viewport.detach().insertAfter(t.viewports[e-1].$viewport)}}for(let t of this.trackViews)t.updateViewportForMultiLocus();this.rulerTrack&&this.rulerTrack.updateLocusLabel(),this.updateUIWithReferenceFrameListChange(this.referenceFrameList),this.resize()}getViewportWithGUID(t){let e;for(let i of this.trackViews)for(let n of i.viewports)t===n.guid&&(e=n);return e}async goto(t,e,i){return this.search(t+":"+e+"-"+i)}async search(t,e){const i=await fh(this,t);if(i&&(await i).length>0){const t=function(t,e){const i=t.calculateViewportWidth(e.length);return e.map((e=>{t.flanking&&e.gene&&(e.start=Math.max(0,e.start-t.flanking),e.end+=t.flanking);const n=t.genome.getChromosome(e.chr);an(n.bpLength,e,t.minimumBases());const r=new ch(t.genome,e.chr,e.start,e.end,(e.end-e.start)/i);return r.locusSearchString=e.locusSearchString,(e.gene||e.snp)&&(r.selection=new rh(e.gene,e.snp)),r}))}(this,i);this.referenceFrameList=t,function(t){for(let e of t){e.scrollbar?(e.scrollbar.$outerScroll.remove(),e.scrollbar=null,e.scrollbar=void 0):Ri(e.trackDiv).find(".igv-scrollbar-shim").remove();for(let t of e.viewports)t.rulerSweeper&&t.rulerSweeper.$rulerSweeper.remove(),t.popover&&t.popover.dispose(),t.$viewport.remove();delete e.viewports,delete e.scrollbar}}(this.trackViews);for(let e of this.trackViews)ir(this,t,e);return this.updateUIWithReferenceFrameListChange(t),e||this.updateViews(),t}throw new Error(`Unrecognized locus ${t}`)}async loadSampleInformation(t){var e=t;t instanceof File&&(e=t.name),"fam"===e.substr(e.lastIndexOf(".")+1)&&(this.sampleInformation=await function(t,e){return(new lh).loadPlinkFile(t,e)}(t))}on(t,e){this.eventHandlers[t]||(this.eventHandlers[t]=[]),this.eventHandlers[t].push(e)}un(t,e){if(this.eventHandlers[t]){var i=this.eventHandlers[t].indexOf(e);-1!==i&&this.eventHandlers[t].splice(i,1)}}off(t,e){if(t)if(e){const i=this.eventHandlers[t].indexOf(e);-1!==i&&this.eventHandlers[t].splice(i,1)}else this.eventHandlers[t]=[];else this.eventHandlers={}}fireEvent(t,e,i){var n,r=this.eventHandlers[t];if(void 0!==r&&0!==r.length)return n=i||window,r.map((function(t){return t.apply(n,e)}))[0]}dispose(){Ri(window).off(this.namespace),Ri(document).off(this.namespace),this.eventHandlers=void 0,this.trackViews.forEach((function(t){t.dispose()}))}toJSON(){const t={version:"2.7.4"};if(t.reference=this.genome.toJSON(),et(t.reference.fastaURL))throw new Error(`Error. Sessions cannot include local file references ${t.reference.fastaURL.name}.`);if(et(t.reference.indexURL))throw new Error(`Error. Sessions cannot include local file references ${t.reference.indexURL.name}.`);const e=[],i={};let n=this.trackViews[0];for(let t of n.viewports){const n=t.referenceFrame,r=t.$viewport[0].clientWidth,s=n.presentLocus(r);if(e.push(s),n.selection){const t={gene:n.selection.gene,snp:n.selection.snp};i[s]=t}}t.locus=1===e.length?e[0]:e;Object.getOwnPropertyNames(i).length>0&&(t.gtexSelections=i);const r=[],s=[];for(let{track:t}of this.trackViews)try{let e;e="function"==typeof t.getState?t.getState():t.config,e&&(e.browser&&delete e.browser,e.order=t.order,r.push(e))}catch(t){s.push(t)}if(s.length>0){let t=1,e="Errors encountered saving session:";for(let i of s)e+=` (${t++}) ${i.toString()}.`;throw Error(e)}if(r.filter((t=>{t.url&&et(t.url)})).length>0)throw new Error("Error. Sessions cannot include local file references.");return t.tracks=r,t}compressedSession(){return function(t){const e=[];for(var i=0;i<t.length;i++)e.push(t.charCodeAt(i));const n=new B.RawDeflate(e).compress(),r=String.fromCharCode.apply(null,n);return P(r).replace(/\+/g,".").replace(/\//g,"_").replace(/=/g,"-")}(JSON.stringify(this.toJSON()))}sessionURL(){const t=window.location.href.slice(),e=t.indexOf("?");return(e>0?t.substring(0,e):t)+"?sessionURL=blob:"+this.compressedSession()}currentLoci(){const t=[],e=this.trackViews[0];for(let i of e.viewports){const e=i.referenceFrame,n=i.$viewport[0].clientWidth,r=e.presentLocus(n);t.push(r)}return t}mouseDownOnViewport(t,e){var i;i=R(t),this.vpMouseDown={viewport:e,lastMouseX:i.x,mouseDownX:i.x,lastMouseY:i.y,mouseDownY:i.y,referenceFrame:e.referenceFrame}}cancelTrackPan(){const t=this.dragObject;this.dragObject=void 0,this.isScrolling=!1,this.vpMouseDown=void 0,t&&t.viewport.referenceFrame.start!==t.start&&(this.updateViews(),this.fireEvent("trackdragend"))}startTrackDrag(t){this.dragTrack=t}updateTrackDrag(t){if(t&&this.dragTrack){const e=this.dragTrack,i=this.trackViews.indexOf(t),n=this.trackViews.indexOf(e),r=this.trackViews;r[i]=e,r[n]=t;const s=this.trackViews[i].track.order;this.trackViews[n].track.order=s;const o=r.length;let a=s;if(i<n)for(let t=i+1;t<o;t++){const e=r[t].track;if(!(e.order<=a))break;e.order=Math.min(Number.MAX_SAFE_INTEGER,a+1),a=e.order}else for(let t=i-1;t>0;t--){const e=r[t].track;if(!(e.order>=a))break;e.order=Math.max(-Number.MAX_SAFE_INTEGER,a-1),a=e.order}this.reorderTracks()}}endTrackDrag(){this.dragTrack&&this.dragTrack.$trackDragScrim.hide(),this.dragTrack=void 0}addMouseHandlers(){var t=this;function e(e){var i,n,r,s;if(e.preventDefault(),!t.loadInProgress()&&(i=R(e),t.vpMouseDown)){const e=Math.abs(i.x-t.vpMouseDown.mouseDownX)>Math.abs(i.y-t.vpMouseDown.mouseDownY);if(r=(n=t.vpMouseDown.viewport).$viewport.width(),s=n.referenceFrame,!t.dragObject&&!t.isScrolling)if(e)t.vpMouseDown.mouseDownX&&Math.abs(i.x-t.vpMouseDown.mouseDownX)>t.constants.dragThreshold&&(t.dragObject={viewport:n,start:s.start});else if(t.vpMouseDown.mouseDownY&&Math.abs(i.y-t.vpMouseDown.mouseDownY)>t.constants.scrollThreshold){t.isScrolling=!0;const e=n.trackView,i=e.$viewportContainer.height(),r=sr(e.viewports);t.vpMouseDown.r=i/r}if(t.dragObject){s.shiftPixels(t.vpMouseDown.lastMouseX-i.x,r)&&(t.referenceFrameList.length>1?t.updateLocusSearchWidget(t.referenceFrameList):t.updateLocusSearchWidget([t.vpMouseDown.referenceFrame]),t.updateViews()),t.fireEvent("trackdrag")}if(t.isScrolling){const e=t.vpMouseDown.r*(t.vpMouseDown.lastMouseY-i.y);t.vpMouseDown.viewport.trackView.scrollBy(e)}t.vpMouseDown.lastMouseX=i.x,t.vpMouseDown.lastMouseY=i.y}}function i(e){t.cancelTrackPan(),t.endTrackDrag()}Ri(window).on("resize"+this.namespace,(()=>{this.resize()})),Ri(this.root).on("mouseup",i),Ri(this.root).on("mouseleave",i),Ri(this.trackContainer).on("mousemove",e),Ri(this.trackContainer).on("touchmove",e),Ri(this.trackContainer).on("mouseleave",i),Ri(this.trackContainer).on("mouseup",i),Ri(this.trackContainer).on("touchend",i)}async getDriveFileInfo(t){const e="https://www.googleapis.com/drive/v3/files/"+W(t)+"?supportsTeamDrives=true";return un.loadJson(e,sn({}))}static uncompressSession(t){let e;if(t.indexOf("/gzip;base64")>0){e=Q(t);let i="";for(let t of e)i+=String.fromCharCode(t);return i}return function(t){t=t.replace(/\./g,"+").replace(/_/g,"/").replace(/-/g,"=");const e=atob(t),i=[];for(let t=0;t<e.length;t++)i.push(e.charCodeAt(t));const n=new B.RawInflate(i).decompress();let r="";for(let t of n)r+=String.fromCharCode(t);return r}(t.substring(5))}}function ph(t,e){for(let i of t)for(let t of i.viewports)t.$trackLabel&&(0===i.viewports.indexOf(t)&&!0===e?t.$trackLabel.show():t.$trackLabel.hide())}class gh{constructor(t,e){this.$container=Ri("<div>",{class:"igv-windowsize-panel-container"}),t.append(this.$container),this.browser=e}show(){this.$container.show()}hide(){this.$container.hide()}updatePanel(t){this.$container.text(1===t.length?function(t){var e,i,n;if(!(t>1e7))return t>1e4?(i=" kb",n=t/(e=1e3),z(Math.floor(n))+i):z(t)+" bp";e=1e6,i=" mb";return n=t/e,Math.floor(n).toString()+i}(Math.round(this.browser.viewportWidth()*t[0].bpPerPixel)):"")}}class mh{constructor(t,e){this.$container=Ri("<div>",{class:"igv-generic-dialog-container"}),t.append(this.$container),this.$container.offset({left:0,top:0});const i=Ri("<div>",{class:"igv-generic-dialog-header"});this.$container.append(i),D(i[0],(()=>{this.$minimum_input.val(void 0),this.$maximum_input.val(void 0),this.$container.offset({left:0,top:0}),this.$container.hide()})),this.$minimum=Ri("<div>",{class:"igv-generic-dialog-label-input"}),this.$container.append(this.$minimum);const n=Ri("<div>");n.text("Minimum"),this.$minimum.append(n),this.$minimum_input=Ri("<input>"),this.$minimum.append(this.$minimum_input),this.$maximum=Ri("<div>",{class:"igv-generic-dialog-label-input"}),this.$container.append(this.$maximum);const r=Ri("<div>");r.text("Maximum"),this.$maximum.append(r),this.$maximum_input=Ri("<input>"),this.$maximum.append(this.$maximum_input);const s=Ri("<div>",{class:"igv-generic-dialog-ok-cancel"});this.$container.append(s),this.$ok=Ri("<div>"),s.append(this.$ok),this.$ok.text("OK"),this.$cancel=Ri("<div>"),s.append(this.$cancel),this.$cancel.text("Cancel"),this.$cancel.on("click",(()=>{this.$minimum_input.val(void 0),this.$maximum_input.val(void 0),this.$container.offset({left:0,top:0}),this.$container.hide()})),ft(this.$container.get(0),i.get(0)),this.$container.hide()}configure(t){const e=t.trackView.dataRange();let i,n;e?(i=e.min,n=e.max):(i=0,n=100),this.$minimum_input.val(i),this.$maximum_input.val(n),this.$minimum_input.unbind(),this.$minimum_input.on("keyup",(e=>{13===e.keyCode&&this.processResults(t)})),this.$maximum_input.unbind(),this.$maximum_input.on("keyup",(e=>{13===e.keyCode&&this.processResults(t)})),this.$ok.unbind(),this.$ok.on("click",(e=>{this.processResults(t)}))}processResults(t){const e=parseFloat(this.$minimum_input.val()),i=parseFloat(this.$maximum_input.val());isNaN(e)||isNaN(i)?v.presentAlert(new Error("Must input numeric values"),void 0):t.trackView.setDataRange(e,i),this.$minimum_input.val(void 0),this.$maximum_input.val(void 0),this.$container.offset({left:0,top:0}),this.$container.hide()}present(t){const e=t.offset().top,i=Ri("body").scrollTop();this.$container.offset({left:t.width()-this.$container.width(),top:e+i}),this.$container.show()}}const bh=function(t){this.$container=Ri('<div class="igv-user-feedback">'),t.append(this.$container);let e=Ri("<div>");this.$container.append(e);let i=Ri("<div>");e.append(i);let n=Tn("exclamation-triangle","red");i.append(n);let r=Ri("<div>");e.append(r);let s=Tn("times-circle","grey");r.append(s);let o=Ri("<div>");this.$container.append(o);let a=Ri("<div>");o.append(a),a.text("i am user feedback"),r.click((function(){a.html(""),undefined.$container.hide()}))};bh.prototype.show=function(){this.$container.show()},bh.prototype.hide=function(){this.$container.hide()};const wh=function(t,e){let i=Ri('<div class="igv-navbar-button">');t.append(i),i.text("Save SVG"),i.on("click.svg-save-control",(()=>{e.saveSVGtoFile({})}))},vh=function(t,e){let i;this.$zoomContainer=Ri('<div class="igv-zoom-widget">'),e.append(this.$zoomContainer),i=Ri("<div>"),this.$zoomContainer.append(i),i.append(Tn("minus-circle")),i.on("click",(function(){t.zoomOut()})),i=Ri("<div>"),this.$zoomContainer.append(i),this.$slider=Ri('<input type="range"/>'),i.append(this.$slider),this.$slider.on("change",(function(e){t.zoomWithRangePercentage(e.target.value/100)})),i=Ri("<div>"),this.$zoomContainer.append(i),i.append(Tn("plus-circle")),i.on("click",(function(){t.zoomIn()})),this.currentChr=void 0;let n=this;t.on("locuschange",(function(){t.updateZoomSlider(n.$slider)}))};vh.prototype.hide=function(){this.$zoomContainer.hide()},vh.prototype.show=function(){this.$zoomContainer.show()},vh.prototype.hideSlider=function(){this.$slider.hide()},vh.prototype.showSlider=function(){this.$slider.show()};const yh=function(t,e){this.showAllChromosomes=!1!==t.config.showAllChromosomes,this.$container=Ri("<div>",{class:"igv-chromosome-select-widget-container"}),e.append(this.$container),this.$select=Ri("<select>",{name:"chromosome-select-widget"}),this.$container.append(this.$select),this.$select.on("change",(function(){""!==Ri(this).val()&&(t.search(Ri(this).val()),Ri(this).blur())}))};yh.prototype.update=function(t){this.$select.empty();const e=this.showAllChromosomes?t.chromosomeNames.slice():t.wgChromosomeNames.slice();t.showWholeGenomeView()&&(e.unshift("all"),e.unshift(""));for(let t of e){var i;i=Ri("<option>",{value:t}),this.$select.append(i),i.text(t)}};const xh=function(t,e){var i=this;this.browser=e,this.$button=Ri('<div class="igv-navbar-button">'),t.append(this.$button),this.$button.text("track labels"),this.$button.on("click",(function(){!0===e.trackLabelsVisible?i.doHide():i.doShow()}))};xh.prototype.doHide=function(){this.$button.removeClass("igv-navbar-button-clicked"),this.browser.hideTrackLabels()},xh.prototype.doShow=function(){this.$button.addClass("igv-navbar-button-clicked"),this.browser.showTrackLabels()},xh.prototype.setState=function(t){!0===t?this.$button.addClass("igv-navbar-button-clicked"):this.$button.removeClass("igv-navbar-button-clicked")},xh.prototype.disable=function(){this.doHide(),this.$button.hide()},xh.prototype.enable=function(){this.$button.show()};class kh{constructor(t,e,i,n){const r=this;this.browser=n,this.$container=Ri('<div class="igv-center-guide igv-center-guide-thin">'),t.append(this.$container),!0===i.showCenterGuideButton&&(this.$centerGuideToggle=Ri('<div class="igv-navbar-button">'),e.append(this.$centerGuideToggle),this.$centerGuideToggle.text("center line"),this.$centerGuideToggle.on("click",(function(){!0===n.isCenterGuideVisible?r.doHide():r.doShow()})))}doHide(){this.$centerGuideToggle&&this.$centerGuideToggle.removeClass("igv-navbar-button-clicked"),this.browser.hideCenterGuide()}doShow(){this.$centerGuideToggle&&this.$centerGuideToggle.addClass("igv-navbar-button-clicked"),this.browser.showCenterGuide()}setState(t){this.$centerGuideToggle&&(!0===t?this.$centerGuideToggle.addClass("igv-navbar-button-clicked"):this.$centerGuideToggle.removeClass("igv-navbar-button-clicked"))}forcedHide(){this.$centerGuideToggle&&this.$centerGuideToggle.hide(),!0===this.browser.isCenterGuideVisible&&this.$container.hide()}forcedShow(){this.$centerGuideToggle&&this.$centerGuideToggle.show(),!0===this.browser.isCenterGuideVisible&&this.$container.show()}repaint(){var t,e,i,n,r,s,o;this.browser.referenceFrameList&&(1/(o=this.browser.referenceFrameList[0]).bpPerPixel>1?(t=this.browser.trackViews[0].$viewportContainer.position(),e=Math.round(this.browser.trackViews[0].$viewportContainer.width()/2),n=t.left+e-.5*(i=o.toPixels(1)),r=Math.round(n).toString()+"px",s=Math.round(i).toString()+"px",this.$container.css({left:r,width:s}),this.$container.removeClass("igv-center-guide-thin"),this.$container.addClass("igv-center-guide-wide")):(this.$container.css({left:"50%",width:"1px"}),this.$container.removeClass("igv-center-guide-wide"),this.$container.addClass("igv-center-guide-thin")))}resize(){this.repaint()}}const Sh=function(t,e,i,n){const r=this;this.browser=n,this.$guide=Ri('<div class="igv-cursor-tracking-guide">'),t.append(this.$guide),t.on("mousemove.cursor-guide",(e=>{e.preventDefault();const i=Ri(document.elementFromPoint(e.clientX,e.clientY)),r=i.parent();let s;r.hasClass("igv-viewport-content")?s=r.parent():r.hasClass("igv-viewport")&&i.hasClass("igv-viewport-content")?s=r:r.hasClass("igv-viewport-container")&&i.hasClass("igv-viewport")&&(s=i);const[o,a]=[i.attr("class")||"noclass",r.attr("class")||"noclass"];if(s){const i=_h(e,s,this.$guide,t,n);if(i){const{bp:t,start:e,end:n,interpolant:r}=i;this.customMouseHandler&&this.customMouseHandler({bp:t,start:e,end:n,interpolant:r})}}})),!0===i.showCursorTrackingGuideButton&&(this.$button=Ri('<div class="igv-navbar-button">'),e.append(this.$button),this.$button.text("cursor guide"),this.$button.on("click",(function(){!0===n.cursorGuideVisible?r.doHide():r.doShow()})))};let _h=(t,e,i,n,r)=>{const s=n.get(0),{x:o}=L(t,s),a=`${o}px`;i.css({left:a});const{x:h,xNormalized:l,width:c}=L(t,e.get(0)),u=e.data("viewportGUID"),f=r.getViewportWithGUID(u);if(void 0===f)return;const{start:d,bpPerPixel:p}=f.referenceFrame;return{$host:e.closest(".igv-track-container"),host_css_left:a,bp:Math.round(d+h*p),start:d,end:1+d+c*p,interpolant:l}};Sh.prototype.doHide=function(){this.$button&&this.$button.removeClass("igv-navbar-button-clicked"),this.browser.hideCursorGuide()},Sh.prototype.doShow=function(){this.$button.addClass("igv-navbar-button-clicked"),this.browser.showCursorGuide()},Sh.prototype.setState=function(t){this.$button&&(!0===t?this.$button.addClass("igv-navbar-button-clicked"):this.$button.removeClass("igv-navbar-button-clicked"))},Sh.prototype.disable=function(){this.doHide(),this.$guide.hide()},Sh.prototype.enable=function(){this.$button&&this.$button.show()};class Ch{constructor(t){this.browser=t}navbarDidResize(t,e){this.updateNavbar(this.createResponsiveClassSchedule(t,e))}updateNavbar(t){this.browser.$toggle_button_container.removeClass(),this.browser.$toggle_button_container.addClass(t.$toggle_button_container),this.browser.zoomWidget.$zoomContainer.removeClass(),this.browser.zoomWidget.$zoomContainer.addClass(t.$zoomContainer)}createResponsiveClassSchedule(t,e){let i={};return e?this.browser.windowSizePanel.hide():this.browser.windowSizePanel.show(),t>990?(i.$toggle_button_container="igv-navbar-toggle-button-container",i.$zoomContainer="igv-zoom-widget"):t>860?(i.$toggle_button_container="igv-navbar-toggle-button-container",i.$zoomContainer="igv-zoom-widget-900"):t>540?(i.$toggle_button_container="igv-navbar-toggle-button-container-750",i.$zoomContainer="igv-zoom-widget-900"):(i.$toggle_button_container="igv-navbar-toggle-button-container-750",i.$zoomContainer="igv-zoom-widget-900",this.browser.windowSizePanel.hide()),e&&(i.$zoomContainer="igv-zoom-widget-hidden"),i}}let Eh=[];const Th=un,Ah=un.setApiKey;!function(){var t=document.createElement("style");t.setAttribute("type","text/css"),t.innerHTML='.igv-generic-container {\n  position: absolute;\n  top: 0;\n  left: 0;\n  z-index: 2048;\n  background-color: white;\n  cursor: pointer;\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  justify-content: flex-start;\n  align-items: center; }\n  .igv-generic-container div:first-child {\n    cursor: move;\n    display: flex;\n    flex-flow: row;\n    flex-wrap: nowrap;\n    justify-content: flex-end;\n    align-items: center;\n    height: 24px;\n    width: 100%;\n    background-color: #dddddd; }\n    .igv-generic-container div:first-child i {\n      display: block;\n      color: #5f5f5f;\n      cursor: pointer;\n      width: 14px;\n      height: 14px;\n      margin-right: 8px;\n      margin-bottom: 4px; }\n\n.igv-generic-dialog-container {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 300px;\n  height: 200px;\n  border-color: #7F7F7F;\n  border-radius: 4px;\n  border-style: solid;\n  border-width: thin;\n  font-family: "Open Sans", sans-serif;\n  font-size: medium;\n  font-weight: 400;\n  z-index: 2048;\n  background-color: white;\n  display: flex;\n  flex-flow: column;\n  flex-wrap: nowrap;\n  justify-content: flex-start;\n  align-items: center; }\n  .igv-generic-dialog-container .igv-generic-dialog-header {\n    display: flex;\n    flex-flow: row;\n    flex-wrap: nowrap;\n    justify-content: flex-end;\n    align-items: center;\n    width: 100%;\n    height: 24px;\n    cursor: move;\n    border-top-left-radius: 4px;\n    border-top-right-radius: 4px;\n    border-bottom-color: #7F7F7F;\n    border-bottom-style: solid;\n    border-bottom-width: thin;\n    background-color: #eee; }\n    .igv-generic-dialog-container .igv-generic-dialog-header div {\n      margin-right: 4px;\n      margin-bottom: 2px;\n      height: 12px;\n      width: 12px;\n      color: #7F7F7F; }\n    .igv-generic-dialog-container .igv-generic-dialog-header div:hover {\n      cursor: pointer;\n      color: #444; }\n  .igv-generic-dialog-container .igv-generic-dialog-one-liner {\n    color: #373737;\n    width: 95%;\n    height: 24px;\n    line-height: 24px;\n    text-align: left;\n    margin-top: 8px;\n    padding-left: 8px;\n    overflow-wrap: break-word;\n    background-color: white; }\n  .igv-generic-dialog-container .igv-generic-dialog-label-input {\n    margin-top: 8px;\n    width: 95%;\n    height: 24px;\n    color: #373737;\n    line-height: 24px;\n    padding-left: 8px;\n    background-color: white;\n    display: flex;\n    flex-flow: row;\n    flex-wrap: nowrap;\n    justify-content: flex-start;\n    align-items: center; }\n    .igv-generic-dialog-container .igv-generic-dialog-label-input div {\n      width: 30%;\n      height: 100%;\n      font-size: 16px;\n      text-align: right;\n      padding-right: 8px;\n      background-color: white; }\n    .igv-generic-dialog-container .igv-generic-dialog-label-input input {\n      display: block;\n      height: 100%;\n      width: 100%;\n      padding-left: 4px;\n      font-family: "Open Sans", sans-serif;\n      font-weight: 400;\n      color: #373737;\n      text-align: left;\n      outline: none;\n      border-style: solid;\n      border-width: thin;\n      border-color: #7F7F7F;\n      background-color: white; }\n    .igv-generic-dialog-container .igv-generic-dialog-label-input input {\n      width: 50%;\n      font-size: 16px; }\n  .igv-generic-dialog-container .igv-generic-dialog-input {\n    margin-top: 8px;\n    width: calc(100% - 16px);\n    height: 24px;\n    color: #373737;\n    line-height: 24px;\n    display: flex;\n    flex-flow: row;\n    flex-wrap: nowrap;\n    justify-content: space-around;\n    align-items: center; }\n    .igv-generic-dialog-container .igv-generic-dialog-input input {\n      display: block;\n      height: 100%;\n      width: 100%;\n      padding-left: 4px;\n      font-family: "Open Sans", sans-serif;\n      font-weight: 400;\n      color: #373737;\n      text-align: left;\n      outline: none;\n      border-style: solid;\n      border-width: thin;\n      border-color: #7F7F7F;\n      background-color: white; }\n    .igv-generic-dialog-container .igv-generic-dialog-input input {\n      font-size: 16px; }\n  .igv-generic-dialog-container .igv-generic-dialog-ok-cancel {\n    width: 100%;\n    height: 28px;\n    display: flex;\n    flex-flow: row;\n    flex-wrap: nowrap;\n    justify-content: space-around;\n    align-items: center; }\n    .igv-generic-dialog-container .igv-generic-dialog-ok-cancel div {\n      margin-top: 32px;\n      color: white;\n      font-family: "Open Sans", sans-serif;\n      font-size: 14px;\n      font-weight: 400;\n      width: 75px;\n      height: 28px;\n      line-height: 28px;\n      text-align: center;\n      border-color: transparent;\n      border-style: solid;\n      border-width: thin;\n      border-radius: 2px; }\n    .igv-generic-dialog-container .igv-generic-dialog-ok-cancel div:first-child {\n      margin-left: 32px;\n      margin-right: 0;\n      background-color: #5ea4e0; }\n    .igv-generic-dialog-container .igv-generic-dialog-ok-cancel div:last-child {\n      margin-left: 0;\n      margin-right: 32px;\n      background-color: #c4c4c4; }\n    .igv-generic-dialog-container .igv-generic-dialog-ok-cancel div:first-child:hover {\n      cursor: pointer;\n      background-color: #3b5c7f; }\n    .igv-generic-dialog-container .igv-generic-dialog-ok-cancel div:last-child:hover {\n      cursor: pointer;\n      background-color: #7f7f7f; }\n  .igv-generic-dialog-container .igv-generic-dialog-ok {\n    width: 100%;\n    height: 36px;\n    margin-top: 32px;\n    display: flex;\n    flex-flow: row;\n    flex-wrap: nowrap;\n    justify-content: space-around;\n    align-items: center; }\n    .igv-generic-dialog-container .igv-generic-dialog-ok div {\n      width: 98px;\n      height: 36px;\n      line-height: 36px;\n      text-align: center;\n      color: white;\n      font-family: "Open Sans", sans-serif;\n      font-size: medium;\n      font-weight: 400;\n      border-color: white;\n      border-style: solid;\n      border-width: thin;\n      border-radius: 4px;\n      background-color: #2B81AF; }\n    .igv-generic-dialog-container .igv-generic-dialog-ok div:hover {\n      cursor: pointer;\n      background-color: #25597f; }\n\n.igv-menu-popup {\n  position: absolute;\n  top: 0;\n  left: 0;\n  min-width: 132px;\n  z-index: 4096;\n  cursor: pointer;\n  font-family: "Open Sans", sans-serif;\n  font-size: small;\n  font-weight: 400;\n  color: #4b4b4b;\n  background: white;\n  border-radius: 4px;\n  border-color: #7F7F7F;\n  border-style: solid;\n  border-width: thin;\n  display: flex;\n  flex-flow: column;\n  flex-wrap: nowrap;\n  justify-content: flex-start;\n  align-items: flex-end;\n  text-align: left; }\n  .igv-menu-popup > div:not(:first-child) {\n    width: 100%; }\n    .igv-menu-popup > div:not(:first-child) > div {\n      background: white; }\n    .igv-menu-popup > div:not(:first-child) > div.context-menu {\n      padding-left: 4px;\n      padding-right: 4px; }\n    .igv-menu-popup > div:not(:first-child) > div:last-child {\n      border-bottom-left-radius: 4px;\n      border-bottom-right-radius: 4px;\n      border-bottom-color: transparent;\n      border-bottom-style: solid;\n      border-bottom-width: thin; }\n    .igv-menu-popup > div:not(:first-child) > div:hover {\n      background: #efefef; }\n\n.igv-menu-popup-shim {\n  padding-left: 8px;\n  padding-right: 8px; }\n\n.igv-menu-popup-header {\n  position: relative;\n  width: 100%;\n  height: 24px;\n  cursor: move;\n  border-top-color: transparent;\n  border-top-left-radius: 4px;\n  border-top-right-radius: 4px;\n  border-bottom-color: #7F7F7F;\n  border-bottom-style: solid;\n  border-bottom-width: thin;\n  background-color: #eee;\n  display: flex;\n  flex-flow: row;\n  flex-wrap: nowrap;\n  justify-content: flex-end;\n  align-items: center; }\n  .igv-menu-popup-header div {\n    margin-right: 4px;\n    height: 12px;\n    width: 12px;\n    color: #7F7F7F; }\n  .igv-menu-popup-header div:hover {\n    cursor: pointer;\n    color: #444; }\n\n.igv-menu-popup-check-container {\n  display: flex;\n  flex-flow: row;\n  flex-wrap: nowrap;\n  justify-content: flex-start;\n  align-items: center;\n  width: 100%;\n  height: 20px;\n  background-color: transparent; }\n  .igv-menu-popup-check-container div {\n    padding-top: 2px;\n    padding-left: 8px; }\n  .igv-menu-popup-check-container div:first-child {\n    position: relative;\n    width: 12px;\n    height: 12px; }\n    .igv-menu-popup-check-container div:first-child svg {\n      position: absolute;\n      width: 12px;\n      height: 12px; }\n\n.igv-user-feedback {\n  position: fixed;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  width: 512px;\n  height: 360px;\n  z-index: 2048;\n  background-color: white;\n  border-color: #a2a2a2;\n  border-style: solid;\n  border-width: thin;\n  font-family: "Open Sans", sans-serif;\n  font-size: medium;\n  font-weight: 400;\n  color: #444;\n  display: flex;\n  flex-direction: column;\n  flex-wrap: nowrap;\n  justify-content: flex-start;\n  align-items: center; }\n  .igv-user-feedback div:first-child {\n    position: relative;\n    height: 24px;\n    width: 100%;\n    background-color: white;\n    border-bottom-color: #a2a2a2;\n    border-bottom-style: solid;\n    border-bottom-width: thin; }\n    .igv-user-feedback div:first-child div {\n      position: absolute;\n      top: 2px;\n      width: 16px;\n      height: 16px;\n      background-color: transparent; }\n    .igv-user-feedback div:first-child div:first-child {\n      left: 8px; }\n    .igv-user-feedback div:first-child div:last-child {\n      cursor: pointer;\n      right: 8px; }\n  .igv-user-feedback div:last-child {\n    width: 100%;\n    height: calc(100% - 24px);\n    border-width: 0; }\n    .igv-user-feedback div:last-child div {\n      width: auto;\n      height: auto;\n      margin: 8px; }\n\n.igv-root {\n  position: relative;\n  padding-top: 4px;\n  margin-left: 10px;\n  margin-right: 10px;\n  display: flex;\n  flex-flow: column;\n  flex-wrap: nowrap;\n  justify-content: flex-start;\n  align-items: stretch; }\n  .igv-root .igv-navbar {\n    display: flex;\n    flex-flow: row;\n    flex-wrap: nowrap;\n    justify-content: space-between;\n    align-items: center;\n    color: #444;\n    font-size: 12px;\n    font-family: "Open Sans", sans-serif;\n    font-weight: 400;\n    line-height: 32px;\n    padding-left: 8px;\n    padding-right: 8px;\n    margin-top: 2px;\n    margin-bottom: 4px;\n    height: 32px;\n    border-style: solid;\n    border-radius: 3px;\n    border-width: thin;\n    border-color: #bfbfbf;\n    background-color: #f3f3f3; }\n    .igv-root .igv-navbar .igv-navbar-left-container {\n      display: flex;\n      flex-flow: row;\n      flex-wrap: nowrap;\n      justify-content: space-between;\n      align-items: center;\n      height: 32px;\n      line-height: 32px; }\n      .igv-root .igv-navbar .igv-navbar-left-container .igv-logo {\n        width: 34px;\n        height: 32px;\n        margin-right: 8px; }\n      .igv-root .igv-navbar .igv-navbar-left-container .igv-current-genome {\n        height: 32px;\n        margin-left: 4px;\n        margin-right: 4px;\n        user-select: none;\n        line-height: 32px;\n        vertical-align: middle;\n        text-align: center; }\n      .igv-root .igv-navbar .igv-navbar-left-container .igv-navbar-genomic-location {\n        display: flex;\n        flex-flow: row;\n        flex-wrap: nowrap;\n        justify-content: space-between;\n        align-items: center;\n        height: 100%; }\n        .igv-root .igv-navbar .igv-navbar-left-container .igv-navbar-genomic-location .igv-chromosome-select-widget-container {\n          display: flex;\n          flex-flow: column;\n          flex-wrap: nowrap;\n          justify-content: space-around;\n          align-items: center;\n          height: 100%;\n          width: 125px;\n          margin-right: 4px; }\n          .igv-root .igv-navbar .igv-navbar-left-container .igv-navbar-genomic-location .igv-chromosome-select-widget-container select {\n            display: block;\n            cursor: pointer;\n            width: 100px;\n            height: 75%;\n            outline: none;\n            font-size: 12px;\n            font-family: "Open Sans", sans-serif;\n            font-weight: 400; }\n        .igv-root .igv-navbar .igv-navbar-left-container .igv-navbar-genomic-location .igv-locus-size-group {\n          display: flex;\n          flex-flow: row;\n          flex-wrap: nowrap;\n          justify-content: space-between;\n          align-items: center;\n          margin-left: 8px;\n          height: 22px; }\n          .igv-root .igv-navbar .igv-navbar-left-container .igv-navbar-genomic-location .igv-locus-size-group .igv-search-container {\n            display: flex;\n            flex-flow: row;\n            flex-wrap: nowrap;\n            justify-content: flex-start;\n            align-items: center;\n            width: 200px;\n            height: 22px;\n            line-height: 22px; }\n            .igv-root .igv-navbar .igv-navbar-left-container .igv-navbar-genomic-location .igv-locus-size-group .igv-search-container input.igv-search-input {\n              cursor: text;\n              width: 85%;\n              height: 22px;\n              line-height: 22px;\n              font-size: 12px;\n              font-family: "Open Sans", sans-serif;\n              font-weight: 400;\n              text-align: left;\n              padding-left: 8px;\n              margin-right: 8px;\n              outline: none;\n              border-style: solid;\n              border-radius: 3px;\n              border-width: thin;\n              border-color: #bfbfbf;\n              background-color: white; }\n            .igv-root .igv-navbar .igv-navbar-left-container .igv-navbar-genomic-location .igv-locus-size-group .igv-search-container .igv-search-icon-container {\n              cursor: pointer;\n              height: 16px;\n              width: 16px; }\n          .igv-root .igv-navbar .igv-navbar-left-container .igv-navbar-genomic-location .igv-locus-size-group .igv-windowsize-panel-container {\n            margin-left: 4px;\n            user-select: none; }\n    .igv-root .igv-navbar .igv-navbar-right-container {\n      display: flex;\n      flex-flow: row;\n      flex-wrap: nowrap;\n      justify-content: space-between;\n      align-items: center;\n      height: 32px;\n      line-height: 32px; }\n      .igv-root .igv-navbar .igv-navbar-right-container .igv-navbar-toggle-button-container {\n        display: flex;\n        flex-flow: row;\n        flex-wrap: nowrap;\n        justify-content: space-between;\n        align-items: center;\n        height: 100%; }\n        .igv-root .igv-navbar .igv-navbar-right-container .igv-navbar-toggle-button-container div {\n          margin-left: 0;\n          margin-right: 4px; }\n        .igv-root .igv-navbar .igv-navbar-right-container .igv-navbar-toggle-button-container div:last-child {\n          margin-left: 0;\n          margin-right: 0; }\n      .igv-root .igv-navbar .igv-navbar-right-container .igv-navbar-toggle-button-container-750 {\n        display: none; }\n      .igv-root .igv-navbar .igv-navbar-right-container .igv-zoom-widget {\n        color: #737373;\n        font-size: 18px;\n        height: 32px;\n        line-height: 32px;\n        margin-left: 8px;\n        user-select: none;\n        display: flex;\n        flex-flow: row;\n        flex-wrap: nowrap;\n        justify-content: flex-end;\n        align-items: center; }\n        .igv-root .igv-navbar .igv-navbar-right-container .igv-zoom-widget div {\n          cursor: pointer;\n          margin-left: unset;\n          margin-right: unset; }\n        .igv-root .igv-navbar .igv-navbar-right-container .igv-zoom-widget div:first-child {\n          height: 24px;\n          width: 24px;\n          margin-left: unset;\n          margin-right: 8px; }\n        .igv-root .igv-navbar .igv-navbar-right-container .igv-zoom-widget div:last-child {\n          height: 24px;\n          width: 24px;\n          margin-left: 8px;\n          margin-right: unset; }\n        .igv-root .igv-navbar .igv-navbar-right-container .igv-zoom-widget div:nth-child(even) {\n          display: block;\n          height: fit-content; }\n        .igv-root .igv-navbar .igv-navbar-right-container .igv-zoom-widget input {\n          display: block;\n          width: 125px; }\n        .igv-root .igv-navbar .igv-navbar-right-container .igv-zoom-widget svg {\n          display: block; }\n      .igv-root .igv-navbar .igv-navbar-right-container .igv-zoom-widget-900 {\n        color: #737373;\n        font-size: 18px;\n        height: 32px;\n        line-height: 32px;\n        margin-left: 8px;\n        user-select: none;\n        display: flex;\n        flex-flow: row;\n        flex-wrap: nowrap;\n        justify-content: flex-end;\n        align-items: center; }\n        .igv-root .igv-navbar .igv-navbar-right-container .igv-zoom-widget-900 div {\n          cursor: pointer;\n          margin-left: unset;\n          margin-right: unset; }\n        .igv-root .igv-navbar .igv-navbar-right-container .igv-zoom-widget-900 div:first-child {\n          height: 24px;\n          width: 24px;\n          margin-left: unset;\n          margin-right: 8px; }\n        .igv-root .igv-navbar .igv-navbar-right-container .igv-zoom-widget-900 div:last-child {\n          height: 24px;\n          width: 24px;\n          margin-left: 8px;\n          margin-right: unset; }\n        .igv-root .igv-navbar .igv-navbar-right-container .igv-zoom-widget-900 div:nth-child(even) {\n          width: 0;\n          height: 0;\n          display: none; }\n        .igv-root .igv-navbar .igv-navbar-right-container .igv-zoom-widget-900 input {\n          width: 0;\n          height: 0;\n          display: none; }\n        .igv-root .igv-navbar .igv-navbar-right-container .igv-zoom-widget-900 svg {\n          display: block; }\n      .igv-root .igv-navbar .igv-navbar-right-container .igv-zoom-widget-hidden {\n        display: none; }\n  .igv-root .igv-ideogram-container {\n    display: flex;\n    flex-flow: row;\n    flex-wrap: nowrap;\n    justify-content: flex-start;\n    align-items: center;\n    margin-top: 10px;\n    height: 16px;\n    width: 100%; }\n    .igv-root .igv-ideogram-container .igv-ideogram-content {\n      height: 100%;\n      background-color: white; }\n    .igv-root .igv-ideogram-container .igv-ideogram-content:first-child {\n      margin-left: 50px; }\n    .igv-root .igv-ideogram-container .igv-ideogram-content-border-right {\n      border-right-color: #292929;\n      border-right-style: solid;\n      border-right-width: 1px; }\n  .igv-root .igv-track-container {\n    position: relative; }\n\n.igv-multi-locus-separator {\n  pointer-events: none;\n  user-select: none;\n  -moz-user-select: none;\n  -webkit-user-select: none;\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  z-index: 2;\n  width: 1px;\n  background-color: gray; }\n\n.igv-track-container-spinner {\n  position: absolute;\n  top: 90%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  z-index: 1024;\n  width: 24px;\n  height: 24px;\n  pointer-events: none;\n  color: #737373; }\n\n.igv-track {\n  position: relative;\n  width: 100%;\n  margin-top: 4px;\n  display: flex;\n  flex-flow: row;\n  flex-wrap: nowrap;\n  justify-content: flex-start;\n  align-items: stretch; }\n\n.igv-left-hand-gutter {\n  width: 50px;\n  height: 100%; }\n\n.igv-right-hand-gutter {\n  position: relative;\n  width: 36px;\n  height: 100%;\n  background: white; }\n\n.igv-viewport-container {\n  position: relative;\n  display: flex;\n  flex-flow: row;\n  flex-wrap: nowrap;\n  justify-content: flex-start;\n  align-items: stretch;\n  width: calc(100% - 112px);\n  height: 100%; }\n  .igv-viewport-container .igv-viewport {\n    position: relative;\n    height: 100%;\n    overflow-x: hidden;\n    overflow-y: hidden;\n    background-color: white; }\n  .igv-viewport-container .igv-viewport-multi-locus-gap-shim {\n    height: 100%;\n    width: 1px;\n    margin-left: 2px;\n    margin-right: 2px;\n    background-color: transparent; }\n\n.igv-viewport-content {\n  position: relative;\n  width: 100%; }\n\n.igv-canvas {\n  position: relative;\n  display: block; }\n\n.igv-scrollbar-shim {\n  position: relative;\n  width: 14px;\n  height: 100%;\n  background-color: white; }\n\n.igv-scrollbar-outer-div {\n  position: relative;\n  width: 14px;\n  height: 100%;\n  background-color: white; }\n  .igv-scrollbar-outer-div > div {\n    cursor: pointer;\n    position: absolute;\n    top: 0;\n    left: 2px;\n    width: 8px;\n    border-width: 1px;\n    border-style: solid;\n    border-color: #c4c4c4;\n    border-top-left-radius: 4px;\n    border-top-right-radius: 4px;\n    border-bottom-left-radius: 4px;\n    border-bottom-right-radius: 4px;\n    background-color: transparent; }\n  .igv-scrollbar-outer-div > div:hover {\n    background-color: #c4c4c4; }\n\n.igv-viewport-border-right {\n  border-right-color: #292929;\n  border-right-style: solid;\n  border-right-width: 1px; }\n\n.igv-viewport-ruler {\n  cursor: pointer;\n  font-family: "Open Sans", sans-serif;\n  font-size: 10px;\n  font-weight: 200;\n  text-align: center; }\n  .igv-viewport-ruler > div {\n    height: 100%; }\n\n.igv-track-manipulation-handle {\n  position: relative;\n  cursor: pointer;\n  width: 12px;\n  height: 100%;\n  margin-left: 0;\n  font-size: medium;\n  border-color: #c4c4c4;\n  border-style: solid;\n  border-width: 0;\n  border-top-right-radius: 6px;\n  border-bottom-right-radius: 6px;\n  z-index: 512;\n  background-color: #c4c4c4; }\n\n.igv-track-manipulation-handle:hover,\n.igv-track-manipulation-handle:focus,\n.igv-track-manipulation-handle:active {\n  border-color: #7e7e7e;\n  background-color: #7e7e7e; }\n\n.igv-multi-locus-panel-border {\n  position: absolute;\n  top: 0;\n  left: 0;\n  height: 100%;\n  width: 1px;\n  background-color: green;\n  border-right-color: #ff0000;\n  border-right-style: solid;\n  border-right-width: 1px; }\n\n.igv-navbar-button {\n  box-sizing: unset;\n  padding-left: 6px;\n  padding-right: 6px;\n  height: 18px;\n  text-transform: capitalize;\n  user-select: none;\n  line-height: 18px;\n  text-align: center;\n  vertical-align: middle;\n  font-family: "Open Sans", sans-serif;\n  font-size: 11px;\n  font-weight: 200;\n  color: #737373;\n  background-color: #f3f3f3;\n  border-color: #737373;\n  border-style: solid;\n  border-width: thin;\n  border-radius: 6px; }\n\n.igv-navbar-button-clicked {\n  color: white;\n  background-color: #737373; }\n\n.igv-navbar-button:hover {\n  cursor: pointer; }\n\n.igv-logo-nonav {\n  margin-left: 4px;\n  margin-top: 12px;\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 34px;\n  height: 16px; }\n\n.igv-search-results {\n  position: absolute;\n  top: 32px;\n  left: 2px;\n  height: 320px;\n  width: 213px;\n  background-color: white;\n  border-color: #7F7F7F;\n  border-style: solid;\n  border-width: thin;\n  overflow-x: hidden;\n  overflow-y: auto;\n  z-index: 9999; }\n  .igv-search-results tr {\n    font-family: "Open Sans", sans-serif;\n    font-size: small;\n    font-weight: 400;\n    color: #444; }\n  .igv-search-results tr:hover,\n  .igv-search-results tr:focus,\n  .igv-search-results tr:active {\n    cursor: pointer;\n    font-weight: 700;\n    color: #141414; }\n\n.igv-viewport-message {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  color: rgba(0, 0, 0, 0.15);\n  font-family: "Open Sans", sans-serif;\n  font-size: 25px;\n  font-weight: bold;\n  user-select: none; }\n\n.igv-whole-genome-container {\n  display: flex;\n  flex-flow: row;\n  flex-wrap: nowrap;\n  justify-content: space-between;\n  width: 100%;\n  height: 100%;\n  background-color: white; }\n  .igv-whole-genome-container div {\n    font-family: "Open Sans", sans-serif;\n    font-size: 10px;\n    font-weight: 400;\n    color: #444;\n    height: 100%;\n    text-align: center;\n    border-right-color: #bfbfbf;\n    border-right-style: solid;\n    border-right-width: thin; }\n    .igv-whole-genome-container div span {\n      display: block;\n      padding-top: 6px;\n      text-overflow: ellipsis; }\n  .igv-whole-genome-container div:last-child {\n    border-right-color: transparent; }\n  .igv-whole-genome-container div:hover,\n  .igv-whole-genome-container div:focus,\n  .igv-whole-genome-container div:active {\n    cursor: pointer;\n    background-color: #efefef; }\n\n.igv-multi-locus-panel-close-container {\n  position: absolute;\n  top: 4px;\n  right: 4px;\n  width: 16px;\n  height: 16px;\n  color: #666666;\n  z-index: 1000; }\n\n.igv-multi-locus-panel-close-container:hover {\n  cursor: pointer;\n  color: #434343; }\n\n.igv-multi-locus-panel-label-div {\n  position: absolute;\n  left: 50%;\n  top: 15%;\n  transform: translate(-50%, -25%);\n  font-family: "Open Sans", sans-serif;\n  font-size: 12px;\n  font-weight: 400;\n  text-align: center;\n  min-width: 16px;\n  z-index: 64;\n  color: #373737;\n  background-color: white;\n  padding: 1px; }\n\n.igv-multi-locus-panel-label-div:hover {\n  cursor: pointer; }\n\n.igv-viewport-spinner {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  z-index: 1024;\n  width: 24px;\n  height: 24px;\n  pointer-events: none;\n  color: #737373; }\n\n.igv-ruler-sweeper-div {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 0;\n  height: 100%;\n  z-index: 99999;\n  background-color: rgba(68, 134, 247, 0.25); }\n\n.igv-track-menu-border-top {\n  border-top-color: #a2a2a2;\n  border-top-style: solid;\n  border-top-width: thin; }\n\n.igv-track-menu-category {\n  padding-left: 4px;\n  font-weight: 400; }\n\n.igv-track-drag-scrim {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 100%;\n  height: 100%;\n  z-index: 256;\n  background-color: rgba(68, 134, 247, 0.25); }\n\n.igv-trackgear-container {\n  position: relative;\n  width: 20px;\n  height: 20px;\n  margin-left: 4px;\n  color: #7F7F7F; }\n\n.igv-trackgear-container:hover {\n  cursor: pointer;\n  color: #444; }\n\n.igv-track-label {\n  position: absolute;\n  left: 8px;\n  top: 8px;\n  width: auto;\n  height: auto;\n  max-width: 200px;\n  padding-left: 4px;\n  padding-right: 4px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  font-family: "Open Sans", sans-serif;\n  font-size: small;\n  font-weight: 400;\n  text-align: center;\n  user-select: none;\n  -moz-user-select: none;\n  -webkit-user-select: none;\n  border-color: #444;\n  border-radius: 2px;\n  border-style: solid;\n  border-width: thin;\n  background-color: white;\n  z-index: 128;\n  cursor: pointer; }\n\n.igv-track-label:hover,\n.igv-track-label:focus,\n.igv-track-label:active {\n  background-color: rgba(0, 0, 0, 0.05); }\n\n.zoom-in-notice-container {\n  position: absolute;\n  top: 10px;\n  left: 50%; }\n  .zoom-in-notice-container div {\n    position: relative;\n    left: -50%;\n    font-family: "Open Sans", sans-serif;\n    font-size: medium;\n    font-weight: 400;\n    color: #3f3f3f;\n    background-color: rgba(255, 255, 255, 0.51);\n    z-index: 64; }\n\n.igv-center-guide {\n  pointer-events: none;\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 50%;\n  width: 8px;\n  z-index: 8;\n  display: none;\n  user-select: none;\n  -moz-user-select: none;\n  -webkit-user-select: none;\n  border-left-style: dashed;\n  border-left-width: thin;\n  border-right-style: dashed;\n  border-right-width: thin; }\n\n.igv-center-guide-wide {\n  background-color: rgba(0, 0, 0, 0);\n  border-left-color: rgba(127, 127, 127, 0.51);\n  border-right-color: rgba(127, 127, 127, 0.51); }\n\n.igv-center-guide-thin {\n  left: 50%;\n  width: 1px;\n  background-color: rgba(0, 0, 0, 0);\n  border-left-color: rgba(127, 127, 127, 0.51);\n  border-right-color: rgba(0, 0, 0, 0);\n  /*background-color: rgba(127, 127, 127, 0.51);*/\n  /*border-left-color: rgba(0,0,0,0);*/\n  /*border-right-color: rgba(0,0,0,0);*/ }\n\n.igv-cursor-tracking-guide {\n  pointer-events: none;\n  user-select: none;\n  -moz-user-select: none;\n  -webkit-user-select: none;\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 50%;\n  width: 1px;\n  z-index: 1;\n  border-left-style: dotted;\n  border-left-width: thin;\n  border-left-color: rgba(127, 127, 127, 0.76);\n  display: none; }\n\n.igv-clickable {\n  cursor: pointer;\n  background-color: white; }\n\n#color-by-tag {\n  color: #444; }\n\n#color-by-tag:hover,\n#color-by-tag:focus,\n#color-by-tag:active {\n  cursor: pointer;\n  padding-left: 2px;\n  padding-right: 2px;\n  color: white;\n  border-color: #444;\n  border-radius: 2px;\n  border-style: solid;\n  border-width: thin;\n  background-color: #7f7f7f; }\n\n.igv-ellipsis {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis; }\n\n.igv-spinner-container {\n  color: #3f3f3f;\n  width: 100%;\n  height: 100%;\n  text-align: center;\n  padding-top: 8px;\n  font-size: 24px;\n  z-index: 512; }\n\n.igv-fa-check-visible {\n  color: inherit;\n  padding-right: 2px; }\n\n.igv-fa-check-hidden {\n  color: transparent;\n  padding-right: 2px; }\n\n.validateTips {\n  border: 1px solid transparent;\n  padding: 0.3em; }\n  .validateTips fieldset {\n    border: 0; }\n\n.igv-spacer-10 {\n  height: 10px;\n  width: 100%;\n  font-size: 0;\n  margin: 0;\n  padding: 0;\n  border: 0;\n  display: block; }\n\n.igv-fa5-spin {\n  -webkit-animation: igv-fa5-spin 2s infinite linear;\n  animation: igv-fa5-spin 2s infinite linear; }\n\n@-webkit-keyframes igv-fa5-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n    transform: rotate(0deg); }\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg); } }\n@keyframes igv-fa5-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n    transform: rotate(0deg); }\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg); } }\n\n/*# sourceMappingURL=igv.css.map */\n',document.head.insertBefore(t,document.head.childNodes[document.head.childNodes.length-1])}();var Rh={createBrowser:async function(t,e){void 0===e&&(e={}),_n.KNOWN_GENOMES||await _n.initializeGenomes(e),function(t){void 0===t.promisified&&(t.promisified=!1);void 0===t.minimumBases&&(t.minimumBases=40);void 0===t.showIdeogram&&(t.showIdeogram=!0);void 0===t.showCursorTrackingGuideButton&&(t.showCursorTrackingGuideButton=!0);void 0===t.showCenterGuideButton&&(t.showCenterGuideButton=!0);void 0===t.showSVGButton&&(t.showSVGButton=!0);void 0===t.showTrackLabelButton&&(t.showTrackLabelButton=!0);void 0===t.showCursorTrackingGuide&&(t.showCursorTrackingGuide=!1);void 0===t.showCenterGuide&&(t.showCenterGuide=!1);void 0===t.showTrackLabels&&(t.showTrackLabels=!0);void 0===t.showControls&&(t.showControls=!0);void 0===t.showNavigation&&(t.showNavigation=!0);void 0===t.showRuler&&(t.showRuler=!0);void 0===t.flanking&&(t.flanking=1e3);void 0===t.pairsSupported&&(t.pairsSupported=!0);t.tracks||(t.tracks=[])}(e),!1!==e.queryParametersSupported&&function(t){var e,i,n,r,s,o,a,h,l;let c,u;if(a=window.location.href,s={},e=a.indexOf("?"),i=a.lastIndexOf("#"),e>=0)for(i<0&&(i=a.length),n=e+1;n<i;)(r=a.indexOf("&",n))<0&&(r=i),2===(o=a.substring(n,r).split("=",2)).length&&(h=o[0],l=decodeURIComponent(o[1]),"file"===h?c=l.split(","):"index"===h?u=l.split(","):t[h]=l,n=r+1);if(c){t.tracks||(t.tracks=[]);for(let e=0;e<c.length;e++){if(c[e].endsWith(".xml")||c[e].endsWith(".json")){t.sessionURL=c[e];break}const i={url:c[e]};u&&u.length>e&&(i.indexURL=u[e]),t.tracks.push(i)}}}(e),e.apiKey&&un.setApiKey(e.apiKey),e.oauthToken&&Xi.setToken(e.oauthToken),e.clientId&&!Z()&&await G({clientId:e.clientId,apiKey:e.apiKey,scope:"https://www.googleapis.com/auth/userinfo.profile"}),function(t){let e=1;t.tracks&&t.tracks.forEach((function(t){void 0===t.order&&(t.order=e++)}))}(e);const i=new dh(e,t);Eh.push(i),function(t,e){const i=function(t,e){t.navbarManager=new Ch(t);const i=Ri("<div>",{class:"igv-navbar"});t.$navigation=i;const n=Ri("<div>",{class:"igv-navbar-left-container"});i.append(n);const r=Ri("<div>",{class:"igv-logo"});n.append(r);const s=Ri('<svg width="690px" height="324px" viewBox="0 0 690 324" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>IGV</title><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="IGV" fill="#666666"><polygon id="Path" points="379.54574 8.00169252 455.581247 8.00169252 515.564813 188.87244 532.884012 253.529506 537.108207 253.529506 554.849825 188.87244 614.833392 8.00169252 689.60164 8.00169252 582.729511 320.722144 486.840288 320.722144"></polygon><path d="M261.482414,323.793286 C207.975678,323.793286 168.339046,310.552102 142.571329,284.069337 C116.803612,257.586572 103.919946,217.158702 103.919946,162.784513 C103.919946,108.410325 117.437235,67.8415913 144.472217,41.0770945 C171.507199,14.3125977 212.903894,0.930550071 268.663545,0.930550071 C283.025879,0.930550071 298.232828,1.84616386 314.284849,3.6774189 C330.33687,5.50867394 344.839793,7.97378798 357.794056,11.072835 L357.794056,68.968378 C339.48912,65.869331 323.578145,63.5450806 310.060654,61.9955571 C296.543163,60.4460336 284.574731,59.6712835 274.154998,59.6712835 C255.850062,59.6712835 240.502308,61.4320792 228.111274,64.9537236 C215.720241,68.4753679 205.793482,74.2507779 198.330701,82.2801269 C190.867919,90.309476 185.587729,100.87425 182.48997,113.974767 C179.392212,127.075284 177.843356,143.345037 177.843356,162.784513 C177.843356,181.942258 179.251407,198.000716 182.067551,210.960367 C184.883695,223.920018 189.671068,234.41436 196.429813,242.443709 C203.188559,250.473058 212.059279,256.178037 223.042241,259.558815 C234.025202,262.939594 247.683295,264.629958 264.01693,264.629958 C268.241146,264.629958 273.098922,264.489094 278.590403,264.207362 C284.081883,263.925631 289.643684,263.50304 295.275972,262.939577 L295.275972,159.826347 L361.595831,159.826347 L361.595831,308.579859 C344.698967,313.087564 327.239137,316.750019 309.215815,319.567334 C291.192494,322.38465 275.281519,323.793286 261.482414,323.793286 L261.482414,323.793286 L261.482414,323.793286 Z" id="Path"></path>;<polygon id="Path" points="0.81355666 5.00169252 73.0472883 5.00169252 73.0472883 317.722144 0.81355666 317.722144"></polygon></g> </g> </svg>');s.css("width","34px"),s.css("height","32px"),r.append(s),t.$current_genome=Ri("<div>",{class:"igv-current-genome"}),n.append(t.$current_genome),t.$current_genome.text("");const o=Ri("<div>",{class:"igv-navbar-genomic-location"});n.append(o),t.chromosomeSelectWidget=new yh(t,o),void 0===e.showChromosomeWidget&&(e.showChromosomeWidget=!0);!0===e.showChromosomeWidget?t.chromosomeSelectWidget.$container.show():t.chromosomeSelectWidget.$container.hide();const a=Ri("<div>",{class:"igv-locus-size-group"});o.append(a);const h=Ri("<div>",{class:"igv-search-container"});a.append(h),t.$searchInput=Ri("<input>",{class:"igv-search-input",type:"text",placeholder:"Locus Search"}),h.append(t.$searchInput),t.$searchInput.change((async()=>{try{const e=t.$searchInput.val(),i=await t.search(e);i.length>1&&(t.updateLocusSearchWidget(i),t.windowSizePanel.updatePanel(i))}catch(t){v.presentAlert(t)}}));const l=Ri("<div>",{class:"igv-search-icon-container"});h.append(l),l.append(Tn("search")),l.on("click",(()=>t.search(t.$searchInput.val()))),t.windowSizePanel=new gh(a,t);const c=Ri("<div>",{class:"igv-navbar-right-container"});i.append(c);const u=Ri('<div class="igv-navbar-toggle-button-container">');c.append(u),t.$toggle_button_container=u,t.cursorGuide=new Sh(Ri(t.trackContainer),u,e,t),t.centerGuide=new kh(Ri(t.trackContainer),u,e,t),!0===e.showTrackLabelButton&&(t.trackLabelControl=new xh(u,t));e.showSVGButton&&(t.svgSaveControl=new wh(u,t));t.zoomWidget=new vh(t,c),!1===e.showNavigation&&t.$navigation.hide();return i}(t,e);i.insertBefore(Ri(t.trackContainer)),!1===e.showControls&&i.hide()}(i,e),i.userFeedback=new bh(Ri(i.trackContainer)),i.userFeedback.hide(),i.inputDialog=new y(i.$root.get(0)),i.dataRangeDialog=new mh(i.$root),!1===e.showTrackLabels?i.hideTrackLabels():(i.showTrackLabels(),i.trackLabelControl&&i.trackLabelControl.setState(i.trackLabelsVisible)),!1===e.showCursorTrackingGuide?i.cursorGuide.doHide():i.cursorGuide.doShow(),!1===e.showCenterGuide?i.centerGuide.doHide():i.centerGuide.doShow(),e.sessionURL?await i.loadSession({url:e.sessionURL}):await i.loadSessionObject(e);const n=i.isMultiLocusWholeGenomeView()||_n.isWholeGenomeView(i.referenceFrameList[0].chr);return i.isMultiLocusMode()||n?i.centerGuide.forcedHide():i.centerGuide.forcedShow(),i.navbarManager.navbarDidResize(i.$navigation.width(),n),i},removeBrowser:function(t){t.dispose(),t.$root.remove(),Eh=Eh.filter((e=>e!==t))},removeAllBrowsers:function(){for(let t of Eh)t.dispose(),t.$root.remove();Eh=[]},visibilityChange:async function(){for(let t of Eh)await t.visibilityChange()},setGoogleOauthToken:function(t){return Xi.setToken(t)},oauth:Xi,version:kn,xhr:Th,setApiKey:Ah};export default Rh;
//# sourceMappingURL=igv.esm.min.js.map
